{
  "version": 3,
  "sources": ["../../../../elements/prompt-advanced/constants.ts", "../../../../elements/prompt-advanced/elements/reference-frame-picker/events.ts", "../../../../elements/prompt-advanced/elements/reference-frame-picker/reference-frame-picker.css.ts", "../../../../elements/prompt-advanced/elements/reference-frame-picker/reference-frame-picker.ts", "../../../../elements/common/coordinate-types.ts", "../../../../elements/hooks/with-hooks.ts", "../../../../elements/hooks/use-borrow-url.ts", "../../../../elements/internal/css-functions.ts", "../../../../elements/hooks/use-observed-value.ts", "../../../../elements/hooks/use-observed-values.ts", "../../../../elements/hooks/use-promise.ts", "../../../../elements/hooks/use-element.ts", "../../../../functions/dom-functions.ts", "../../../../elements/hooks/use-spectrum-theme.ts", "../../../../elements/hooks/use-drag-observe.ts", "../../../../elements/hooks/use-drag-transaction.ts", "../../../../elements/textfield/events.ts", "../../../../elements/textfield/functions.ts", "../../../../elements/textfield/textfield.css.ts", "../../../../elements/textfield/textfield.ts", "../../../../elements/common/styles.css.ts", "../../../../functions/array-functions.ts", "../../../../functions/nano-banana-constants.ts", "../../../../functions/aspect-ratio-functions.ts", "../../../../services/dependent-state/enable-universal-asset-picker-shared.ts", "../../../../elements/icons/icon-upload-s2.ts", "../../../../elements/tooltip/tooltip.css.ts", "../../../../elements/tooltip/tooltip.ts", "../../../../elements/upload/crop-overlay.css.ts", "../../../../elements/upload/events.ts", "../../../../elements/upload/crop-overlay.ts", "../../../../services/locale-service/locale-functions.ts", "../../../../../node_modules/.pnpm/tslib@2.8.1/node_modules/tslib/tslib.es6.mjs", "../../../../../node_modules/.pnpm/@formatjs+icu-messageformat-parser@2.7.8/node_modules/@formatjs/icu-messageformat-parser/lib/error.js", "../../../../../node_modules/.pnpm/@formatjs+icu-messageformat-parser@2.7.8/node_modules/@formatjs/icu-messageformat-parser/lib/types.js", "../../../../../node_modules/.pnpm/@formatjs+icu-messageformat-parser@2.7.8/node_modules/@formatjs/icu-messageformat-parser/lib/regex.generated.js", "../../../../../node_modules/.pnpm/@formatjs+icu-skeleton-parser@1.8.2/node_modules/@formatjs/icu-skeleton-parser/lib/date-time.js", "../../../../../node_modules/.pnpm/@formatjs+icu-skeleton-parser@1.8.2/node_modules/@formatjs/icu-skeleton-parser/lib/regex.generated.js", "../../../../../node_modules/.pnpm/@formatjs+icu-skeleton-parser@1.8.2/node_modules/@formatjs/icu-skeleton-parser/lib/number.js", "../../../../../node_modules/.pnpm/@formatjs+icu-messageformat-parser@2.7.8/node_modules/@formatjs/icu-messageformat-parser/lib/time-data.generated.js", "../../../../../node_modules/.pnpm/@formatjs+icu-messageformat-parser@2.7.8/node_modules/@formatjs/icu-messageformat-parser/lib/date-time-pattern-generator.js", "../../../../../node_modules/.pnpm/@formatjs+icu-messageformat-parser@2.7.8/node_modules/@formatjs/icu-messageformat-parser/lib/parser.js", "../../../../../node_modules/.pnpm/@formatjs+icu-messageformat-parser@2.7.8/node_modules/@formatjs/icu-messageformat-parser/lib/index.js", "../../../../../node_modules/.pnpm/@formatjs+fast-memoize@2.2.0/node_modules/@formatjs/fast-memoize/lib/index.js", "../../../../../node_modules/.pnpm/intl-messageformat@10.5.14/node_modules/intl-messageformat/lib/src/error.js", "../../../../../node_modules/.pnpm/intl-messageformat@10.5.14/node_modules/intl-messageformat/lib/src/formatters.js", "../../../../../node_modules/.pnpm/intl-messageformat@10.5.14/node_modules/intl-messageformat/lib/src/core.js", "../../../../functions/environment-functions.ts", "../../../../services/locale-service/icu-message-locale-service.ts", "../../../../services/locale-service/index.ts", "../../../../elements/cropper/cropper-functions.ts", "../../../../elements/cropper/cropper.css.ts", "../../../../elements/cropper/events.ts", "../../../../elements/cropper/cropper.ts", "../../../../functions/file-functions/download.ts", "../../../../functions/file-functions.ts", "../../../../functions/video-functions.ts", "../../../../functions/image-functions.ts", "../../../../functions/file-edit-functions.ts", "../../../../functions/math-functions.ts", "../../../../elements/common/geometry-functions.ts", "../../../../elements/icons/icon-checkmark.ts", "../../../../elements/tray-panel/tray-panel.css.ts", "../../../../elements/tray-panel/tray-panel.ts", "../../../../elements/upload/modals.css.ts", "../../../../elements/upload/dni-flagged-modal.ts", "../../../../services/host-service/host-service-functions.ts", "../../../../elements/upload/elements/empty-state/empty-state-presentation.ts", "../../../../elements/upload/elements/empty-state/empty-state.css.ts", "../../../../elements/upload/elements/popover-menu/popover-menu-presentation.ts", "../../../../elements/icons/icon-file-upload.ts", "../../../../elements/icons/icon-upload-to-cloud.ts", "../../../../elements/upload/elements/popover-menu/popover-menu.css.ts", "../../../../elements/upload/file-preview.css.ts", "../../../../elements/upload/file-preview.ts", "../../../../elements/upload/types.ts", "../../../../elements/upload/upload.css.ts", "../../../../elements/upload/upload.ts", "../../../../elements/icons/icon-adobe-cloud-storage.ts", "../../../../elements/icons/icon-file-import.ts", "../../../../elements/uap/events.ts", "../../../../elements/uap/functions.ts", "../../../../elements/uap/uap-config.ts", "../../../../elements/uap/uap-presentation.ts", "../../../../elements/uap/uap.css.ts", "../../../../elements/uap/uap.ts", "../../../../functions/aup-sdk-functions.ts", "../../../../elements/prompt-advanced/events.ts", "../../../../elements/prompt-advanced/functions/icon-functions.ts", "../../../../elements/icons/icon-ai-effects.ts", "../../../../elements/icons/icon-aspect-landscape.ts", "../../../../elements/icons/icon-aspect-portrait.ts", "../../../../elements/icons/icon-aspect-ratio.ts", "../../../../elements/icons/icon-aspect-square.ts", "../../../../elements/icons/icon-aspect-tallscreen.ts", "../../../../elements/icons/icon-aspect-widescreen.ts", "../../../../elements/icons/icon-audio-wave.ts", "../../../../elements/icons/icon-crown.ts", "../../../../elements/icons/icon-image.ts", "../../../../elements/icons/icon-models.ts", "../../../../elements/icons/icon-vector-draw.ts", "../../../../elements/icons/icon-vector.ts", "../../../../elements/icons/icon-video.ts", "../../../../elements/image-icon/image-icon.css.ts", "../../../../elements/image-icon/image-icon.ts", "../../../../functions/lit-functions.ts", "../../../../elements/prompt-advanced/functions/utils.ts", "../../../../services/image-generation-service/types/reference-support.ts", "../../../../services/image-generation-service/image-generation-service.ts", "../../../../types/graphics-types.ts", "../../../../types/reference-blob-types.ts", "../../../../services/commerce-data-service/commerce-data-types.ts", "../../../../functions/object-functions.ts", "../../../../services/host-service/host-service.ts", "../../../../services/graphic-generation-service/graphic-generation-service.ts", "../../../../services/types.ts", "../../../../services/video-generation-service/video-generation-service.ts", "../../../../services/video-generation-service/video-generation-model.ts", "../../../../elements/prompt-advanced/elements/effect-thumbnail-item/effect-thumbnail-item.css.ts", "../../../../elements/prompt-advanced/elements/effect-thumbnail-item/effect-thumbnail-item.ts", "../../../../elements/prompt-advanced/prompt-advanced-unlocalized.ts", "../../../../elements/prompt-advanced/prompt-advanced.css.ts", "../../../../elements/prompt-advanced/prompt-advanced.ts", "../../../../elements/coach-indicator/coach-indicator.css.ts", "../../../../elements/coach-indicator/coach-indicator.ts", "../../../../elements/icons/icon-ai-generate.ts", "../../../../elements/icons/icon-ai-sparkles.ts", "../../../../elements/icons/icon-properties.ts", "../../../../elements/prompt/events.ts", "../../../../elements/prompt/prompt.css.ts", "../../../../elements/prompt/prompt.ts", "../../../../functions/key-functions.ts", "../../../../elements/selectable-grid/events.ts", "../../../../elements/selectable-grid/functions/accessibility-functions.ts", "../../../../elements/selectable-grid/functions/drag-functions.ts", "../../../../elements/selectable-grid/functions/keyboard-functions.ts", "../../../../elements/selectable-grid/functions/selection-functions.ts", "../../../../elements/selectable-grid/selectable-grid-presentation.ts", "../../../../elements/grid/grid.ts", "../../../../elements/selectable-grid/selectable-grid.css.ts", "../../../../elements/selectable-grid/selectable-grid.ts", "../../../../elements/prompt-advanced/functions/config-parser-image.ts", "../../../../functions/model-functions.ts", "../../../../elements/prompt-advanced/functions/config-parser-video.ts", "../../../../elements/prompt-advanced/functions/config-parser-sound-fx.ts", "../../events.ts"],
  "sourcesContent": ["// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport fireflyThumbnail from '../../assets/filogo/firefly_thumbnail_new.svg';\n\nimport googleThumbnail from '../../assets/google_thumbnail.png';\nimport openAIThumbnail from '../../assets/gpt-icon-white.jpg';\nimport blackforestThumbnail from '../../assets/model-icon-flux.png';\nimport ideogramThumbnail from '../../assets/model-icon-ideogram.png';\nimport runwayThumbnail from '../../assets/runway-thumbnail.png';\nimport { ImageGenerationModelId } from '../../services/image-generation-service/image-generation-service.js';\nimport { VectorGenerationModelId } from '../../services/vector-generation-service/vector-generation-service.js';\nimport googleVideoThumbnail from '../../services/video-generation-service/configs/google/shared/assets/thumbnail.png';\nimport lumaThumbnail from '../../services/video-generation-service/configs/luma/shared/assets/thumbnail.png';\nimport pikaThumbnail from '../../services/video-generation-service/configs/pika/shared/assets/thumbnail.png';\nimport { VideoGenerationModelId } from '../../services/video-generation-service/video-generation-service.js';\n\n// extracted from the constants files in applications\nexport const imageModelThumbnails = {\n  'adobe:firefly:colligo:image3': fireflyThumbnail,\n  'adobe:firefly:colligo:image4': fireflyThumbnail,\n  'adobe:firefly:colligo:image4:ultra': fireflyThumbnail,\n  'adobe:firefly:colligo:image5': fireflyThumbnail,\n  'google:firefly:colligo:imagen3': googleThumbnail,\n  'google:firefly:colligo:imagen4': googleThumbnail,\n  'google:firefly:colligo:gemini-flash': googleThumbnail,\n  'google:firefly:colligo:nano-banana-pro': googleThumbnail,\n  'ideogram:firefly:colligo:ideogram3': ideogramThumbnail,\n  'openai:firefly:colligo:gpt-4o': openAIThumbnail,\n  'blackforest:firefly:colligo:flux-pro': blackforestThumbnail,\n  'blackforest:firefly:colligo:flux-ultra': blackforestThumbnail,\n  'blackforest:firefly:colligo:flux-ultra-raw': blackforestThumbnail,\n  'blackforest:firefly:colligo:flux2-pro': blackforestThumbnail,\n  'runway:firefly:colligo:gen4': runwayThumbnail,\n  'blackforest:firefly:colligo:flux-kontext-max': blackforestThumbnail,\n  'blackforest:firefly:colligo:flux-kontext-pro': blackforestThumbnail,\n} as const satisfies Record<ImageGenerationModelId, string>;\n\nexport const vectorModelThumbnails = {\n  'adobe:firefly:colligo:image3': fireflyThumbnail,\n  'google:firefly:colligo:imagen3': googleThumbnail,\n  'google:firefly:colligo:imagen4': googleThumbnail,\n  'openai:firefly:colligo:gpt-4o': openAIThumbnail,\n  'blackforest:firefly:colligo:flux-pro': blackforestThumbnail,\n  'ideogramAI:firefly:colligo:ideogram3': ideogramThumbnail,\n} as const satisfies Record<VectorGenerationModelId, string>;\n\nexport const videoModelThumbnails = {\n  'adobe:firefly:colligo:video1': fireflyThumbnail,\n  'google:firefly:colligo:veo31': googleVideoThumbnail,\n  'google:firefly:colligo:veo31-fast': googleVideoThumbnail,\n  'google:firefly:colligo:veo3': googleVideoThumbnail,\n  'google:firefly:colligo:veo2': googleVideoThumbnail,\n  'pika:firefly:colligo:pika22': pikaThumbnail,\n  'luma:firefly:colligo:ray2': lumaThumbnail,\n  'luma:firefly:colligo:ray3': lumaThumbnail,\n  'luma:firefly:colligo:ray3-flash': lumaThumbnail,\n  'luma:firefly:colligo:ray3-hdr': lumaThumbnail,\n  'video:runway:firefly:colligo:gen4_aleph': runwayThumbnail,\n  'video:runway:firefly:colligo:gen45': runwayThumbnail,\n  'video:runway:firefly:colligo:gen45_turbo': runwayThumbnail,\n  'openai:firefly:colligo:sora2': openAIThumbnail,\n  'openai:firefly:colligo:sora2-pro': openAIThumbnail,\n} as const satisfies Record<VideoGenerationModelId, string>;\n\nexport const defaultThumbnail = fireflyThumbnail;\n\nexport const APPLICATION_KEY = 'application' as const;\n\n// application keys\nexport const VECTOR_APPLICATION_KEY = 'vector-generation' as const;\nexport const IMAGE_APPLICATION_KEY = 'image-generation' as const;\nexport const VIDEO_APPLICATION_KEY = 'video-generation' as const;\nexport const SOUND_FX_APPLICATION_KEY = 'sound-fx-generation' as const;\n\n// setting keys\nexport const MODEL_KEY = 'model' as const;\nexport const ASPECT_RATIO_KEY = 'aspect-ratio' as const;\nexport const EFFECTS_KEY = 'effects' as const;\nexport const VIDEO_REFERENCE_FRAMES_KEY = 'reference-frames' as const;\n\nexport const PromptBarAppConfigKey = {\n  application: {\n    VECTOR: VECTOR_APPLICATION_KEY,\n    IMAGE: IMAGE_APPLICATION_KEY,\n    VIDEO: VIDEO_APPLICATION_KEY,\n    SOUND_FX: SOUND_FX_APPLICATION_KEY,\n  },\n  setting: {\n    MODEL: MODEL_KEY,\n    ASPECT_RATIO: ASPECT_RATIO_KEY,\n    EFFECTS: EFFECTS_KEY,\n    VIDEO_REFERENCE_FRAMES: VIDEO_REFERENCE_FRAMES_KEY,\n  },\n  filter: {\n    ALL: 'all' as const,\n    FIRST_PARTY: 'first-party' as const,\n    THIRD_PARTY: 'third-party' as const,\n  },\n};\n\nexport const PROMPT_KEY = 'prompt' as const;\nexport const VIDEO_REFERENCE_FRAMES_FIRST_FRAME_KEY = 'first-frame' as const;\nexport const VIDEO_REFERENCE_FRAMES_END_FRAME_KEY = 'end-frame' as const;\nexport const INTERNAL_CLIENT_ID = 'clio-playground-web' as const;\n\n// TODO: Clean up these breakpoints/names once breakpoints are 100% confirmed with design/tested\nexport const SCREENWIDTH = {\n  XL: 2048,\n  LG: 1680,\n  MD: 1440,\n  SM: 1280,\n  XS: 1080,\n  MOBILE_L: 900,\n  MOBILE_M: 768,\n  MOBILE_S: 600,\n  MOBILE_XS: 440,\n  MOBILE_XXS: 393,\n  MOBILE_XXXS: 320,\n} as const;\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { AdvancedSettingChangeItem, PromptAdvancedInteractionEventType } from '../../prompt-advanced.types.js';\n\nexport type PromptAdvancedFrameSelectionEventDetail = {\n  value: AdvancedSettingChangeItem;\n};\n\nexport class PromptAdvancedFrameSelectionEvent extends CustomEvent<PromptAdvancedFrameSelectionEventDetail> {\n  static readonly eventName = 'prompt-advanced-frame-selection';\n\n  constructor(payload: PromptAdvancedFrameSelectionEventDetail) {\n    super(PromptAdvancedFrameSelectionEvent.eventName, { detail: payload });\n  }\n}\n\nexport type ReferenceFramePickerInteractEventDetail = {\n  type: PromptAdvancedInteractionEventType;\n  value?: string | string[];\n  item?: AdvancedSettingChangeItem | AdvancedSettingChangeItem[];\n};\n\nexport class ReferenceFramePickerInteractEvent extends CustomEvent<ReferenceFramePickerInteractEventDetail> {\n  static readonly eventName = 'prompt-advanced-reference-frame-picker-interact';\n\n  constructor(payload: ReferenceFramePickerInteractEventDetail) {\n    super(ReferenceFramePickerInteractEvent.eventName, { detail: payload });\n  }\n}\n", "import { css } from 'lit';\n\nexport const styles = css`\n  :host {\n    display: flex;\n    flex-direction: row;\n    gap: var(--spectrum-spacing-200);\n  }\n\n  firefly-upload {\n    --firefly-upload-preview-width: max-content;\n    --firefly-upload-preview-height: 32px;\n    --firefly-upload-preview-height-new: 32px;\n    --firefly-upload-preview-flex-direction: row;\n    --firefly-upload-preview-width-with-file: 110px;\n    --firefly-upload-preview-padding: 7px 12px 7px 10px;\n    --firefly-upload-font-size: var(--spectrum-font-size-100);\n    --firefly-upload-preview-border-width: 1px;\n    --firefly-upload-preview-border-color: var(--spectrum-gray-500);\n    --firefly-upload-preview-gap: 6px;\n    --firefly-upload-disabled-opacity: 0.5;\n    --firefly-upload-font-color-disabled: var(--spectrum-gray-800);\n  }\n`;\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { PromptAdvancedFrameSelectionEvent, ReferenceFramePickerInteractEvent } from './events.js';\nimport { styles } from './reference-frame-picker.css.js';\nimport { fromConstant } from '@adobe/data/observe';\nimport { LitElement, html } from 'lit';\nimport { customElement, property } from 'lit/decorators.js';\nimport { repeat } from 'lit/directives/repeat.js';\n\nimport { useObservedValues, withHooks } from '../../../index.js';\nimport '@spectrum-web-components/menu/sp-menu-item.js';\nimport '@spectrum-web-components/menu/sp-menu.js';\nimport '@spectrum-web-components/picker/sp-picker.js';\n\nimport { getNumericAspectRatio } from '../../../../functions/aspect-ratio-functions.js';\nimport { FileEditorSettings } from '../../../../functions/file-edit-functions.js';\nimport { enableUniversalAssetPickerShared } from '../../../../services/dependent-state/enable-universal-asset-picker-shared.js';\nimport { HostService } from '../../../../services/host-service/host-service.js';\nimport { Size } from '../../../../services/video-generation-service/video-generation-service.js';\nimport { commonStyles } from '../../../common/styles.css.js';\nimport '../../../icons/icon-upload-s2.js';\nimport '../../../tooltip/tooltip.js';\nimport { FileChangeEvent } from '../../../upload/events.js';\nimport '../../../upload/upload.js';\nimport { ReferenceFrameValue } from '../../prompt-advanced.types.js';\nimport type { AdvancedSetting, AdvancedSettingItem, PromptAdvancedLocalized, PromptAdvancedServices } from '../../prompt-advanced.types.js';\n\nconst tagName = 'firefly-prompt-advanced-reference-frame-picker';\n\ninterface PromptAdvancedReferenceFramePickerProps {\n  setting?: AdvancedSetting;\n}\n\n@customElement(tagName)\nexport class PromptAdvancedReferenceFramePicker extends LitElement implements PromptAdvancedReferenceFramePickerProps {\n  static styles = [commonStyles, styles];\n\n  @property({ type: Object }) setting?: AdvancedSetting;\n\n  @property({ type: Object }) services?: PromptAdvancedServices;\n\n  @property({ type: Object }) aspectRatio?: Size;\n\n  @property({ type: Object }) localized?: PromptAdvancedLocalized;\n\n  handleFileChange = ({\n    index,\n    settingId,\n    file,\n    editorSettings,\n  }: {\n    index: number;\n    settingId: string;\n    file: File | undefined;\n    editorSettings?: FileEditorSettings;\n  }) => {\n    const eventType = editorSettings?.crop ? 'edit' : 'select';\n    const value = { file, editorSettings, index };\n    const item = { id: settingId, value };\n\n    this.dispatchEvent(new PromptAdvancedFrameSelectionEvent({ value: item }));\n\n    this.dispatchEvent(\n      new ReferenceFramePickerInteractEvent({\n        type: eventType,\n        value: settingId,\n        item,\n      })\n    );\n  };\n\n  getItems() {\n    const items = this.setting?.items?.filter((item): item is AdvancedSettingItem => 'id' in item) ?? [];\n    return { items, numItems: items.length };\n  }\n\n  @withHooks\n  render() {\n    const features = this.services?.features ?? {};\n    const authentication = this.services?.authentication ?? {};\n    const environment = this.services?.environment ?? {};\n    const sam = this.services?.sam ?? {};\n    const hostService = { features, authentication, environment, sam } as HostService;\n\n    const isUploadCropperEnabledObservable = this.services?.features?.uploadCropper ?? fromConstant(false);\n    const isUniversalAssetPickerEnabledObservable =\n      this.services?.features?.enableUniversalAssetPicker && this.services?.authentication?.isSignedIn\n        ? enableUniversalAssetPickerShared({ host: hostService })\n        : fromConstant(false);\n\n    const values = useObservedValues(() => ({\n      isUploadCropperEnabled: isUploadCropperEnabledObservable,\n      isUniversalAssetPickerEnabled: isUniversalAssetPickerEnabledObservable,\n    }));\n\n    const { items } = this.getItems();\n    return repeat(\n      items,\n      item => item.id,\n      (item, index) => {\n        const referenceFrameValue = item?.value as ReferenceFrameValue | undefined;\n        const fileRef = referenceFrameValue?.fileRef ?? null;\n        return html`\n          <firefly-upload\n            .fileRef=${fileRef}\n            .editorSettings=${referenceFrameValue?.editorSettings}\n            placeholder=${item.label}\n            .localized=${this.localized?.uploadUnlocalized}\n            .acceptedFileTypes=${'image/jpg,image/jpeg,image/png,image/webp'}\n            .disabled=${!!item.disabled}\n            variant=\"compact\"\n            size=\"s\"\n            .cropOverlayPlacement=${'bottom'}\n            @uploadSourceOpened=${() => {\n              this.dispatchEvent(new ReferenceFramePickerInteractEvent({ type: 'open' }));\n            }}\n            .uploadButtonLabel=${item.label}\n            .contentAuthenticity=${this.services?.contentAuthenticity}\n            .authentication=${this.services?.authentication}\n            .environment=${this.services?.environment}\n            .sam=${this.services?.sam}\n            ?enableEditing=${values?.isUploadCropperEnabled}\n            .aspectRatio=${this.aspectRatio ? getNumericAspectRatio(this.aspectRatio) : null}\n            ?enableUniversalAssetPicker=${values?.isUniversalAssetPickerEnabled}\n            @fileChanged=${(e: FileChangeEvent) => {\n              const file = e.detail.file;\n              const editorSettings = e.detail.editorSettings;\n              this.handleFileChange({ index, settingId: item.id, file, editorSettings });\n            }}>\n            <sp-icon slot=\"placeHolderIcon\" size=\"xl\">\n              <firefly-icon-upload-s2></firefly-icon-upload-s2>\n            </sp-icon>\n          </firefly-upload>\n        `;\n      }\n    );\n  }\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { F32Schema, FromSchema, Schema } from '@adobe/data/schema';\n\n/**\n * Point in 2D space\n */\nexport interface Point {\n  x: number;\n  y: number;\n}\n\n/**\n * Rectangle with top-left coordinates\n */\nexport interface Rectangle {\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n}\n\nexport const BoundsSchema = {\n  type: 'object',\n  properties: {\n    x: F32Schema,\n    y: F32Schema,\n    width: F32Schema,\n    height: F32Schema,\n    rotation: F32Schema,\n  },\n  required: ['x', 'y', 'width', 'height'],\n  default: {\n    x: 0,\n    y: 0,\n    width: 0,\n    height: 0,\n    rotation: 0,\n  },\n  additionalProperties: false,\n} as const satisfies Schema;\n\nexport type Bounds = FromSchema<typeof BoundsSchema>;\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport type { ReactiveController } from 'lit';\n\nconst hookPropsKey = Symbol('isHookControllerAttached');\nconst renderElementStack: Array<HookElement> = [];\n\ntype EffectHookState = { dispose?: () => void; dependencies: unknown[] };\nfunction isEffectHookState(value: unknown): value is EffectHookState {\n  const maybe = value as Partial<EffectHookState>;\n  return typeof maybe?.dispose === 'function';\n}\n\n//  This is implemented by LitElement, but we can add hooks to any function on any element that implements this interface.\ntype HookElement = {\n  addController: (controller: ReactiveController) => void;\n  requestUpdate(): void;\n  [hookPropsKey]: HookProperties;\n};\n\nfunction arrayEquals<T>(a?: ArrayLike<T>, b?: ArrayLike<T>) {\n  if (a === undefined || b === undefined) {\n    return false;\n  }\n  const length = a.length;\n  if (length !== b.length) {\n    return false;\n  }\n  for (let i = 0; i < length; i++) {\n    if (a[i] !== b[i]) {\n      return false;\n    }\n  }\n  return true;\n}\n\n/**\n * This decorator can be attached to lit element render functions to enable the use of hooks.\n */\n// eslint-disable-next-line @typescript-eslint/no-explicit-any -- need any for hooks\nexport function withHooks<T extends (...args: any[]) => any>(\n  _target: Omit<HookElement, typeof hookPropsKey>,\n  _propertyKey: string,\n  descriptor: TypedPropertyDescriptor<T>\n): TypedPropertyDescriptor<T> {\n  const original = descriptor.value;\n\n  descriptor.value = function withHooksRenderWrapper(this: HookElement, ...args: unknown[]) {\n    let props = this[hookPropsKey];\n    if (props) {\n      props.hookIndex = 0;\n    } else {\n      props = this[hookPropsKey] = {\n        hookIndex: 0,\n        hooks: [],\n        updatedListeners: new Set(),\n      };\n      this.addController({\n        hostDisconnected: () => {\n          //  dispose of all effect hooks\n          for (const hook of props.hooks) {\n            if (isEffectHookState(hook)) {\n              hook.dispose?.();\n            }\n          }\n          //  clear all hook data\n          props.hooks = [];\n        },\n        hostUpdated: () => {\n          //  call all updated listeners\n          for (const listener of props.updatedListeners) {\n            listener();\n          }\n        },\n      });\n    }\n    renderElementStack.push(this);\n    try {\n      return original?.call(this, ...args);\n    } finally {\n      renderElementStack.pop();\n    }\n  } as T;\n\n  return descriptor;\n}\n\ninterface HookProperties {\n  hookIndex: number;\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any -- need any for hooks\n  hooks: (StateHookState<any> | EffectHookState | UpdatedHookState)[];\n  updatedListeners: Set<() => void>;\n}\n\n// useEffect and useState hooks. The only fundamental hooks that we need.\n\ntype EffectCallback = () => void | (() => void);\n\nexport function useActiveElement() {\n  const activeElement = renderElementStack[renderElementStack.length - 1];\n  if (!activeElement) {\n    throw new Error(`Hooks can only be used with a render function decorated with @withHooks. Did you forget to add the decorator?`);\n  }\n  return activeElement;\n}\n\nexport function useEffect(callback: EffectCallback, dependencies: unknown[] = []) {\n  const activeElement = useActiveElement();\n  const hookProps = activeElement[hookPropsKey];\n  const hookIndex = hookProps.hookIndex++;\n  const oldHookState = hookProps.hooks[hookIndex] as EffectHookState | undefined;\n  const rerunEffect = !oldHookState || !arrayEquals(dependencies, oldHookState.dependencies);\n  if (rerunEffect) {\n    oldHookState?.dispose?.();\n    hookProps.hooks[hookIndex] = { dispose: callback.call(hookProps) ?? undefined, dependencies };\n  }\n}\n\ntype StateHookState<T> = [T, (value: T) => void];\n\nexport function useState<T>(initialFunction: () => T): [T, (value: T) => void];\nexport function useState<T>(initial: T): [T, (value: T) => void];\nexport function useState<T>(initialOrFunction: T): [T, (value: T) => void] {\n  const activeElement = useActiveElement();\n  const hookProps = activeElement[hookPropsKey];\n  const hookIndex = hookProps.hookIndex++;\n  let hookState = hookProps.hooks[hookIndex] as StateHookState<T> | undefined;\n  if (!hookState) {\n    hookState = hookProps.hooks[hookIndex] = [\n      typeof initialOrFunction === 'function' ? initialOrFunction() : initialOrFunction,\n      (value: T) => {\n        if (hookState) {\n          hookState[0] = value;\n          activeElement.requestUpdate();\n        }\n      },\n    ] as StateHookState<T>;\n  }\n  return hookState;\n}\n\ntype UpdatedHookState = () => void;\n\n/**\n * Adds a callback that will fire after the host lit element has been updated.\n * This is useful for when you need to access an element that you can't find during the first render\n * because it hasn't been added to the dom yet.\n * @see https://lit.dev/docs/components/lifecycle/#updated\n */\nexport function useUpdated(listener: () => void) {\n  const activeElement = useActiveElement();\n  const hookProps = activeElement[hookPropsKey];\n  const hookIndex = hookProps.hookIndex++;\n  const hookState = hookProps.hooks[hookIndex] as UpdatedHookState | undefined;\n  if (hookState) {\n    hookProps.updatedListeners.delete(hookState);\n  }\n  hookProps.updatedListeners.add(listener);\n}\n\nexport function useRef<T>(initialValue?: T) {\n  const [ref] = useState({ current: initialValue });\n  return ref;\n}\n\nexport function useMemo<T>(compute: () => T, dependencies: unknown[] = []): T {\n  // eslint-disable-next-line prefer-const -- this is a bug in the linter\n  let [value, setValue] = useState(undefined as T);\n  useEffect(() => {\n    const newValue = compute();\n    if (newValue !== value) {\n      setValue((value = newValue));\n    }\n  }, dependencies);\n  return value;\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { useEffect, useState } from './with-hooks.js';\nimport { BlobRef, blobStore } from '@adobe/data/cache';\n\n/**\n * Borrows a URL from a BlobRef in the blob store.\n * @param blobRef\n * @returns undefined if not yet ready, null if not found or the URL when succeeded.\n */\nexport function useBorrowUrl(blobRef: BlobRef | null = null): string | null | undefined {\n  // eslint-disable-next-line prefer-const -- this is a bug in the linter\n  let [url, setUrl] = useState<string | null | undefined>(undefined);\n  useEffect(() => {\n    if (!blobRef) {\n      setUrl(null);\n      return () => {};\n    }\n    let disconnected = false;\n    const cleanup = () => {\n      if (url) {\n        blobStore.returnUrl(url);\n        url = undefined;\n      }\n    };\n\n    blobStore\n      .borrowUrl(blobRef)\n      .then(value => {\n        // this must be set before the possible cleanup call\n        url = value;\n        if (disconnected) {\n          cleanup();\n        } else {\n          setUrl(url);\n        }\n      })\n      .catch(e => {\n        console.error('error borrowing url', e);\n      });\n    return () => {\n      disconnected = true;\n      cleanup();\n    };\n  }, [JSON.stringify(blobRef)]);\n\n  return blobRef ? url : null;\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { CssUnit } from '../types.js';\n\n/**\n * @internal\n */\nexport const toCssUnitString = (measurement: CssUnit): string => {\n  if (typeof measurement === 'number') {\n    return `${measurement}px`;\n  }\n\n  return measurement;\n};\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { useEffect, useState } from './with-hooks.js';\nimport { Observe } from '@adobe/data/observe';\n\n/**\n * This hook allows returns the current observed value from an observe function or undefined if it hasn't notified with a first value yet.\n */\nexport function useObservedValue<T>(observe: Observe<T>) {\n  // eslint-disable-next-line prefer-const -- setValue is assigned later, but eslint doesn't understand desctructuring.\n  let [value, setValue] = useState<T | undefined>(undefined);\n\n  useEffect(() => {\n    const dispose = observe(newValue => {\n      value = newValue;\n      setValue(newValue);\n    });\n    return () => {\n      dispose();\n    };\n  }, [observe]);\n\n  return value;\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { useObservedValue } from './use-observed-value.js';\nimport { useMemo } from './with-hooks.js';\nimport { Observe, fromProperties } from '@adobe/data/observe';\n\n/**\n * Given a function which returns an object with observe function properties,\n * returns an object of the values of those observe functions or undefined if any of the observe functions haven't notified with a first value yet.\n * Internally, this uses useMemo\n * @param dependencies - Any depenencies which should trigger a recompute of the observables properties function.\n */\nexport function useObservedValues<T extends { readonly [key: string]: Observe<unknown> }>(\n  observeProperties: () => T,\n  dependencies?: unknown[]\n):\n  | {\n      readonly [K in keyof T]: T[K] extends Observe<infer U> ? U : never;\n    }\n  | undefined {\n  const observables = useMemo(() => {\n    return fromProperties(observeProperties());\n  }, dependencies);\n  const values = useObservedValue(observables);\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any -- we know this is correctly typed.\n  return values as any;\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { useEffect, useState } from './with-hooks.js';\n\nexport function usePromise<T>(promiseFactory: () => Promise<T>, deps: unknown[]): T | null {\n  const [data, setData] = useState<T | null>(null);\n\n  useEffect(() => {\n    let isMounted = true;\n\n    promiseFactory().then((result: T) => {\n      if (isMounted) {\n        setData(result);\n      }\n    });\n\n    return () => {\n      isMounted = false;\n    };\n  }, deps);\n\n  return data;\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { useActiveElement } from './with-hooks.js';\nimport { LitElement } from 'lit';\n\n/**\n * @returns The currently actively rendering lit element.\n */\nexport function useElement(): LitElement {\n  return useActiveElement() as unknown as LitElement;\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\n\n/**\n * Recursively searches for an element matching the given selector within the\n * given root element and its shadow DOM.\n *\n * @param root - The root element to search within.\n * @param selector - The CSS selector to match.\n * @returns The first element matching the selector, or null if no match is found.\n */\nexport function querySelectorDeep(root: Element | ShadowRoot | Document, selector: string): HTMLElement | null {\n  const directMatch = root.querySelector(selector);\n  if (directMatch) {\n    return directMatch as HTMLElement;\n  }\n  if (root instanceof Element && root.shadowRoot) {\n    const shadowMatch = querySelectorDeep(root.shadowRoot, selector);\n    if (shadowMatch) {\n      return shadowMatch;\n    }\n  }\n  const potentialShadowHosts = root.querySelectorAll('*');\n  for (const host of potentialShadowHosts) {\n    if (host.shadowRoot) {\n      const shadowMatch = querySelectorDeep(host.shadowRoot, selector);\n      if (shadowMatch) {\n        return shadowMatch;\n      }\n    }\n  }\n\n  return null;\n}\n\nexport function* iterateSelfAndAncestors(element: Element): IterableIterator<Element> {\n  let current: Element | null = element;\n\n  while (current) {\n    yield current;\n\n    if (current instanceof HTMLSlotElement && current.assignedSlot) {\n      // Move to the slot's parent if the current element is assigned to a slot\n      current = current.assignedSlot;\n    } else if (current.parentNode instanceof Element) {\n      // Move up to the parent node if it is an element\n      current = current.parentNode;\n    } else if ((current.getRootNode() as ShadowRoot).host) {\n      // Move to the host element if we're at a shadow root\n      current = (current.getRootNode() as ShadowRoot).host;\n    } else {\n      // If no more ancestors, stop the iteration\n      current = null;\n    }\n  }\n}\n\n/**\n * Returns the first ancestor of the element that satisfies the predicate.\n * @param element the element to start searching from\n * @param predicate the predicate to satisfy\n * @returns the first ancestor that satisfies the predicate or null if no ancestor satisfies the predicate\n */\nexport function getSelfOrAncestor(element: Element, predicate: (element: Element) => boolean): Element | null {\n  for (const ancestor of iterateSelfAndAncestors(element)) {\n    if (predicate(ancestor)) {\n      return ancestor;\n    }\n  }\n  return null;\n}\n\n/**\n * Returns the first ancestor of the element that has the given tag name.\n * @param element the element to start searching from\n * @param tagName the tag name to search for\n * @returns the first ancestor that has the given tag name or null if no ancestor has the given tag name\n */\nexport function getSelfOrAncestorByTagName(element: Element, tagName: string): Element | null {\n  tagName = tagName.toLowerCase();\n  return getSelfOrAncestor(element, check => check.tagName.toLowerCase() === tagName);\n}\n\n/**\n * Creates a custom element with the given tag name, properties, and event handlers.\n * @param tagName the tag name of the element to create\n * @param properties the properties to set on the element\n * @param eventHandlers the event handlers to set on the element\n * @returns the created element\n */\nexport function createCustomElement<T extends keyof HTMLElementTagNameMap>(\n  tagName: T,\n  properties?: Partial<HTMLElementTagNameMap[T]>,\n  eventHandlers?: Record<string, (event: Event) => void | ((event: Event) => void)[]>\n) {\n  const element = document.createElement(tagName);\n  // Properties can be either attributes/complex objects.\n  Object.entries(properties ?? {}).forEach(([key, value]) => {\n    // @ts-expect-error - Assume the custom element can handle the property.\n    element[key] = value;\n    // We don't know if the property is an attribute or a property, so we set both.\n    element.setAttribute(key, value);\n  });\n  Object.entries(eventHandlers ?? {}).forEach(([eventName, handlers]) => {\n    if (Array.isArray(handlers)) {\n      handlers.forEach(handler => element.addEventListener(eventName, handler));\n    } else {\n      element.addEventListener(eventName, handlers);\n    }\n  });\n  return element;\n}\n\n/**\n * This decorator makes a method into a capturing event handler.\n */\nexport function withCapture(_target: object, _propertyKey: string | symbol, descriptor: PropertyDescriptor) {\n  descriptor.value.capture = true;\n  return descriptor;\n}\n\n/**\n * Get the true target element of the event even if it crosses shadow boundaries.\n * @param e - The event.\n * @returns The target element.\n */\nexport function getEventTarget(e: Event): EventTarget | null {\n  const composedPath = e.composedPath();\n  return composedPath[0] ?? null;\n}\n\n/**\n * Checks if a slot element is empty (contains no meaningful content).\n * A slot is considered empty if it has no assigned nodes or only contains whitespace text nodes.\n * @param slotElement - The element containing the slot to check\n * @returns true if the slot is empty, false otherwise\n */\nexport function isSlotEmpty(slotElement: HTMLElement): boolean {\n  const slot = slotElement.querySelector('slot') as HTMLSlotElement;\n  const assignedNodes = slot?.assignedNodes({ flatten: true }) || [];\n\n  // Check if slot is empty or only contains whitespace/empty text nodes\n  const hasContent = assignedNodes.some(node => {\n    if (node.nodeType === Node.ELEMENT_NODE) {\n      return true; // Has element content\n    }\n    if (node.nodeType === Node.TEXT_NODE) {\n      return node.textContent?.trim() !== ''; // Has non-whitespace text\n    }\n    return false;\n  });\n\n  return !hasContent;\n}\n\n/**\n * Checks if the pointer is definitely entering an element from a non-descendant element.\n * Note: This can give false negatives when entering from a recently disconnected element.\n * @param event - The pointer event.\n * @returns true if the pointer is entering the element, false otherwise\n */\nexport function isPointerEntering(event: PointerEvent) {\n  const currentElement = event.currentTarget as HTMLElement;\n  const enteringFrom = event.relatedTarget;\n  if (enteringFrom instanceof HTMLElement) {\n    // Assume this element was removed, revealing its parent, so the pointer is not entering the parent.\n    if (!enteringFrom.isConnected) return false;\n\n    // If \"entering\" from a child, the pointer is not truly entering the parent.\n    return !currentElement.contains(enteringFrom as Node);\n  }\n\n  return false;\n}\n\n/**\n * Checks if the pointer is definitely leaving an element to a non-descendant element.\n * @param event - The pointer event.\n * @returns true if the pointer is leaving the element, false otherwise\n */\nexport function isPointerLeaving(event: PointerEvent) {\n  const currentElement = event.currentTarget as HTMLElement;\n  const leavingTo = event.relatedTarget;\n  if (leavingTo instanceof HTMLElement) {\n    // If \"leaving\" to a parent, the pointer is not truly leaving the parent.\n    return !leavingTo.contains(currentElement as Node);\n  }\n\n  return false;\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { useElement } from './use-element.js';\n\nimport { useEffect, useState } from '../index.js';\n\nimport { getSelfOrAncestorByTagName } from '../../functions/dom-functions.js';\n\ntype SpectrumTheme = {\n  color: 'light' | 'dark';\n  scale: 'small' | 'medium' | 'large';\n};\n\n/**\n * @returns The current theme of the Spectrum component.\n */\nexport function useSpectrumTheme(): SpectrumTheme {\n  const element = useElement();\n  const themeElement = getSelfOrAncestorByTagName(element, 'sp-theme');\n  if (!themeElement) {\n    // If the element is not connected, return a default theme.\n    return {\n      color: 'light',\n      scale: 'medium',\n    };\n  }\n  const getTheme = () => {\n    const color = themeElement.getAttribute('color') as SpectrumTheme['color'];\n    const scale = themeElement.getAttribute('scale') as SpectrumTheme['scale'];\n    return {\n      color,\n      scale,\n    };\n  };\n  const [theme, setTheme] = useState<SpectrumTheme>(getTheme());\n  useEffect(() => {\n    const observer = new MutationObserver(() => {\n      setTheme(getTheme());\n    });\n    observer.observe(themeElement, { attributes: true });\n    return () => observer.disconnect();\n  }, []);\n\n  return theme;\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { DraggableProps, Vector2, useDraggable } from './use-draggable.js';\nimport { useElement } from './use-element.js';\nimport { createObservableEvent } from '@adobe/data/observe';\n\nexport type DragObserveProps = Pick<\n  DraggableProps,\n  'minDragDistance' | 'dragCursor' | 'addPlaceholder' | 'dependencies' | 'stopPropagation'\n>;\nexport type DragStart = {\n  readonly type: 'start' | 'cancel';\n};\nexport type DragMove = {\n  readonly type: 'move';\n  readonly delta: Vector2;\n  readonly position: Vector2;\n};\nexport type DragEnd = {\n  readonly type: 'end';\n  readonly position: Vector2;\n};\nexport type DragState = DragStart | DragMove | DragEnd;\n\n/**\n * This hook creates a drag observe function that can be used to observe the drag state of an element.\n * This is normally not used directly, but rather through the `useDragTransaction` hook.\n * @param props\n * @returns\n */\nexport function useDragObserve(props: DragObserveProps) {\n  const [dragState, setDragState] = createObservableEvent<DragState>();\n  const element = useElement();\n  useDraggable(element, () => ({\n    ...props,\n    onDragStart: _e => {\n      setDragState({ type: 'start' });\n    },\n    onDrag: (_e, position, delta) => {\n      setDragState({\n        type: 'move',\n        position,\n        delta,\n      });\n    },\n    onDragEnd: (_e, position) => {\n      setDragState({ type: 'end', position });\n    },\n    onDragCancel: () => {\n      setDragState({ type: 'cancel' });\n    },\n  }));\n  return dragState;\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { DragEnd, DragMove, DragObserveProps, useDragObserve } from './use-drag-observe.js';\nimport { useEffect } from './with-hooks.js';\nimport { AsyncArgsProvider } from '@adobe/data/ecs';\nimport { toAsyncGenerator, withFilter } from '@adobe/data/observe';\n\nexport type DragTransactionProps<T> = DragObserveProps & {\n  transaction: (asyncArgs: AsyncArgsProvider<T>) => void;\n  update: (drag: DragMove) => T;\n  finish: (drag: DragEnd) => T;\n};\n\nexport function useDragTransaction<T>(props: DragTransactionProps<T>) {\n  const { transaction, update, finish, dependencies } = props;\n  const dragObserve = useDragObserve(props);\n  const startDragTransaction = () => {\n    let done = false;\n    // we start the transaction by calling it with an async generator that will yield the args asynchronously\n    transaction(\n      // we create the async generator by mapping the dragObserve state changes to transaction args\n      () =>\n        toAsyncGenerator(\n          // this uses the withMap function and the provided update and finish functions\n          // any type 'start' will just be ignored and filtered out\n          withFilter(dragObserve, value => {\n            if (value.type === 'end') {\n              done = true;\n              return finish(value);\n            }\n            if (value.type === 'move') {\n              return update(value);\n            }\n          }),\n          _value => done\n        )\n    );\n  };\n  // now we will observe the drag state and start a new transaction whenever a drag starts\n  useEffect(() => {\n    return dragObserve(value => {\n      if (value.type === 'start') {\n        startDragTransaction();\n      }\n    });\n  }, dependencies);\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\n\nexport class TextfieldInputEvent extends CustomEvent<{ value: string }> {\n  static readonly eventName = 'textfield-input';\n\n  constructor(value: string) {\n    super(TextfieldInputEvent.eventName, {\n      detail: { value },\n      bubbles: true,\n      composed: true,\n    });\n  }\n}\n\nexport class TextfieldKeydownEvent extends CustomEvent<{ originalEvent: KeyboardEvent }> {\n  static readonly eventName = 'textfield-keydown';\n\n  constructor(originalEvent: KeyboardEvent) {\n    super(TextfieldKeydownEvent.eventName, {\n      detail: { originalEvent },\n      bubbles: true,\n      composed: true,\n    });\n  }\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\n\nconst DEFAULT_LINE_HEIGHT = 20;\n\nexport const getLineHeight = (textarea: HTMLTextAreaElement): number => {\n  const lineHeight = parseInt(getComputedStyle(textarea).lineHeight, 10);\n  return isNaN(lineHeight) ? DEFAULT_LINE_HEIGHT : lineHeight;\n};\n\n/**\n * Measures the natural content height of a textarea by setting it to auto\n * Note: This function leaves the textarea in a state ready for animation setup\n */\nexport const measureNaturalHeight = (textarea: HTMLTextAreaElement): number => {\n  // Disable transition and set height to auto to measure content\n  textarea.style.transition = 'none';\n  textarea.style.height = 'auto';\n  return textarea.scrollHeight;\n};\n\n// Calculates the final height considering max rows constraint\nexport const calculateFinalHeight = (naturalHeight: number, maxRows: number, lineHeight: number): number => {\n  if (maxRows <= 0) return naturalHeight;\n\n  const maxHeight = maxRows * lineHeight;\n  return Math.min(naturalHeight, maxHeight);\n};\n\n/**\n * Checks if the change is significant enough to warrant animation\n * Animation is triggered based on focus state:\n * - When focused (user typing): Animate only for 2+ line changes to avoid jitter\n * - When not focused (programmatic): Animate for 1+ line changes for better visual feedback\n */\nexport const shouldAnimate = (currentHeight: number, finalHeight: number, lineHeight: number, isFocused: boolean): boolean => {\n  const heightChange = Math.abs(finalHeight - currentHeight);\n\n  // Don't animate minimal height changes (1px or less)\n  if (heightChange <= 1) return false;\n\n  // When focused (user typing): require 2+ line changes to avoid jitter\n  if (isFocused) {\n    return heightChange >= lineHeight * 2;\n  }\n\n  // When not focused (programmatic): animate for 1+ line changes for visual feedback\n  return heightChange >= lineHeight;\n};\n\n// Prepares textarea for height animation by setting initial state\nexport const prepareForAnimation = (textarea: HTMLTextAreaElement, currentHeight: number): void => {\n  textarea.style.height = `${currentHeight}px`;\n  textarea.style.removeProperty('transition'); // Restore CSS transition\n};\n\n// Forces a reflow to ensure transitions work properly\nexport const forceReflow = (textarea: HTMLTextAreaElement) => void textarea.offsetHeight;\n\nexport const setHeight = (textarea: HTMLTextAreaElement, height: number) => (textarea.style.height = `${height}px`);\n\nexport const setHeightImmediately = (textarea: HTMLTextAreaElement, height: number): void => {\n  textarea.style.height = `${height}px`;\n  textarea.style.removeProperty('transition');\n};\n\nexport const updateTextareaHeight = (textarea: HTMLTextAreaElement, maxRows: number, isFocused: boolean): void => {\n  const currentHeight = textarea.offsetHeight;\n  const naturalHeight = measureNaturalHeight(textarea);\n  const lineHeight = getLineHeight(textarea);\n  const finalHeight = calculateFinalHeight(naturalHeight, maxRows, lineHeight);\n\n  if (shouldAnimate(currentHeight, finalHeight, lineHeight, isFocused)) {\n    prepareForAnimation(textarea, currentHeight);\n    forceReflow(textarea);\n    setHeight(textarea, finalHeight);\n  } else {\n    setHeightImmediately(textarea, finalHeight);\n  }\n};\n", "import { css } from 'lit';\n\nexport const styles = css`\n  :host {\n    display: block;\n    position: relative;\n    width: 100%;\n  }\n\n  .textfield-container {\n    position: relative;\n    width: 100%;\n    display: var(--firefly-textfield-container-display, inline-flex);\n  }\n\n  textarea,\n  input {\n    width: 100%;\n    border: none;\n    outline: none;\n    background: var(--firefly-textfield-background-color, transparent);\n    font-style: var(--firefly-textfield-font-style);\n    font-family: var(--firefly-textfield-font-family, var(--spectrum-font-family));\n    font-size: var(--firefly-textfield-font-size, var(--spectrum-font-size-200));\n    line-height: var(--firefly-textfield-line-height, var(--spectrum-line-height-200));\n    color: var(--firefly-textfield-text-color, var(--spectrum-gray-900));\n    padding: 0;\n    margin: 0;\n    box-sizing: border-box;\n    resize: none;\n  }\n\n  /* Multiline textarea with height animation */\n  .multiline textarea {\n    overflow-y: auto;\n    overflow-x: hidden;\n    word-wrap: break-word;\n    white-space: pre-wrap;\n    transition: var(--firefly-textfield-height-transition, height 0.2s ease-in-out);\n  }\n\n  /* Overflow shadow for multiline when out of focus */\n  .textfield-container.multiline.overflowing::after {\n    content: '';\n    position: absolute;\n    bottom: 0;\n    left: 0;\n    right: 0;\n    height: var(--firefly-textfield-overflow-shadow-height, 20px);\n    background: var(\n      --firefly-textfield-overflow-shadow-background,\n      linear-gradient(to top, var(--firefly-primary-background-color) 20%, transparent)\n    );\n    pointer-events: none;\n    opacity: 1;\n    transition: var(--firefly-textfield-overflow-shadow-transition, opacity 0.2s ease-in-out);\n  }\n\n  /* Hide overflow shadow on hover and focus */\n  .textfield-container.multiline.overflowing:hover::after,\n  .textfield-container.multiline.overflowing:focus-within::after {\n    opacity: 0;\n  }\n\n  /* Disabled state */\n  .disabled textarea,\n  .disabled input {\n    cursor: not-allowed;\n    color: var(--firefly-textfield-disabled-color, var(--spectrum-disabled-background-color));\n  }\n\n  /* Placeholder styling */\n  textarea::placeholder,\n  input::placeholder {\n    color: var(--firefly-textfield-placeholder-color, var(--spectrum-gray-900));\n    font-style: var(--firefly-textfield-placeholder-font-style, normal);\n    opacity: var(--firefly-textfield-placeholder-opacity, 1);\n  }\n\n  textarea:focus::placeholder,\n  input:focus::placeholder {\n    color: var(--firefly-textfield-placeholder-focus-color, transparent);\n  }\n`;\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { TextfieldInputEvent, TextfieldKeydownEvent } from './events.js';\nimport { updateTextareaHeight } from './functions.js';\nimport { styles } from './textfield.css.js';\nimport { LitElement, html } from 'lit';\nimport { customElement, property, query, state } from 'lit/decorators.js';\nimport { classMap } from 'lit/directives/class-map.js';\nimport { ifDefined } from 'lit/directives/if-defined.js';\n\nimport { commonStyles } from '../common/styles.css.js';\n\nexport const tagName = 'firefly-textfield';\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    [tagName]: Textfield;\n  }\n}\n\nexport interface TextfieldProps {\n  value?: string;\n  placeholder?: string;\n  disabled?: boolean;\n  readonly?: boolean;\n  rows?: number;\n  shrinkToFitText?: boolean;\n  maxRows?: number;\n  maxlength?: number;\n  minlength?: number;\n  tabIndex?: number;\n}\n\n/**\n * @description `firefly-textfield` is a flexible textfield component that supports both single-line and multiline input modes.\n * It features smart height animation that only triggers for significant content changes to avoid jitter during normal typing,\n * automatic overflow detection using ResizeObserver, and CSS-based focus behavior for optimal performance.\n * The component automatically switches between HTML `<input>` and `<textarea>` elements based on the rows configuration.\n *\n * @fires textfield-input - Fired when the input value changes. The detail contains `{ value: string }`.\n * @fires textfield-keydown - Fired when a key is pressed. The detail contains `{ originalEvent: KeyboardEvent }`.\n *\n * @cssprop --firefly-textfield-background-color - Background color for overflow shadow gradient. Default: #ffffff\n * @cssprop --firefly-textfield-placeholder-color - Color of placeholder text. Default: #999999\n *\n * @element firefly-textfield\n *\n * @property {string} value - The current value of the input/textarea\n * @property {string} placeholder - Placeholder text (automatically hidden when focused via CSS)\n * @property {boolean} disabled - Whether the input is disabled\n * @property {number} rows - Number of visible text lines (determines single vs multiline mode). Default: 1\n * @property {number} maxRows - Maximum number of rows in multiline mode (0 = no limit). Default: 0\n * @property {number} maxlength - Maximum number of characters (-1 = no limit). Default: -1\n * @property {number} minlength - Minimum number of characters (-1 = no limit). Default: -1\n * @property {number} tabIndex - Tab index for keyboard navigation. Default: 0\n *\n */\n@customElement(tagName)\nexport class Textfield extends LitElement implements TextfieldProps {\n  // Static properties\n  static styles = [commonStyles, styles];\n\n  // Public properties\n  @property({ type: String })\n  value = '';\n\n  @property({ type: String, attribute: 'aria-label' })\n  ariaLabel = '';\n\n  @property({ type: String })\n  placeholder = '';\n\n  @property({ type: Boolean })\n  disabled = false;\n\n  @property({ type: Boolean })\n  readonly = false;\n\n  @property({ type: Number })\n  rows = 1;\n\n  @property({ type: Boolean })\n  shrinkToFitText = false;\n\n  @property({ type: Number, attribute: 'max-rows' })\n  maxRows = 0;\n\n  @property({ type: Number })\n  maxlength = -1;\n\n  @property({ type: Number })\n  minlength = -1;\n\n  @property({ type: Number })\n  tabIndex = 0;\n\n  // State properties\n  @state()\n  private isOverflowing = false;\n\n  @state()\n  private isFocused = false;\n\n  // Query properties\n  @query('textarea')\n  private textarea?: HTMLTextAreaElement;\n\n  @query('input')\n  private input?: HTMLInputElement;\n\n  // Private properties\n  private resizeObserver?: ResizeObserver;\n\n  // Computed properties (getters)\n  get isMultiline(): boolean {\n    return this.rows > 1 || this.maxRows > 1;\n  }\n\n  get shouldShowOverflowShadow(): boolean {\n    return this.isMultiline && this.isOverflowing;\n  }\n\n  get containerClasses() {\n    return {\n      'textfield-container': true,\n      multiline: this.isMultiline,\n      overflowing: this.shouldShowOverflowShadow,\n      disabled: this.disabled,\n    };\n  }\n\n  private get currentInputElement(): HTMLTextAreaElement | HTMLInputElement | undefined {\n    return this.isMultiline ? this.textarea : this.input;\n  }\n\n  // Lifecycle methods\n  connectedCallback(): void {\n    super.connectedCallback();\n    this.setupResizeObserver();\n    if (this.shrinkToFitText) {\n      window.addEventListener('resize', this.handleWindowResize);\n    }\n  }\n\n  disconnectedCallback(): void {\n    super.disconnectedCallback();\n    this.resizeObserver?.disconnect();\n    if (this.shrinkToFitText) {\n      window.removeEventListener('resize', this.handleWindowResize);\n    }\n  }\n\n  protected firstUpdated(): void {\n    // Setup observer on first render\n    this.resetObservingTextarea();\n  }\n\n  protected updated(changedProperties: Map<string, unknown>): void {\n    if (this.isMultiline) {\n      this.updateHeight();\n      this.checkOverflow();\n    }\n\n    // Only setup observer when switching to/from multiline mode\n    if (changedProperties.has('rows') || changedProperties.has('maxRows')) {\n      this.resetObservingTextarea();\n    }\n  }\n\n  // Public methods\n  /**\n   * Focus the textfield input or textarea element.\n   * Works for both single-line and multiline modes.\n   */\n  public focus(): void {\n    this.currentInputElement?.focus();\n  }\n\n  /**\n   * Select all text in the textfield input or textarea element.\n   * Works for both single-line and multiline modes.\n   */\n  public select(): void {\n    this.currentInputElement?.select();\n  }\n\n  /**\n   * Remove focus from the textfield input or textarea element.\n   * Works for both single-line and multiline modes.\n   */\n  public blur(): void {\n    this.currentInputElement?.blur();\n  }\n\n  // Private methods\n  private setupResizeObserver(): void {\n    this.resizeObserver = new ResizeObserver(this.checkOverflow);\n  }\n\n  private resetObservingTextarea(): void {\n    if (!this.resizeObserver) return;\n\n    // Always disconnect first to avoid duplicate observations\n    this.resizeObserver.disconnect();\n\n    // Only observe if we have a textarea in multiline mode\n    if (this.isMultiline && this.textarea) {\n      this.resizeObserver.observe(this.textarea);\n    }\n  }\n\n  private updateHeight(): void {\n    if (!this.isMultiline || !this.textarea) return;\n    updateTextareaHeight(this.textarea, this.maxRows, this.isFocused);\n  }\n\n  private handleWindowResize = (): void => {\n    // Update height when window resizes in case we have room to go from more to less lines\n    if (this.isMultiline) {\n      this.updateHeight();\n    }\n  };\n\n  private checkOverflow = (): void => {\n    if (!this.isMultiline || !this.textarea) return;\n    this.isOverflowing = this.textarea.scrollHeight > this.textarea.clientHeight;\n  };\n\n  // Event handlers\n  private handleInput(event: Event): void {\n    const target = event.target as HTMLTextAreaElement | HTMLInputElement;\n    this.value = target.value;\n\n    if (this.isMultiline) {\n      this.updateHeight();\n      this.checkOverflow();\n    }\n\n    this.dispatchEvent(new TextfieldInputEvent(this.value));\n  }\n\n  private handleKeydown(event: KeyboardEvent): void {\n    if (event.key === 'Enter' && event.shiftKey && this.isMultiline) {\n      event.stopPropagation();\n    } else {\n      this.dispatchEvent(new TextfieldKeydownEvent(event));\n    }\n  }\n\n  private handleFocus(): void {\n    this.isFocused = true;\n  }\n\n  private handleBlur(): void {\n    this.isFocused = false;\n  }\n\n  // Render method (always last)\n  render() {\n    // Extract repeated attribute logic\n    const maxLengthAttr = this.maxlength > 0 ? this.maxlength : undefined;\n    const minLengthAttr = this.minlength > 0 ? this.minlength : undefined;\n\n    // TODO: Consider adding the spread helper directive from - https://open-wc.org/docs/development/lit-helpers/#spread-directives\n    return html`\n      <div class=${classMap(this.containerClasses)}>\n        ${this.isMultiline\n          ? html`\n              <textarea\n                aria-label=${this.ariaLabel}\n                .value=${this.value}\n                placeholder=${this.placeholder}\n                ?disabled=${this.disabled}\n                ?readonly=${this.readonly}\n                rows=${this.rows}\n                maxlength=${ifDefined(maxLengthAttr)}\n                minlength=${ifDefined(minLengthAttr)}\n                tabindex=${this.tabIndex}\n                @input=${this.handleInput}\n                @keydown=${this.handleKeydown}\n                @focus=${this.handleFocus}\n                @blur=${this.handleBlur}>\n              </textarea>\n            `\n          : html`\n              <input\n                type=\"text\"\n                aria-label=${this.ariaLabel}\n                .value=${this.value}\n                placeholder=${this.placeholder}\n                ?disabled=${this.disabled}\n                ?readonly=${this.readonly}\n                maxlength=${ifDefined(maxLengthAttr)}\n                minlength=${ifDefined(minLengthAttr)}\n                tabindex=${this.tabIndex}\n                @input=${this.handleInput}\n                @keydown=${this.handleKeydown}\n                @focus=${this.handleFocus}\n                @blur=${this.handleBlur} />\n            `}\n      </div>\n    `;\n  }\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { css } from 'lit';\n\n/**\n * Common styles for Firefly components\n *\n * Add any missing common styles here and import them in the components that need them\n */\nexport const commonStyles = css`\n  *,\n  *::before,\n  *::after {\n    box-sizing: border-box;\n  }\n\n  :host {\n    --firefly-primary-background-color: var(--spectrum-gray-50);\n    --firefly-primary-background-color-rgb: var(--spectrum-gray-50-rgb);\n\n    /**\n       16px is the default border radius for the prompt,\n       this is not defined under --spectrum-corner-radius-{value}\n    */\n    --firefly-secondary-border-radius: 8px;\n    --firefly-primary-border-radius: 16px;\n    --firefly-primary-border-radius-large: 24px;\n    --firefly-primary-box-shadow-style: 0 0 3px 0 rgba(0 0 0 / 12%), 0 3px 8px 0 rgba(0 0 0 / 4%), 0 0 10px 0 rgba(0 0 0 / 8%);\n    --firefly-zindex-coachmark: 1000;\n\n    /**\n      The firefly mobile designs currently use 15px for body text, and 17px text for headers.\n      These are non-standard spectrum sizes, but they are the exact size specified in the design.\n     */\n    --firefly-mobile-font-size: 15px;\n    --firefly-mobile-font-size-lg: 17px;\n\n    --firefly-zindex-overlay: 100;\n    --firefly-zindex-overlay-modal: 101;\n  }\n\n  .visually-hidden {\n    clip: rect(0 0 0 0);\n    clip-path: inset(50%);\n    height: 1px;\n    overflow: hidden;\n    position: absolute;\n    white-space: nowrap;\n    width: 1px;\n  }\n\n  @keyframes fade-in {\n    0% {\n      opacity: 0;\n    }\n\n    100% {\n      opacity: 1;\n    }\n  }\n`;\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\n\nexport function deduplicate<T>(array: T[]): T[] {\n  return Array.from(new Set(array));\n}\n\nexport const notNull = <T>(v: T | null): v is T => v !== null;\n\nexport const isTruthy = <T>(v: T | undefined | null): v is T => !!v;\n\n// Returns a new Array containing elements in given but not in other.\nexport function difference<T>(given: T[], other: T[]) {\n  const givenSet = new Set(given);\n  for (const key of other) {\n    givenSet.delete(key);\n  }\n  return Array.from(givenSet);\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\n\n/**\n * Shared constants for Nano Banana model aspect ratios\n * These are used across multiple files to identify and handle Nano Banana sizes\n *\n * Note: These dimensions match NANO_BANANA_OUTPUT_SIZES in aspect-ratios.ts\n * Kept here to avoid circular dependencies while maintaining single source of truth concept\n */\nimport { AspectRatio } from '../types/graphics-types.js';\n\n// Type for aspect ratio localization keys used across Generate, Edit, and Home page\nexport type AspectRatioLocalizationKey =\n  | 'square'\n  | 'portrait'\n  | 'landscape'\n  | 'widescreen'\n  | 'vertical'\n  | 'ultraWide'\n  | 'ultraTall'\n  | 'wide'\n  | 'classic'\n  | 'standard'\n  | 'tall';\n\n// Type for Nano Banana size information\nexport type NanoBananaSizeInfo = {\n  displayRatio: string;\n  displayNameKey: AspectRatioLocalizationKey;\n  descriptor: AspectRatio;\n};\n\nexport const NANO_BANANA_SIZE_MAP: Map<string, NanoBananaSizeInfo> = new Map([\n  // Nano Banana (Gemini 2.5) dimensions\n  ['1184x864', { displayRatio: '4:3', displayNameKey: 'landscape', descriptor: 'landscape' }],\n  ['1024x1024', { displayRatio: '1:1', displayNameKey: 'square', descriptor: 'square' }],\n  ['768x1344', { displayRatio: '9:16', displayNameKey: 'vertical', descriptor: 'vertical' }],\n  ['1344x768', { displayRatio: '16:9', displayNameKey: 'widescreen', descriptor: 'widescreen' }],\n  ['864x1184', { displayRatio: '3:4', displayNameKey: 'portrait', descriptor: 'portrait' }],\n  ['1536x672', { displayRatio: '21:9', displayNameKey: 'ultraWide', descriptor: 'widescreen' }],\n  ['1248x832', { displayRatio: '3:2', displayNameKey: 'wide', descriptor: 'landscape' }],\n  ['1152x896', { displayRatio: '5:4', displayNameKey: 'classic', descriptor: 'landscape' }],\n  ['896x1152', { displayRatio: '4:5', displayNameKey: 'standard', descriptor: 'portrait' }],\n  ['832x1248', { displayRatio: '2:3', displayNameKey: 'tall', descriptor: 'portrait' }],\n\n  // Nano Banana Pro (Gemini 3) dimensions\n  ['1200x896', { displayRatio: '4:3', displayNameKey: 'landscape', descriptor: 'landscape' }],\n  ['768x1376', { displayRatio: '9:16', displayNameKey: 'vertical', descriptor: 'vertical' }],\n  ['1376x768', { displayRatio: '16:9', displayNameKey: 'widescreen', descriptor: 'widescreen' }],\n  ['896x1200', { displayRatio: '3:4', displayNameKey: 'portrait', descriptor: 'portrait' }],\n  ['1584x672', { displayRatio: '21:9', displayNameKey: 'ultraWide', descriptor: 'widescreen' }],\n  ['1264x848', { displayRatio: '3:2', displayNameKey: 'wide', descriptor: 'landscape' }],\n  ['1152x928', { displayRatio: '5:4', displayNameKey: 'classic', descriptor: 'landscape' }],\n  ['928x1152', { displayRatio: '4:5', displayNameKey: 'standard', descriptor: 'portrait' }],\n  ['848x1264', { displayRatio: '2:3', displayNameKey: 'tall', descriptor: 'portrait' }],\n]);\n\nexport function getDimensionKey(size: { width: number; height: number }): string {\n  return `${size.width}x${size.height}`;\n}\n\n// Converts Map to Record for model config (Observables require serializable types)\nexport function getNanoBananaSizeMapAsRecord(): Record<string, { displayRatio: string; [key: string]: unknown }> {\n  return Object.fromEntries(NANO_BANANA_SIZE_MAP);\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { isTruthy } from './array-functions.js';\nimport { getDimensionKey } from './nano-banana-constants.js';\n\nimport { AspectRatio, AspectRatioCode, Size } from '../types/graphics-types.js';\n\n// Standard aspect ratios (widest to tallest)\nexport const ASPECT_RATIO_ORDER: readonly AspectRatioCode[] = ['21:9', '16:9', '4:3', '1:1', '3:4', '9:16', '9:21'] as const;\n\n// Internal constant containing all known aspect ratios for initializing sort maps\n// This ensures no undefined errors when models support different aspect ratio subsets\nconst ASPECT_RATIO_CODES: readonly AspectRatioCode[] = [\n  '21:9',\n  '16:9',\n  '3:2',\n  '4:3',\n  '5:4',\n  '1:1',\n  '4:5',\n  '3:4',\n  '2:3',\n  '9:16',\n  '9:21',\n] as const;\n\n// Deafults are priority-ordered lists so we can provide fallbacks if needed\nconst DEFAULT_ASPECT_RATIO_PRIORITY_DESKTOP_IMAGE: AspectRatioCode[] = ['4:3'];\nconst DEFAULT_ASPECT_RATIO_PRIORITY_MOBILE_IMAGE: AspectRatioCode[] = ['3:4'];\nconst DEFAULT_ASPECT_RATIO_PRIORITY_DESKTOP_VIDEO: AspectRatioCode[] = ['16:9'];\nconst DEFAULT_ASPECT_RATIO_PRIORITY_MOBILE_VIDEO: AspectRatioCode[] = ['9:16'];\n\nexport function getDefaultAspectRatioPriority({ isMobile, type }: { isMobile: boolean; type: 'image' | 'video' }): AspectRatioCode[] {\n  if (type === 'image') {\n    return isMobile ? DEFAULT_ASPECT_RATIO_PRIORITY_MOBILE_IMAGE : DEFAULT_ASPECT_RATIO_PRIORITY_DESKTOP_IMAGE;\n  }\n  return isMobile ? DEFAULT_ASPECT_RATIO_PRIORITY_MOBILE_VIDEO : DEFAULT_ASPECT_RATIO_PRIORITY_DESKTOP_VIDEO;\n}\n\nfunction buildNumericRatiosMap(codes: readonly AspectRatioCode[]): Record<string, number> {\n  return codes.reduce(\n    (acc, code) => {\n      const [width, height] = code.split(':').map(Number);\n      acc[code] = width / height;\n      return acc;\n    },\n    {} as Record<string, number>\n  );\n}\n\nconst ASPECT_RATIO_CODE_TO_DESCRIPTOR: Record<AspectRatioCode, AspectRatio> = {\n  '9:21': 'ultraTall',\n  '9:16': 'vertical',\n  '2:3': 'portrait',\n  '3:4': 'portrait',\n  '4:5': 'portrait',\n  '1:1': 'square',\n  '5:4': 'landscape',\n  '4:3': 'landscape',\n  '3:2': 'landscape',\n  '16:9': 'widescreen',\n  '21:9': 'ultraWide',\n};\n\nexport function getResolution(size: Size): number {\n  return Math.min(size.width, size.height);\n}\n\nexport function getAspectRatioCode({\n  size,\n  availableAspects = ASPECT_RATIO_ORDER,\n}: {\n  size: { width: number; height: number };\n  availableAspects?: readonly AspectRatioCode[];\n}): { code: AspectRatioCode; ratioDiff: number } {\n  const ratio = size.width / size.height;\n  const defaultRatioCode: AspectRatioCode = '1:1';\n\n  // Build numeric ratios map from the provided available aspects\n  const ratiosMap = buildNumericRatiosMap(availableAspects);\n  const defaultDiff = Math.abs(ratio - (ratiosMap[defaultRatioCode] ?? 1));\n\n  const { closestRatioCode, ratioDiff } = (Object.entries(ratiosMap) as [AspectRatioCode, number][]).reduce(\n    (acc, [code, value]) => {\n      const ratioDiff = Math.abs(ratio - value);\n      return ratioDiff < acc.ratioDiff ? { closestRatioCode: code, ratioDiff } : acc;\n    },\n    {\n      closestRatioCode: defaultRatioCode,\n      ratioDiff: defaultDiff,\n    } as { closestRatioCode: AspectRatioCode; ratioDiff: number }\n  );\n  return { code: closestRatioCode, ratioDiff };\n}\n\n/**\n * Sorts sizes by aspect ratio.\n * @param deduplicateSizes - Whether to return only the smallest size per aspect ratio (default: true)\n * @param sizeMap - Optional map of dimension keys to display info for exact default size matching\n * @returns The sorted sizes\n */\n\ntype AspectRatioItem = {\n  size: { width: number; height: number };\n  code: AspectRatioCode;\n  descriptor: AspectRatio;\n  isDefault: boolean;\n};\n\nexport function getSortedAspectRatioSizes({\n  sizes,\n  defaultAspectRatioPriority = DEFAULT_ASPECT_RATIO_PRIORITY_DESKTOP_IMAGE,\n  order = ASPECT_RATIO_ORDER,\n  availableAspects,\n  deduplicateSizes = true,\n  sizeMap,\n}: {\n  sizes: readonly { width: number; height: number }[];\n  defaultAspectRatioPriority?: readonly AspectRatioCode[];\n  order?: readonly AspectRatioCode[];\n  availableAspects?: readonly AspectRatioCode[];\n  deduplicateSizes?: boolean;\n  sizeMap?: Record<string, { displayRatio: string; [key: string]: unknown }>;\n}) {\n  // Use provided availableAspects, fall back to order parameter for backward compatibility\n  const aspectsToUse = availableAspects ?? order;\n\n  // Always initialize with ALL possible aspect ratio codes to prevent undefined errors\n  const defaultSortMap = ASPECT_RATIO_CODES.reduce(\n    (acc, code) => {\n      acc[code] = [];\n      return acc;\n    },\n    {} as Record<AspectRatioCode, AspectRatioItem[]>\n  );\n\n  const aspectRatioSizesByNameMap = [...sizes].reduce((acc, cur) => {\n    const { code } = getAspectRatioCode({ size: cur, availableAspects: aspectsToUse });\n\n    // Always push all sizes - no deduplication at this stage\n    acc[code].push({\n      size: cur,\n      code,\n      descriptor: ASPECT_RATIO_CODE_TO_DESCRIPTOR[code],\n      isDefault: false,\n    });\n    return acc;\n  }, defaultSortMap);\n\n  // sort each aspect ratio array by resolution\n  Object.values(aspectRatioSizesByNameMap).forEach(aspectRatioItems => {\n    aspectRatioItems.sort((a, b) => {\n      // sort largest-to-smallest\n      const resolutionA = getResolution(a.size);\n      const resolutionB = getResolution(b.size);\n      return resolutionA < resolutionB ? 1 : -1;\n    });\n  });\n\n  const defaultAspectRatioCode = defaultAspectRatioPriority?.find(code => !!aspectRatioSizesByNameMap[code].length);\n\n  // Find the exact default size if a size map is provided (for models with specific dimension requirements)\n  const getDefaultSizeForGroup = (items: AspectRatioItem[], code: AspectRatioCode): AspectRatioItem | undefined => {\n    if (!sizeMap || code !== defaultAspectRatioCode) return undefined;\n\n    // Use size map to find the exact size that matches the display ratio\n    return items.find(item => {\n      const dimensionKey = getDimensionKey(item.size);\n      const sizeInfo = sizeMap[dimensionKey];\n      return sizeInfo?.displayRatio === code;\n    });\n  };\n\n  const sortedSizes = aspectsToUse\n    .flatMap(name => {\n      const allResolutions = aspectRatioSizesByNameMap[name];\n      if (!allResolutions.length) return undefined;\n\n      const exactDefaultSize = getDefaultSizeForGroup(allResolutions, name);\n\n      const withDefaultFlag = [...allResolutions].map((item, index, arr) => ({\n        ...item,\n        isDefault: exactDefaultSize\n          ? item.size.width === exactDefaultSize.size.width && item.size.height === exactDefaultSize.size.height\n          : item.code === defaultAspectRatioCode && index === arr.length - 1, // Standard: smallest resolution\n      }));\n\n      // If we have an exact default, sort to put it first in its group\n      if (exactDefaultSize) {\n        return withDefaultFlag.sort((a, b) => {\n          if (a.isDefault) return -1; // Put default first\n          if (b.isDefault) return 1;\n          return 0; // Keep other items in their original order\n        });\n      }\n\n      return withDefaultFlag;\n    })\n    .filter(isTruthy);\n\n  // Return ALL sizes or deduplicate based on parameter\n  const smallestResolutionPerAspectRatio = deduplicateSizes\n    ? aspectsToUse\n        .map(code => {\n          const allResolutions = aspectRatioSizesByNameMap[code];\n          if (!allResolutions.length) return undefined;\n          const smallestResolution = allResolutions[allResolutions.length - 1];\n          return {\n            ...smallestResolution,\n            isDefault: code === defaultAspectRatioCode,\n          };\n        })\n        .filter(isTruthy)\n    : aspectsToUse\n        .flatMap(code => {\n          const allResolutions = aspectRatioSizesByNameMap[code];\n          if (!allResolutions.length) return undefined;\n\n          const exactDefaultSize = getDefaultSizeForGroup(allResolutions, code);\n\n          // Return ALL resolutions for this code\n          const withDefaultFlag = allResolutions.map(item => ({\n            ...item,\n            isDefault: exactDefaultSize\n              ? item.size.width === exactDefaultSize.size.width && item.size.height === exactDefaultSize.size.height\n              : false,\n          }));\n\n          // Sort to put the default size first in its group\n          if (exactDefaultSize) {\n            return withDefaultFlag.sort((a, b) => {\n              if (a.isDefault) return -1;\n              if (b.isDefault) return 1;\n              return 0;\n            });\n          }\n\n          return withDefaultFlag;\n        })\n        .filter(isTruthy);\n\n  return {\n    sortedSizes,\n    smallestResolutionPerAspectRatio,\n  };\n}\n\n/**\n * Gets the default size from available sizes based on device type\n * @param type - The type of media ('image' | 'video')\n * @param isMobile - Whether the device is mobile\n * @param sizes - Available sizes to choose from\n * @param availableAspects - Optional model-specific aspect ratios\n * @param sizeMap - Optional model-specific size map for exact dimension matching\n * @returns The default size\n */\nexport function getDefaultSize({\n  type,\n  isMobile,\n  sizes,\n  availableAspects,\n  sizeMap,\n}: {\n  type: 'image' | 'video';\n  isMobile: boolean;\n  sizes: readonly Size[];\n  availableAspects?: readonly AspectRatioCode[];\n  sizeMap?: Record<string, { displayRatio: string; [key: string]: unknown }>;\n}): Size {\n  const defaultAspectRatioPriority = getDefaultAspectRatioPriority({ isMobile, type });\n  const { sortedSizes } = getSortedAspectRatioSizes({\n    sizes,\n    defaultAspectRatioPriority,\n    availableAspects,\n    sizeMap,\n  });\n  return sortedSizes.find(s => s.isDefault)?.size ?? sizes[0];\n}\n\n/**\n * Finds the closest matching size from available sizes based on aspect ratio and dimensions\n * @param targetSize - The desired size to match\n * @param availableSizes - Array of available sizes to choose from\n * @returns The closest matching size or null if no sizes available\n */\nexport function getClosestSize(targetSize: Size, availableSizes: readonly Size[]): Size | null {\n  if (!availableSizes.length) {\n    return null;\n  }\n\n  const targetRatio = targetSize.width / targetSize.height;\n\n  // First, find sizes with the closest aspect ratio\n  const sizesByAspectRatio = availableSizes.map(size => ({\n    size,\n    ratio: size.width / size.height,\n    ratioDiff: Math.abs(targetRatio - size.width / size.height),\n  }));\n\n  // Sort by ratio difference to find closest matches\n  sizesByAspectRatio.sort((a, b) => a.ratioDiff - b.ratioDiff);\n\n  // Get all sizes that have the same (closest) aspect ratio\n  const minRatioDiff = sizesByAspectRatio[0].ratioDiff;\n  const closestRatioSizes = sizesByAspectRatio.filter(s => Math.abs(s.ratioDiff - minRatioDiff) < 0.0001);\n\n  // If only one size with closest ratio, return it\n  if (closestRatioSizes.length === 1) {\n    return closestRatioSizes[0].size;\n  }\n\n  // Among sizes with same aspect ratio, find closest by dimensions\n  // Using diagonal length as a measure of overall size\n  const targetDiagonal = Math.sqrt(targetSize.width ** 2 + targetSize.height ** 2);\n\n  return closestRatioSizes.reduce((closest, current) => {\n    const currentDiagonal = Math.sqrt(current.size.width ** 2 + current.size.height ** 2);\n    const closestDiagonal = Math.sqrt(closest.size.width ** 2 + closest.size.height ** 2);\n\n    const currentDiff = Math.abs(currentDiagonal - targetDiagonal);\n    const closestDiff = Math.abs(closestDiagonal - targetDiagonal);\n\n    return currentDiff < closestDiff ? current : closest;\n  }, closestRatioSizes[0]).size;\n}\n\n/**\n * Picks the best size to use when switching models based on a previously\n * selected size and the new model's available sizes.\n *\n * Behavior:\n * - If there is no previous size or no available sizes, returns null.\n * - If an exact size match (width/height) exists in the new model, returns it.\n * - Otherwise, returns the closest size by aspect ratio and then by dimensions.\n *\n * Callers should fall back to their existing defaulting logic when this\n * function returns null.\n */\nexport function chooseSizeForModelSwitch({\n  previousSize,\n  availableSizes,\n}: {\n  previousSize: Size | null | undefined;\n  availableSizes: readonly Size[];\n}): Size | null {\n  if (!previousSize || !availableSizes.length) {\n    return null;\n  }\n\n  const exactMatch = availableSizes.find(size => size.width === previousSize.width && size.height === previousSize.height);\n  if (exactMatch) {\n    return exactMatch;\n  }\n\n  return getClosestSize(previousSize, availableSizes);\n}\n\ntype AspectRatioModuleType = 'video' | 'image';\n/**\n * Returns the aspect ratio descriptor for a given size.\n *\n * The `type` parameter determines the aspect descriptor set:\n * - 'video' will return an `AspectRatio` ID (e.g., 'widescreen', 'ultraWide', etc.)\n * - 'image' will return a generic string descriptor ('portrait', 'landscape', etc.)\n *\n * The default value for `type` is 'image'. Types work best with explicit overloads; see below for safest TS usage.\n *\n * @param size - The dimensions of the element.\n * @param type - (optional) The module type: 'image' | 'video'\n * @returns The aspect ratio descriptor.\n */\nexport function getAspectRatioDescriptor(size: Size, type: 'image'): 'portrait' | 'landscape' | 'square' | 'widescreen' | 'vertical';\nexport function getAspectRatioDescriptor(size: Size, type: 'video'): AspectRatio;\nexport function getAspectRatioDescriptor(size: Size): 'portrait' | 'landscape' | 'square' | 'widescreen' | 'vertical';\nexport function getAspectRatioDescriptor(\n  size: Size,\n  type: AspectRatioModuleType = 'image'\n): AspectRatio | 'portrait' | 'landscape' | 'square' | 'widescreen' | 'vertical' {\n  const { code } = getAspectRatioCode({ size });\n  if (type === 'video') {\n    const descriptor = ASPECT_RATIO_CODE_TO_DESCRIPTOR[code];\n    return descriptor;\n  } else {\n    // For 'image' \u2014 normalize descriptors\n    let descriptor = ASPECT_RATIO_CODE_TO_DESCRIPTOR[code];\n    if (descriptor === 'ultraWide') {\n      descriptor = 'widescreen';\n    } else if (descriptor === 'ultraTall') {\n      descriptor = 'vertical';\n    }\n    // Typescript trusts the overloads above for return type\n    return descriptor as 'portrait' | 'landscape' | 'square' | 'widescreen' | 'vertical';\n  }\n}\n\n/**\n * Sorts sizes by aspect ratio.\n * On Mobile: vertical first, then widescreen, then square, then others\n * On Desktop: widescreen first, then vertical, then square, then others\n * @param sizes - Array of sizes to sort\n * @param isMobile - Whether the current view is mobile\n */\nexport function sortSizesByAspectRatio(sizes: readonly Size[], _isMobile?: boolean): readonly Size[] {\n  const { sortedSizes } = getSortedAspectRatioSizes({ sizes });\n  return sortedSizes.map(({ size }) => size);\n}\n\nexport function getNumericAspectRatio(size: Size): number {\n  return size.width / size.height;\n}\n\nexport function reduceAspectRatio(aspectRatio: Size): Size {\n  function greatestCommonDivisor(a: number, b: number): number {\n    return b === 0 ? a : greatestCommonDivisor(b, a % b);\n  }\n\n  const divisor = greatestCommonDivisor(aspectRatio.width, aspectRatio.height);\n  return {\n    width: aspectRatio.width / divisor,\n    height: aspectRatio.height / divisor,\n  };\n}\n\nexport function getReducedAspectRatioString(aspectRatio: Size): string {\n  const reduced = reduceAspectRatio(aspectRatio);\n  return `${reduced.width}:${reduced.height}`;\n}\n\n/**\n * These sizes are defined in the GenerateImagesRequest type documentation:\n * The supported sizes for the output images are:\n * - Square (1:1) - width 2048px, height 2048px\n * - Square (1:1) - width 1024px, height 1024px\n * - Landscape (~4:3, actually 9:7) - width 2304px, height 1792px (legacy Firefly v3)\n * - Portrait (~3:4, actually 7:9) - width 1792px, height 2304px (legacy Firefly v3)\n * - Widescreen (16:9) - width 2688px, height 1536px\n *\n * Note: These are legacy Firefly v3 sizes. Newer models (like Nano Banana) use different dimensions.\n *\n * @param aspectRatio string representation of the aspect ratio\n * @returns Size object with width and height matching the closest supported ratio\n */\nexport function getSizeFromAspectRatio(aspectRatio: AspectRatio): Size {\n  switch (aspectRatio) {\n    case 'square':\n      // High resolution square format\n      return { width: 2048, height: 2048 };\n\n    case 'ultraWide':\n      // 21:9 format - ultra widescreen\n      return { width: 2688, height: 1152 };\n\n    case 'widescreen':\n      // 16:9 format\n      return { width: 2688, height: 1536 };\n\n    case 'landscape':\n      // Legacy Firefly v3 size (9:7 ratio, approximates 4:3)\n      return { width: 2304, height: 1792 };\n\n    case 'portrait':\n      // Legacy Firefly v3 size (7:9 ratio, approximates 3:4)\n      return { width: 1792, height: 2304 };\n\n    case 'vertical':\n      // 9:16 format (same as portrait for legacy compatibility)\n      return { width: 1792, height: 2304 };\n\n    case 'ultraTall':\n      // 9:21 format - ultra vertical\n      return { width: 1152, height: 2688 };\n\n    default:\n      // This should never happen as AspectRatio is an enum\n      return { width: 2048, height: 2048 };\n  }\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { fromProperties, withMapData } from '@adobe/data/observe';\n\nimport { HostService } from '../host-service/host-service.js';\n\n/**\n * Creates an observable that determines whether the Universal Asset Picker (UAP)\n * is able to be shown or not. It is able to be shown when:\n * - The user is authenticated\n * - The relevant feature flag is enabled\n */\nexport const enableUniversalAssetPickerShared = (\n  service: { host: HostService },\n  dependencies = {\n    enableUniversalAssetPicker: service.host.features.enableUniversalAssetPicker,\n    isSignedIn: service.host.authentication.isSignedIn,\n  }\n) =>\n  withMapData(\n    fromProperties(dependencies),\n    ({ enableUniversalAssetPicker, isSignedIn }) => enableUniversalAssetPicker && (isSignedIn !== null ? isSignedIn : false)\n  );\n\n/**\n * Creates an observable that determines whether the Universal Asset Picker (UAP)\n * is to be shown on mobile devices. It is able to be shown when:\n * - The user is authenticated\n * - The relevant feature flag is enabled\n */\nexport const enableUniversalAssetPickerMobile = (\n  service: { host: HostService },\n  dependencies = {\n    enableUniversalAssetPickerMobile: service.host.features.enableUniversalAssetPickerMobile,\n    isSignedIn: service.host.authentication.isSignedIn,\n  }\n) =>\n  withMapData(\n    fromProperties(dependencies),\n    ({ enableUniversalAssetPickerMobile, isSignedIn }) => enableUniversalAssetPickerMobile && (isSignedIn !== null ? isSignedIn : false)\n  );\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\n// This file is generated. Do not edit.\nimport { TemplateResult, html } from 'lit';\nimport { customElement } from 'lit/decorators.js';\n\nimport { IconBase } from '@spectrum-web-components/icon';\n\nconst tagName = 'firefly-icon-upload-s2';\n\n@customElement(tagName)\nexport class IconUploadS2 extends IconBase {\n  protected override render(): TemplateResult {\n    return html`\n      <svg role=\"img\" aria-label=\"Upload\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" fill=\"none\" viewBox=\"0 0 20 20\">\n        <path\n          d=\"M13.5273 10.4912L10.5249 7.49317C10.2319 7.20019 9.75782 7.20019 9.46485 7.49317L6.46729 10.4912C6.17432 10.7842 6.17432 11.2588 6.46729 11.5518C6.61377 11.6982 6.80567 11.7715 6.99756 11.7715C7.18945 11.7715 7.38135 11.6983 7.52783 11.5518L9.25 9.8296V18.0098C9.25 18.4238 9.58594 18.7598 10 18.7598C10.4141 18.7598 10.75 18.4238 10.75 18.0098V9.83693L12.4678 11.5518C12.7607 11.8447 13.2353 11.8447 13.5283 11.5518C13.8208 11.2588 13.8208 10.7832 13.5273 10.4912Z\"\n          fill=\"currentColor\" />\n        <path\n          d=\"M15.75 17H12.9512C12.5371 17 12.2012 16.6641 12.2012 16.25C12.2012 15.8359 12.5371 15.5 12.9512 15.5H15.75C16.1636 15.5 16.5 15.1631 16.5 14.75V4.25C16.5 3.83691 16.1636 3.5 15.75 3.5H4.25C3.83643 3.5 3.5 3.83691 3.5 4.25V14.75C3.5 15.1631 3.83643 15.5 4.25 15.5H6.97559C7.38965 15.5 7.72559 15.8359 7.72559 16.25C7.72559 16.6641 7.38965 17 6.97559 17H4.25C3.00928 17 2 15.9902 2 14.75V4.25C2 3.00977 3.00928 2 4.25 2H15.75C16.9907 2 18 3.00977 18 4.25V14.75C18 15.9902 16.9907 17 15.75 17Z\"\n          fill=\"currentColor\" />\n      </svg>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    [tagName]: IconUploadS2;\n  }\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { css } from 'lit';\n\nexport const styles = css`\n  :host {\n    --firefly-tooltip-touchscreen-sp-tray-border-radius: var(--firefly-primary-border-radius);\n    --firefly-tooltip-touchscreen-sp-tray-content-padding: var(--spectrum-spacing-400);\n  }\n\n  .trigger-button {\n    display: flex;\n    background-color: transparent;\n    border: none;\n    height: 100%;\n    padding: 0;\n    width: 100%;\n  }\n\n  .tooltip-tray-content {\n    text-align: center;\n    justify-content: center;\n    display: flex;\n  }\n\n  sp-tray {\n    --mod-tray-corner-radius-portrait: var(--firefly-tooltip-touchscreen-sp-tray-border-radius);\n    --mod-tray-corner-radius: var(--firefly-tooltip-touchscreen-sp-tray-border-radius);\n  }\n\n  sp-tray ::slotted([slot='content']) {\n    padding: var(--firefly-tooltip-touchscreen-sp-tray-content-padding);\n  }\n`;\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { styles } from './tooltip.css.js';\nimport { LitElement, html } from 'lit';\nimport { customElement, property } from 'lit/decorators.js';\nimport { ifDefined } from 'lit/directives/if-defined.js';\nimport { when } from 'lit/directives/when.js';\n\nimport type { Placement } from '@spectrum-web-components/overlay';\nimport '@spectrum-web-components/overlay/overlay-trigger.js';\nimport { TriggerInteraction } from '@spectrum-web-components/overlay/src/overlay-types.js';\nimport '@spectrum-web-components/tooltip/sp-tooltip.js';\nimport '@spectrum-web-components/tray/sp-tray.js';\n\nimport { commonStyles } from '../common/styles.css.js';\n\nexport type TooltipProps = {\n  displayOn?: TriggerInteraction;\n  placement?: Placement;\n  showAsTray?: boolean;\n  disabled?: boolean;\n};\n\nexport const tagName = 'firefly-tooltip';\n\n/**\n * @deprecated Please use the self-managed tooltip pattern or <firefly-info-tooltip> instead:\n * ```typescript\n * <sp-action-button>\n *   <my-icon slot=\"icon\"></my-icon>\n *   <sp-tooltip self-managed placement=\"top\">\n *     Tooltip content\n *   </sp-tooltip>\n * </sp-action-button>\n * ```\n * See examples in\n * https://opensource.adobe.com/spectrum-web-components/components/tooltip/#self-managed-overlays\n * for more details on using self-managed tooltips.\n *\n * @description `firefly-tooltip` is a custom web component for a tooltip with configurable trigger options.\n *\n * @element firefly-tooltip\n *\n * @cssprop [--firefly-tooltip-touchscreen-sp-tray-border-radius] - Border radius of the tray with showAsTray set to true.\n * @cssprop [--firefly-tooltip-touchscreen-sp-tray-content-padding] - Padding of the tray with showAsTray set to true.\n *\n * @property {TriggerInteraction} displayOn - Display event for the tooltip.\n * @property {Placement} placement - Placement of the tooltip.\n * @property {boolean} showAsTray - Whether the tooltip is on a touchscreen device.\n *\n * @slot default - Slot for the tooltip UI.\n * @slot content - Slot for the tooltip content.\n *\n * @example\n * <firefly-tooltip displayOn=\"click\" placement=\"top\">\n *   <button>Trigger tooltip</button>\n *   <span slot=\"content\">Tooltip content</span>\n * </firefly-tooltip>\n */\n@customElement(tagName)\nexport class FFTooltip extends LitElement implements TooltipProps {\n  static styles = [commonStyles, styles];\n\n  @property({ type: String })\n  displayOn: TooltipProps['displayOn'] = 'hover';\n\n  @property({ type: String })\n  placement: TooltipProps['placement'] = 'right';\n\n  @property({ type: Boolean })\n  showAsTray = false;\n\n  @property({ type: Boolean })\n  disabled = false;\n\n  render() {\n    // There is a very good reason not to just inline the slotted element on the consumer's end when the tooltip is disabled.\n    // Changing the structure of the DOM on the consumer's end will cause the slotted component to disconnect and lose its state.\n    if (this.disabled) {\n      return html`<slot></slot>`;\n    }\n\n    return html`\n      <overlay-trigger placement=${ifDefined(!this.showAsTray ? this.placement : undefined)}>\n        <button tabindex=\"-1\" slot=\"trigger\" class=\"trigger-button\">\n          <slot></slot>\n        </button>\n        ${when(\n          // use sp-tray on touchscreen devices\n          !this.showAsTray,\n          () => html`\n            <sp-tooltip slot=${`${this.displayOn}-content`} data-testid=\"firefly-tooltip-${this.displayOn}-content\">\n              <slot name=\"content\"></slot>\n            </sp-tooltip>\n          `,\n          () => html`\n            <sp-tray slot=${`click-content`}>\n              <slot name=\"content\"></slot>\n            </sp-tray>\n          `\n        )}\n      </overlay-trigger>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    [tagName]: FFTooltip;\n  }\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { css } from 'lit';\n\nexport const styles = css`\n  :host {\n    --firefly-tray-panel-padding: 0;\n  }\n\n  /*\n    An invisible border around the popover that intercepts pointer events.\n    Improves user experience by preventing nearby popovers from being accidentally triggered.\n  */\n  .popover-underlay {\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    width: 100%;\n    height: 100%;\n    background-color: transparent;\n    z-index: -1;\n    border: 10px solid transparent;\n    box-sizing: content-box;\n  }\n\n  sp-popover {\n    width: fit-content;\n    height: fit-content;\n    padding: var(--spectrum-global-dimension-size-150);\n    background-color: color-mix(in srgb, var(--spectrum-global-color-gray-300) 75%, transparent);\n    backdrop-filter: blur(3px);\n    border: none;\n    overflow: visible;\n\n    position: relative;\n\n    .upload-cropper-close-button {\n      position: absolute;\n      top: var(--spectrum-global-dimension-size-25);\n      right: var(--spectrum-global-dimension-size-25);\n      padding: var(--spectrum-global-dimension-size-50);\n      aspect-ratio: 1;\n      border-radius: 50%;\n      color: var(--spectrum-global-color-gray-900);\n      background-color: color-mix(in srgb, var(--spectrum-global-color-gray-400) 50%, transparent);\n      transition: background-color 0.1s ease-in-out;\n      border: none;\n      cursor: pointer;\n\n      &:hover {\n        background-color: var(--spectrum-global-color-gray-300);\n      }\n\n      z-index: 1;\n\n      display: flex;\n      align-items: center;\n      justify-content: center;\n    }\n  }\n\n  ::slotted(firefly-file-preview) {\n    width: var(--firefly-upload-preview-width);\n    height: var(--firefly-upload-preview-height);\n  }\n\n  .mobile-trigger {\n    display: flex;\n    width: var(--firefly-upload-preview-width);\n    height: var(--firefly-upload-preview-height);\n  }\n\n  .mobile-content {\n    display: flex;\n    justify-content: center;\n    align-items: stretch;\n    box-sizing: border-box;\n    width: 100%;\n    padding: var(--spectrum-global-dimension-size-200);\n  }\n`;\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { FileEditorSettings } from '../../functions/file-edit-functions.js';\nimport { ImageUploadSource, ImageUploadTrigger } from '../types.js';\n\nexport class FileSelectedEvent extends CustomEvent<{ file: File; source?: Exclude<ImageUploadTrigger, undefined> }> {\n  static readonly EVENT_NAME = 'fileSelected';\n\n  constructor(file: File, source?: Exclude<ImageUploadTrigger, undefined>) {\n    super(FileSelectedEvent.EVENT_NAME, {\n      bubbles: true,\n      composed: true,\n      detail: { file, source },\n    });\n  }\n}\n\nexport class FileChangeEvent extends CustomEvent<{\n  file?: File;\n  source?: Exclude<ImageUploadTrigger, undefined>;\n  editorSettings?: FileEditorSettings;\n}> {\n  static readonly EVENT_NAME = 'fileChanged';\n\n  constructor(file?: File, source?: Exclude<ImageUploadTrigger, undefined>, editorSettings?: FileEditorSettings) {\n    super(FileChangeEvent.EVENT_NAME, {\n      bubbles: true,\n      composed: true,\n      detail: { file, source, editorSettings },\n    });\n  }\n}\n\nexport class FileTypeNotAcceptedEvent extends CustomEvent<{ fileType: string; source: Exclude<ImageUploadTrigger, undefined> }> {\n  static readonly EVENT_NAME = 'fileTypeNotAccepted';\n\n  constructor(fileType: string, source: Exclude<ImageUploadTrigger, undefined>) {\n    super(FileTypeNotAcceptedEvent.EVENT_NAME, {\n      bubbles: true,\n      composed: true,\n      detail: { fileType, source },\n    });\n  }\n}\n\nexport class DNIFlaggedEvent extends CustomEvent<{ source?: Exclude<ImageUploadTrigger, undefined> }> {\n  static readonly EVENT_NAME = 'dniFlagged';\n\n  constructor(source?: Exclude<ImageUploadTrigger, undefined>) {\n    super(DNIFlaggedEvent.EVENT_NAME, {\n      bubbles: true,\n      composed: true,\n      detail: { source },\n    });\n  }\n}\n\nexport class DNIFlaggedCancelEvent extends CustomEvent<object> {\n  static readonly EVENT_NAME = 'dniFlaggedCancel';\n\n  constructor() {\n    super(DNIFlaggedCancelEvent.EVENT_NAME, {\n      bubbles: true,\n      composed: true,\n      detail: {},\n    });\n  }\n}\nexport class DNIFlaggedConfirmEvent extends CustomEvent<object> {\n  static readonly EVENT_NAME = 'dniFlaggedConfirm';\n\n  constructor() {\n    super(DNIFlaggedConfirmEvent.EVENT_NAME, {\n      bubbles: true,\n      composed: true,\n      detail: {},\n    });\n  }\n}\nexport class FilePreviewImageClickEvent extends CustomEvent<object> {\n  static readonly EVENT_NAME = 'imageClick';\n\n  constructor() {\n    super(FilePreviewImageClickEvent.EVENT_NAME, {\n      bubbles: true,\n      composed: true,\n      detail: {},\n    });\n  }\n}\nexport class FilePreviewRemoveClickEvent extends CustomEvent<object> {\n  static readonly EVENT_NAME = 'removeClick';\n\n  constructor() {\n    super(FilePreviewRemoveClickEvent.EVENT_NAME, {\n      bubbles: true,\n      composed: true,\n      detail: {},\n    });\n  }\n}\n\nexport class FilePreviewPointerOverEvent extends CustomEvent<object> {\n  static readonly EVENT_NAME = 'pointerOverFilePreview';\n\n  constructor() {\n    super(FilePreviewPointerOverEvent.EVENT_NAME, {\n      bubbles: true,\n      composed: true,\n      detail: {},\n    });\n  }\n}\nexport class FilePreviewPointerOutEvent extends CustomEvent<object> {\n  static readonly EVENT_NAME = 'pointerOutFilePreview';\n\n  constructor() {\n    super(FilePreviewPointerOutEvent.EVENT_NAME, {\n      bubbles: true,\n      composed: true,\n      detail: {},\n    });\n  }\n}\n\nexport class UploadEditedEvent extends CustomEvent<{ editorSettings: FileEditorSettings }> {\n  static readonly EVENT_NAME = 'uploadEdited';\n\n  constructor(editorSettings: FileEditorSettings) {\n    super(UploadEditedEvent.EVENT_NAME, {\n      bubbles: true,\n      composed: true,\n      detail: { editorSettings },\n    });\n  }\n}\n\nexport class UploadValidationErrorEvent extends CustomEvent<{\n  error: string;\n  message?: string;\n  source?: Exclude<ImageUploadTrigger, undefined>;\n}> {\n  static readonly EVENT_NAME = 'uploadValidationError';\n\n  constructor(error: string, message?: string, source?: Exclude<ImageUploadTrigger, undefined>) {\n    super(UploadValidationErrorEvent.EVENT_NAME, {\n      bubbles: true,\n      composed: true,\n      detail: { error, message, source },\n    });\n  }\n}\n\nexport class UploadProcessingErrorEvent extends CustomEvent<{\n  error: string;\n  message?: string;\n  source?: Exclude<ImageUploadTrigger, undefined>;\n}> {\n  static readonly EVENT_NAME = 'uploadProcessingError';\n\n  constructor(error: string, message?: string, source?: Exclude<ImageUploadTrigger, undefined>) {\n    super(UploadProcessingErrorEvent.EVENT_NAME, {\n      bubbles: true,\n      composed: true,\n      detail: { error, message, source },\n    });\n  }\n}\n\n/**\n * Fired when a user opens an upload source (file picker or cloud browser).\n * This event fires when the picker/modal is triggered to open, before any file is selected.\n */\nexport class UploadSourceOpenedEvent extends CustomEvent<{ source: ImageUploadSource }> {\n  static readonly EVENT_NAME = 'uploadSourceOpened';\n\n  constructor(source: ImageUploadSource) {\n    super(UploadSourceOpenedEvent.EVENT_NAME, {\n      bubbles: true,\n      composed: true,\n      detail: { source },\n    });\n  }\n}\n\ndeclare global {\n  interface HTMLElementEventMap {\n    uploadSourceOpened: UploadSourceOpenedEvent;\n  }\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { styles } from './crop-overlay.css.js';\nimport { UploadEditedEvent } from './events.js';\nimport { LitElement, html, nothing } from 'lit';\nimport { customElement, property, query, state } from 'lit/decorators.js';\nimport { when } from 'lit/directives/when.js';\n\nimport { localizeBundleDefault } from '../../services/locale-service/index.js';\nimport '@spectrum-web-components/action-button/sp-action-button.js';\nimport '@spectrum-web-components/icon/sp-icon.js';\nimport '@spectrum-web-components/icons-workflow/icons/sp-icon-close-circle.js';\nimport '@spectrum-web-components/icons-workflow/icons/sp-icon-close.js';\nimport type { Placement } from '@spectrum-web-components/overlay';\nimport '@spectrum-web-components/overlay/sp-overlay.js';\nimport '@spectrum-web-components/popover/sp-popover.js';\n\nimport { withCapture } from '../../functions/dom-functions.js';\nimport { FileEditorSettings } from '../../functions/file-edit-functions.js';\nimport { Localized, Unlocalized } from '../../services/locale-service/locale-service.js';\nimport { commonStyles } from '../common/styles.css.js';\nimport '../cropper/cropper.js';\nimport { Cropper } from '../cropper/cropper.js';\nimport { unlocalized as cropperUnlocalized } from '../cropper/cropper.js';\nimport '../icons/icon-checkmark.js';\nimport '../tray-panel/tray-panel.js';\nimport { TrayPanel } from '../tray-panel/tray-panel.js';\n\n/**\n * See src/applications/README.md#localization for more information.\n */\nexport const unlocalized = {\n  crop: 'Crop image',\n  cropToSupportedAspectRatio: 'Crop image to supported aspect ratio',\n  closeAriaLabel: 'Close crop overlay',\n  cropper: cropperUnlocalized,\n} as const satisfies Unlocalized;\n\nexport type CropOverlayProps = {\n  editorSettings?: FileEditorSettings;\n  aspectRatio: number | null;\n  disabled?: boolean;\n};\n\nconst tagName = 'firefly-crop-overlay';\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    [tagName]: CropOverlay;\n  }\n}\n\n@customElement(tagName)\nexport class CropOverlay extends LitElement implements CropOverlayProps {\n  static styles = [commonStyles, styles];\n\n  @query('firefly-cropper')\n  cropper!: Cropper;\n\n  @query('firefly-tray-panel')\n  trayPanel!: TrayPanel;\n\n  ///////////////////////////////\n  // State\n\n  @property({ type: Object }) editorSettings?: FileEditorSettings;\n\n  @property({ type: Object })\n  localized: Localized<typeof unlocalized> = localizeBundleDefault(unlocalized);\n\n  @property({ type: Boolean }) disabled = false;\n\n  @property({ type: Number }) aspectRatio: number | null = null;\n\n  @property({ type: String }) placement: Placement = 'top';\n\n  baseFileRef() {\n    return this.editorSettings?.baseFileRef ?? null;\n  }\n\n  cropArea() {\n    let rect = this.editorSettings?.crop?.rect;\n    if (rect) {\n      return [\n        { x: rect.x, y: rect.y },\n        { x: rect.x + rect.width, y: rect.y + rect.height },\n      ];\n    }\n    return undefined;\n  }\n\n  @state() cropperOpen = false;\n\n  @state() cropperActive = false;\n\n  // Has the user hovered since the overlay was opened?\n  @state() hasHovered = false;\n\n  @state() isMobile = false;\n\n  showPreview() {\n    return !this.cropperActive && !this.hasHovered;\n  }\n\n  ///////////////////////////////\n  // Actions\n\n  activate() {\n    this.cropperActive = true;\n    this.open();\n    this.cropper?.focusSelection();\n  }\n\n  open() {\n    this.trayPanel?.open();\n    this.cropperOpen = true;\n    this.cancelClose();\n    this.hasHovered = false;\n  }\n\n  close() {\n    if (this.cropperActive) this.dispatchUploadEditedEvent();\n\n    this.trayPanel?.close();\n    this.cropperOpen = false;\n    this.cropperActive = false;\n  }\n\n  private closeTimeout: NodeJS.Timeout | null = null;\n\n  cancelClose() {\n    if (this.closeTimeout) {\n      clearTimeout(this.closeTimeout);\n    }\n  }\n\n  scheduleClose(ms = 500) {\n    this.cancelClose();\n    this.closeTimeout = setTimeout(() => {\n      this.close();\n    }, ms);\n  }\n\n  async dispatchUploadEditedEvent() {\n    if (!this.isConnected || !this.cropper) return;\n    const editorSettings = this.cropper.getEditorSettings();\n    if (!editorSettings) return;\n    this.dispatchEvent(new UploadEditedEvent(editorSettings));\n  }\n\n  ///////////////////////////////\n  // Event Handlers\n\n  handleClose(event: Event) {\n    this.close();\n    event.stopPropagation();\n  }\n\n  handleCropperUpdate() {\n    // Don't commit changes if user is still editing the crop section.\n    // That would be a firehose of updates.\n    if (!this.cropperActive) this.dispatchUploadEditedEvent();\n  }\n\n  @withCapture\n  handleKeyDown(event: KeyboardEvent) {\n    if (event.key === 'Escape') {\n      this.close();\n      event.stopPropagation();\n    }\n    if (event.key === 'Enter') {\n      if (this.cropperOpen) {\n        this.close();\n      } else {\n        this.activate();\n        this.cropper?.focusSelection(true);\n      }\n    }\n  }\n\n  @withCapture\n  handlePointerDown() {\n    this.activate();\n  }\n\n  ///////////////////////////////\n  // Render\n\n  renderDesktop() {\n    const preview = this.showPreview();\n    const cropArea = this.cropArea();\n\n    return html`\n      <span @keypress=${this.handleKeyDown}>\n        <sp-overlay trigger=\"container\" placement=${this.placement} type=\"hint\" ?open=${this.cropperOpen} @sp-closed=${this.close}>\n          <sp-popover\n            class=\"upload-cropper-popover\"\n            @pointerdown=${this.handlePointerDown}\n            @pointerover=${() => {\n              this.hasHovered = true;\n              this.cancelClose();\n            }}\n            @pointerleave=${() => {\n              if (!this.cropperActive) this.scheduleClose(400);\n            }}>\n            <firefly-cropper\n              @update=${this.handleCropperUpdate}\n              .fileRef=${this.baseFileRef()}\n              .aspectRatio=${this.aspectRatio}\n              .preview=${preview}\n              .initialCropArea=${cropArea}\n              .autoFit=${!cropArea}\n              .isMobile=${false}></firefly-cropper>\n            ${when(\n              this.cropperActive,\n              () =>\n                html`<button\n                  class=\"upload-cropper-close-button\"\n                  tabindex=\"0\"\n                  @click=${this.handleClose}\n                  aria-label=${this.localized.closeAriaLabel}>\n                  <sp-icon-close size=\"xs\"></sp-icon-close>\n                </button>`,\n              () => nothing\n            )}\n            <div class=\"popover-underlay\"></div>\n          </sp-popover>\n        </sp-overlay>\n        <span\n          id=\"container\"\n          @pointerover=${this.open}\n          @pointerleave=${() => {\n            this.scheduleClose(200);\n          }}>\n          <slot></slot>\n        </span>\n      </span>\n    `;\n  }\n\n  renderMobile() {\n    const cropArea = this.cropArea();\n\n    const title = this.aspectRatio === null ? this.localized.crop : this.localized.cropToSupportedAspectRatio;\n\n    const handleClosed = (event: Event) => {\n      // Stop both sp-closed and dismissed events from bubbling to parent tray panels\n      event.stopPropagation();\n      this.close();\n    };\n\n    const handleDismissed = (event: Event) => {\n      // Stop dismissed event from bubbling to parent tray panels\n      event.stopPropagation();\n    };\n\n    return html`\n      <firefly-tray-panel\n        testId=\"\"\n        @sp-closed=${handleClosed}\n        @dismissed=${handleDismissed}\n        @sp-opened=${() => {\n          this.cropperActive = true;\n          this.cropperOpen = true;\n        }}>\n        <span slot=\"title\">${title}</span>\n        <span slot=\"trigger\" class=\"mobile-trigger\">\n          <slot></slot>\n        </span>\n        <sp-action-button slot=\"dismiss\" quiet icon-only data-testid=\"firefly-video-dismiss-button\">\n          <firefly-icon-checkmark slot=\"icon\"></firefly-icon-checkmark>\n        </sp-action-button>\n        <div slot=\"content\" class=\"mobile-content\">\n          <firefly-cropper\n            @update=${this.handleCropperUpdate}\n            .fileRef=${this.baseFileRef()}\n            .aspectRatio=${this.aspectRatio}\n            .initialCropArea=${cropArea}\n            .autoFit=${!cropArea}\n            .isMobile=${true}></firefly-cropper>\n        </div>\n      </firefly-tray-panel>\n    `;\n  }\n\n  render() {\n    if (this.disabled) return html`<slot></slot>`;\n    return this.isMobile ? this.renderMobile() : this.renderDesktop();\n  }\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport type { LocaleService, Localized, Message, MessageBundle } from './locale-service.js';\nimport { Observe, withMap } from '@adobe/data/observe';\n\n// Type declarations for Intl.Segmenter (not available in ES2020 lib)\ndeclare namespace Intl {\n  interface SegmenterOptions {\n    granularity?: 'grapheme' | 'word' | 'sentence';\n  }\n\n  interface SegmentData {\n    segment: string;\n    index: number;\n    input: string;\n    isWordLike?: boolean;\n  }\n\n  interface Segmenter {\n    segment(input: string): IterableIterator<SegmentData>;\n  }\n\n  interface SegmenterConstructor {\n    new (locale?: string | string[], options?: SegmenterOptions): Segmenter;\n  }\n\n  // Only add Segmenter if it doesn't already exist\n  const Segmenter: SegmenterConstructor;\n}\n\nexport function localizeBundle<T extends MessageBundle>(\n  bundle: T,\n  localizeFunction: (key: string, message: Message) => Message,\n  prefix = ''\n): Localized<T> {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any -- The type matches the input.\n  const result = { LOCALIZED: true } as any;\n  for (const [key, value] of Object.entries(bundle)) {\n    const newKey = prefix + key;\n    if (typeof value === 'object') {\n      result[key] = localizeBundle(value, localizeFunction, newKey + '-');\n    } else {\n      result[key] = localizeFunction(newKey, value);\n    }\n  }\n  return result;\n}\n\n/**\n * Creates a text segmentation function based on the provided locale code.\n * For CJKT locales, it uses Intl.Segmenter. For other locales, falls back to basic string splitting.\n *\n * @param {string} localCode - The locale identifier (e.g., 'en-US', 'ja-JP', 'zh-CN')\n * @returns {(text: string) => string[]} A function that:\n *   - Takes a string input\n *   - Returns an array of string segments\n * @example\n * const segmenter = getSegmenter('ja-JP');\n * const segments = segmenter('\u3053\u3093\u306B\u3061\u306F\u4E16\u754C'); // ['\u3053\u3093', '\u306B\u3061', '\u306F', '\u4E16\u754C']\n *\n */\nexport function getSegmenter(localCode: string): (text: string) => string[] {\n  const defaultSplitter = (text: string) => text.split(/[-.,=[\\]\\s]+/);\n\n  const isSegmentationRequired = /^(zh|ja|ko|th)-/.test(localCode);\n  const locale = localCode.replace(/[\\W_].*$/i, '');\n\n  // Check if Intl.Segmenter is available at runtime\n  if (isSegmentationRequired && typeof Intl.Segmenter === 'function') {\n    const segmenter = new Intl.Segmenter(locale, { granularity: 'word' });\n    return (text: string) => Array.from(segmenter.segment(text), segment => segment.segment);\n  }\n\n  return defaultSplitter;\n}\n\n/**\n * Localizes a bundle based upon an observable locale service.\n * @param locale - An observable of the locale service.\n * @param tagName - The tag name to localize.\n * @param bundle - The bundle to localize.\n * @returns An observable of the localized bundle.\n */\nexport function localizeBundleObservable<T extends MessageBundle>(\n  locale: Observe<LocaleService>,\n  tagName: string,\n  bundle: T\n): Observe<Localized<T>> {\n  return withMap(locale, localeService => localeService.localize(tagName.toLowerCase(), bundle));\n}\n", "/******************************************************************************\nCopyright (c) Microsoft Corporation.\n\nPermission to use, copy, modify, and/or distribute this software for any\npurpose with or without fee is hereby granted.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\nPERFORMANCE OF THIS SOFTWARE.\n***************************************************************************** */\n/* global Reflect, Promise, SuppressedError, Symbol, Iterator */\n\nvar extendStatics = function(d, b) {\n  extendStatics = Object.setPrototypeOf ||\n      ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n      function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n  return extendStatics(d, b);\n};\n\nexport function __extends(d, b) {\n  if (typeof b !== \"function\" && b !== null)\n      throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n  extendStatics(d, b);\n  function __() { this.constructor = d; }\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\nexport var __assign = function() {\n  __assign = Object.assign || function __assign(t) {\n      for (var s, i = 1, n = arguments.length; i < n; i++) {\n          s = arguments[i];\n          for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n      return t;\n  }\n  return __assign.apply(this, arguments);\n}\n\nexport function __rest(s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n      t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n      for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n          if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n              t[p[i]] = s[p[i]];\n      }\n  return t;\n}\n\nexport function __decorate(decorators, target, key, desc) {\n  var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n  else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n}\n\nexport function __param(paramIndex, decorator) {\n  return function (target, key) { decorator(target, key, paramIndex); }\n}\n\nexport function __esDecorate(ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\n  function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\n  var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\n  var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\n  var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\n  var _, done = false;\n  for (var i = decorators.length - 1; i >= 0; i--) {\n      var context = {};\n      for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\n      for (var p in contextIn.access) context.access[p] = contextIn.access[p];\n      context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\n      var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\n      if (kind === \"accessor\") {\n          if (result === void 0) continue;\n          if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\n          if (_ = accept(result.get)) descriptor.get = _;\n          if (_ = accept(result.set)) descriptor.set = _;\n          if (_ = accept(result.init)) initializers.unshift(_);\n      }\n      else if (_ = accept(result)) {\n          if (kind === \"field\") initializers.unshift(_);\n          else descriptor[key] = _;\n      }\n  }\n  if (target) Object.defineProperty(target, contextIn.name, descriptor);\n  done = true;\n};\n\nexport function __runInitializers(thisArg, initializers, value) {\n  var useValue = arguments.length > 2;\n  for (var i = 0; i < initializers.length; i++) {\n      value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\n  }\n  return useValue ? value : void 0;\n};\n\nexport function __propKey(x) {\n  return typeof x === \"symbol\" ? x : \"\".concat(x);\n};\n\nexport function __setFunctionName(f, name, prefix) {\n  if (typeof name === \"symbol\") name = name.description ? \"[\".concat(name.description, \"]\") : \"\";\n  return Object.defineProperty(f, \"name\", { configurable: true, value: prefix ? \"\".concat(prefix, \" \", name) : name });\n};\n\nexport function __metadata(metadataKey, metadataValue) {\n  if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\n}\n\nexport function __awaiter(thisArg, _arguments, P, generator) {\n  function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n  return new (P || (P = Promise))(function (resolve, reject) {\n      function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n      function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n      function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n      step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n}\n\nexport function __generator(thisArg, body) {\n  var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g = Object.create((typeof Iterator === \"function\" ? Iterator : Object).prototype);\n  return g.next = verb(0), g[\"throw\"] = verb(1), g[\"return\"] = verb(2), typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n  function verb(n) { return function (v) { return step([n, v]); }; }\n  function step(op) {\n      if (f) throw new TypeError(\"Generator is already executing.\");\n      while (g && (g = 0, op[0] && (_ = 0)), _) try {\n          if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n          if (y = 0, t) op = [op[0] & 2, t.value];\n          switch (op[0]) {\n              case 0: case 1: t = op; break;\n              case 4: _.label++; return { value: op[1], done: false };\n              case 5: _.label++; y = op[1]; op = [0]; continue;\n              case 7: op = _.ops.pop(); _.trys.pop(); continue;\n              default:\n                  if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                  if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                  if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                  if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                  if (t[2]) _.ops.pop();\n                  _.trys.pop(); continue;\n          }\n          op = body.call(thisArg, _);\n      } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n      if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n  }\n}\n\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n  }\n  Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nexport function __exportStar(m, o) {\n  for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\n}\n\nexport function __values(o) {\n  var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n  if (m) return m.call(o);\n  if (o && typeof o.length === \"number\") return {\n      next: function () {\n          if (o && i >= o.length) o = void 0;\n          return { value: o && o[i++], done: !o };\n      }\n  };\n  throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n}\n\nexport function __read(o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o), r, ar = [], e;\n  try {\n      while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  }\n  catch (error) { e = { error: error }; }\n  finally {\n      try {\n          if (r && !r.done && (m = i[\"return\"])) m.call(i);\n      }\n      finally { if (e) throw e.error; }\n  }\n  return ar;\n}\n\n/** @deprecated */\nexport function __spread() {\n  for (var ar = [], i = 0; i < arguments.length; i++)\n      ar = ar.concat(__read(arguments[i]));\n  return ar;\n}\n\n/** @deprecated */\nexport function __spreadArrays() {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n  for (var r = Array(s), k = 0, i = 0; i < il; i++)\n      for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n          r[k] = a[j];\n  return r;\n}\n\nexport function __spreadArray(to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n      if (ar || !(i in from)) {\n          if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n          ar[i] = from[i];\n      }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n}\n\nexport function __await(v) {\n  return this instanceof __await ? (this.v = v, this) : new __await(v);\n}\n\nexport function __asyncGenerator(thisArg, _arguments, generator) {\n  if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n  var g = generator.apply(thisArg, _arguments || []), i, q = [];\n  return i = Object.create((typeof AsyncIterator === \"function\" ? AsyncIterator : Object).prototype), verb(\"next\"), verb(\"throw\"), verb(\"return\", awaitReturn), i[Symbol.asyncIterator] = function () { return this; }, i;\n  function awaitReturn(f) { return function (v) { return Promise.resolve(v).then(f, reject); }; }\n  function verb(n, f) { if (g[n]) { i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; if (f) i[n] = f(i[n]); } }\n  function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\n  function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\n  function fulfill(value) { resume(\"next\", value); }\n  function reject(value) { resume(\"throw\", value); }\n  function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\n}\n\nexport function __asyncDelegator(o) {\n  var i, p;\n  return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\n  function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: false } : f ? f(v) : v; } : f; }\n}\n\nexport function __asyncValues(o) {\n  if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n  var m = o[Symbol.asyncIterator], i;\n  return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\n  function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\n  function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\n}\n\nexport function __makeTemplateObject(cooked, raw) {\n  if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\n  return cooked;\n};\n\nvar __setModuleDefault = Object.create ? (function(o, v) {\n  Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n  o[\"default\"] = v;\n};\n\nvar ownKeys = function(o) {\n  ownKeys = Object.getOwnPropertyNames || function (o) {\n    var ar = [];\n    for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n    return ar;\n  };\n  return ownKeys(o);\n};\n\nexport function __importStar(mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n  __setModuleDefault(result, mod);\n  return result;\n}\n\nexport function __importDefault(mod) {\n  return (mod && mod.__esModule) ? mod : { default: mod };\n}\n\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n  return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n}\n\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\n  if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n  return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n}\n\nexport function __classPrivateFieldIn(state, receiver) {\n  if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\n  return typeof state === \"function\" ? receiver === state : state.has(receiver);\n}\n\nexport function __addDisposableResource(env, value, async) {\n  if (value !== null && value !== void 0) {\n    if (typeof value !== \"object\" && typeof value !== \"function\") throw new TypeError(\"Object expected.\");\n    var dispose, inner;\n    if (async) {\n      if (!Symbol.asyncDispose) throw new TypeError(\"Symbol.asyncDispose is not defined.\");\n      dispose = value[Symbol.asyncDispose];\n    }\n    if (dispose === void 0) {\n      if (!Symbol.dispose) throw new TypeError(\"Symbol.dispose is not defined.\");\n      dispose = value[Symbol.dispose];\n      if (async) inner = dispose;\n    }\n    if (typeof dispose !== \"function\") throw new TypeError(\"Object not disposable.\");\n    if (inner) dispose = function() { try { inner.call(this); } catch (e) { return Promise.reject(e); } };\n    env.stack.push({ value: value, dispose: dispose, async: async });\n  }\n  else if (async) {\n    env.stack.push({ async: true });\n  }\n  return value;\n}\n\nvar _SuppressedError = typeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\n  var e = new Error(message);\n  return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\n};\n\nexport function __disposeResources(env) {\n  function fail(e) {\n    env.error = env.hasError ? new _SuppressedError(e, env.error, \"An error was suppressed during disposal.\") : e;\n    env.hasError = true;\n  }\n  var r, s = 0;\n  function next() {\n    while (r = env.stack.pop()) {\n      try {\n        if (!r.async && s === 1) return s = 0, env.stack.push(r), Promise.resolve().then(next);\n        if (r.dispose) {\n          var result = r.dispose.call(r.value);\n          if (r.async) return s |= 2, Promise.resolve(result).then(next, function(e) { fail(e); return next(); });\n        }\n        else s |= 1;\n      }\n      catch (e) {\n        fail(e);\n      }\n    }\n    if (s === 1) return env.hasError ? Promise.reject(env.error) : Promise.resolve();\n    if (env.hasError) throw env.error;\n  }\n  return next();\n}\n\nexport function __rewriteRelativeImportExtension(path, preserveJsx) {\n  if (typeof path === \"string\" && /^\\.\\.?\\//.test(path)) {\n      return path.replace(/\\.(tsx)$|((?:\\.d)?)((?:\\.[^./]+?)?)\\.([cm]?)ts$/i, function (m, tsx, d, ext, cm) {\n          return tsx ? preserveJsx ? \".jsx\" : \".js\" : d && (!ext || !cm) ? m : (d + ext + \".\" + cm.toLowerCase() + \"js\");\n      });\n  }\n  return path;\n}\n\nexport default {\n  __extends,\n  __assign,\n  __rest,\n  __decorate,\n  __param,\n  __esDecorate,\n  __runInitializers,\n  __propKey,\n  __setFunctionName,\n  __metadata,\n  __awaiter,\n  __generator,\n  __createBinding,\n  __exportStar,\n  __values,\n  __read,\n  __spread,\n  __spreadArrays,\n  __spreadArray,\n  __await,\n  __asyncGenerator,\n  __asyncDelegator,\n  __asyncValues,\n  __makeTemplateObject,\n  __importStar,\n  __importDefault,\n  __classPrivateFieldGet,\n  __classPrivateFieldSet,\n  __classPrivateFieldIn,\n  __addDisposableResource,\n  __disposeResources,\n  __rewriteRelativeImportExtension,\n};\n", "export var ErrorKind;\n(function (ErrorKind) {\n    /** Argument is unclosed (e.g. `{0`) */\n    ErrorKind[ErrorKind[\"EXPECT_ARGUMENT_CLOSING_BRACE\"] = 1] = \"EXPECT_ARGUMENT_CLOSING_BRACE\";\n    /** Argument is empty (e.g. `{}`). */\n    ErrorKind[ErrorKind[\"EMPTY_ARGUMENT\"] = 2] = \"EMPTY_ARGUMENT\";\n    /** Argument is malformed (e.g. `{foo!}``) */\n    ErrorKind[ErrorKind[\"MALFORMED_ARGUMENT\"] = 3] = \"MALFORMED_ARGUMENT\";\n    /** Expect an argument type (e.g. `{foo,}`) */\n    ErrorKind[ErrorKind[\"EXPECT_ARGUMENT_TYPE\"] = 4] = \"EXPECT_ARGUMENT_TYPE\";\n    /** Unsupported argument type (e.g. `{foo,foo}`) */\n    ErrorKind[ErrorKind[\"INVALID_ARGUMENT_TYPE\"] = 5] = \"INVALID_ARGUMENT_TYPE\";\n    /** Expect an argument style (e.g. `{foo, number, }`) */\n    ErrorKind[ErrorKind[\"EXPECT_ARGUMENT_STYLE\"] = 6] = \"EXPECT_ARGUMENT_STYLE\";\n    /** The number skeleton is invalid. */\n    ErrorKind[ErrorKind[\"INVALID_NUMBER_SKELETON\"] = 7] = \"INVALID_NUMBER_SKELETON\";\n    /** The date time skeleton is invalid. */\n    ErrorKind[ErrorKind[\"INVALID_DATE_TIME_SKELETON\"] = 8] = \"INVALID_DATE_TIME_SKELETON\";\n    /** Exepct a number skeleton following the `::` (e.g. `{foo, number, ::}`) */\n    ErrorKind[ErrorKind[\"EXPECT_NUMBER_SKELETON\"] = 9] = \"EXPECT_NUMBER_SKELETON\";\n    /** Exepct a date time skeleton following the `::` (e.g. `{foo, date, ::}`) */\n    ErrorKind[ErrorKind[\"EXPECT_DATE_TIME_SKELETON\"] = 10] = \"EXPECT_DATE_TIME_SKELETON\";\n    /** Unmatched apostrophes in the argument style (e.g. `{foo, number, 'test`) */\n    ErrorKind[ErrorKind[\"UNCLOSED_QUOTE_IN_ARGUMENT_STYLE\"] = 11] = \"UNCLOSED_QUOTE_IN_ARGUMENT_STYLE\";\n    /** Missing select argument options (e.g. `{foo, select}`) */\n    ErrorKind[ErrorKind[\"EXPECT_SELECT_ARGUMENT_OPTIONS\"] = 12] = \"EXPECT_SELECT_ARGUMENT_OPTIONS\";\n    /** Expecting an offset value in `plural` or `selectordinal` argument (e.g `{foo, plural, offset}`) */\n    ErrorKind[ErrorKind[\"EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE\"] = 13] = \"EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE\";\n    /** Offset value in `plural` or `selectordinal` is invalid (e.g. `{foo, plural, offset: x}`) */\n    ErrorKind[ErrorKind[\"INVALID_PLURAL_ARGUMENT_OFFSET_VALUE\"] = 14] = \"INVALID_PLURAL_ARGUMENT_OFFSET_VALUE\";\n    /** Expecting a selector in `select` argument (e.g `{foo, select}`) */\n    ErrorKind[ErrorKind[\"EXPECT_SELECT_ARGUMENT_SELECTOR\"] = 15] = \"EXPECT_SELECT_ARGUMENT_SELECTOR\";\n    /** Expecting a selector in `plural` or `selectordinal` argument (e.g `{foo, plural}`) */\n    ErrorKind[ErrorKind[\"EXPECT_PLURAL_ARGUMENT_SELECTOR\"] = 16] = \"EXPECT_PLURAL_ARGUMENT_SELECTOR\";\n    /** Expecting a message fragment after the `select` selector (e.g. `{foo, select, apple}`) */\n    ErrorKind[ErrorKind[\"EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT\"] = 17] = \"EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT\";\n    /**\n     * Expecting a message fragment after the `plural` or `selectordinal` selector\n     * (e.g. `{foo, plural, one}`)\n     */\n    ErrorKind[ErrorKind[\"EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT\"] = 18] = \"EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT\";\n    /** Selector in `plural` or `selectordinal` is malformed (e.g. `{foo, plural, =x {#}}`) */\n    ErrorKind[ErrorKind[\"INVALID_PLURAL_ARGUMENT_SELECTOR\"] = 19] = \"INVALID_PLURAL_ARGUMENT_SELECTOR\";\n    /**\n     * Duplicate selectors in `plural` or `selectordinal` argument.\n     * (e.g. {foo, plural, one {#} one {#}})\n     */\n    ErrorKind[ErrorKind[\"DUPLICATE_PLURAL_ARGUMENT_SELECTOR\"] = 20] = \"DUPLICATE_PLURAL_ARGUMENT_SELECTOR\";\n    /** Duplicate selectors in `select` argument.\n     * (e.g. {foo, select, apple {apple} apple {apple}})\n     */\n    ErrorKind[ErrorKind[\"DUPLICATE_SELECT_ARGUMENT_SELECTOR\"] = 21] = \"DUPLICATE_SELECT_ARGUMENT_SELECTOR\";\n    /** Plural or select argument option must have `other` clause. */\n    ErrorKind[ErrorKind[\"MISSING_OTHER_CLAUSE\"] = 22] = \"MISSING_OTHER_CLAUSE\";\n    /** The tag is malformed. (e.g. `<bold!>foo</bold!>) */\n    ErrorKind[ErrorKind[\"INVALID_TAG\"] = 23] = \"INVALID_TAG\";\n    /** The tag name is invalid. (e.g. `<123>foo</123>`) */\n    ErrorKind[ErrorKind[\"INVALID_TAG_NAME\"] = 25] = \"INVALID_TAG_NAME\";\n    /** The closing tag does not match the opening tag. (e.g. `<bold>foo</italic>`) */\n    ErrorKind[ErrorKind[\"UNMATCHED_CLOSING_TAG\"] = 26] = \"UNMATCHED_CLOSING_TAG\";\n    /** The opening tag has unmatched closing tag. (e.g. `<bold>foo`) */\n    ErrorKind[ErrorKind[\"UNCLOSED_TAG\"] = 27] = \"UNCLOSED_TAG\";\n})(ErrorKind || (ErrorKind = {}));\n", "export var TYPE;\n(function (TYPE) {\n    /**\n     * Raw text\n     */\n    TYPE[TYPE[\"literal\"] = 0] = \"literal\";\n    /**\n     * Variable w/o any format, e.g `var` in `this is a {var}`\n     */\n    TYPE[TYPE[\"argument\"] = 1] = \"argument\";\n    /**\n     * Variable w/ number format\n     */\n    TYPE[TYPE[\"number\"] = 2] = \"number\";\n    /**\n     * Variable w/ date format\n     */\n    TYPE[TYPE[\"date\"] = 3] = \"date\";\n    /**\n     * Variable w/ time format\n     */\n    TYPE[TYPE[\"time\"] = 4] = \"time\";\n    /**\n     * Variable w/ select format\n     */\n    TYPE[TYPE[\"select\"] = 5] = \"select\";\n    /**\n     * Variable w/ plural format\n     */\n    TYPE[TYPE[\"plural\"] = 6] = \"plural\";\n    /**\n     * Only possible within plural argument.\n     * This is the `#` symbol that will be substituted with the count.\n     */\n    TYPE[TYPE[\"pound\"] = 7] = \"pound\";\n    /**\n     * XML-like tag\n     */\n    TYPE[TYPE[\"tag\"] = 8] = \"tag\";\n})(TYPE || (TYPE = {}));\nexport var SKELETON_TYPE;\n(function (SKELETON_TYPE) {\n    SKELETON_TYPE[SKELETON_TYPE[\"number\"] = 0] = \"number\";\n    SKELETON_TYPE[SKELETON_TYPE[\"dateTime\"] = 1] = \"dateTime\";\n})(SKELETON_TYPE || (SKELETON_TYPE = {}));\n/**\n * Type Guards\n */\nexport function isLiteralElement(el) {\n    return el.type === TYPE.literal;\n}\nexport function isArgumentElement(el) {\n    return el.type === TYPE.argument;\n}\nexport function isNumberElement(el) {\n    return el.type === TYPE.number;\n}\nexport function isDateElement(el) {\n    return el.type === TYPE.date;\n}\nexport function isTimeElement(el) {\n    return el.type === TYPE.time;\n}\nexport function isSelectElement(el) {\n    return el.type === TYPE.select;\n}\nexport function isPluralElement(el) {\n    return el.type === TYPE.plural;\n}\nexport function isPoundElement(el) {\n    return el.type === TYPE.pound;\n}\nexport function isTagElement(el) {\n    return el.type === TYPE.tag;\n}\nexport function isNumberSkeleton(el) {\n    return !!(el && typeof el === 'object' && el.type === SKELETON_TYPE.number);\n}\nexport function isDateTimeSkeleton(el) {\n    return !!(el && typeof el === 'object' && el.type === SKELETON_TYPE.dateTime);\n}\nexport function createLiteralElement(value) {\n    return {\n        type: TYPE.literal,\n        value: value,\n    };\n}\nexport function createNumberElement(value, style) {\n    return {\n        type: TYPE.number,\n        value: value,\n        style: style,\n    };\n}\n", "// @generated from regex-gen.ts\nexport var SPACE_SEPARATOR_REGEX = /[ \\xA0\\u1680\\u2000-\\u200A\\u202F\\u205F\\u3000]/;\nexport var WHITE_SPACE_REGEX = /[\\t-\\r \\x85\\u200E\\u200F\\u2028\\u2029]/;\n", "/**\n * https://unicode.org/reports/tr35/tr35-dates.html#Date_Field_Symbol_Table\n * Credit: https://github.com/caridy/intl-datetimeformat-pattern/blob/master/index.js\n * with some tweaks\n */\nvar DATE_TIME_REGEX = /(?:[Eec]{1,6}|G{1,5}|[Qq]{1,5}|(?:[yYur]+|U{1,5})|[ML]{1,5}|d{1,2}|D{1,3}|F{1}|[abB]{1,5}|[hkHK]{1,2}|w{1,2}|W{1}|m{1,2}|s{1,2}|[zZOvVxX]{1,4})(?=([^']*'[^']*')*[^']*$)/g;\n/**\n * Parse Date time skeleton into Intl.DateTimeFormatOptions\n * Ref: https://unicode.org/reports/tr35/tr35-dates.html#Date_Field_Symbol_Table\n * @public\n * @param skeleton skeleton string\n */\nexport function parseDateTimeSkeleton(skeleton) {\n    var result = {};\n    skeleton.replace(DATE_TIME_REGEX, function (match) {\n        var len = match.length;\n        switch (match[0]) {\n            // Era\n            case 'G':\n                result.era = len === 4 ? 'long' : len === 5 ? 'narrow' : 'short';\n                break;\n            // Year\n            case 'y':\n                result.year = len === 2 ? '2-digit' : 'numeric';\n                break;\n            case 'Y':\n            case 'u':\n            case 'U':\n            case 'r':\n                throw new RangeError('`Y/u/U/r` (year) patterns are not supported, use `y` instead');\n            // Quarter\n            case 'q':\n            case 'Q':\n                throw new RangeError('`q/Q` (quarter) patterns are not supported');\n            // Month\n            case 'M':\n            case 'L':\n                result.month = ['numeric', '2-digit', 'short', 'long', 'narrow'][len - 1];\n                break;\n            // Week\n            case 'w':\n            case 'W':\n                throw new RangeError('`w/W` (week) patterns are not supported');\n            case 'd':\n                result.day = ['numeric', '2-digit'][len - 1];\n                break;\n            case 'D':\n            case 'F':\n            case 'g':\n                throw new RangeError('`D/F/g` (day) patterns are not supported, use `d` instead');\n            // Weekday\n            case 'E':\n                result.weekday = len === 4 ? 'long' : len === 5 ? 'narrow' : 'short';\n                break;\n            case 'e':\n                if (len < 4) {\n                    throw new RangeError('`e..eee` (weekday) patterns are not supported');\n                }\n                result.weekday = ['short', 'long', 'narrow', 'short'][len - 4];\n                break;\n            case 'c':\n                if (len < 4) {\n                    throw new RangeError('`c..ccc` (weekday) patterns are not supported');\n                }\n                result.weekday = ['short', 'long', 'narrow', 'short'][len - 4];\n                break;\n            // Period\n            case 'a': // AM, PM\n                result.hour12 = true;\n                break;\n            case 'b': // am, pm, noon, midnight\n            case 'B': // flexible day periods\n                throw new RangeError('`b/B` (period) patterns are not supported, use `a` instead');\n            // Hour\n            case 'h':\n                result.hourCycle = 'h12';\n                result.hour = ['numeric', '2-digit'][len - 1];\n                break;\n            case 'H':\n                result.hourCycle = 'h23';\n                result.hour = ['numeric', '2-digit'][len - 1];\n                break;\n            case 'K':\n                result.hourCycle = 'h11';\n                result.hour = ['numeric', '2-digit'][len - 1];\n                break;\n            case 'k':\n                result.hourCycle = 'h24';\n                result.hour = ['numeric', '2-digit'][len - 1];\n                break;\n            case 'j':\n            case 'J':\n            case 'C':\n                throw new RangeError('`j/J/C` (hour) patterns are not supported, use `h/H/K/k` instead');\n            // Minute\n            case 'm':\n                result.minute = ['numeric', '2-digit'][len - 1];\n                break;\n            // Second\n            case 's':\n                result.second = ['numeric', '2-digit'][len - 1];\n                break;\n            case 'S':\n            case 'A':\n                throw new RangeError('`S/A` (second) patterns are not supported, use `s` instead');\n            // Zone\n            case 'z': // 1..3, 4: specific non-location format\n                result.timeZoneName = len < 4 ? 'short' : 'long';\n                break;\n            case 'Z': // 1..3, 4, 5: The ISO8601 varios formats\n            case 'O': // 1, 4: milliseconds in day short, long\n            case 'v': // 1, 4: generic non-location format\n            case 'V': // 1, 2, 3, 4: time zone ID or city\n            case 'X': // 1, 2, 3, 4: The ISO8601 varios formats\n            case 'x': // 1, 2, 3, 4: The ISO8601 varios formats\n                throw new RangeError('`Z/O/v/V/X/x` (timeZone) patterns are not supported, use `z` instead');\n        }\n        return '';\n    });\n    return result;\n}\n", "// @generated from regex-gen.ts\nexport var WHITE_SPACE_REGEX = /[\\t-\\r \\x85\\u200E\\u200F\\u2028\\u2029]/i;\n", "import { __assign } from \"tslib\";\nimport { WHITE_SPACE_REGEX } from './regex.generated';\nexport function parseNumberSkeletonFromString(skeleton) {\n    if (skeleton.length === 0) {\n        throw new Error('Number skeleton cannot be empty');\n    }\n    // Parse the skeleton\n    var stringTokens = skeleton\n        .split(WHITE_SPACE_REGEX)\n        .filter(function (x) { return x.length > 0; });\n    var tokens = [];\n    for (var _i = 0, stringTokens_1 = stringTokens; _i < stringTokens_1.length; _i++) {\n        var stringToken = stringTokens_1[_i];\n        var stemAndOptions = stringToken.split('/');\n        if (stemAndOptions.length === 0) {\n            throw new Error('Invalid number skeleton');\n        }\n        var stem = stemAndOptions[0], options = stemAndOptions.slice(1);\n        for (var _a = 0, options_1 = options; _a < options_1.length; _a++) {\n            var option = options_1[_a];\n            if (option.length === 0) {\n                throw new Error('Invalid number skeleton');\n            }\n        }\n        tokens.push({ stem: stem, options: options });\n    }\n    return tokens;\n}\nfunction icuUnitToEcma(unit) {\n    return unit.replace(/^(.*?)-/, '');\n}\nvar FRACTION_PRECISION_REGEX = /^\\.(?:(0+)(\\*)?|(#+)|(0+)(#+))$/g;\nvar SIGNIFICANT_PRECISION_REGEX = /^(@+)?(\\+|#+)?[rs]?$/g;\nvar INTEGER_WIDTH_REGEX = /(\\*)(0+)|(#+)(0+)|(0+)/g;\nvar CONCISE_INTEGER_WIDTH_REGEX = /^(0+)$/;\nfunction parseSignificantPrecision(str) {\n    var result = {};\n    if (str[str.length - 1] === 'r') {\n        result.roundingPriority = 'morePrecision';\n    }\n    else if (str[str.length - 1] === 's') {\n        result.roundingPriority = 'lessPrecision';\n    }\n    str.replace(SIGNIFICANT_PRECISION_REGEX, function (_, g1, g2) {\n        // @@@ case\n        if (typeof g2 !== 'string') {\n            result.minimumSignificantDigits = g1.length;\n            result.maximumSignificantDigits = g1.length;\n        }\n        // @@@+ case\n        else if (g2 === '+') {\n            result.minimumSignificantDigits = g1.length;\n        }\n        // .### case\n        else if (g1[0] === '#') {\n            result.maximumSignificantDigits = g1.length;\n        }\n        // .@@## or .@@@ case\n        else {\n            result.minimumSignificantDigits = g1.length;\n            result.maximumSignificantDigits =\n                g1.length + (typeof g2 === 'string' ? g2.length : 0);\n        }\n        return '';\n    });\n    return result;\n}\nfunction parseSign(str) {\n    switch (str) {\n        case 'sign-auto':\n            return {\n                signDisplay: 'auto',\n            };\n        case 'sign-accounting':\n        case '()':\n            return {\n                currencySign: 'accounting',\n            };\n        case 'sign-always':\n        case '+!':\n            return {\n                signDisplay: 'always',\n            };\n        case 'sign-accounting-always':\n        case '()!':\n            return {\n                signDisplay: 'always',\n                currencySign: 'accounting',\n            };\n        case 'sign-except-zero':\n        case '+?':\n            return {\n                signDisplay: 'exceptZero',\n            };\n        case 'sign-accounting-except-zero':\n        case '()?':\n            return {\n                signDisplay: 'exceptZero',\n                currencySign: 'accounting',\n            };\n        case 'sign-never':\n        case '+_':\n            return {\n                signDisplay: 'never',\n            };\n    }\n}\nfunction parseConciseScientificAndEngineeringStem(stem) {\n    // Engineering\n    var result;\n    if (stem[0] === 'E' && stem[1] === 'E') {\n        result = {\n            notation: 'engineering',\n        };\n        stem = stem.slice(2);\n    }\n    else if (stem[0] === 'E') {\n        result = {\n            notation: 'scientific',\n        };\n        stem = stem.slice(1);\n    }\n    if (result) {\n        var signDisplay = stem.slice(0, 2);\n        if (signDisplay === '+!') {\n            result.signDisplay = 'always';\n            stem = stem.slice(2);\n        }\n        else if (signDisplay === '+?') {\n            result.signDisplay = 'exceptZero';\n            stem = stem.slice(2);\n        }\n        if (!CONCISE_INTEGER_WIDTH_REGEX.test(stem)) {\n            throw new Error('Malformed concise eng/scientific notation');\n        }\n        result.minimumIntegerDigits = stem.length;\n    }\n    return result;\n}\nfunction parseNotationOptions(opt) {\n    var result = {};\n    var signOpts = parseSign(opt);\n    if (signOpts) {\n        return signOpts;\n    }\n    return result;\n}\n/**\n * https://github.com/unicode-org/icu/blob/master/docs/userguide/format_parse/numbers/skeletons.md#skeleton-stems-and-options\n */\nexport function parseNumberSkeleton(tokens) {\n    var result = {};\n    for (var _i = 0, tokens_1 = tokens; _i < tokens_1.length; _i++) {\n        var token = tokens_1[_i];\n        switch (token.stem) {\n            case 'percent':\n            case '%':\n                result.style = 'percent';\n                continue;\n            case '%x100':\n                result.style = 'percent';\n                result.scale = 100;\n                continue;\n            case 'currency':\n                result.style = 'currency';\n                result.currency = token.options[0];\n                continue;\n            case 'group-off':\n            case ',_':\n                result.useGrouping = false;\n                continue;\n            case 'precision-integer':\n            case '.':\n                result.maximumFractionDigits = 0;\n                continue;\n            case 'measure-unit':\n            case 'unit':\n                result.style = 'unit';\n                result.unit = icuUnitToEcma(token.options[0]);\n                continue;\n            case 'compact-short':\n            case 'K':\n                result.notation = 'compact';\n                result.compactDisplay = 'short';\n                continue;\n            case 'compact-long':\n            case 'KK':\n                result.notation = 'compact';\n                result.compactDisplay = 'long';\n                continue;\n            case 'scientific':\n                result = __assign(__assign(__assign({}, result), { notation: 'scientific' }), token.options.reduce(function (all, opt) { return (__assign(__assign({}, all), parseNotationOptions(opt))); }, {}));\n                continue;\n            case 'engineering':\n                result = __assign(__assign(__assign({}, result), { notation: 'engineering' }), token.options.reduce(function (all, opt) { return (__assign(__assign({}, all), parseNotationOptions(opt))); }, {}));\n                continue;\n            case 'notation-simple':\n                result.notation = 'standard';\n                continue;\n            // https://github.com/unicode-org/icu/blob/master/icu4c/source/i18n/unicode/unumberformatter.h\n            case 'unit-width-narrow':\n                result.currencyDisplay = 'narrowSymbol';\n                result.unitDisplay = 'narrow';\n                continue;\n            case 'unit-width-short':\n                result.currencyDisplay = 'code';\n                result.unitDisplay = 'short';\n                continue;\n            case 'unit-width-full-name':\n                result.currencyDisplay = 'name';\n                result.unitDisplay = 'long';\n                continue;\n            case 'unit-width-iso-code':\n                result.currencyDisplay = 'symbol';\n                continue;\n            case 'scale':\n                result.scale = parseFloat(token.options[0]);\n                continue;\n            case 'rounding-mode-floor':\n                result.roundingMode = 'floor';\n                continue;\n            case 'rounding-mode-ceiling':\n                result.roundingMode = 'ceil';\n                continue;\n            case 'rounding-mode-down':\n                result.roundingMode = 'trunc';\n                continue;\n            case 'rounding-mode-up':\n                result.roundingMode = 'expand';\n                continue;\n            case 'rounding-mode-half-even':\n                result.roundingMode = 'halfEven';\n                continue;\n            case 'rounding-mode-half-down':\n                result.roundingMode = 'halfTrunc';\n                continue;\n            case 'rounding-mode-half-up':\n                result.roundingMode = 'halfExpand';\n                continue;\n            // https://unicode-org.github.io/icu/userguide/format_parse/numbers/skeletons.html#integer-width\n            case 'integer-width':\n                if (token.options.length > 1) {\n                    throw new RangeError('integer-width stems only accept a single optional option');\n                }\n                token.options[0].replace(INTEGER_WIDTH_REGEX, function (_, g1, g2, g3, g4, g5) {\n                    if (g1) {\n                        result.minimumIntegerDigits = g2.length;\n                    }\n                    else if (g3 && g4) {\n                        throw new Error('We currently do not support maximum integer digits');\n                    }\n                    else if (g5) {\n                        throw new Error('We currently do not support exact integer digits');\n                    }\n                    return '';\n                });\n                continue;\n        }\n        // https://unicode-org.github.io/icu/userguide/format_parse/numbers/skeletons.html#integer-width\n        if (CONCISE_INTEGER_WIDTH_REGEX.test(token.stem)) {\n            result.minimumIntegerDigits = token.stem.length;\n            continue;\n        }\n        if (FRACTION_PRECISION_REGEX.test(token.stem)) {\n            // Precision\n            // https://unicode-org.github.io/icu/userguide/format_parse/numbers/skeletons.html#fraction-precision\n            // precision-integer case\n            if (token.options.length > 1) {\n                throw new RangeError('Fraction-precision stems only accept a single optional option');\n            }\n            token.stem.replace(FRACTION_PRECISION_REGEX, function (_, g1, g2, g3, g4, g5) {\n                // .000* case (before ICU67 it was .000+)\n                if (g2 === '*') {\n                    result.minimumFractionDigits = g1.length;\n                }\n                // .### case\n                else if (g3 && g3[0] === '#') {\n                    result.maximumFractionDigits = g3.length;\n                }\n                // .00## case\n                else if (g4 && g5) {\n                    result.minimumFractionDigits = g4.length;\n                    result.maximumFractionDigits = g4.length + g5.length;\n                }\n                else {\n                    result.minimumFractionDigits = g1.length;\n                    result.maximumFractionDigits = g1.length;\n                }\n                return '';\n            });\n            var opt = token.options[0];\n            // https://unicode-org.github.io/icu/userguide/format_parse/numbers/skeletons.html#trailing-zero-display\n            if (opt === 'w') {\n                result = __assign(__assign({}, result), { trailingZeroDisplay: 'stripIfInteger' });\n            }\n            else if (opt) {\n                result = __assign(__assign({}, result), parseSignificantPrecision(opt));\n            }\n            continue;\n        }\n        // https://unicode-org.github.io/icu/userguide/format_parse/numbers/skeletons.html#significant-digits-precision\n        if (SIGNIFICANT_PRECISION_REGEX.test(token.stem)) {\n            result = __assign(__assign({}, result), parseSignificantPrecision(token.stem));\n            continue;\n        }\n        var signOpts = parseSign(token.stem);\n        if (signOpts) {\n            result = __assign(__assign({}, result), signOpts);\n        }\n        var conciseScientificAndEngineeringOpts = parseConciseScientificAndEngineeringStem(token.stem);\n        if (conciseScientificAndEngineeringOpts) {\n            result = __assign(__assign({}, result), conciseScientificAndEngineeringOpts);\n        }\n    }\n    return result;\n}\n", "// @generated from time-data-gen.ts\n// prettier-ignore  \nexport var timeData = {\n    \"001\": [\n        \"H\",\n        \"h\"\n    ],\n    \"AC\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"AD\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"AE\": [\n        \"h\",\n        \"hB\",\n        \"hb\",\n        \"H\"\n    ],\n    \"AF\": [\n        \"H\",\n        \"hb\",\n        \"hB\",\n        \"h\"\n    ],\n    \"AG\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"AI\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"AL\": [\n        \"h\",\n        \"H\",\n        \"hB\"\n    ],\n    \"AM\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"AO\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"AR\": [\n        \"H\",\n        \"h\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"AS\": [\n        \"h\",\n        \"H\"\n    ],\n    \"AT\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"AU\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"AW\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"AX\": [\n        \"H\"\n    ],\n    \"AZ\": [\n        \"H\",\n        \"hB\",\n        \"h\"\n    ],\n    \"BA\": [\n        \"H\",\n        \"hB\",\n        \"h\"\n    ],\n    \"BB\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"BD\": [\n        \"h\",\n        \"hB\",\n        \"H\"\n    ],\n    \"BE\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"BF\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"BG\": [\n        \"H\",\n        \"hB\",\n        \"h\"\n    ],\n    \"BH\": [\n        \"h\",\n        \"hB\",\n        \"hb\",\n        \"H\"\n    ],\n    \"BI\": [\n        \"H\",\n        \"h\"\n    ],\n    \"BJ\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"BL\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"BM\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"BN\": [\n        \"hb\",\n        \"hB\",\n        \"h\",\n        \"H\"\n    ],\n    \"BO\": [\n        \"H\",\n        \"hB\",\n        \"h\",\n        \"hb\"\n    ],\n    \"BQ\": [\n        \"H\"\n    ],\n    \"BR\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"BS\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"BT\": [\n        \"h\",\n        \"H\"\n    ],\n    \"BW\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"BY\": [\n        \"H\",\n        \"h\"\n    ],\n    \"BZ\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"CA\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"CC\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"CD\": [\n        \"hB\",\n        \"H\"\n    ],\n    \"CF\": [\n        \"H\",\n        \"h\",\n        \"hB\"\n    ],\n    \"CG\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"CH\": [\n        \"H\",\n        \"hB\",\n        \"h\"\n    ],\n    \"CI\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"CK\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"CL\": [\n        \"H\",\n        \"h\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"CM\": [\n        \"H\",\n        \"h\",\n        \"hB\"\n    ],\n    \"CN\": [\n        \"H\",\n        \"hB\",\n        \"hb\",\n        \"h\"\n    ],\n    \"CO\": [\n        \"h\",\n        \"H\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"CP\": [\n        \"H\"\n    ],\n    \"CR\": [\n        \"H\",\n        \"h\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"CU\": [\n        \"H\",\n        \"h\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"CV\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"CW\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"CX\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"CY\": [\n        \"h\",\n        \"H\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"CZ\": [\n        \"H\"\n    ],\n    \"DE\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"DG\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"DJ\": [\n        \"h\",\n        \"H\"\n    ],\n    \"DK\": [\n        \"H\"\n    ],\n    \"DM\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"DO\": [\n        \"h\",\n        \"H\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"DZ\": [\n        \"h\",\n        \"hB\",\n        \"hb\",\n        \"H\"\n    ],\n    \"EA\": [\n        \"H\",\n        \"h\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"EC\": [\n        \"H\",\n        \"hB\",\n        \"h\",\n        \"hb\"\n    ],\n    \"EE\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"EG\": [\n        \"h\",\n        \"hB\",\n        \"hb\",\n        \"H\"\n    ],\n    \"EH\": [\n        \"h\",\n        \"hB\",\n        \"hb\",\n        \"H\"\n    ],\n    \"ER\": [\n        \"h\",\n        \"H\"\n    ],\n    \"ES\": [\n        \"H\",\n        \"hB\",\n        \"h\",\n        \"hb\"\n    ],\n    \"ET\": [\n        \"hB\",\n        \"hb\",\n        \"h\",\n        \"H\"\n    ],\n    \"FI\": [\n        \"H\"\n    ],\n    \"FJ\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"FK\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"FM\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"FO\": [\n        \"H\",\n        \"h\"\n    ],\n    \"FR\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"GA\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"GB\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"GD\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"GE\": [\n        \"H\",\n        \"hB\",\n        \"h\"\n    ],\n    \"GF\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"GG\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"GH\": [\n        \"h\",\n        \"H\"\n    ],\n    \"GI\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"GL\": [\n        \"H\",\n        \"h\"\n    ],\n    \"GM\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"GN\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"GP\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"GQ\": [\n        \"H\",\n        \"hB\",\n        \"h\",\n        \"hb\"\n    ],\n    \"GR\": [\n        \"h\",\n        \"H\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"GT\": [\n        \"H\",\n        \"h\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"GU\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"GW\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"GY\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"HK\": [\n        \"h\",\n        \"hB\",\n        \"hb\",\n        \"H\"\n    ],\n    \"HN\": [\n        \"H\",\n        \"h\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"HR\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"HU\": [\n        \"H\",\n        \"h\"\n    ],\n    \"IC\": [\n        \"H\",\n        \"h\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"ID\": [\n        \"H\"\n    ],\n    \"IE\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"IL\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"IM\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"IN\": [\n        \"h\",\n        \"H\"\n    ],\n    \"IO\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"IQ\": [\n        \"h\",\n        \"hB\",\n        \"hb\",\n        \"H\"\n    ],\n    \"IR\": [\n        \"hB\",\n        \"H\"\n    ],\n    \"IS\": [\n        \"H\"\n    ],\n    \"IT\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"JE\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"JM\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"JO\": [\n        \"h\",\n        \"hB\",\n        \"hb\",\n        \"H\"\n    ],\n    \"JP\": [\n        \"H\",\n        \"K\",\n        \"h\"\n    ],\n    \"KE\": [\n        \"hB\",\n        \"hb\",\n        \"H\",\n        \"h\"\n    ],\n    \"KG\": [\n        \"H\",\n        \"h\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"KH\": [\n        \"hB\",\n        \"h\",\n        \"H\",\n        \"hb\"\n    ],\n    \"KI\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"KM\": [\n        \"H\",\n        \"h\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"KN\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"KP\": [\n        \"h\",\n        \"H\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"KR\": [\n        \"h\",\n        \"H\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"KW\": [\n        \"h\",\n        \"hB\",\n        \"hb\",\n        \"H\"\n    ],\n    \"KY\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"KZ\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"LA\": [\n        \"H\",\n        \"hb\",\n        \"hB\",\n        \"h\"\n    ],\n    \"LB\": [\n        \"h\",\n        \"hB\",\n        \"hb\",\n        \"H\"\n    ],\n    \"LC\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"LI\": [\n        \"H\",\n        \"hB\",\n        \"h\"\n    ],\n    \"LK\": [\n        \"H\",\n        \"h\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"LR\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"LS\": [\n        \"h\",\n        \"H\"\n    ],\n    \"LT\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"LU\": [\n        \"H\",\n        \"h\",\n        \"hB\"\n    ],\n    \"LV\": [\n        \"H\",\n        \"hB\",\n        \"hb\",\n        \"h\"\n    ],\n    \"LY\": [\n        \"h\",\n        \"hB\",\n        \"hb\",\n        \"H\"\n    ],\n    \"MA\": [\n        \"H\",\n        \"h\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"MC\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"MD\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"ME\": [\n        \"H\",\n        \"hB\",\n        \"h\"\n    ],\n    \"MF\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"MG\": [\n        \"H\",\n        \"h\"\n    ],\n    \"MH\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"MK\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"ML\": [\n        \"H\"\n    ],\n    \"MM\": [\n        \"hB\",\n        \"hb\",\n        \"H\",\n        \"h\"\n    ],\n    \"MN\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"MO\": [\n        \"h\",\n        \"hB\",\n        \"hb\",\n        \"H\"\n    ],\n    \"MP\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"MQ\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"MR\": [\n        \"h\",\n        \"hB\",\n        \"hb\",\n        \"H\"\n    ],\n    \"MS\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"MT\": [\n        \"H\",\n        \"h\"\n    ],\n    \"MU\": [\n        \"H\",\n        \"h\"\n    ],\n    \"MV\": [\n        \"H\",\n        \"h\"\n    ],\n    \"MW\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"MX\": [\n        \"H\",\n        \"h\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"MY\": [\n        \"hb\",\n        \"hB\",\n        \"h\",\n        \"H\"\n    ],\n    \"MZ\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"NA\": [\n        \"h\",\n        \"H\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"NC\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"NE\": [\n        \"H\"\n    ],\n    \"NF\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"NG\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"NI\": [\n        \"H\",\n        \"h\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"NL\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"NO\": [\n        \"H\",\n        \"h\"\n    ],\n    \"NP\": [\n        \"H\",\n        \"h\",\n        \"hB\"\n    ],\n    \"NR\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"NU\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"NZ\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"OM\": [\n        \"h\",\n        \"hB\",\n        \"hb\",\n        \"H\"\n    ],\n    \"PA\": [\n        \"h\",\n        \"H\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"PE\": [\n        \"H\",\n        \"hB\",\n        \"h\",\n        \"hb\"\n    ],\n    \"PF\": [\n        \"H\",\n        \"h\",\n        \"hB\"\n    ],\n    \"PG\": [\n        \"h\",\n        \"H\"\n    ],\n    \"PH\": [\n        \"h\",\n        \"hB\",\n        \"hb\",\n        \"H\"\n    ],\n    \"PK\": [\n        \"h\",\n        \"hB\",\n        \"H\"\n    ],\n    \"PL\": [\n        \"H\",\n        \"h\"\n    ],\n    \"PM\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"PN\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"PR\": [\n        \"h\",\n        \"H\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"PS\": [\n        \"h\",\n        \"hB\",\n        \"hb\",\n        \"H\"\n    ],\n    \"PT\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"PW\": [\n        \"h\",\n        \"H\"\n    ],\n    \"PY\": [\n        \"H\",\n        \"h\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"QA\": [\n        \"h\",\n        \"hB\",\n        \"hb\",\n        \"H\"\n    ],\n    \"RE\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"RO\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"RS\": [\n        \"H\",\n        \"hB\",\n        \"h\"\n    ],\n    \"RU\": [\n        \"H\"\n    ],\n    \"RW\": [\n        \"H\",\n        \"h\"\n    ],\n    \"SA\": [\n        \"h\",\n        \"hB\",\n        \"hb\",\n        \"H\"\n    ],\n    \"SB\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"SC\": [\n        \"H\",\n        \"h\",\n        \"hB\"\n    ],\n    \"SD\": [\n        \"h\",\n        \"hB\",\n        \"hb\",\n        \"H\"\n    ],\n    \"SE\": [\n        \"H\"\n    ],\n    \"SG\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"SH\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"SI\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"SJ\": [\n        \"H\"\n    ],\n    \"SK\": [\n        \"H\"\n    ],\n    \"SL\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"SM\": [\n        \"H\",\n        \"h\",\n        \"hB\"\n    ],\n    \"SN\": [\n        \"H\",\n        \"h\",\n        \"hB\"\n    ],\n    \"SO\": [\n        \"h\",\n        \"H\"\n    ],\n    \"SR\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"SS\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"ST\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"SV\": [\n        \"H\",\n        \"h\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"SX\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"SY\": [\n        \"h\",\n        \"hB\",\n        \"hb\",\n        \"H\"\n    ],\n    \"SZ\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"TA\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"TC\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"TD\": [\n        \"h\",\n        \"H\",\n        \"hB\"\n    ],\n    \"TF\": [\n        \"H\",\n        \"h\",\n        \"hB\"\n    ],\n    \"TG\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"TH\": [\n        \"H\",\n        \"h\"\n    ],\n    \"TJ\": [\n        \"H\",\n        \"h\"\n    ],\n    \"TL\": [\n        \"H\",\n        \"hB\",\n        \"hb\",\n        \"h\"\n    ],\n    \"TM\": [\n        \"H\",\n        \"h\"\n    ],\n    \"TN\": [\n        \"h\",\n        \"hB\",\n        \"hb\",\n        \"H\"\n    ],\n    \"TO\": [\n        \"h\",\n        \"H\"\n    ],\n    \"TR\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"TT\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"TW\": [\n        \"hB\",\n        \"hb\",\n        \"h\",\n        \"H\"\n    ],\n    \"TZ\": [\n        \"hB\",\n        \"hb\",\n        \"H\",\n        \"h\"\n    ],\n    \"UA\": [\n        \"H\",\n        \"hB\",\n        \"h\"\n    ],\n    \"UG\": [\n        \"hB\",\n        \"hb\",\n        \"H\",\n        \"h\"\n    ],\n    \"UM\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"US\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"UY\": [\n        \"H\",\n        \"h\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"UZ\": [\n        \"H\",\n        \"hB\",\n        \"h\"\n    ],\n    \"VA\": [\n        \"H\",\n        \"h\",\n        \"hB\"\n    ],\n    \"VC\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"VE\": [\n        \"h\",\n        \"H\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"VG\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"VI\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"VN\": [\n        \"H\",\n        \"h\"\n    ],\n    \"VU\": [\n        \"h\",\n        \"H\"\n    ],\n    \"WF\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"WS\": [\n        \"h\",\n        \"H\"\n    ],\n    \"XK\": [\n        \"H\",\n        \"hB\",\n        \"h\"\n    ],\n    \"YE\": [\n        \"h\",\n        \"hB\",\n        \"hb\",\n        \"H\"\n    ],\n    \"YT\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"ZA\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"ZM\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"ZW\": [\n        \"H\",\n        \"h\"\n    ],\n    \"af-ZA\": [\n        \"H\",\n        \"h\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"ar-001\": [\n        \"h\",\n        \"hB\",\n        \"hb\",\n        \"H\"\n    ],\n    \"ca-ES\": [\n        \"H\",\n        \"h\",\n        \"hB\"\n    ],\n    \"en-001\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"es-BO\": [\n        \"H\",\n        \"h\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"es-BR\": [\n        \"H\",\n        \"h\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"es-EC\": [\n        \"H\",\n        \"h\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"es-ES\": [\n        \"H\",\n        \"h\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"es-GQ\": [\n        \"H\",\n        \"h\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"es-PE\": [\n        \"H\",\n        \"h\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"fr-CA\": [\n        \"H\",\n        \"h\",\n        \"hB\"\n    ],\n    \"gl-ES\": [\n        \"H\",\n        \"h\",\n        \"hB\"\n    ],\n    \"gu-IN\": [\n        \"hB\",\n        \"hb\",\n        \"h\",\n        \"H\"\n    ],\n    \"hi-IN\": [\n        \"hB\",\n        \"h\",\n        \"H\"\n    ],\n    \"it-CH\": [\n        \"H\",\n        \"h\",\n        \"hB\"\n    ],\n    \"it-IT\": [\n        \"H\",\n        \"h\",\n        \"hB\"\n    ],\n    \"kn-IN\": [\n        \"hB\",\n        \"h\",\n        \"H\"\n    ],\n    \"ml-IN\": [\n        \"hB\",\n        \"h\",\n        \"H\"\n    ],\n    \"mr-IN\": [\n        \"hB\",\n        \"hb\",\n        \"h\",\n        \"H\"\n    ],\n    \"pa-IN\": [\n        \"hB\",\n        \"hb\",\n        \"h\",\n        \"H\"\n    ],\n    \"ta-IN\": [\n        \"hB\",\n        \"h\",\n        \"hb\",\n        \"H\"\n    ],\n    \"te-IN\": [\n        \"hB\",\n        \"h\",\n        \"H\"\n    ],\n    \"zu-ZA\": [\n        \"H\",\n        \"hB\",\n        \"hb\",\n        \"h\"\n    ]\n};\n", "import { timeData } from './time-data.generated';\n/**\n * Returns the best matching date time pattern if a date time skeleton\n * pattern is provided with a locale. Follows the Unicode specification:\n * https://www.unicode.org/reports/tr35/tr35-dates.html#table-mapping-requested-time-skeletons-to-patterns\n * @param skeleton date time skeleton pattern that possibly includes j, J or C\n * @param locale\n */\nexport function getBestPattern(skeleton, locale) {\n    var skeletonCopy = '';\n    for (var patternPos = 0; patternPos < skeleton.length; patternPos++) {\n        var patternChar = skeleton.charAt(patternPos);\n        if (patternChar === 'j') {\n            var extraLength = 0;\n            while (patternPos + 1 < skeleton.length &&\n                skeleton.charAt(patternPos + 1) === patternChar) {\n                extraLength++;\n                patternPos++;\n            }\n            var hourLen = 1 + (extraLength & 1);\n            var dayPeriodLen = extraLength < 2 ? 1 : 3 + (extraLength >> 1);\n            var dayPeriodChar = 'a';\n            var hourChar = getDefaultHourSymbolFromLocale(locale);\n            if (hourChar == 'H' || hourChar == 'k') {\n                dayPeriodLen = 0;\n            }\n            while (dayPeriodLen-- > 0) {\n                skeletonCopy += dayPeriodChar;\n            }\n            while (hourLen-- > 0) {\n                skeletonCopy = hourChar + skeletonCopy;\n            }\n        }\n        else if (patternChar === 'J') {\n            skeletonCopy += 'H';\n        }\n        else {\n            skeletonCopy += patternChar;\n        }\n    }\n    return skeletonCopy;\n}\n/**\n * Maps the [hour cycle type](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl/Locale/hourCycle)\n * of the given `locale` to the corresponding time pattern.\n * @param locale\n */\nfunction getDefaultHourSymbolFromLocale(locale) {\n    var hourCycle = locale.hourCycle;\n    if (hourCycle === undefined &&\n        // @ts-ignore hourCycle(s) is not identified yet\n        locale.hourCycles &&\n        // @ts-ignore\n        locale.hourCycles.length) {\n        // @ts-ignore\n        hourCycle = locale.hourCycles[0];\n    }\n    if (hourCycle) {\n        switch (hourCycle) {\n            case 'h24':\n                return 'k';\n            case 'h23':\n                return 'H';\n            case 'h12':\n                return 'h';\n            case 'h11':\n                return 'K';\n            default:\n                throw new Error('Invalid hourCycle');\n        }\n    }\n    // TODO: Once hourCycle is fully supported remove the following with data generation\n    var languageTag = locale.language;\n    var regionTag;\n    if (languageTag !== 'root') {\n        regionTag = locale.maximize().region;\n    }\n    var hourCycles = timeData[regionTag || ''] ||\n        timeData[languageTag || ''] ||\n        timeData[\"\".concat(languageTag, \"-001\")] ||\n        timeData['001'];\n    return hourCycles[0];\n}\n", "var _a;\nimport { __assign } from \"tslib\";\nimport { ErrorKind } from './error';\nimport { SKELETON_TYPE, TYPE, } from './types';\nimport { SPACE_SEPARATOR_REGEX } from './regex.generated';\nimport { parseNumberSkeleton, parseNumberSkeletonFromString, parseDateTimeSkeleton, } from '@formatjs/icu-skeleton-parser';\nimport { getBestPattern } from './date-time-pattern-generator';\nvar SPACE_SEPARATOR_START_REGEX = new RegExp(\"^\".concat(SPACE_SEPARATOR_REGEX.source, \"*\"));\nvar SPACE_SEPARATOR_END_REGEX = new RegExp(\"\".concat(SPACE_SEPARATOR_REGEX.source, \"*$\"));\nfunction createLocation(start, end) {\n    return { start: start, end: end };\n}\n// #region Ponyfills\n// Consolidate these variables up top for easier toggling during debugging\nvar hasNativeStartsWith = !!String.prototype.startsWith && '_a'.startsWith('a', 1);\nvar hasNativeFromCodePoint = !!String.fromCodePoint;\nvar hasNativeFromEntries = !!Object.fromEntries;\nvar hasNativeCodePointAt = !!String.prototype.codePointAt;\nvar hasTrimStart = !!String.prototype.trimStart;\nvar hasTrimEnd = !!String.prototype.trimEnd;\nvar hasNativeIsSafeInteger = !!Number.isSafeInteger;\nvar isSafeInteger = hasNativeIsSafeInteger\n    ? Number.isSafeInteger\n    : function (n) {\n        return (typeof n === 'number' &&\n            isFinite(n) &&\n            Math.floor(n) === n &&\n            Math.abs(n) <= 0x1fffffffffffff);\n    };\n// IE11 does not support y and u.\nvar REGEX_SUPPORTS_U_AND_Y = true;\ntry {\n    var re = RE('([^\\\\p{White_Space}\\\\p{Pattern_Syntax}]*)', 'yu');\n    /**\n     * legacy Edge or Xbox One browser\n     * Unicode flag support: supported\n     * Pattern_Syntax support: not supported\n     * See https://github.com/formatjs/formatjs/issues/2822\n     */\n    REGEX_SUPPORTS_U_AND_Y = ((_a = re.exec('a')) === null || _a === void 0 ? void 0 : _a[0]) === 'a';\n}\ncatch (_) {\n    REGEX_SUPPORTS_U_AND_Y = false;\n}\nvar startsWith = hasNativeStartsWith\n    ? // Native\n        function startsWith(s, search, position) {\n            return s.startsWith(search, position);\n        }\n    : // For IE11\n        function startsWith(s, search, position) {\n            return s.slice(position, position + search.length) === search;\n        };\nvar fromCodePoint = hasNativeFromCodePoint\n    ? String.fromCodePoint\n    : // IE11\n        function fromCodePoint() {\n            var codePoints = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                codePoints[_i] = arguments[_i];\n            }\n            var elements = '';\n            var length = codePoints.length;\n            var i = 0;\n            var code;\n            while (length > i) {\n                code = codePoints[i++];\n                if (code > 0x10ffff)\n                    throw RangeError(code + ' is not a valid code point');\n                elements +=\n                    code < 0x10000\n                        ? String.fromCharCode(code)\n                        : String.fromCharCode(((code -= 0x10000) >> 10) + 0xd800, (code % 0x400) + 0xdc00);\n            }\n            return elements;\n        };\nvar fromEntries = \n// native\nhasNativeFromEntries\n    ? Object.fromEntries\n    : // Ponyfill\n        function fromEntries(entries) {\n            var obj = {};\n            for (var _i = 0, entries_1 = entries; _i < entries_1.length; _i++) {\n                var _a = entries_1[_i], k = _a[0], v = _a[1];\n                obj[k] = v;\n            }\n            return obj;\n        };\nvar codePointAt = hasNativeCodePointAt\n    ? // Native\n        function codePointAt(s, index) {\n            return s.codePointAt(index);\n        }\n    : // IE 11\n        function codePointAt(s, index) {\n            var size = s.length;\n            if (index < 0 || index >= size) {\n                return undefined;\n            }\n            var first = s.charCodeAt(index);\n            var second;\n            return first < 0xd800 ||\n                first > 0xdbff ||\n                index + 1 === size ||\n                (second = s.charCodeAt(index + 1)) < 0xdc00 ||\n                second > 0xdfff\n                ? first\n                : ((first - 0xd800) << 10) + (second - 0xdc00) + 0x10000;\n        };\nvar trimStart = hasTrimStart\n    ? // Native\n        function trimStart(s) {\n            return s.trimStart();\n        }\n    : // Ponyfill\n        function trimStart(s) {\n            return s.replace(SPACE_SEPARATOR_START_REGEX, '');\n        };\nvar trimEnd = hasTrimEnd\n    ? // Native\n        function trimEnd(s) {\n            return s.trimEnd();\n        }\n    : // Ponyfill\n        function trimEnd(s) {\n            return s.replace(SPACE_SEPARATOR_END_REGEX, '');\n        };\n// Prevent minifier to translate new RegExp to literal form that might cause syntax error on IE11.\nfunction RE(s, flag) {\n    return new RegExp(s, flag);\n}\n// #endregion\nvar matchIdentifierAtIndex;\nif (REGEX_SUPPORTS_U_AND_Y) {\n    // Native\n    var IDENTIFIER_PREFIX_RE_1 = RE('([^\\\\p{White_Space}\\\\p{Pattern_Syntax}]*)', 'yu');\n    matchIdentifierAtIndex = function matchIdentifierAtIndex(s, index) {\n        var _a;\n        IDENTIFIER_PREFIX_RE_1.lastIndex = index;\n        var match = IDENTIFIER_PREFIX_RE_1.exec(s);\n        return (_a = match[1]) !== null && _a !== void 0 ? _a : '';\n    };\n}\nelse {\n    // IE11\n    matchIdentifierAtIndex = function matchIdentifierAtIndex(s, index) {\n        var match = [];\n        while (true) {\n            var c = codePointAt(s, index);\n            if (c === undefined || _isWhiteSpace(c) || _isPatternSyntax(c)) {\n                break;\n            }\n            match.push(c);\n            index += c >= 0x10000 ? 2 : 1;\n        }\n        return fromCodePoint.apply(void 0, match);\n    };\n}\nvar Parser = /** @class */ (function () {\n    function Parser(message, options) {\n        if (options === void 0) { options = {}; }\n        this.message = message;\n        this.position = { offset: 0, line: 1, column: 1 };\n        this.ignoreTag = !!options.ignoreTag;\n        this.locale = options.locale;\n        this.requiresOtherClause = !!options.requiresOtherClause;\n        this.shouldParseSkeletons = !!options.shouldParseSkeletons;\n    }\n    Parser.prototype.parse = function () {\n        if (this.offset() !== 0) {\n            throw Error('parser can only be used once');\n        }\n        return this.parseMessage(0, '', false);\n    };\n    Parser.prototype.parseMessage = function (nestingLevel, parentArgType, expectingCloseTag) {\n        var elements = [];\n        while (!this.isEOF()) {\n            var char = this.char();\n            if (char === 123 /* `{` */) {\n                var result = this.parseArgument(nestingLevel, expectingCloseTag);\n                if (result.err) {\n                    return result;\n                }\n                elements.push(result.val);\n            }\n            else if (char === 125 /* `}` */ && nestingLevel > 0) {\n                break;\n            }\n            else if (char === 35 /* `#` */ &&\n                (parentArgType === 'plural' || parentArgType === 'selectordinal')) {\n                var position = this.clonePosition();\n                this.bump();\n                elements.push({\n                    type: TYPE.pound,\n                    location: createLocation(position, this.clonePosition()),\n                });\n            }\n            else if (char === 60 /* `<` */ &&\n                !this.ignoreTag &&\n                this.peek() === 47 // char code for '/'\n            ) {\n                if (expectingCloseTag) {\n                    break;\n                }\n                else {\n                    return this.error(ErrorKind.UNMATCHED_CLOSING_TAG, createLocation(this.clonePosition(), this.clonePosition()));\n                }\n            }\n            else if (char === 60 /* `<` */ &&\n                !this.ignoreTag &&\n                _isAlpha(this.peek() || 0)) {\n                var result = this.parseTag(nestingLevel, parentArgType);\n                if (result.err) {\n                    return result;\n                }\n                elements.push(result.val);\n            }\n            else {\n                var result = this.parseLiteral(nestingLevel, parentArgType);\n                if (result.err) {\n                    return result;\n                }\n                elements.push(result.val);\n            }\n        }\n        return { val: elements, err: null };\n    };\n    /**\n     * A tag name must start with an ASCII lower/upper case letter. The grammar is based on the\n     * [custom element name][] except that a dash is NOT always mandatory and uppercase letters\n     * are accepted:\n     *\n     * ```\n     * tag ::= \"<\" tagName (whitespace)* \"/>\" | \"<\" tagName (whitespace)* \">\" message \"</\" tagName (whitespace)* \">\"\n     * tagName ::= [a-z] (PENChar)*\n     * PENChar ::=\n     *     \"-\" | \".\" | [0-9] | \"_\" | [a-z] | [A-Z] | #xB7 | [#xC0-#xD6] | [#xD8-#xF6] | [#xF8-#x37D] |\n     *     [#x37F-#x1FFF] | [#x200C-#x200D] | [#x203F-#x2040] | [#x2070-#x218F] | [#x2C00-#x2FEF] |\n     *     [#x3001-#xD7FF] | [#xF900-#xFDCF] | [#xFDF0-#xFFFD] | [#x10000-#xEFFFF]\n     * ```\n     *\n     * [custom element name]: https://html.spec.whatwg.org/multipage/custom-elements.html#valid-custom-element-name\n     * NOTE: We're a bit more lax here since HTML technically does not allow uppercase HTML element but we do\n     * since other tag-based engines like React allow it\n     */\n    Parser.prototype.parseTag = function (nestingLevel, parentArgType) {\n        var startPosition = this.clonePosition();\n        this.bump(); // `<`\n        var tagName = this.parseTagName();\n        this.bumpSpace();\n        if (this.bumpIf('/>')) {\n            // Self closing tag\n            return {\n                val: {\n                    type: TYPE.literal,\n                    value: \"<\".concat(tagName, \"/>\"),\n                    location: createLocation(startPosition, this.clonePosition()),\n                },\n                err: null,\n            };\n        }\n        else if (this.bumpIf('>')) {\n            var childrenResult = this.parseMessage(nestingLevel + 1, parentArgType, true);\n            if (childrenResult.err) {\n                return childrenResult;\n            }\n            var children = childrenResult.val;\n            // Expecting a close tag\n            var endTagStartPosition = this.clonePosition();\n            if (this.bumpIf('</')) {\n                if (this.isEOF() || !_isAlpha(this.char())) {\n                    return this.error(ErrorKind.INVALID_TAG, createLocation(endTagStartPosition, this.clonePosition()));\n                }\n                var closingTagNameStartPosition = this.clonePosition();\n                var closingTagName = this.parseTagName();\n                if (tagName !== closingTagName) {\n                    return this.error(ErrorKind.UNMATCHED_CLOSING_TAG, createLocation(closingTagNameStartPosition, this.clonePosition()));\n                }\n                this.bumpSpace();\n                if (!this.bumpIf('>')) {\n                    return this.error(ErrorKind.INVALID_TAG, createLocation(endTagStartPosition, this.clonePosition()));\n                }\n                return {\n                    val: {\n                        type: TYPE.tag,\n                        value: tagName,\n                        children: children,\n                        location: createLocation(startPosition, this.clonePosition()),\n                    },\n                    err: null,\n                };\n            }\n            else {\n                return this.error(ErrorKind.UNCLOSED_TAG, createLocation(startPosition, this.clonePosition()));\n            }\n        }\n        else {\n            return this.error(ErrorKind.INVALID_TAG, createLocation(startPosition, this.clonePosition()));\n        }\n    };\n    /**\n     * This method assumes that the caller has peeked ahead for the first tag character.\n     */\n    Parser.prototype.parseTagName = function () {\n        var startOffset = this.offset();\n        this.bump(); // the first tag name character\n        while (!this.isEOF() && _isPotentialElementNameChar(this.char())) {\n            this.bump();\n        }\n        return this.message.slice(startOffset, this.offset());\n    };\n    Parser.prototype.parseLiteral = function (nestingLevel, parentArgType) {\n        var start = this.clonePosition();\n        var value = '';\n        while (true) {\n            var parseQuoteResult = this.tryParseQuote(parentArgType);\n            if (parseQuoteResult) {\n                value += parseQuoteResult;\n                continue;\n            }\n            var parseUnquotedResult = this.tryParseUnquoted(nestingLevel, parentArgType);\n            if (parseUnquotedResult) {\n                value += parseUnquotedResult;\n                continue;\n            }\n            var parseLeftAngleResult = this.tryParseLeftAngleBracket();\n            if (parseLeftAngleResult) {\n                value += parseLeftAngleResult;\n                continue;\n            }\n            break;\n        }\n        var location = createLocation(start, this.clonePosition());\n        return {\n            val: { type: TYPE.literal, value: value, location: location },\n            err: null,\n        };\n    };\n    Parser.prototype.tryParseLeftAngleBracket = function () {\n        if (!this.isEOF() &&\n            this.char() === 60 /* `<` */ &&\n            (this.ignoreTag ||\n                // If at the opening tag or closing tag position, bail.\n                !_isAlphaOrSlash(this.peek() || 0))) {\n            this.bump(); // `<`\n            return '<';\n        }\n        return null;\n    };\n    /**\n     * Starting with ICU 4.8, an ASCII apostrophe only starts quoted text if it immediately precedes\n     * a character that requires quoting (that is, \"only where needed\"), and works the same in\n     * nested messages as on the top level of the pattern. The new behavior is otherwise compatible.\n     */\n    Parser.prototype.tryParseQuote = function (parentArgType) {\n        if (this.isEOF() || this.char() !== 39 /* `'` */) {\n            return null;\n        }\n        // Parse escaped char following the apostrophe, or early return if there is no escaped char.\n        // Check if is valid escaped character\n        switch (this.peek()) {\n            case 39 /* `'` */:\n                // double quote, should return as a single quote.\n                this.bump();\n                this.bump();\n                return \"'\";\n            // '{', '<', '>', '}'\n            case 123:\n            case 60:\n            case 62:\n            case 125:\n                break;\n            case 35: // '#'\n                if (parentArgType === 'plural' || parentArgType === 'selectordinal') {\n                    break;\n                }\n                return null;\n            default:\n                return null;\n        }\n        this.bump(); // apostrophe\n        var codePoints = [this.char()]; // escaped char\n        this.bump();\n        // read chars until the optional closing apostrophe is found\n        while (!this.isEOF()) {\n            var ch = this.char();\n            if (ch === 39 /* `'` */) {\n                if (this.peek() === 39 /* `'` */) {\n                    codePoints.push(39);\n                    // Bump one more time because we need to skip 2 characters.\n                    this.bump();\n                }\n                else {\n                    // Optional closing apostrophe.\n                    this.bump();\n                    break;\n                }\n            }\n            else {\n                codePoints.push(ch);\n            }\n            this.bump();\n        }\n        return fromCodePoint.apply(void 0, codePoints);\n    };\n    Parser.prototype.tryParseUnquoted = function (nestingLevel, parentArgType) {\n        if (this.isEOF()) {\n            return null;\n        }\n        var ch = this.char();\n        if (ch === 60 /* `<` */ ||\n            ch === 123 /* `{` */ ||\n            (ch === 35 /* `#` */ &&\n                (parentArgType === 'plural' || parentArgType === 'selectordinal')) ||\n            (ch === 125 /* `}` */ && nestingLevel > 0)) {\n            return null;\n        }\n        else {\n            this.bump();\n            return fromCodePoint(ch);\n        }\n    };\n    Parser.prototype.parseArgument = function (nestingLevel, expectingCloseTag) {\n        var openingBracePosition = this.clonePosition();\n        this.bump(); // `{`\n        this.bumpSpace();\n        if (this.isEOF()) {\n            return this.error(ErrorKind.EXPECT_ARGUMENT_CLOSING_BRACE, createLocation(openingBracePosition, this.clonePosition()));\n        }\n        if (this.char() === 125 /* `}` */) {\n            this.bump();\n            return this.error(ErrorKind.EMPTY_ARGUMENT, createLocation(openingBracePosition, this.clonePosition()));\n        }\n        // argument name\n        var value = this.parseIdentifierIfPossible().value;\n        if (!value) {\n            return this.error(ErrorKind.MALFORMED_ARGUMENT, createLocation(openingBracePosition, this.clonePosition()));\n        }\n        this.bumpSpace();\n        if (this.isEOF()) {\n            return this.error(ErrorKind.EXPECT_ARGUMENT_CLOSING_BRACE, createLocation(openingBracePosition, this.clonePosition()));\n        }\n        switch (this.char()) {\n            // Simple argument: `{name}`\n            case 125 /* `}` */: {\n                this.bump(); // `}`\n                return {\n                    val: {\n                        type: TYPE.argument,\n                        // value does not include the opening and closing braces.\n                        value: value,\n                        location: createLocation(openingBracePosition, this.clonePosition()),\n                    },\n                    err: null,\n                };\n            }\n            // Argument with options: `{name, format, ...}`\n            case 44 /* `,` */: {\n                this.bump(); // `,`\n                this.bumpSpace();\n                if (this.isEOF()) {\n                    return this.error(ErrorKind.EXPECT_ARGUMENT_CLOSING_BRACE, createLocation(openingBracePosition, this.clonePosition()));\n                }\n                return this.parseArgumentOptions(nestingLevel, expectingCloseTag, value, openingBracePosition);\n            }\n            default:\n                return this.error(ErrorKind.MALFORMED_ARGUMENT, createLocation(openingBracePosition, this.clonePosition()));\n        }\n    };\n    /**\n     * Advance the parser until the end of the identifier, if it is currently on\n     * an identifier character. Return an empty string otherwise.\n     */\n    Parser.prototype.parseIdentifierIfPossible = function () {\n        var startingPosition = this.clonePosition();\n        var startOffset = this.offset();\n        var value = matchIdentifierAtIndex(this.message, startOffset);\n        var endOffset = startOffset + value.length;\n        this.bumpTo(endOffset);\n        var endPosition = this.clonePosition();\n        var location = createLocation(startingPosition, endPosition);\n        return { value: value, location: location };\n    };\n    Parser.prototype.parseArgumentOptions = function (nestingLevel, expectingCloseTag, value, openingBracePosition) {\n        var _a;\n        // Parse this range:\n        // {name, type, style}\n        //        ^---^\n        var typeStartPosition = this.clonePosition();\n        var argType = this.parseIdentifierIfPossible().value;\n        var typeEndPosition = this.clonePosition();\n        switch (argType) {\n            case '':\n                // Expecting a style string number, date, time, plural, selectordinal, or select.\n                return this.error(ErrorKind.EXPECT_ARGUMENT_TYPE, createLocation(typeStartPosition, typeEndPosition));\n            case 'number':\n            case 'date':\n            case 'time': {\n                // Parse this range:\n                // {name, number, style}\n                //              ^-------^\n                this.bumpSpace();\n                var styleAndLocation = null;\n                if (this.bumpIf(',')) {\n                    this.bumpSpace();\n                    var styleStartPosition = this.clonePosition();\n                    var result = this.parseSimpleArgStyleIfPossible();\n                    if (result.err) {\n                        return result;\n                    }\n                    var style = trimEnd(result.val);\n                    if (style.length === 0) {\n                        return this.error(ErrorKind.EXPECT_ARGUMENT_STYLE, createLocation(this.clonePosition(), this.clonePosition()));\n                    }\n                    var styleLocation = createLocation(styleStartPosition, this.clonePosition());\n                    styleAndLocation = { style: style, styleLocation: styleLocation };\n                }\n                var argCloseResult = this.tryParseArgumentClose(openingBracePosition);\n                if (argCloseResult.err) {\n                    return argCloseResult;\n                }\n                var location_1 = createLocation(openingBracePosition, this.clonePosition());\n                // Extract style or skeleton\n                if (styleAndLocation && startsWith(styleAndLocation === null || styleAndLocation === void 0 ? void 0 : styleAndLocation.style, '::', 0)) {\n                    // Skeleton starts with `::`.\n                    var skeleton = trimStart(styleAndLocation.style.slice(2));\n                    if (argType === 'number') {\n                        var result = this.parseNumberSkeletonFromString(skeleton, styleAndLocation.styleLocation);\n                        if (result.err) {\n                            return result;\n                        }\n                        return {\n                            val: { type: TYPE.number, value: value, location: location_1, style: result.val },\n                            err: null,\n                        };\n                    }\n                    else {\n                        if (skeleton.length === 0) {\n                            return this.error(ErrorKind.EXPECT_DATE_TIME_SKELETON, location_1);\n                        }\n                        var dateTimePattern = skeleton;\n                        // Get \"best match\" pattern only if locale is passed, if not, let it\n                        // pass as-is where `parseDateTimeSkeleton()` will throw an error\n                        // for unsupported patterns.\n                        if (this.locale) {\n                            dateTimePattern = getBestPattern(skeleton, this.locale);\n                        }\n                        var style = {\n                            type: SKELETON_TYPE.dateTime,\n                            pattern: dateTimePattern,\n                            location: styleAndLocation.styleLocation,\n                            parsedOptions: this.shouldParseSkeletons\n                                ? parseDateTimeSkeleton(dateTimePattern)\n                                : {},\n                        };\n                        var type = argType === 'date' ? TYPE.date : TYPE.time;\n                        return {\n                            val: { type: type, value: value, location: location_1, style: style },\n                            err: null,\n                        };\n                    }\n                }\n                // Regular style or no style.\n                return {\n                    val: {\n                        type: argType === 'number'\n                            ? TYPE.number\n                            : argType === 'date'\n                                ? TYPE.date\n                                : TYPE.time,\n                        value: value,\n                        location: location_1,\n                        style: (_a = styleAndLocation === null || styleAndLocation === void 0 ? void 0 : styleAndLocation.style) !== null && _a !== void 0 ? _a : null,\n                    },\n                    err: null,\n                };\n            }\n            case 'plural':\n            case 'selectordinal':\n            case 'select': {\n                // Parse this range:\n                // {name, plural, options}\n                //              ^---------^\n                var typeEndPosition_1 = this.clonePosition();\n                this.bumpSpace();\n                if (!this.bumpIf(',')) {\n                    return this.error(ErrorKind.EXPECT_SELECT_ARGUMENT_OPTIONS, createLocation(typeEndPosition_1, __assign({}, typeEndPosition_1)));\n                }\n                this.bumpSpace();\n                // Parse offset:\n                // {name, plural, offset:1, options}\n                //                ^-----^\n                //\n                // or the first option:\n                //\n                // {name, plural, one {...} other {...}}\n                //                ^--^\n                var identifierAndLocation = this.parseIdentifierIfPossible();\n                var pluralOffset = 0;\n                if (argType !== 'select' && identifierAndLocation.value === 'offset') {\n                    if (!this.bumpIf(':')) {\n                        return this.error(ErrorKind.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE, createLocation(this.clonePosition(), this.clonePosition()));\n                    }\n                    this.bumpSpace();\n                    var result = this.tryParseDecimalInteger(ErrorKind.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE, ErrorKind.INVALID_PLURAL_ARGUMENT_OFFSET_VALUE);\n                    if (result.err) {\n                        return result;\n                    }\n                    // Parse another identifier for option parsing\n                    this.bumpSpace();\n                    identifierAndLocation = this.parseIdentifierIfPossible();\n                    pluralOffset = result.val;\n                }\n                var optionsResult = this.tryParsePluralOrSelectOptions(nestingLevel, argType, expectingCloseTag, identifierAndLocation);\n                if (optionsResult.err) {\n                    return optionsResult;\n                }\n                var argCloseResult = this.tryParseArgumentClose(openingBracePosition);\n                if (argCloseResult.err) {\n                    return argCloseResult;\n                }\n                var location_2 = createLocation(openingBracePosition, this.clonePosition());\n                if (argType === 'select') {\n                    return {\n                        val: {\n                            type: TYPE.select,\n                            value: value,\n                            options: fromEntries(optionsResult.val),\n                            location: location_2,\n                        },\n                        err: null,\n                    };\n                }\n                else {\n                    return {\n                        val: {\n                            type: TYPE.plural,\n                            value: value,\n                            options: fromEntries(optionsResult.val),\n                            offset: pluralOffset,\n                            pluralType: argType === 'plural' ? 'cardinal' : 'ordinal',\n                            location: location_2,\n                        },\n                        err: null,\n                    };\n                }\n            }\n            default:\n                return this.error(ErrorKind.INVALID_ARGUMENT_TYPE, createLocation(typeStartPosition, typeEndPosition));\n        }\n    };\n    Parser.prototype.tryParseArgumentClose = function (openingBracePosition) {\n        // Parse: {value, number, ::currency/GBP }\n        //\n        if (this.isEOF() || this.char() !== 125 /* `}` */) {\n            return this.error(ErrorKind.EXPECT_ARGUMENT_CLOSING_BRACE, createLocation(openingBracePosition, this.clonePosition()));\n        }\n        this.bump(); // `}`\n        return { val: true, err: null };\n    };\n    /**\n     * See: https://github.com/unicode-org/icu/blob/af7ed1f6d2298013dc303628438ec4abe1f16479/icu4c/source/common/messagepattern.cpp#L659\n     */\n    Parser.prototype.parseSimpleArgStyleIfPossible = function () {\n        var nestedBraces = 0;\n        var startPosition = this.clonePosition();\n        while (!this.isEOF()) {\n            var ch = this.char();\n            switch (ch) {\n                case 39 /* `'` */: {\n                    // Treat apostrophe as quoting but include it in the style part.\n                    // Find the end of the quoted literal text.\n                    this.bump();\n                    var apostrophePosition = this.clonePosition();\n                    if (!this.bumpUntil(\"'\")) {\n                        return this.error(ErrorKind.UNCLOSED_QUOTE_IN_ARGUMENT_STYLE, createLocation(apostrophePosition, this.clonePosition()));\n                    }\n                    this.bump();\n                    break;\n                }\n                case 123 /* `{` */: {\n                    nestedBraces += 1;\n                    this.bump();\n                    break;\n                }\n                case 125 /* `}` */: {\n                    if (nestedBraces > 0) {\n                        nestedBraces -= 1;\n                    }\n                    else {\n                        return {\n                            val: this.message.slice(startPosition.offset, this.offset()),\n                            err: null,\n                        };\n                    }\n                    break;\n                }\n                default:\n                    this.bump();\n                    break;\n            }\n        }\n        return {\n            val: this.message.slice(startPosition.offset, this.offset()),\n            err: null,\n        };\n    };\n    Parser.prototype.parseNumberSkeletonFromString = function (skeleton, location) {\n        var tokens = [];\n        try {\n            tokens = parseNumberSkeletonFromString(skeleton);\n        }\n        catch (e) {\n            return this.error(ErrorKind.INVALID_NUMBER_SKELETON, location);\n        }\n        return {\n            val: {\n                type: SKELETON_TYPE.number,\n                tokens: tokens,\n                location: location,\n                parsedOptions: this.shouldParseSkeletons\n                    ? parseNumberSkeleton(tokens)\n                    : {},\n            },\n            err: null,\n        };\n    };\n    /**\n     * @param nesting_level The current nesting level of messages.\n     *     This can be positive when parsing message fragment in select or plural argument options.\n     * @param parent_arg_type The parent argument's type.\n     * @param parsed_first_identifier If provided, this is the first identifier-like selector of\n     *     the argument. It is a by-product of a previous parsing attempt.\n     * @param expecting_close_tag If true, this message is directly or indirectly nested inside\n     *     between a pair of opening and closing tags. The nested message will not parse beyond\n     *     the closing tag boundary.\n     */\n    Parser.prototype.tryParsePluralOrSelectOptions = function (nestingLevel, parentArgType, expectCloseTag, parsedFirstIdentifier) {\n        var _a;\n        var hasOtherClause = false;\n        var options = [];\n        var parsedSelectors = new Set();\n        var selector = parsedFirstIdentifier.value, selectorLocation = parsedFirstIdentifier.location;\n        // Parse:\n        // one {one apple}\n        // ^--^\n        while (true) {\n            if (selector.length === 0) {\n                var startPosition = this.clonePosition();\n                if (parentArgType !== 'select' && this.bumpIf('=')) {\n                    // Try parse `={number}` selector\n                    var result = this.tryParseDecimalInteger(ErrorKind.EXPECT_PLURAL_ARGUMENT_SELECTOR, ErrorKind.INVALID_PLURAL_ARGUMENT_SELECTOR);\n                    if (result.err) {\n                        return result;\n                    }\n                    selectorLocation = createLocation(startPosition, this.clonePosition());\n                    selector = this.message.slice(startPosition.offset, this.offset());\n                }\n                else {\n                    break;\n                }\n            }\n            // Duplicate selector clauses\n            if (parsedSelectors.has(selector)) {\n                return this.error(parentArgType === 'select'\n                    ? ErrorKind.DUPLICATE_SELECT_ARGUMENT_SELECTOR\n                    : ErrorKind.DUPLICATE_PLURAL_ARGUMENT_SELECTOR, selectorLocation);\n            }\n            if (selector === 'other') {\n                hasOtherClause = true;\n            }\n            // Parse:\n            // one {one apple}\n            //     ^----------^\n            this.bumpSpace();\n            var openingBracePosition = this.clonePosition();\n            if (!this.bumpIf('{')) {\n                return this.error(parentArgType === 'select'\n                    ? ErrorKind.EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT\n                    : ErrorKind.EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT, createLocation(this.clonePosition(), this.clonePosition()));\n            }\n            var fragmentResult = this.parseMessage(nestingLevel + 1, parentArgType, expectCloseTag);\n            if (fragmentResult.err) {\n                return fragmentResult;\n            }\n            var argCloseResult = this.tryParseArgumentClose(openingBracePosition);\n            if (argCloseResult.err) {\n                return argCloseResult;\n            }\n            options.push([\n                selector,\n                {\n                    value: fragmentResult.val,\n                    location: createLocation(openingBracePosition, this.clonePosition()),\n                },\n            ]);\n            // Keep track of the existing selectors\n            parsedSelectors.add(selector);\n            // Prep next selector clause.\n            this.bumpSpace();\n            (_a = this.parseIdentifierIfPossible(), selector = _a.value, selectorLocation = _a.location);\n        }\n        if (options.length === 0) {\n            return this.error(parentArgType === 'select'\n                ? ErrorKind.EXPECT_SELECT_ARGUMENT_SELECTOR\n                : ErrorKind.EXPECT_PLURAL_ARGUMENT_SELECTOR, createLocation(this.clonePosition(), this.clonePosition()));\n        }\n        if (this.requiresOtherClause && !hasOtherClause) {\n            return this.error(ErrorKind.MISSING_OTHER_CLAUSE, createLocation(this.clonePosition(), this.clonePosition()));\n        }\n        return { val: options, err: null };\n    };\n    Parser.prototype.tryParseDecimalInteger = function (expectNumberError, invalidNumberError) {\n        var sign = 1;\n        var startingPosition = this.clonePosition();\n        if (this.bumpIf('+')) {\n        }\n        else if (this.bumpIf('-')) {\n            sign = -1;\n        }\n        var hasDigits = false;\n        var decimal = 0;\n        while (!this.isEOF()) {\n            var ch = this.char();\n            if (ch >= 48 /* `0` */ && ch <= 57 /* `9` */) {\n                hasDigits = true;\n                decimal = decimal * 10 + (ch - 48);\n                this.bump();\n            }\n            else {\n                break;\n            }\n        }\n        var location = createLocation(startingPosition, this.clonePosition());\n        if (!hasDigits) {\n            return this.error(expectNumberError, location);\n        }\n        decimal *= sign;\n        if (!isSafeInteger(decimal)) {\n            return this.error(invalidNumberError, location);\n        }\n        return { val: decimal, err: null };\n    };\n    Parser.prototype.offset = function () {\n        return this.position.offset;\n    };\n    Parser.prototype.isEOF = function () {\n        return this.offset() === this.message.length;\n    };\n    Parser.prototype.clonePosition = function () {\n        // This is much faster than `Object.assign` or spread.\n        return {\n            offset: this.position.offset,\n            line: this.position.line,\n            column: this.position.column,\n        };\n    };\n    /**\n     * Return the code point at the current position of the parser.\n     * Throws if the index is out of bound.\n     */\n    Parser.prototype.char = function () {\n        var offset = this.position.offset;\n        if (offset >= this.message.length) {\n            throw Error('out of bound');\n        }\n        var code = codePointAt(this.message, offset);\n        if (code === undefined) {\n            throw Error(\"Offset \".concat(offset, \" is at invalid UTF-16 code unit boundary\"));\n        }\n        return code;\n    };\n    Parser.prototype.error = function (kind, location) {\n        return {\n            val: null,\n            err: {\n                kind: kind,\n                message: this.message,\n                location: location,\n            },\n        };\n    };\n    /** Bump the parser to the next UTF-16 code unit. */\n    Parser.prototype.bump = function () {\n        if (this.isEOF()) {\n            return;\n        }\n        var code = this.char();\n        if (code === 10 /* '\\n' */) {\n            this.position.line += 1;\n            this.position.column = 1;\n            this.position.offset += 1;\n        }\n        else {\n            this.position.column += 1;\n            // 0 ~ 0x10000 -> unicode BMP, otherwise skip the surrogate pair.\n            this.position.offset += code < 0x10000 ? 1 : 2;\n        }\n    };\n    /**\n     * If the substring starting at the current position of the parser has\n     * the given prefix, then bump the parser to the character immediately\n     * following the prefix and return true. Otherwise, don't bump the parser\n     * and return false.\n     */\n    Parser.prototype.bumpIf = function (prefix) {\n        if (startsWith(this.message, prefix, this.offset())) {\n            for (var i = 0; i < prefix.length; i++) {\n                this.bump();\n            }\n            return true;\n        }\n        return false;\n    };\n    /**\n     * Bump the parser until the pattern character is found and return `true`.\n     * Otherwise bump to the end of the file and return `false`.\n     */\n    Parser.prototype.bumpUntil = function (pattern) {\n        var currentOffset = this.offset();\n        var index = this.message.indexOf(pattern, currentOffset);\n        if (index >= 0) {\n            this.bumpTo(index);\n            return true;\n        }\n        else {\n            this.bumpTo(this.message.length);\n            return false;\n        }\n    };\n    /**\n     * Bump the parser to the target offset.\n     * If target offset is beyond the end of the input, bump the parser to the end of the input.\n     */\n    Parser.prototype.bumpTo = function (targetOffset) {\n        if (this.offset() > targetOffset) {\n            throw Error(\"targetOffset \".concat(targetOffset, \" must be greater than or equal to the current offset \").concat(this.offset()));\n        }\n        targetOffset = Math.min(targetOffset, this.message.length);\n        while (true) {\n            var offset = this.offset();\n            if (offset === targetOffset) {\n                break;\n            }\n            if (offset > targetOffset) {\n                throw Error(\"targetOffset \".concat(targetOffset, \" is at invalid UTF-16 code unit boundary\"));\n            }\n            this.bump();\n            if (this.isEOF()) {\n                break;\n            }\n        }\n    };\n    /** advance the parser through all whitespace to the next non-whitespace code unit. */\n    Parser.prototype.bumpSpace = function () {\n        while (!this.isEOF() && _isWhiteSpace(this.char())) {\n            this.bump();\n        }\n    };\n    /**\n     * Peek at the *next* Unicode codepoint in the input without advancing the parser.\n     * If the input has been exhausted, then this returns null.\n     */\n    Parser.prototype.peek = function () {\n        if (this.isEOF()) {\n            return null;\n        }\n        var code = this.char();\n        var offset = this.offset();\n        var nextCode = this.message.charCodeAt(offset + (code >= 0x10000 ? 2 : 1));\n        return nextCode !== null && nextCode !== void 0 ? nextCode : null;\n    };\n    return Parser;\n}());\nexport { Parser };\n/**\n * This check if codepoint is alphabet (lower & uppercase)\n * @param codepoint\n * @returns\n */\nfunction _isAlpha(codepoint) {\n    return ((codepoint >= 97 && codepoint <= 122) ||\n        (codepoint >= 65 && codepoint <= 90));\n}\nfunction _isAlphaOrSlash(codepoint) {\n    return _isAlpha(codepoint) || codepoint === 47; /* '/' */\n}\n/** See `parseTag` function docs. */\nfunction _isPotentialElementNameChar(c) {\n    return (c === 45 /* '-' */ ||\n        c === 46 /* '.' */ ||\n        (c >= 48 && c <= 57) /* 0..9 */ ||\n        c === 95 /* '_' */ ||\n        (c >= 97 && c <= 122) /** a..z */ ||\n        (c >= 65 && c <= 90) /* A..Z */ ||\n        c == 0xb7 ||\n        (c >= 0xc0 && c <= 0xd6) ||\n        (c >= 0xd8 && c <= 0xf6) ||\n        (c >= 0xf8 && c <= 0x37d) ||\n        (c >= 0x37f && c <= 0x1fff) ||\n        (c >= 0x200c && c <= 0x200d) ||\n        (c >= 0x203f && c <= 0x2040) ||\n        (c >= 0x2070 && c <= 0x218f) ||\n        (c >= 0x2c00 && c <= 0x2fef) ||\n        (c >= 0x3001 && c <= 0xd7ff) ||\n        (c >= 0xf900 && c <= 0xfdcf) ||\n        (c >= 0xfdf0 && c <= 0xfffd) ||\n        (c >= 0x10000 && c <= 0xeffff));\n}\n/**\n * Code point equivalent of regex `\\p{White_Space}`.\n * From: https://www.unicode.org/Public/UCD/latest/ucd/PropList.txt\n */\nfunction _isWhiteSpace(c) {\n    return ((c >= 0x0009 && c <= 0x000d) ||\n        c === 0x0020 ||\n        c === 0x0085 ||\n        (c >= 0x200e && c <= 0x200f) ||\n        c === 0x2028 ||\n        c === 0x2029);\n}\n/**\n * Code point equivalent of regex `\\p{Pattern_Syntax}`.\n * See https://www.unicode.org/Public/UCD/latest/ucd/PropList.txt\n */\nfunction _isPatternSyntax(c) {\n    return ((c >= 0x0021 && c <= 0x0023) ||\n        c === 0x0024 ||\n        (c >= 0x0025 && c <= 0x0027) ||\n        c === 0x0028 ||\n        c === 0x0029 ||\n        c === 0x002a ||\n        c === 0x002b ||\n        c === 0x002c ||\n        c === 0x002d ||\n        (c >= 0x002e && c <= 0x002f) ||\n        (c >= 0x003a && c <= 0x003b) ||\n        (c >= 0x003c && c <= 0x003e) ||\n        (c >= 0x003f && c <= 0x0040) ||\n        c === 0x005b ||\n        c === 0x005c ||\n        c === 0x005d ||\n        c === 0x005e ||\n        c === 0x0060 ||\n        c === 0x007b ||\n        c === 0x007c ||\n        c === 0x007d ||\n        c === 0x007e ||\n        c === 0x00a1 ||\n        (c >= 0x00a2 && c <= 0x00a5) ||\n        c === 0x00a6 ||\n        c === 0x00a7 ||\n        c === 0x00a9 ||\n        c === 0x00ab ||\n        c === 0x00ac ||\n        c === 0x00ae ||\n        c === 0x00b0 ||\n        c === 0x00b1 ||\n        c === 0x00b6 ||\n        c === 0x00bb ||\n        c === 0x00bf ||\n        c === 0x00d7 ||\n        c === 0x00f7 ||\n        (c >= 0x2010 && c <= 0x2015) ||\n        (c >= 0x2016 && c <= 0x2017) ||\n        c === 0x2018 ||\n        c === 0x2019 ||\n        c === 0x201a ||\n        (c >= 0x201b && c <= 0x201c) ||\n        c === 0x201d ||\n        c === 0x201e ||\n        c === 0x201f ||\n        (c >= 0x2020 && c <= 0x2027) ||\n        (c >= 0x2030 && c <= 0x2038) ||\n        c === 0x2039 ||\n        c === 0x203a ||\n        (c >= 0x203b && c <= 0x203e) ||\n        (c >= 0x2041 && c <= 0x2043) ||\n        c === 0x2044 ||\n        c === 0x2045 ||\n        c === 0x2046 ||\n        (c >= 0x2047 && c <= 0x2051) ||\n        c === 0x2052 ||\n        c === 0x2053 ||\n        (c >= 0x2055 && c <= 0x205e) ||\n        (c >= 0x2190 && c <= 0x2194) ||\n        (c >= 0x2195 && c <= 0x2199) ||\n        (c >= 0x219a && c <= 0x219b) ||\n        (c >= 0x219c && c <= 0x219f) ||\n        c === 0x21a0 ||\n        (c >= 0x21a1 && c <= 0x21a2) ||\n        c === 0x21a3 ||\n        (c >= 0x21a4 && c <= 0x21a5) ||\n        c === 0x21a6 ||\n        (c >= 0x21a7 && c <= 0x21ad) ||\n        c === 0x21ae ||\n        (c >= 0x21af && c <= 0x21cd) ||\n        (c >= 0x21ce && c <= 0x21cf) ||\n        (c >= 0x21d0 && c <= 0x21d1) ||\n        c === 0x21d2 ||\n        c === 0x21d3 ||\n        c === 0x21d4 ||\n        (c >= 0x21d5 && c <= 0x21f3) ||\n        (c >= 0x21f4 && c <= 0x22ff) ||\n        (c >= 0x2300 && c <= 0x2307) ||\n        c === 0x2308 ||\n        c === 0x2309 ||\n        c === 0x230a ||\n        c === 0x230b ||\n        (c >= 0x230c && c <= 0x231f) ||\n        (c >= 0x2320 && c <= 0x2321) ||\n        (c >= 0x2322 && c <= 0x2328) ||\n        c === 0x2329 ||\n        c === 0x232a ||\n        (c >= 0x232b && c <= 0x237b) ||\n        c === 0x237c ||\n        (c >= 0x237d && c <= 0x239a) ||\n        (c >= 0x239b && c <= 0x23b3) ||\n        (c >= 0x23b4 && c <= 0x23db) ||\n        (c >= 0x23dc && c <= 0x23e1) ||\n        (c >= 0x23e2 && c <= 0x2426) ||\n        (c >= 0x2427 && c <= 0x243f) ||\n        (c >= 0x2440 && c <= 0x244a) ||\n        (c >= 0x244b && c <= 0x245f) ||\n        (c >= 0x2500 && c <= 0x25b6) ||\n        c === 0x25b7 ||\n        (c >= 0x25b8 && c <= 0x25c0) ||\n        c === 0x25c1 ||\n        (c >= 0x25c2 && c <= 0x25f7) ||\n        (c >= 0x25f8 && c <= 0x25ff) ||\n        (c >= 0x2600 && c <= 0x266e) ||\n        c === 0x266f ||\n        (c >= 0x2670 && c <= 0x2767) ||\n        c === 0x2768 ||\n        c === 0x2769 ||\n        c === 0x276a ||\n        c === 0x276b ||\n        c === 0x276c ||\n        c === 0x276d ||\n        c === 0x276e ||\n        c === 0x276f ||\n        c === 0x2770 ||\n        c === 0x2771 ||\n        c === 0x2772 ||\n        c === 0x2773 ||\n        c === 0x2774 ||\n        c === 0x2775 ||\n        (c >= 0x2794 && c <= 0x27bf) ||\n        (c >= 0x27c0 && c <= 0x27c4) ||\n        c === 0x27c5 ||\n        c === 0x27c6 ||\n        (c >= 0x27c7 && c <= 0x27e5) ||\n        c === 0x27e6 ||\n        c === 0x27e7 ||\n        c === 0x27e8 ||\n        c === 0x27e9 ||\n        c === 0x27ea ||\n        c === 0x27eb ||\n        c === 0x27ec ||\n        c === 0x27ed ||\n        c === 0x27ee ||\n        c === 0x27ef ||\n        (c >= 0x27f0 && c <= 0x27ff) ||\n        (c >= 0x2800 && c <= 0x28ff) ||\n        (c >= 0x2900 && c <= 0x2982) ||\n        c === 0x2983 ||\n        c === 0x2984 ||\n        c === 0x2985 ||\n        c === 0x2986 ||\n        c === 0x2987 ||\n        c === 0x2988 ||\n        c === 0x2989 ||\n        c === 0x298a ||\n        c === 0x298b ||\n        c === 0x298c ||\n        c === 0x298d ||\n        c === 0x298e ||\n        c === 0x298f ||\n        c === 0x2990 ||\n        c === 0x2991 ||\n        c === 0x2992 ||\n        c === 0x2993 ||\n        c === 0x2994 ||\n        c === 0x2995 ||\n        c === 0x2996 ||\n        c === 0x2997 ||\n        c === 0x2998 ||\n        (c >= 0x2999 && c <= 0x29d7) ||\n        c === 0x29d8 ||\n        c === 0x29d9 ||\n        c === 0x29da ||\n        c === 0x29db ||\n        (c >= 0x29dc && c <= 0x29fb) ||\n        c === 0x29fc ||\n        c === 0x29fd ||\n        (c >= 0x29fe && c <= 0x2aff) ||\n        (c >= 0x2b00 && c <= 0x2b2f) ||\n        (c >= 0x2b30 && c <= 0x2b44) ||\n        (c >= 0x2b45 && c <= 0x2b46) ||\n        (c >= 0x2b47 && c <= 0x2b4c) ||\n        (c >= 0x2b4d && c <= 0x2b73) ||\n        (c >= 0x2b74 && c <= 0x2b75) ||\n        (c >= 0x2b76 && c <= 0x2b95) ||\n        c === 0x2b96 ||\n        (c >= 0x2b97 && c <= 0x2bff) ||\n        (c >= 0x2e00 && c <= 0x2e01) ||\n        c === 0x2e02 ||\n        c === 0x2e03 ||\n        c === 0x2e04 ||\n        c === 0x2e05 ||\n        (c >= 0x2e06 && c <= 0x2e08) ||\n        c === 0x2e09 ||\n        c === 0x2e0a ||\n        c === 0x2e0b ||\n        c === 0x2e0c ||\n        c === 0x2e0d ||\n        (c >= 0x2e0e && c <= 0x2e16) ||\n        c === 0x2e17 ||\n        (c >= 0x2e18 && c <= 0x2e19) ||\n        c === 0x2e1a ||\n        c === 0x2e1b ||\n        c === 0x2e1c ||\n        c === 0x2e1d ||\n        (c >= 0x2e1e && c <= 0x2e1f) ||\n        c === 0x2e20 ||\n        c === 0x2e21 ||\n        c === 0x2e22 ||\n        c === 0x2e23 ||\n        c === 0x2e24 ||\n        c === 0x2e25 ||\n        c === 0x2e26 ||\n        c === 0x2e27 ||\n        c === 0x2e28 ||\n        c === 0x2e29 ||\n        (c >= 0x2e2a && c <= 0x2e2e) ||\n        c === 0x2e2f ||\n        (c >= 0x2e30 && c <= 0x2e39) ||\n        (c >= 0x2e3a && c <= 0x2e3b) ||\n        (c >= 0x2e3c && c <= 0x2e3f) ||\n        c === 0x2e40 ||\n        c === 0x2e41 ||\n        c === 0x2e42 ||\n        (c >= 0x2e43 && c <= 0x2e4f) ||\n        (c >= 0x2e50 && c <= 0x2e51) ||\n        c === 0x2e52 ||\n        (c >= 0x2e53 && c <= 0x2e7f) ||\n        (c >= 0x3001 && c <= 0x3003) ||\n        c === 0x3008 ||\n        c === 0x3009 ||\n        c === 0x300a ||\n        c === 0x300b ||\n        c === 0x300c ||\n        c === 0x300d ||\n        c === 0x300e ||\n        c === 0x300f ||\n        c === 0x3010 ||\n        c === 0x3011 ||\n        (c >= 0x3012 && c <= 0x3013) ||\n        c === 0x3014 ||\n        c === 0x3015 ||\n        c === 0x3016 ||\n        c === 0x3017 ||\n        c === 0x3018 ||\n        c === 0x3019 ||\n        c === 0x301a ||\n        c === 0x301b ||\n        c === 0x301c ||\n        c === 0x301d ||\n        (c >= 0x301e && c <= 0x301f) ||\n        c === 0x3020 ||\n        c === 0x3030 ||\n        c === 0xfd3e ||\n        c === 0xfd3f ||\n        (c >= 0xfe45 && c <= 0xfe46));\n}\n", "import { __assign } from \"tslib\";\nimport { ErrorKind } from './error';\nimport { Parser } from './parser';\nimport { isDateElement, isDateTimeSkeleton, isNumberElement, isNumberSkeleton, isPluralElement, isSelectElement, isTagElement, isTimeElement, } from './types';\nfunction pruneLocation(els) {\n    els.forEach(function (el) {\n        delete el.location;\n        if (isSelectElement(el) || isPluralElement(el)) {\n            for (var k in el.options) {\n                delete el.options[k].location;\n                pruneLocation(el.options[k].value);\n            }\n        }\n        else if (isNumberElement(el) && isNumberSkeleton(el.style)) {\n            delete el.style.location;\n        }\n        else if ((isDateElement(el) || isTimeElement(el)) &&\n            isDateTimeSkeleton(el.style)) {\n            delete el.style.location;\n        }\n        else if (isTagElement(el)) {\n            pruneLocation(el.children);\n        }\n    });\n}\nexport function parse(message, opts) {\n    if (opts === void 0) { opts = {}; }\n    opts = __assign({ shouldParseSkeletons: true, requiresOtherClause: true }, opts);\n    var result = new Parser(message, opts).parse();\n    if (result.err) {\n        var error = SyntaxError(ErrorKind[result.err.kind]);\n        // @ts-expect-error Assign to error object\n        error.location = result.err.location;\n        // @ts-expect-error Assign to error object\n        error.originalMessage = result.err.message;\n        throw error;\n    }\n    if (!(opts === null || opts === void 0 ? void 0 : opts.captureLocation)) {\n        pruneLocation(result.val);\n    }\n    return result.val;\n}\nexport * from './types';\n// only for testing\nexport var _Parser = Parser;\n", "//\n// Main\n//\nexport function memoize(fn, options) {\n    var cache = options && options.cache ? options.cache : cacheDefault;\n    var serializer = options && options.serializer ? options.serializer : serializerDefault;\n    var strategy = options && options.strategy ? options.strategy : strategyDefault;\n    return strategy(fn, {\n        cache: cache,\n        serializer: serializer,\n    });\n}\n//\n// Strategy\n//\nfunction isPrimitive(value) {\n    return (value == null || typeof value === 'number' || typeof value === 'boolean'); // || typeof value === \"string\" 'unsafe' primitive for our needs\n}\nfunction monadic(fn, cache, serializer, arg) {\n    var cacheKey = isPrimitive(arg) ? arg : serializer(arg);\n    var computedValue = cache.get(cacheKey);\n    if (typeof computedValue === 'undefined') {\n        computedValue = fn.call(this, arg);\n        cache.set(cacheKey, computedValue);\n    }\n    return computedValue;\n}\nfunction variadic(fn, cache, serializer) {\n    var args = Array.prototype.slice.call(arguments, 3);\n    var cacheKey = serializer(args);\n    var computedValue = cache.get(cacheKey);\n    if (typeof computedValue === 'undefined') {\n        computedValue = fn.apply(this, args);\n        cache.set(cacheKey, computedValue);\n    }\n    return computedValue;\n}\nfunction assemble(fn, context, strategy, cache, serialize) {\n    return strategy.bind(context, fn, cache, serialize);\n}\nfunction strategyDefault(fn, options) {\n    var strategy = fn.length === 1 ? monadic : variadic;\n    return assemble(fn, this, strategy, options.cache.create(), options.serializer);\n}\nfunction strategyVariadic(fn, options) {\n    return assemble(fn, this, variadic, options.cache.create(), options.serializer);\n}\nfunction strategyMonadic(fn, options) {\n    return assemble(fn, this, monadic, options.cache.create(), options.serializer);\n}\n//\n// Serializer\n//\nvar serializerDefault = function () {\n    return JSON.stringify(arguments);\n};\n//\n// Cache\n//\nfunction ObjectWithoutPrototypeCache() {\n    this.cache = Object.create(null);\n}\nObjectWithoutPrototypeCache.prototype.get = function (key) {\n    return this.cache[key];\n};\nObjectWithoutPrototypeCache.prototype.set = function (key, value) {\n    this.cache[key] = value;\n};\nvar cacheDefault = {\n    create: function create() {\n        // @ts-ignore\n        return new ObjectWithoutPrototypeCache();\n    },\n};\nexport var strategies = {\n    variadic: strategyVariadic,\n    monadic: strategyMonadic,\n};\n", "import { __extends } from \"tslib\";\nexport var ErrorCode;\n(function (ErrorCode) {\n    // When we have a placeholder but no value to format\n    ErrorCode[\"MISSING_VALUE\"] = \"MISSING_VALUE\";\n    // When value supplied is invalid\n    ErrorCode[\"INVALID_VALUE\"] = \"INVALID_VALUE\";\n    // When we need specific Intl API but it's not available\n    ErrorCode[\"MISSING_INTL_API\"] = \"MISSING_INTL_API\";\n})(ErrorCode || (ErrorCode = {}));\nvar FormatError = /** @class */ (function (_super) {\n    __extends(FormatError, _super);\n    function FormatError(msg, code, originalMessage) {\n        var _this = _super.call(this, msg) || this;\n        _this.code = code;\n        _this.originalMessage = originalMessage;\n        return _this;\n    }\n    FormatError.prototype.toString = function () {\n        return \"[formatjs Error: \".concat(this.code, \"] \").concat(this.message);\n    };\n    return FormatError;\n}(Error));\nexport { FormatError };\nvar InvalidValueError = /** @class */ (function (_super) {\n    __extends(InvalidValueError, _super);\n    function InvalidValueError(variableId, value, options, originalMessage) {\n        return _super.call(this, \"Invalid values for \\\"\".concat(variableId, \"\\\": \\\"\").concat(value, \"\\\". Options are \\\"\").concat(Object.keys(options).join('\", \"'), \"\\\"\"), ErrorCode.INVALID_VALUE, originalMessage) || this;\n    }\n    return InvalidValueError;\n}(FormatError));\nexport { InvalidValueError };\nvar InvalidValueTypeError = /** @class */ (function (_super) {\n    __extends(InvalidValueTypeError, _super);\n    function InvalidValueTypeError(value, type, originalMessage) {\n        return _super.call(this, \"Value for \\\"\".concat(value, \"\\\" must be of type \").concat(type), ErrorCode.INVALID_VALUE, originalMessage) || this;\n    }\n    return InvalidValueTypeError;\n}(FormatError));\nexport { InvalidValueTypeError };\nvar MissingValueError = /** @class */ (function (_super) {\n    __extends(MissingValueError, _super);\n    function MissingValueError(variableId, originalMessage) {\n        return _super.call(this, \"The intl string context variable \\\"\".concat(variableId, \"\\\" was not provided to the string \\\"\").concat(originalMessage, \"\\\"\"), ErrorCode.MISSING_VALUE, originalMessage) || this;\n    }\n    return MissingValueError;\n}(FormatError));\nexport { MissingValueError };\n", "import { isArgumentElement, isDateElement, isDateTimeSkeleton, isLiteralElement, isNumberElement, isNumberSkeleton, isPluralElement, isPoundElement, isSelectElement, isTimeElement, isTagElement, } from '@formatjs/icu-messageformat-parser';\nimport { MissingValueError, InvalidValueError, ErrorCode, FormatError, InvalidValueTypeError, } from './error';\nexport var PART_TYPE;\n(function (PART_TYPE) {\n    PART_TYPE[PART_TYPE[\"literal\"] = 0] = \"literal\";\n    PART_TYPE[PART_TYPE[\"object\"] = 1] = \"object\";\n})(PART_TYPE || (PART_TYPE = {}));\nfunction mergeLiteral(parts) {\n    if (parts.length < 2) {\n        return parts;\n    }\n    return parts.reduce(function (all, part) {\n        var lastPart = all[all.length - 1];\n        if (!lastPart ||\n            lastPart.type !== PART_TYPE.literal ||\n            part.type !== PART_TYPE.literal) {\n            all.push(part);\n        }\n        else {\n            lastPart.value += part.value;\n        }\n        return all;\n    }, []);\n}\nexport function isFormatXMLElementFn(el) {\n    return typeof el === 'function';\n}\n// TODO(skeleton): add skeleton support\nexport function formatToParts(els, locales, formatters, formats, values, currentPluralValue, \n// For debugging\noriginalMessage) {\n    // Hot path for straight simple msg translations\n    if (els.length === 1 && isLiteralElement(els[0])) {\n        return [\n            {\n                type: PART_TYPE.literal,\n                value: els[0].value,\n            },\n        ];\n    }\n    var result = [];\n    for (var _i = 0, els_1 = els; _i < els_1.length; _i++) {\n        var el = els_1[_i];\n        // Exit early for string parts.\n        if (isLiteralElement(el)) {\n            result.push({\n                type: PART_TYPE.literal,\n                value: el.value,\n            });\n            continue;\n        }\n        // TODO: should this part be literal type?\n        // Replace `#` in plural rules with the actual numeric value.\n        if (isPoundElement(el)) {\n            if (typeof currentPluralValue === 'number') {\n                result.push({\n                    type: PART_TYPE.literal,\n                    value: formatters.getNumberFormat(locales).format(currentPluralValue),\n                });\n            }\n            continue;\n        }\n        var varName = el.value;\n        // Enforce that all required values are provided by the caller.\n        if (!(values && varName in values)) {\n            throw new MissingValueError(varName, originalMessage);\n        }\n        var value = values[varName];\n        if (isArgumentElement(el)) {\n            if (!value || typeof value === 'string' || typeof value === 'number') {\n                value =\n                    typeof value === 'string' || typeof value === 'number'\n                        ? String(value)\n                        : '';\n            }\n            result.push({\n                type: typeof value === 'string' ? PART_TYPE.literal : PART_TYPE.object,\n                value: value,\n            });\n            continue;\n        }\n        // Recursively format plural and select parts' option \u2014 which can be a\n        // nested pattern structure. The choosing of the option to use is\n        // abstracted-by and delegated-to the part helper object.\n        if (isDateElement(el)) {\n            var style = typeof el.style === 'string'\n                ? formats.date[el.style]\n                : isDateTimeSkeleton(el.style)\n                    ? el.style.parsedOptions\n                    : undefined;\n            result.push({\n                type: PART_TYPE.literal,\n                value: formatters\n                    .getDateTimeFormat(locales, style)\n                    .format(value),\n            });\n            continue;\n        }\n        if (isTimeElement(el)) {\n            var style = typeof el.style === 'string'\n                ? formats.time[el.style]\n                : isDateTimeSkeleton(el.style)\n                    ? el.style.parsedOptions\n                    : formats.time.medium;\n            result.push({\n                type: PART_TYPE.literal,\n                value: formatters\n                    .getDateTimeFormat(locales, style)\n                    .format(value),\n            });\n            continue;\n        }\n        if (isNumberElement(el)) {\n            var style = typeof el.style === 'string'\n                ? formats.number[el.style]\n                : isNumberSkeleton(el.style)\n                    ? el.style.parsedOptions\n                    : undefined;\n            if (style && style.scale) {\n                value =\n                    value *\n                        (style.scale || 1);\n            }\n            result.push({\n                type: PART_TYPE.literal,\n                value: formatters\n                    .getNumberFormat(locales, style)\n                    .format(value),\n            });\n            continue;\n        }\n        if (isTagElement(el)) {\n            var children = el.children, value_1 = el.value;\n            var formatFn = values[value_1];\n            if (!isFormatXMLElementFn(formatFn)) {\n                throw new InvalidValueTypeError(value_1, 'function', originalMessage);\n            }\n            var parts = formatToParts(children, locales, formatters, formats, values, currentPluralValue);\n            var chunks = formatFn(parts.map(function (p) { return p.value; }));\n            if (!Array.isArray(chunks)) {\n                chunks = [chunks];\n            }\n            result.push.apply(result, chunks.map(function (c) {\n                return {\n                    type: typeof c === 'string' ? PART_TYPE.literal : PART_TYPE.object,\n                    value: c,\n                };\n            }));\n        }\n        if (isSelectElement(el)) {\n            var opt = el.options[value] || el.options.other;\n            if (!opt) {\n                throw new InvalidValueError(el.value, value, Object.keys(el.options), originalMessage);\n            }\n            result.push.apply(result, formatToParts(opt.value, locales, formatters, formats, values));\n            continue;\n        }\n        if (isPluralElement(el)) {\n            var opt = el.options[\"=\".concat(value)];\n            if (!opt) {\n                if (!Intl.PluralRules) {\n                    throw new FormatError(\"Intl.PluralRules is not available in this environment.\\nTry polyfilling it using \\\"@formatjs/intl-pluralrules\\\"\\n\", ErrorCode.MISSING_INTL_API, originalMessage);\n                }\n                var rule = formatters\n                    .getPluralRules(locales, { type: el.pluralType })\n                    .select(value - (el.offset || 0));\n                opt = el.options[rule] || el.options.other;\n            }\n            if (!opt) {\n                throw new InvalidValueError(el.value, value, Object.keys(el.options), originalMessage);\n            }\n            result.push.apply(result, formatToParts(opt.value, locales, formatters, formats, values, value - (el.offset || 0)));\n            continue;\n        }\n    }\n    return mergeLiteral(result);\n}\n", "/*\nCopyright (c) 2014, Yahoo! Inc. All rights reserved.\nCopyrights licensed under the New BSD License.\nSee the accompanying LICENSE file for terms.\n*/\nimport { __assign, __rest, __spreadArray } from \"tslib\";\nimport { parse, } from '@formatjs/icu-messageformat-parser';\nimport { memoize, strategies } from '@formatjs/fast-memoize';\nimport { formatToParts, PART_TYPE, } from './formatters';\n// -- MessageFormat --------------------------------------------------------\nfunction mergeConfig(c1, c2) {\n    if (!c2) {\n        return c1;\n    }\n    return __assign(__assign(__assign({}, (c1 || {})), (c2 || {})), Object.keys(c1).reduce(function (all, k) {\n        all[k] = __assign(__assign({}, c1[k]), (c2[k] || {}));\n        return all;\n    }, {}));\n}\nfunction mergeConfigs(defaultConfig, configs) {\n    if (!configs) {\n        return defaultConfig;\n    }\n    return Object.keys(defaultConfig).reduce(function (all, k) {\n        all[k] = mergeConfig(defaultConfig[k], configs[k]);\n        return all;\n    }, __assign({}, defaultConfig));\n}\nfunction createFastMemoizeCache(store) {\n    return {\n        create: function () {\n            return {\n                get: function (key) {\n                    return store[key];\n                },\n                set: function (key, value) {\n                    store[key] = value;\n                },\n            };\n        },\n    };\n}\nfunction createDefaultFormatters(cache) {\n    if (cache === void 0) { cache = {\n        number: {},\n        dateTime: {},\n        pluralRules: {},\n    }; }\n    return {\n        getNumberFormat: memoize(function () {\n            var _a;\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i] = arguments[_i];\n            }\n            return new ((_a = Intl.NumberFormat).bind.apply(_a, __spreadArray([void 0], args, false)))();\n        }, {\n            cache: createFastMemoizeCache(cache.number),\n            strategy: strategies.variadic,\n        }),\n        getDateTimeFormat: memoize(function () {\n            var _a;\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i] = arguments[_i];\n            }\n            return new ((_a = Intl.DateTimeFormat).bind.apply(_a, __spreadArray([void 0], args, false)))();\n        }, {\n            cache: createFastMemoizeCache(cache.dateTime),\n            strategy: strategies.variadic,\n        }),\n        getPluralRules: memoize(function () {\n            var _a;\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i] = arguments[_i];\n            }\n            return new ((_a = Intl.PluralRules).bind.apply(_a, __spreadArray([void 0], args, false)))();\n        }, {\n            cache: createFastMemoizeCache(cache.pluralRules),\n            strategy: strategies.variadic,\n        }),\n    };\n}\nvar IntlMessageFormat = /** @class */ (function () {\n    function IntlMessageFormat(message, locales, overrideFormats, opts) {\n        var _this = this;\n        if (locales === void 0) { locales = IntlMessageFormat.defaultLocale; }\n        this.formatterCache = {\n            number: {},\n            dateTime: {},\n            pluralRules: {},\n        };\n        this.format = function (values) {\n            var parts = _this.formatToParts(values);\n            // Hot path for straight simple msg translations\n            if (parts.length === 1) {\n                return parts[0].value;\n            }\n            var result = parts.reduce(function (all, part) {\n                if (!all.length ||\n                    part.type !== PART_TYPE.literal ||\n                    typeof all[all.length - 1] !== 'string') {\n                    all.push(part.value);\n                }\n                else {\n                    all[all.length - 1] += part.value;\n                }\n                return all;\n            }, []);\n            if (result.length <= 1) {\n                return result[0] || '';\n            }\n            return result;\n        };\n        this.formatToParts = function (values) {\n            return formatToParts(_this.ast, _this.locales, _this.formatters, _this.formats, values, undefined, _this.message);\n        };\n        this.resolvedOptions = function () {\n            var _a;\n            return ({\n                locale: ((_a = _this.resolvedLocale) === null || _a === void 0 ? void 0 : _a.toString()) ||\n                    Intl.NumberFormat.supportedLocalesOf(_this.locales)[0],\n            });\n        };\n        this.getAst = function () { return _this.ast; };\n        // Defined first because it's used to build the format pattern.\n        this.locales = locales;\n        this.resolvedLocale = IntlMessageFormat.resolveLocale(locales);\n        if (typeof message === 'string') {\n            this.message = message;\n            if (!IntlMessageFormat.__parse) {\n                throw new TypeError('IntlMessageFormat.__parse must be set to process `message` of type `string`');\n            }\n            var _a = opts || {}, formatters = _a.formatters, parseOpts = __rest(_a, [\"formatters\"]);\n            // Parse string messages into an AST.\n            this.ast = IntlMessageFormat.__parse(message, __assign(__assign({}, parseOpts), { locale: this.resolvedLocale }));\n        }\n        else {\n            this.ast = message;\n        }\n        if (!Array.isArray(this.ast)) {\n            throw new TypeError('A message must be provided as a String or AST.');\n        }\n        // Creates a new object with the specified `formats` merged with the default\n        // formats.\n        this.formats = mergeConfigs(IntlMessageFormat.formats, overrideFormats);\n        this.formatters =\n            (opts && opts.formatters) || createDefaultFormatters(this.formatterCache);\n    }\n    Object.defineProperty(IntlMessageFormat, \"defaultLocale\", {\n        get: function () {\n            if (!IntlMessageFormat.memoizedDefaultLocale) {\n                IntlMessageFormat.memoizedDefaultLocale =\n                    new Intl.NumberFormat().resolvedOptions().locale;\n            }\n            return IntlMessageFormat.memoizedDefaultLocale;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    IntlMessageFormat.memoizedDefaultLocale = null;\n    IntlMessageFormat.resolveLocale = function (locales) {\n        if (typeof Intl.Locale === 'undefined') {\n            return;\n        }\n        var supportedLocales = Intl.NumberFormat.supportedLocalesOf(locales);\n        if (supportedLocales.length > 0) {\n            return new Intl.Locale(supportedLocales[0]);\n        }\n        return new Intl.Locale(typeof locales === 'string' ? locales : locales[0]);\n    };\n    IntlMessageFormat.__parse = parse;\n    // Default format options used as the prototype of the `formats` provided to the\n    // constructor. These are used when constructing the internal Intl.NumberFormat\n    // and Intl.DateTimeFormat instances.\n    IntlMessageFormat.formats = {\n        number: {\n            integer: {\n                maximumFractionDigits: 0,\n            },\n            currency: {\n                style: 'currency',\n            },\n            percent: {\n                style: 'percent',\n            },\n        },\n        date: {\n            short: {\n                month: 'numeric',\n                day: 'numeric',\n                year: '2-digit',\n            },\n            medium: {\n                month: 'short',\n                day: 'numeric',\n                year: 'numeric',\n            },\n            long: {\n                month: 'long',\n                day: 'numeric',\n                year: 'numeric',\n            },\n            full: {\n                weekday: 'long',\n                month: 'long',\n                day: 'numeric',\n                year: 'numeric',\n            },\n        },\n        time: {\n            short: {\n                hour: 'numeric',\n                minute: 'numeric',\n            },\n            medium: {\n                hour: 'numeric',\n                minute: 'numeric',\n                second: 'numeric',\n            },\n            long: {\n                hour: 'numeric',\n                minute: 'numeric',\n                second: 'numeric',\n                timeZoneName: 'short',\n            },\n            full: {\n                hour: 'numeric',\n                minute: 'numeric',\n                second: 'numeric',\n                timeZoneName: 'short',\n            },\n        },\n    };\n    return IntlMessageFormat;\n}());\nexport { IntlMessageFormat };\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\n/**\n * Returns true if the current environment is a development environment.\n *\n * @returns {boolean} True if the current environment is a development environment, false otherwise.\n */\nexport function getIsDevEnvironment(hostname = window.location.hostname): boolean {\n  return /^(localhost|dev|stage)/.test(hostname);\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { localizeBundle } from './locale-functions.js';\nimport { LocaleService, Localized, MessageBundle, Unlocalized } from './locale-service.js';\nimport { IntlMessageFormat } from 'intl-messageformat';\n\nimport { getIsDevEnvironment } from '../../functions/environment-functions.js';\n\n/**\n * A function that provides a localized string for a given key and unlocalizedValue.\n */\nexport type LocalizedStringFunction = (key: string, unlocalizedValue: string) => string;\n\nfunction getStringFormatFunction(key: string, message: string, locale: string): (values: Record<string, unknown>) => string {\n  // Step 1: Replace HTML tags with placeholders\n  const htmlTags: string[] = [];\n  const sanitizedMessage = message.replace(/(<[^>]+>)/g, match => {\n    htmlTags.push(match);\n    return `__HTML_TAG_${htmlTags.length - 1}__`;\n  });\n  // Step 2: Format the sanitized message\n  const formatter = new IntlMessageFormat(sanitizedMessage, locale);\n  return values => {\n    let formattedMessage = formatter.format(values) as string;\n    // Step 3: Replace placeholders with original HTML tags\n    formattedMessage = formattedMessage.replace(/__HTML_TAG_(\\d+)__/g, (_match, index) => {\n      // Step 4: we need to find for each {key} in values and replace with values[key]\n      let htmlTagsMatch = htmlTags[index];\n      for (const key of Object.keys(values)) {\n        htmlTagsMatch = htmlTagsMatch.replace(new RegExp(`{${key}}`, 'g'), values[key] as string);\n      }\n      return htmlTagsMatch;\n    });\n    return formattedMessage;\n  };\n}\n\nfunction identityLocalizedStringFunction(_key: string, unlocalizedValue: string): string {\n  return unlocalizedValue;\n}\n\n/**\n * Creates a locale service that uses ICU message format for localization.\n */\nexport async function createICUMessageLocaleService(props: {\n  localeCode: string;\n  prefix?: string;\n  localize?: LocalizedStringFunction;\n  isProdEnvironment?: boolean;\n}): Promise<LocaleService> {\n  const { localeCode, prefix = '', localize = identityLocalizedStringFunction, isProdEnvironment = !getIsDevEnvironment() } = props;\n\n  function convertCamelCaseToKebabCase(camelCase: string): string {\n    return camelCase.replace(/([a-z])([A-Z])/g, '$1-$2').toLowerCase();\n  }\n\n  function getUniqueKey(tagName: string, key: string): string {\n    return `${prefix ? prefix + '-' : ''}${tagName}--${convertCamelCaseToKebabCase(key)}`;\n  }\n\n  function getLocalizedValue<T extends string | ((args: unknown) => string)>(key: string, value: T): T {\n    // Internal implementation without error handling.\n    const getLocalizedValueInternal = (localizeFunction: LocalizedStringFunction): T => {\n      // In a real implementation, this would look up the unique key in a localization file.\n      if (typeof value === 'function') {\n        return getStringFormatFunction(key, localizeFunction(key, value({})), localeCode) as T;\n      }\n      return getStringFormatFunction(key, localizeFunction(key, value), localeCode)({}) as T;\n    };\n\n    try {\n      return getLocalizedValueInternal(localize);\n    } catch (error) {\n      // Fall back to english in prod.\n      if (isProdEnvironment) return getLocalizedValueInternal(identityLocalizedStringFunction);\n      // eslint-disable-next-line no-console -- We do not want to lose the stack trace for this error.\n      console.trace('Error localizing message:', { key, value, error });\n      const errorMessage = `Translation error for \"${key}\": ${error}`;\n      if (typeof value === 'function') return ((_args: unknown) => errorMessage) as T;\n      return errorMessage as T;\n    }\n  }\n\n  return {\n    serviceName: 'icu-message-locale-service',\n    localize<T extends MessageBundle>(_tagName: string, bundle: Unlocalized<T>): Localized<T> {\n      return localizeBundle(bundle, (key, message) => getLocalizedValue(getUniqueKey(_tagName, key), message));\n    },\n  };\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { Localized, MessageBundle } from './locale-service.js';\n\nimport { createICUMessageLocaleService } from '../../services/locale-service/icu-message-locale-service.js';\n\nexport * from './locale-functions.js';\n\nconst defaultLocaleService = await createICUMessageLocaleService({\n  localeCode: navigator.language,\n});\n\n/**\n * Converts an unlocalized message bundle into a functional localized message bundle\n * but without any actual localization.\n * The resulting message bundle will use the ICU message standard to format messages.\n * This should only be used by shared elements that are not localized via a locale service.\n */\nexport function localizeBundleDefault<T extends MessageBundle>(bundle: T): Localized<T> {\n  return defaultLocaleService.localize('', bundle);\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { Rect } from '../common/geometry-functions.js';\n\n/**\n * Creates a CSS clip path that fills the whole element, but with a rectangular hole cut out of it.\n *\n * @param cutoutRect - The rectangle to cut out of the element.\n * @returns The clip path for the element.\n */\nexport function clipPathWithRectangularHole(cutoutRect: Rect) {\n  const [min, max] = cutoutRect;\n\n  let polygon = [\n    // Full element:\n    '0 0',\n    '100% 0',\n    '100% 100%',\n    '0 100%',\n    '0 0',\n    // Cutout: (this part will get cut out because of the evenodd rule)\n    `${min.x}px ${min.y}px`,\n    `${max.x}px ${min.y}px`,\n    `${max.x}px ${max.y}px`,\n    `${min.x}px ${max.y}px`,\n    `${min.x}px ${min.y}px`,\n  ];\n\n  return `polygon(evenodd,${polygon.join(', ')}) content-box`;\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { css } from 'lit';\n\nexport const styles = css`\n  :host {\n    display: flex;\n    user-select: none;\n    touch-action: none;\n\n    width: fit-content;\n    height: fit-content;\n  }\n  \n  .root {\n    display: flex;\n    position: relative;\n\n    --border-color: var(--spectrum-global-color-gray-900);\n  \n    --background-contrast: 0.5;\n    --background-saturation: 1.5;\n    --background-brightness: 1.5;\n\n    --handle-radius: 30px;\n  }\n\n  .root.dark {\n    --background-contrast: 0.5;\n    --background-saturation: 1.5;\n    --background-brightness: 0.5;\n  }\n\n  .image {\n    -webkit-user-drag: none;\n    -khtml-user-drag: none;\n    -moz-user-drag: none;\n    -o-user-drag: none;\n  }\n  \n  .image-mask {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    pointer-events: none;\n    background-color: var(--spectrum-global-color-gray-50);\n    opacity: 0.75;\n    clip-path: var(--clip-path);\n  }\n\n  .desktop .image-mask {\n    /* We can use a fancier filter on desktop. This isn't interacting well with clip-path on mobile. */\n    backdrop-filter: contrast(var(--background-contrast)) saturate(var(--background-saturation)) brightness(var(--background-brightness)) blur(1px);\n    background-color: transparent;\n    opacity: 1;\n  }\n\n  .crop-area {\n    position: absolute;\n    background-color: transparent;\n    cursor: move;\n    display: flex;\n    outline: none;\n  }\n\n  .keyboard-mode .crop-area:focus {\n    --border-color: var(--spectrum-global-color-blue-400);\n  }\n\n  .handle-container {\n    position: relative;\n    border: 1px solid var(--border-color);\n    flex: 1 1 auto;\n  }\n\n  .handle {\n    position: absolute;\n    width: var(--handle-radius);\n    height: var(--handle-radius);\n  }\n\n  .handle-padding {\n    width: 100%;\n    height: 100%;\n    box-sizing: content-box;\n\n    position: absolute;\n    top: calc(var(--pad-top, 0) * -1);\n    left: calc(var(--pad-left, 0) * -1);\n    bottom: calc(var(--pad-bottom, 0) * -1);\n    right: calc(var(--pad-right, 0) * -1);\n\n    border-top: var(--pad-top) solid transparent;\n    border-left: var(--pad-left) solid transparent;\n    border-bottom: var(--pad-bottom) solid transparent;\n    border-right: var(--pad-right) solid transparent;\n  }\n\n  .center-translation-handle {\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    border-radius: 50%;\n    transform: translate(-50%, -50%);\n    width: var(--handle-radius);\n    height: var(--handle-radius);\n  }\n`;\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { Rect } from '../common/geometry-functions.js';\n\nexport class CropperUpdateEvent extends CustomEvent<{ cropArea: Rect }> {\n  static readonly eventName = 'update';\n\n  constructor(cropArea: Rect) {\n    super(CropperUpdateEvent.eventName, {\n      detail: { cropArea },\n      composed: true,\n    });\n  }\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { clipPathWithRectangularHole } from './cropper-functions.js';\nimport { styles } from './cropper.css.js';\nimport { CropperUpdateEvent } from './events.js';\nimport { BlobRef } from '@adobe/data/cache';\nimport { LitElement, html, nothing } from 'lit';\nimport { customElement, property, query, state } from 'lit/decorators.js';\nimport { classMap } from 'lit/directives/class-map.js';\nimport { Ref, createRef, ref } from 'lit/directives/ref.js';\n\nimport { localizeBundleDefault } from '../../services/locale-service/index.js';\n\nimport { withCapture } from '../../functions/dom-functions.js';\nimport { FileEditorSettings, getEditedFile } from '../../functions/file-edit-functions.js';\nimport { Localized } from '../../services/locale-service/locale-service.js';\nimport { LineSegment, Rect, Vec2 } from '../common/geometry-functions.js';\nimport { commonStyles } from '../common/styles.css.js';\nimport { useBorrowUrl } from '../hooks/use-borrow-url.js';\nimport { useSpectrumTheme } from '../hooks/use-spectrum-theme.js';\nimport { useEffect, withHooks } from '../hooks/with-hooks.js';\n\nexport const unlocalized = {\n  topLeft: 'top left',\n  topRight: 'top right',\n  bottomLeft: 'bottom left',\n  bottomRight: 'bottom right',\n  resizeHandle: (_: { label: string }) => `Crop selection {label} corner. Use arrow keys to resize`,\n  translationHandle: 'Crop selection. Use arrow keys to move.',\n  move: 'Move',\n  resize: 'Resize',\n};\n\nexport type CropperProps = {\n  fileRef: BlobRef | null;\n  aspectRatio: number | null;\n  preview: boolean;\n  autoFit: boolean;\n  initialCropArea?: Rect;\n  isMobile?: boolean;\n};\n\nexport const tagName = 'firefly-cropper';\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    [tagName]: Cropper;\n  }\n}\n\ntype DragHandlers = {\n  onMove?: (event: PointerEvent) => void;\n  onUp?: (event: PointerEvent) => void;\n};\n\ntype DragState = {\n  pointerId: number;\n  releasePointer: () => void;\n  handlers: DragHandlers;\n  cursor?: string;\n};\n\ntype HandleItem = {\n  point: Vec2;\n  anchor: Vec2;\n  style: string;\n  cursor: string;\n  label: string;\n};\n\n@customElement(tagName)\nexport class Cropper extends LitElement implements CropperProps {\n  static styles = [commonStyles, styles];\n\n  @query('.crop-area')\n  cropAreaElement!: HTMLElement;\n\n  //////////////////////////////////////////////////////////////////////////////\n  // Inputs\n\n  @property({ type: Object, reflect: true }) fileRef: BlobRef | null = null;\n\n  @property({ type: Number, reflect: true }) aspectRatio: number | null = null;\n\n  @property({ type: Boolean, reflect: true }) preview = false;\n\n  /**\n   * If true, the crop area will be automatically fit to the image when it loads.\n   */\n  @property({ type: Boolean, reflect: true }) autoFit = true;\n\n  // In client coordinates.\n  @property({ type: Number, reflect: true }) maxWidth = 360;\n\n  // In client coordinates.\n  @property({ type: Number, reflect: true }) maxHeight = 360;\n\n  @property({ type: Array }) initialCropArea: Rect | undefined = undefined;\n\n  @property({ type: Boolean, reflect: true }) isMobile = false;\n\n  /**\n   * The localized strings for the component.\n   * These can be provided by the consuming application.\n   */\n  @property({ type: Object })\n  localized: Localized<typeof unlocalized> = localizeBundleDefault(unlocalized);\n\n  //////////////////////////////////////////////////////////////////////////////\n  // State\n\n  _cropArea: Rect | undefined;\n\n  @state()\n  get cropArea() {\n    return (\n      this._cropArea ??\n      this.initialCropArea ?? [\n        { x: 0, y: 0 },\n        { x: 1, y: 1 },\n      ]\n    );\n  }\n\n  set cropArea(value: Rect) {\n    this._cropArea = value;\n  }\n\n  private rootRef: Ref<HTMLElement> = createRef();\n\n  @state() private dragState: DragState | null = null;\n\n  private imageSize: Vec2 = { x: 0, y: 0 };\n\n  @state() keyboardMode = false;\n\n  //////////////////////////////////////////////////////////////////////////////\n  // Accessors\n\n  private imageBounds(): Rect {\n    return [{ x: 0, y: 0 }, this.imageSize];\n  }\n\n  private cropCenter(): Vec2 {\n    if (!this.cropArea) return { x: 0, y: 0 };\n    return Vec2.scale(Vec2.add(this.cropArea[0], this.cropArea[1]), 0.5);\n  }\n\n  private minCropAreaSize(): Vec2 {\n    const minWidth = this.imageSize.x * 0.2;\n    if (this.aspectRatio) {\n      return this.aspectRatio > 1 ? { x: minWidth, y: minWidth / this.aspectRatio } : { x: minWidth * this.aspectRatio, y: minWidth };\n    }\n    return { x: minWidth, y: minWidth };\n  }\n\n  setCropArea(cropArea: Rect) {\n    let clamped = Rect.fitToBounds(cropArea, this.imageBounds());\n    if (this.aspectRatio) clamped = Rect.fitToBounds(Rect.clampAspect(clamped, this.aspectRatio), this.imageBounds());\n\n    const size = Rect.getSize(clamped);\n    if (size.x < 1 || size.y < 1 || isNaN(size.x) || isNaN(size.y) || !isFinite(size.x) || !isFinite(size.y)) return;\n\n    this.cropArea = clamped;\n\n    if (this.isConnected) this.dispatchEvent(new CropperUpdateEvent(this.cropArea));\n  }\n\n  fitCropAreaToImage() {\n    this.setCropArea(this.imageBounds());\n  }\n\n  async getCroppedImage() {\n    const editorSettings = this.getEditorSettings();\n    if (!editorSettings) return null;\n    return getEditedFile(editorSettings);\n  }\n\n  getEditorSettings(): FileEditorSettings | null {\n    if (!this.fileRef || !this.cropArea) return null;\n    return {\n      baseFileRef: this.fileRef,\n      crop: {\n        rect: {\n          x: this.cropArea[0].x,\n          y: this.cropArea[0].y,\n          width: Rect.getWidth(this.cropArea),\n          height: Rect.getHeight(this.cropArea),\n        },\n      },\n    };\n  }\n\n  focusSelection(keyboardMode = false) {\n    this.keyboardMode = keyboardMode;\n    // Wait for the next tick to focus the crop area.\n    // Otherwise the calling event may steal focus back.\n    // Calling event.preventDefault() from each event is the cleaner but less general way to do this.\n    if (this.cropAreaElement) setTimeout(() => this.cropAreaElement.focus(), 0);\n  }\n\n  //////////////////////////////////////////////////////////////////////////////\n  // Coordinate Transformations\n\n  contentClientSize(): Vec2 {\n    const { maxWidth, maxHeight } = this;\n    const contentAspectRatio = this.imageSize.y === 0 || this.imageSize.x === 0 ? 1 : this.imageSize.x / this.imageSize.y;\n    return maxWidth > maxHeight * contentAspectRatio\n      ? { x: maxHeight * contentAspectRatio, y: maxHeight }\n      : { x: maxWidth, y: maxWidth / contentAspectRatio };\n  }\n\n  /**\n   * Converts a vector or point from client space to image space.\n   *\n   * @param vector - The vector in client space.\n   * @returns The vector in image space.\n   */\n  clientToImageSpace(vector: Vec2): Vec2 {\n    const root = this.rootRef.value;\n    if (!root) return { x: 0, y: 0 };\n\n    const contentSize = this.contentClientSize();\n    const scaleX = this.imageSize.x / contentSize.x;\n    const scaleY = this.imageSize.y / contentSize.y;\n\n    return {\n      x: vector.x * scaleX,\n      y: vector.y * scaleY,\n    };\n  }\n\n  /**\n   * Converts a vector or point from image space to client space.\n   *\n   * @param vector - The vector in image space.\n   * @returns The vector in client space.\n   */\n  imageToClientSpace(vector: Vec2): Vec2 {\n    const root = this.rootRef.value;\n    if (!root) return { x: 0, y: 0 };\n\n    const contentSize = this.contentClientSize();\n    const scaleX = this.imageSize.x / contentSize.x;\n    const scaleY = this.imageSize.y / contentSize.y;\n\n    return {\n      x: vector.x / scaleX,\n      y: vector.y / scaleY,\n    };\n  }\n\n  imageSpacePointer(event: PointerEvent): Vec2 {\n    return this.clientToImageSpace({\n      x: event.clientX,\n      y: event.clientY,\n    });\n  }\n\n  /**\n   * Ratio of image's natural size to its size in client space.\n   */\n  imageSizeRatio(): Vec2 {\n    const root = this.rootRef.value;\n    if (!root) return { x: 0, y: 0 };\n    const clientBounds = root.getBoundingClientRect();\n    return { x: this.imageSize.x / clientBounds.width, y: this.imageSize.y / clientBounds.height };\n  }\n\n  //////////////////////////////////////////////////////////////////////////////\n  // Event Handlers\n\n  handlePointerMove(event: PointerEvent) {\n    if (!this.dragState) return;\n\n    this.dragState.handlers.onMove?.(event);\n  }\n\n  beginDrag(event: PointerEvent, cursor: string, handlers: DragHandlers) {\n    if (!this.rootRef.value) return null;\n\n    const pointerId = event.pointerId;\n    const releasePointer = () => this.rootRef.value?.releasePointerCapture(pointerId);\n    this.rootRef.value.setPointerCapture(pointerId);\n\n    return {\n      pointerId,\n      releasePointer,\n      handlers,\n      cursor,\n    };\n  }\n\n  endDrag() {\n    if (!this.dragState) return;\n    this.dragState.releasePointer();\n    this.dragState = null;\n  }\n\n  handlePointerDown_cropArea(event: PointerEvent) {\n    if (this.dragState || !this.cropArea) return;\n\n    const pointerStart = this.imageSpacePointer(event);\n\n    const startRect = this.cropArea;\n    this.dragState = this.beginDrag(event, 'move', {\n      onMove: (event: PointerEvent) => {\n        if (!this.cropArea) return;\n        const pointer = this.imageSpacePointer(event);\n\n        let offset = Vec2.sub(pointer, pointerStart);\n        if (event.shiftKey) {\n          // Snap to the nearest axis.\n          offset = Math.abs(offset.x) > Math.abs(offset.y) ? { x: offset.x, y: 0 } : { x: 0, y: offset.y };\n        }\n\n        this.setCropArea(Rect.translate(startRect, offset));\n      },\n    });\n\n    event.preventDefault();\n    event.stopPropagation();\n    this.keyboardMode = false;\n  }\n\n  getArrowKeySpeed(event: KeyboardEvent) {\n    const size = Rect.getSize(this.cropArea);\n    const baseSpeed = Math.sqrt(size.x * size.y) * 0.1;\n    const speed = event.altKey ? baseSpeed * 0.2 : baseSpeed;\n    return speed;\n  }\n\n  handleKeyDown_cropArea(event: KeyboardEvent) {\n    const speed = this.getArrowKeySpeed(event);\n    // Arrow keys move the crop area.\n    const offsets = {\n      ArrowUp: { x: 0, y: -speed },\n      ArrowDown: { x: 0, y: speed },\n      ArrowLeft: { x: -speed, y: 0 },\n      ArrowRight: { x: speed, y: 0 },\n    };\n    const offset = offsets[event.key as keyof typeof offsets];\n    if (offset) {\n      this.setCropArea(Rect.translate(this.cropArea, offset));\n      event.preventDefault();\n      event.stopPropagation();\n      this.keyboardMode = true;\n    }\n  }\n\n  getSnapLine(point: Vec2) {\n    if (!this.aspectRatio) return null;\n    return Rect.intersectLine(this.imageBounds(), { point, direction: Vec2.sub(this.cropCenter(), point) });\n  }\n\n  handlePointerDown_resizeHandle(event: PointerEvent, handle: HandleItem) {\n    if (this.dragState || !this.cropArea) return;\n    const pointerStart = this.imageSpacePointer(event);\n    const snapLine = this.getSnapLine(handle.point);\n    const initialCenter = this.cropCenter();\n    this.dragState = this.beginDrag(event, handle.cursor, {\n      onMove: (event: PointerEvent) => {\n        if (!this.cropArea) return;\n        const pointer = this.imageSpacePointer(event);\n        const pointerOffset = Vec2.sub(pointer, pointerStart);\n        this.moveHandle(event, handle.point, handle.anchor, pointerOffset, snapLine, initialCenter);\n      },\n    });\n    event.preventDefault();\n    event.stopPropagation();\n    this.keyboardMode = false;\n  }\n\n  handleKeyDown_resizeHandle(event: KeyboardEvent, handle: HandleItem) {\n    const speed = this.getArrowKeySpeed(event);\n    const offsets = {\n      ArrowUp: { x: 0, y: -speed },\n      ArrowDown: { x: 0, y: speed },\n      ArrowLeft: { x: -speed, y: 0 },\n      ArrowRight: { x: speed, y: 0 },\n    };\n    const offset = offsets[event.key as keyof typeof offsets];\n    if (offset) {\n      this.moveHandle(event, handle.point, handle.anchor, offset);\n      event.preventDefault();\n      event.stopPropagation();\n      this.keyboardMode = true;\n    }\n  }\n\n  moveHandle(\n    event: PointerEvent | KeyboardEvent,\n    handlePoint: Vec2,\n    anchor: Vec2,\n    offset: Vec2,\n    snapLine: LineSegment | null = this.getSnapLine(handlePoint),\n    initialCenter: Vec2 = this.cropCenter()\n  ) {\n    let dragPoint = Vec2.add(handlePoint, offset);\n\n    // We maintain aspect ratio by snapping to the crop area's diagonal.\n    // Don't worry about accumulating floating point errors.\n    // Aspect ratio constraints are also enforced directly in setCropArea.\n    if (snapLine) dragPoint = LineSegment.nearestPoint(snapLine, dragPoint);\n    else dragPoint = Vec2.clampToRect(dragPoint, this.imageBounds());\n\n    {\n      // Adjust the drag point so we don't shrink below the minimum size.\n      const minSize = this.minCropAreaSize();\n\n      let diff = Vec2.sub(dragPoint, anchor);\n\n      const epsilon = 0.0001; // Handle degenerate case.\n      if (Math.abs(diff.x) < epsilon || Math.abs(diff.y) < epsilon) diff = Vec2.scale(Vec2.sub(dragPoint, initialCenter), 0.01);\n\n      const clampedDiff = Vec2.mul(Vec2.max(Vec2.abs(diff), minSize), Vec2.sign(diff));\n      dragPoint = Vec2.add(anchor, clampedDiff);\n    }\n\n    if (event.shiftKey) {\n      const newRect = Rect.boundingBox([anchor, dragPoint]);\n      const newCenter = Vec2.scale(Vec2.add(newRect[0], newRect[1]), 0.5);\n      const offset = Vec2.sub(initialCenter, newCenter);\n      const centeredRect = Rect.translate(newRect, offset);\n      this.setCropArea(centeredRect);\n    } else {\n      this.setCropArea(Rect.boundingBox([anchor, dragPoint]));\n    }\n  }\n\n  async handlePointerUp(event: PointerEvent) {\n    if (!this.dragState || this.dragState.pointerId !== event.pointerId) return;\n\n    this.endDrag();\n  }\n\n  handleImageLoad(event: Event) {\n    if (!this.rootRef.value) return;\n    const img = event.currentTarget as HTMLImageElement;\n    this.imageSize = { x: img.naturalWidth, y: img.naturalHeight };\n    if (this.autoFit) this.fitCropAreaToImage();\n  }\n\n  @withCapture\n  handleKeyDown(event: KeyboardEvent) {\n    if (event.key === 'Tab') this.keyboardMode = true;\n  }\n\n  handleContextMenu() {\n    this.endDrag();\n  }\n\n  handlePointerDown() {\n    this.focusSelection();\n  }\n\n  // Always rerender on resize.\n  resizeObserver: ResizeObserver | null = null;\n\n  connectedCallback() {\n    super.connectedCallback();\n    this.resizeObserver = new ResizeObserver(() => this.requestUpdate());\n    this.resizeObserver.observe(this);\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback();\n    this.resizeObserver?.disconnect();\n  }\n\n  //////////////////////////////////////////////////////////////////////////////\n  // Rendering\n\n  handleItems(): HandleItem[] {\n    const corners: Record<string, Vec2> = {\n      topLeft: this.cropArea[0],\n      topRight: { x: this.cropArea[1].x, y: this.cropArea[0].y },\n      bottomRight: this.cropArea[1],\n      bottomLeft: { x: this.cropArea[0].x, y: this.cropArea[1].y },\n    };\n\n    const borderThickness = '2px';\n    const border = `${borderThickness} solid var(--border-color)`;\n    const padding = '15px';\n    return [\n      {\n        point: corners.topLeft,\n        anchor: corners.bottomRight,\n        label: this.localized.resizeHandle({ label: this.localized.topLeft }),\n        cursor: 'nwse-resize',\n        style: `\n          left: -${borderThickness}; top: -${borderThickness}; cursor: nwse-resize;\n          border-top: ${border}; border-left: ${border}; border-bottom-right-radius: 50%;\n          --pad-top: ${padding}; --pad-left: ${padding};\n        `,\n      },\n      {\n        point: corners.topRight,\n        anchor: corners.bottomLeft,\n        label: this.localized.resizeHandle({ label: this.localized.topRight }),\n        cursor: 'nesw-resize',\n        style: `\n          right: -${borderThickness}; top: -${borderThickness}; cursor: nesw-resize;\n          border-top: ${border}; border-right: ${border}; border-bottom-left-radius: 50%;\n          --pad-top: ${padding}; --pad-right: ${padding};\n        `,\n      },\n      {\n        point: corners.bottomLeft,\n        anchor: corners.topRight,\n        label: this.localized.resizeHandle({ label: this.localized.bottomLeft }),\n        cursor: 'nesw-resize',\n        style: `\n          left: -${borderThickness}; bottom: -${borderThickness}; cursor: nesw-resize;\n          border-bottom: ${border}; border-left: ${border}; border-top-right-radius: 50%;\n          --pad-bottom: ${padding}; --pad-left: ${padding};\n        `,\n      },\n      {\n        point: corners.bottomRight,\n        anchor: corners.topLeft,\n        label: this.localized.resizeHandle({ label: this.localized.bottomRight }),\n        cursor: 'nwse-resize',\n        style: `\n          right: -${borderThickness}; bottom: -${borderThickness}; cursor: nwse-resize;\n          border-bottom: ${border}; border-right: ${border}; border-top-left-radius: 50%;\n          --pad-bottom: ${padding}; --pad-right: ${padding};\n        `,\n      },\n    ];\n  }\n\n  renderCropHandles() {\n    if (!this.cropArea) return nothing;\n\n    return html`<div class=\"handle-container\">\n      ${this.handleItems().map(\n        handle =>\n          html`<div\n            tabindex=\"0\"\n            aria-label=${handle.label}\n            class=\"handle\"\n            style=\"${handle.style}\"\n            @pointerdown=${(event: PointerEvent) => this.handlePointerDown_resizeHandle(event, handle)}\n            @keydown=${(event: KeyboardEvent) => this.handleKeyDown_resizeHandle(event, handle)}>\n            <div class=\"handle-padding\"></div>\n          </div>`\n      )}\n    </div>`;\n  }\n\n  renderCropArea() {\n    if (!this.cropArea) return nothing;\n\n    const toRelative = (point: Vec2) => this.imageToClientSpace(point);\n    const clientCropArea = this.cropArea.map(toRelative) as unknown as Rect; // TS doesn't understand the result must be a Rect.\n\n    const width = Rect.getWidth(clientCropArea);\n    const height = Rect.getHeight(clientCropArea);\n\n    const style = `\n      ${this.preview ? 'display: none;' : ''}\n      left: ${clientCropArea[0].x}px;\n      top: ${clientCropArea[0].y}px;\n      width: ${width}px;\n      height: ${height}px;\n    `;\n\n    return html`<div\n      tabindex=\"0\"\n      class=\"crop-area\"\n      aria-label=${this.localized.translationHandle}\n      @pointerdown=${this.handlePointerDown_cropArea}\n      @keydown=${this.handleKeyDown_cropArea}\n      style=${style}>\n      ${this.renderCropHandles()}\n      <div class=\"center-translation-handle\"></div>\n    </div>`;\n  }\n\n  renderPreview() {\n    if (!this.preview) return nothing;\n    const url = useBorrowUrl(this.fileRef);\n\n    const cropSize = Rect.getSize(this.cropArea);\n    const clientCropSize = this.imageToClientSpace(cropSize);\n    const clientPosition = this.imageToClientSpace(this.cropArea[0]);\n\n    const clientImageSize = this.imageToClientSpace(this.imageSize);\n\n    const { x: width, y: height } = clientCropSize;\n\n    const style = `\n      background-image: url(${url});\n      width: ${width}px;\n      height: ${height}px;\n      background-position: ${-clientPosition.x}px ${-clientPosition.y}px;\n      background-size: ${clientImageSize.x}px ${clientImageSize.y}px;\n    `;\n\n    return html`<div class=\"preview\" style=${style}></div>`;\n  }\n\n  renderImageMask() {\n    if (this.preview) return nothing;\n    const toClientSpace = (point: Vec2) => this.imageToClientSpace(point);\n    const clientCropArea = this.cropArea.map(toClientSpace) as unknown as Rect;\n    const clipPath = clipPathWithRectangularHole(clientCropArea);\n    return html`<div class=\"image-mask\" style=\"--clip-path: ${clipPath}\"></div>`;\n  }\n\n  @withHooks\n  render() {\n    useEffect(() => {\n      this.fitCropAreaToImage();\n    }, [this.aspectRatio]);\n\n    const theme = useSpectrumTheme();\n\n    if (!this.fileRef) return nothing;\n\n    const url = useBorrowUrl(this.fileRef);\n\n    const contentSize = this.contentClientSize();\n    const imgStyle = `width: ${contentSize.x}px; height: ${contentSize.y}px; ${this.preview ? 'display: none;' : ''}`;\n\n    const clasName = classMap({\n      root: true,\n      dark: theme.color === 'dark',\n      'keyboard-mode': this.keyboardMode,\n      desktop: !this.isMobile,\n    });\n\n    const style = `cursor: ${this.dragState?.cursor ?? 'default'};`;\n\n    return html`<div\n      class=${clasName}\n      style=${style}\n      ${ref(this.rootRef)}\n      @pointerdown=${this.handlePointerDown}\n      @contextmenu=${this.handleContextMenu}\n      @pointermove=${this.handlePointerMove}\n      @pointerup=${this.handlePointerUp}\n      @dblclick=${this.fitCropAreaToImage}\n      @keydown=${this.handleKeyDown}>\n      <img style=${imgStyle} class=\"image\" src=${url ?? ''} @load=${this.handleImageLoad} alt=\"content to crop\" />\n      ${this.renderImageMask()} ${this.renderCropArea()} ${this.renderPreview()}\n    </div>`;\n  }\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details\nimport { BlobRef, blobStore } from '@adobe/data/cache';\n\nexport async function download(file: BlobRef, options: { filename: string }) {\n  if (!file) return;\n  try {\n    // Fetch the file and create a Blob from it\n    const blobUrl = await blobStore.getBlob(file);\n    if (blobUrl) {\n      const anchor = document.createElement('a');\n      anchor.href = URL.createObjectURL(blobUrl);\n      anchor.download = options.filename;\n      document.body.append(anchor);\n      anchor.click();\n      document.body.removeChild(anchor); // Clean up after the download\n    }\n  } catch (error) {\n    console.error('Download failed:', error);\n  }\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { download } from './file-functions/download.js';\nimport { convertBlobToFormat } from './image-functions.js';\nimport { isSafari } from './user-agent-functions.js';\nimport { BlobRef, blobStore } from '@adobe/data/cache';\n\nexport { download } from './file-functions/download.js';\nexport { mimeToExtensionMap } from './file-functions/mime-to-extension-map.js';\n\nexport function canShare(shareData: ShareData) {\n  // navigator.share() only available in secure contexts.\n  return typeof navigator.share === 'function' && navigator.canShare(shareData);\n}\n\nexport async function upload(args: { accept?: string }) {\n  const input = document.createElement('input');\n  input.type = 'file';\n  input.accept = args.accept ?? '*';\n\n  const result = await new Promise<File | null>(resolve => {\n    input.onchange = event => {\n      const file = (event.target as HTMLInputElement).files?.[0];\n      if (!file) return;\n      resolve(file);\n    };\n    input.click();\n  });\n\n  return result;\n}\n\nexport async function copy(file: BlobRef) {\n  if (!file) return;\n\n  if (isSafari()) {\n    // For Safari, we need a continuous promise chain with no awaits\n    // Get blob and convert to PNG in a single promise chain\n    const blobPromise = blobStore.getBlob(file).then(blob => {\n      if (!blob) throw new Error('No blob available');\n      return convertBlobToFormat(blob, 'image/png');\n    });\n\n    // Pass the promise chain directly to clipboard API\n    await navigator.clipboard.write([\n      new ClipboardItem({\n        ['image/png']: blobPromise,\n      }),\n    ]);\n  } else {\n    // For other browsers, we can use a more direct approach\n    const blob = await blobStore.getBlob(file);\n    if (!blob) throw new Error('No blob available');\n    const pngBlob = await convertBlobToFormat(blob, 'image/png');\n    await navigator.clipboard.write([\n      new ClipboardItem({\n        ['image/png']: Promise.resolve(pngBlob),\n      }),\n    ]);\n  }\n}\n\n/**\n * Result type for clipboard paste operations\n */\nexport type ClipboardContent = { type: 'image'; content: BlobRef } | { type: 'text'; content: string } | { type: 'empty'; content: null };\n\n/**\n * Extracts content from ClipboardEvent's DataTransfer object\n * Handles files from Finder, images from web, and text\n * @param clipboardData - The DataTransfer object from ClipboardEvent.clipboardData\n * @returns An object with type ('image', 'text', or 'empty') and the corresponding content\n */\nexport async function extractClipboardContent(clipboardData: DataTransfer | null): Promise<ClipboardContent> {\n  // Check if there are files (handle local image paste)\n  if (clipboardData?.files && clipboardData.files.length > 0) {\n    const localImageFile = Array.from(clipboardData.files).find(file => file.type.startsWith('image/'));\n    if (localImageFile) {\n      return { type: 'image', content: await blobStore.getRef(localImageFile) };\n    }\n  }\n  // Check items for image data (web paste)\n  if (clipboardData?.items && clipboardData.items.length > 0) {\n    const imageItem = Array.from(clipboardData.items).find(item => item.type.startsWith('image/'));\n    if (imageItem) {\n      const file = imageItem.getAsFile();\n      if (file) {\n        return { type: 'image', content: await blobStore.getRef(file) };\n      }\n    }\n    // Check items for text data\n    const textItem = Array.from(clipboardData.items).find(item => item.type.startsWith('text/plain'));\n    if (textItem) {\n      const text = await new Promise<string>(resolve => {\n        textItem.getAsString(resolve);\n      });\n      if (text.trim()) {\n        return { type: 'text', content: text };\n      }\n    }\n  }\n\n  return { type: 'empty', content: null };\n}\n\n/**\n * Shares a file using the Web Share API\n * @param file - The blob reference to share\n * @param options - Share options including filename and text\n * @returns Promise<void>\n * @description\n * Attempts to share the file using the Web Share API. If the Web Share API is not available\n * or doesn't support file sharing (e.g., on some Android browsers), it will automatically\n * fall back to downloading the file instead. This ensures users can always save their files\n * regardless of platform or browser support.\n *\n * Web Share API can also fail due to permissions + other security measures, so an option is provided\n * to fall back to downloading in these cases.\n */\nexport async function share(\n  file: BlobRef,\n  options: { filename: string; text?: string; downloadOnPermissionError?: boolean }\n): Promise<void> {\n  if (!file) return;\n  try {\n    const blob = await blobStore.getBlob(file);\n    if (!blob) {\n      throw new Error('Failed to acquire blob for sharing');\n    }\n\n    const fileObj = new File([blob], options.filename, { type: blob.type });\n    const shareData: ShareData = {\n      files: [fileObj],\n      title: options.filename,\n      text: options.text,\n    };\n    if (canShare(shareData)) {\n      await navigator.share(shareData);\n    } else {\n      await download(file, { filename: options.filename });\n    }\n  } catch (error) {\n    console.error('Share failed:', error);\n    // cancelling the share will result in an `AbortError` that we don't want to recover from\n    if (options.downloadOnPermissionError && error instanceof Error && error.name === 'NotAllowedError') {\n      await download(file, { filename: options.filename });\n    }\n  }\n}\n\nexport async function compressFile(file: File): Promise<File> {\n  const stream = file.stream();\n  const compressedStream = stream.pipeThrough(new CompressionStream('gzip'));\n  const compressedBlob = await new Response(compressedStream).blob();\n  return new File([compressedBlob], file.name, { type: file.type });\n}\n\nexport async function decompressFile(file: File): Promise<File> {\n  const stream = file.stream();\n  const decompressedStream = stream.pipeThrough(new DecompressionStream('gzip'));\n  const decompressedBlob = await new Response(decompressedStream).blob();\n  return new File([decompressedBlob], file.name, { type: file.type });\n}\n\n/**\n * Open a file in a new tab.\n * @param file - The blob reference to preview\n * @returns Promise<void>\n */\nexport async function openInNewTab(file: BlobRef, features = 'width=300,height=300') {\n  if (!file) return;\n  const url = await blobStore.borrowUrl(file);\n  if (!url) return;\n  const windowProxy = await window.open(url, '_blank', features);\n  windowProxy?.addEventListener('load', () => blobStore.returnUrl(url));\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { BlobRef, blobStore } from '@adobe/data/cache';\n\nimport { MediaSize } from '../types/graphics-types.js';\n\nconst withVideoMetadata = async <A>(blobRef: BlobRef, useVideo: (videoElement: HTMLVideoElement) => A): Promise<A> => {\n  const url = await blobStore.borrowUrl(blobRef);\n  if (!url) {\n    throw new Error('Failed to get blob from BlobRef');\n  }\n\n  try {\n    const video = document.createElement('video');\n    video.src = url;\n    video.muted = true;\n    video.autoplay = false;\n    video.preload = 'metadata';\n    //  set so we aren't blocked by CORS policy\n    video.crossOrigin = 'anonymous';\n\n    await new Promise<void>((resolve, reject) => {\n      video.addEventListener('loadedmetadata', () => resolve());\n      video.addEventListener('error', () => reject(new Error('Failed to load video metadata')));\n      video.load();\n    });\n\n    return useVideo(video);\n  } finally {\n    blobStore.returnUrl(url);\n  }\n};\n\nexport async function getVideoSize(blobRef: BlobRef): Promise<MediaSize> {\n  return withVideoMetadata(blobRef, video => {\n    const width = video.videoWidth;\n    const height = video.videoHeight;\n    const duration = video.duration;\n    return { width, height, duration };\n  });\n}\n\nexport const getVideoDuration = async (videoBlobRef: BlobRef) => {\n  return withVideoMetadata(videoBlobRef, video => {\n    return video.duration;\n  });\n};\n\n/**\n * Detects if a video element has an audio track.\n * This method checks various browser-specific APIs to determine audio presence.\n *\n * @param video - The video element to check for audio\n * @returns Promise that resolves to true if video has audio, false otherwise\n */\nexport async function detectVideoAudio(video: HTMLVideoElement): Promise<boolean> {\n  // Extended video element interface for browser-specific properties\n  interface ExtendedHTMLVideoElement extends HTMLVideoElement {\n    audioTracks?: { length: number };\n    webkitAudioDecodedByteCount?: number;\n    mozHasAudio?: boolean;\n    mozCaptureStream?: () => MediaStream;\n  }\n\n  const extendedVideo = video as ExtendedHTMLVideoElement;\n\n  // Try audioTracks API first (most browsers)\n  const audioTracks = extendedVideo.audioTracks;\n  if (audioTracks !== undefined && audioTracks !== null) {\n    return audioTracks.length > 0;\n  }\n\n  // Check webkit property - if defined, it's a reliable indicator\n  const webkitAudioDecodedByteCount = extendedVideo.webkitAudioDecodedByteCount;\n  if (webkitAudioDecodedByteCount !== undefined) {\n    // If > 0, audio definitely exists\n    if (webkitAudioDecodedByteCount > 0) {\n      return true;\n    }\n    // If 0, wait briefly and check again (audio may not be decoded yet at metadata load time)\n    await new Promise(resolve => setTimeout(resolve, 100));\n    const webkitAfterWait = extendedVideo.webkitAudioDecodedByteCount;\n    if (webkitAfterWait !== undefined && webkitAfterWait > 0) {\n      return true;\n    }\n    // Still 0 after wait - no audio track\n    return false;\n  }\n\n  // Firefox has a dedicated property\n  const mozHasAudio = extendedVideo.mozHasAudio;\n  if (mozHasAudio !== undefined) {\n    return mozHasAudio;\n  }\n\n  // Last resort for Firefox: capture stream and check audio tracks\n  try {\n    const mozCaptureStream = extendedVideo.mozCaptureStream;\n    if (mozCaptureStream) {\n      const stream = mozCaptureStream.call(video);\n      if (stream) {\n        return stream.getAudioTracks().length > 0;\n      }\n    }\n  } catch (e) {\n    // Ignore errors from stream capture\n  }\n\n  // Default to hiding controls if we can't detect audio reliably\n  return false;\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { getAspectRatioDescriptor } from './aspect-ratio-functions.js';\nimport { mimeToExtensionMap } from './file-functions.js';\nimport { getVideoSize } from './video-functions.js';\nimport { BlobRef, blobStore, memoize } from '@adobe/data/cache';\n\nimport { AspectRatio, MediaSize, Size } from '../types/graphics-types.js';\n\nexport type ThumbnailSrcRect = {\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n};\n\nexport type ImageFormatType = 'image/webp' | 'image/jpeg' | 'image/png';\n\n// Todo: Replace raw \"await new Promise\" usage in this file with this and similar functions.\n// https://jira.corp.adobe.com/browse/FFP-41232\nexport function loadImage(src: string, options: Partial<HTMLImageElement> = { crossOrigin: 'anonymous' }): Promise<HTMLImageElement> {\n  return new Promise((resolve, reject) => {\n    const img = new Image();\n    img.onload = () => resolve(img);\n    img.onerror = reject;\n    Object.assign(img, options);\n    img.src = src;\n  });\n}\n\nexport function getPreferredSize(natural: Size, preferred: Partial<Size> = {}): Size {\n  const { width: pWidth, height: pHeight } = preferred;\n  const { width: nWidth, height: nHeight } = natural;\n\n  if (pWidth && pHeight) {\n    return preferred as Size;\n  }\n  if (pWidth && !pHeight) {\n    return { width: pWidth, height: (pWidth / nWidth) * nHeight };\n  }\n  if (!pWidth && pHeight) {\n    return { width: (pHeight / nHeight) * nWidth, height: pHeight };\n  }\n  return natural;\n}\n\nexport const getVideoFrame = memoize(\n  'getFrame:v1',\n  async (source: BlobRef, options: { time: number; size?: Partial<Size> }): Promise<BlobRef | null> => {\n    const url = await blobStore.borrowUrl(source);\n    const { size, time = 0 } = options;\n\n    if (!url) {\n      return null;\n    }\n\n    try {\n      const video = document.createElement('video');\n      video.src = url;\n      video.muted = true; // Required for autoplay on iOS\n      video.setAttribute('playsinline', '');\n\n      // Load metadata\n      await new Promise<void>((resolve, reject) => {\n        video.onloadedmetadata = () => resolve();\n        video.onerror = error => reject(error);\n      });\n\n      const { width, height } = getPreferredSize({ width: video.videoWidth, height: video.videoHeight }, size);\n      video.width = width;\n      video.height = height;\n\n      // *** Safari iOS Fix: Play briefly before seeking ***\n      try {\n        await video.play();\n        video.pause();\n      } catch (e) {\n        // Ignore autoplay errors\n      }\n\n      // Seek to the desired time\n      video.currentTime = time;\n\n      // Wait for the seek operation to complete\n      await new Promise<void>((resolve, reject) => {\n        const seekHandler = () => {\n          video.onseeked = null;\n          video.ontimeupdate = null;\n          resolve();\n        };\n        video.onseeked = seekHandler;\n        video.ontimeupdate = seekHandler; // Fallback for iOS\n        video.onerror = error => reject(error);\n      });\n\n      let presolve: (value: BlobRef | null) => void;\n      let preject: (value: Error) => void;\n\n      const framePromise: Promise<BlobRef | null> = new Promise((resolve, reject) => {\n        presolve = resolve;\n        preject = reject;\n      });\n\n      const getFrame = async () => {\n        // Draw the frame onto a canvas\n        const canvas = document.createElement('canvas');\n        canvas.width = width;\n        canvas.height = height;\n        const context = canvas.getContext('2d');\n        if (!context) {\n          preject(new Error('Failed to get canvas context'));\n          return;\n        }\n        context.drawImage(video, 0, 0, video.width, video.height);\n        // Convert the canvas content to a Blob\n        const blob = await new Promise<Blob | null>(resolve => canvas.toBlob(resolve, 'image/png'));\n        if (blob) {\n          const ref = await blobStore.getRef(blob);\n          presolve(ref);\n          return;\n        }\n        presolve(null);\n      };\n\n      // the goal of this block of code is to run successfully in all browsers without specifically referencing any browser\n      if (typeof video.requestVideoFrameCallback === 'function') {\n        video.requestVideoFrameCallback(getFrame);\n        // chrome does not allow playing a video without user interaction, so we need to suppress the exception\n        try {\n          video.load();\n          // safari is very finicky about when it will make frame data available, so we need to play and pause the video\n          await video.play();\n          video.pause();\n        } catch (e) {\n          // ignore\n        }\n        return await framePromise;\n      }\n      await getFrame();\n      return await framePromise;\n    } finally {\n      blobStore.returnUrl(url);\n    }\n  }\n);\n\nexport const getPreviewImage = memoize('getPreviewImage:v2', async (unknownType: BlobRef | null): Promise<BlobRef | null> => {\n  if (unknownType) {\n    const blob = await blobStore.getBlob(unknownType);\n    if (blob) {\n      if (blob.type.startsWith('image')) {\n        return unknownType;\n      }\n      if (blob.type.startsWith('video')) {\n        const videoFrame = await getVideoFrame(unknownType, { time: 0 });\n        return videoFrame;\n      }\n    }\n  }\n  return null;\n});\n\nexport const getMimeType = async (ref: BlobRef): Promise<string | null> => {\n  const blob = await blobStore.getBlob(ref);\n  if (!blob) {\n    return null;\n  }\n  return blob.type;\n};\n\nexport const getImageExtension = async (ref: BlobRef): Promise<string | null> => {\n  const mimeType = await getMimeType(ref);\n  if (!mimeType) {\n    return null;\n  }\n  return mimeToExtensionMap.get(mimeType) ?? null;\n};\n\nexport function isImageType(type: string) {\n  return type.startsWith('image/');\n}\n\nexport function isVideoType(type: string) {\n  return type.startsWith('video/');\n}\n\nexport function isMediaType(type: string) {\n  return isImageType(type) || isVideoType(type);\n}\n\nexport function blobToBase64(blobRef: BlobRef): Promise<string> {\n  return new Promise((resolve, reject) => {\n    blobStore.getBlob(blobRef).then(blob => {\n      if (!blob) {\n        reject(new Error('Blob not found'));\n        return;\n      }\n      const reader = new FileReader();\n      reader.onloadend = () => {\n        if (typeof reader.result === 'string') {\n          resolve(reader.result);\n        }\n      };\n      reader.onerror = e => {\n        reject(e);\n      };\n      reader.readAsDataURL(blob);\n    });\n  });\n}\n\nexport function createCanvasContext(): CanvasRenderingContext2D | null {\n  const canvas = document.createElement('canvas');\n  canvas.width = 10;\n  canvas.height = 10;\n  return canvas.getContext('2d');\n}\n\nexport type ResizeImageResult = {\n  blobRef: BlobRef;\n  size: Size;\n};\n\nexport const resizeImageToFit = (image: HTMLImageElement, maxDimension: number, format: string): Promise<ResizeImageResult | undefined> => {\n  let width = image.width;\n  let height = image.height;\n\n  if (width > height) {\n    if (width > maxDimension) {\n      height *= maxDimension / width;\n      width = maxDimension;\n    }\n  } else {\n    if (height > maxDimension) {\n      width *= maxDimension / height;\n      height = maxDimension;\n    }\n  }\n\n  const context = createCanvasContext();\n  if (!context) {\n    return Promise.resolve(undefined);\n  }\n  const canvas = context.canvas;\n\n  width = Math.floor(width);\n  height = Math.floor(height);\n\n  canvas.width = width;\n  canvas.height = height;\n\n  context.clearRect(0, 0, width, height);\n  context.drawImage(image, 0, 0, width, height);\n\n  return new Promise(resolve => {\n    canvas.toBlob(async blob => {\n      if (blob) {\n        const blobRef = await blobStore.getRef(blob);\n        resolve({\n          blobRef,\n          size: { width, height },\n        });\n      } else {\n        resolve(undefined);\n      }\n    }, format);\n  });\n};\n\n/**\n * Resize an input blob to be under a given max file size\n * @param image - The image to resize\n * @param maxDimension - The maximum file dimension\n * @returns A resized Blob that is under the max file size, as well as the new width/height if resized\n */\nexport async function resizeBlobToFit(image: Blob, maxDimension: number): Promise<Blob | undefined> {\n  const img = new Image();\n  img.src = URL.createObjectURL(image);\n\n  await new Promise((resolve, reject) => {\n    img.onload = resolve;\n    img.onerror = () => reject(new Error('Image failed to load during resizing'));\n  });\n  const result = await resizeImageToFit(img, maxDimension, image.type);\n  if (!result?.blobRef) return undefined;\n  const blob = await blobStore.getBlob(result?.blobRef);\n  return blob ?? undefined;\n}\n\n/**\n * Given a url and a max dimension, resize the image to fit the max dimension\n */\nexport const resizeImageFromUrl = (\n  url: string,\n  maxDimension: number,\n  format: ImageFormatType = 'image/png' // No compression by default\n): Promise<ResizeImageResult | undefined> => {\n  const image = new Image();\n\n  image.crossOrigin = 'anonymous';\n\n  return new Promise((resolve, reject) => {\n    image.src = url;\n\n    image.onload = () => resolve(resizeImageToFit(image, maxDimension, format));\n    image.onerror = err => reject(err);\n  });\n};\n\n/**\n * Fetches a Blob object from the given URL.\n *\n * @param url - The URL to fetch the Blob from.\n * @returns A promise that resolves to a Blob object.\n */\nexport async function fetchBlob(url: string): Promise<Blob> {\n  return (await fetch(url)).blob();\n}\n\n/**\n * Resize an input blob to be under a given max file size\n * @param image - The image to resize\n * @param maxFileSizeMB - The maximum file size in MB\n * @returns A resized Blob that is under the max file size, as well as the new width/height if resized\n */\nexport async function resizeImageToFileSize(\n  image: Blob,\n  maxFileSizeMB: number\n): Promise<{ resizedImage: Blob; width?: number; height?: number }> {\n  const maxSize = maxFileSizeMB * 1024 * 1024; // Convert MB to bytes\n\n  if (image.size <= maxSize) {\n    return { resizedImage: image }; // File is already under the limit\n  }\n\n  const img = new Image();\n  img.src = URL.createObjectURL(image);\n\n  await new Promise((resolve, reject) => {\n    img.onload = resolve;\n    img.onerror = () => reject(new Error('Image failed to load during resizing'));\n  });\n\n  let resizedImage = image;\n  const ctx = createCanvasContext();\n  if (!ctx) {\n    throw new Error('Failed to get canvas context');\n  }\n  const canvas = ctx?.canvas;\n\n  // Set initial canvas dimensions to image dimensions\n  canvas.width = img.width;\n  canvas.height = img.height;\n\n  let scaleFactor = Math.sqrt(maxSize / image.size);\n\n  while (resizedImage.size > maxSize) {\n    canvas.width = img.width * scaleFactor;\n    canvas.height = img.height * scaleFactor;\n    ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\n\n    const resizedBlob = await new Promise<Blob | null>(resolve => canvas.toBlob(resolve, image.type));\n\n    if (!resizedBlob) {\n      throw new Error('Failed to resize image');\n    }\n\n    resizedImage = resizedBlob;\n\n    // Adjust the scaleFactor for further iterations if needed\n    scaleFactor *= Math.sqrt(maxSize / resizedBlob.size);\n  }\n\n  URL.revokeObjectURL(img.src); // Clean up the object URL\n\n  return { resizedImage, width: canvas.width, height: canvas.height };\n}\n\nexport function getMediaSizeAsPerContainer(naturalSize: Size, containerSize: Size, allowUpscaling = false, minWidth?: number): Size {\n  const { width: naturalWidth, height: naturalHeight } = naturalSize;\n  const { width: clientWidth, height: clientHeight } = containerSize;\n  const aspectRatio = naturalWidth / naturalHeight;\n  let width = allowUpscaling ? clientWidth : Math.min(naturalWidth, clientWidth);\n  let height = width / aspectRatio;\n\n  if (height > clientHeight) {\n    height = clientHeight;\n    width = height * aspectRatio;\n  }\n\n  // Apply minimum width constraint if specified\n  if (minWidth && width < minWidth) {\n    width = minWidth;\n    height = width / aspectRatio;\n  }\n\n  return { width, height };\n}\n\nexport const getMediaSize = memoize('getImageDimensions:v1', async (mediaRef: BlobRef | null): Promise<MediaSize | null> => {\n  if (mediaRef) {\n    const blob = await blobStore.getBlob(mediaRef);\n    if (blob) {\n      if (blob.type.startsWith('video')) {\n        return getVideoSize(mediaRef);\n      }\n      if (blob.type.startsWith('image')) {\n        const dimensions = await new Promise<Size>((resolve, reject) => {\n          const img = new Image();\n          const url = URL.createObjectURL(blob);\n          img.onload = () => {\n            URL.revokeObjectURL(url); // Looks like this leaks when the image errors out. https://jira.corp.adobe.com/browse/FFP-41232\n            resolve({ width: img.width, height: img.height });\n          };\n          img.onerror = reject;\n          img.src = url;\n        });\n        return dimensions;\n      }\n    }\n  }\n  return null;\n});\n\nexport async function getAspectRatioFromBlobRef(ref: BlobRef | null): Promise<AspectRatio | null> {\n  if (!ref) return null;\n  const dimensions = await getMediaSize(ref);\n  if (!dimensions) return null;\n  return getAspectRatioDescriptor(dimensions);\n}\n\nexport function fitThumbnail(srcRect: ThumbnailSrcRect | undefined, size: number) {\n  return !srcRect\n    ? {\n        width: size,\n        height: size,\n        objectFit: 'cover' as const,\n      }\n    : {\n        translate:\n          srcRect.width === 0 || srcRect.height === 0\n            ? '0px 0px'\n            : `${-(srcRect.x * size) / srcRect.width}px ${-(srcRect.y * size) / srcRect.height}px`,\n        scale: srcRect.width === 0 || srcRect.height === 0 ? '1 1' : `${size / srcRect.width} ${size / srcRect.height}`,\n      };\n}\n\nexport async function convertBlobToFormat(blob: Blob, format: ImageFormatType = 'image/png'): Promise<Blob> {\n  const image = await createImageBitmap(blob);\n  const canvas = document.createElement('canvas');\n  canvas.width = image.width;\n  canvas.height = image.height;\n\n  const context = canvas.getContext('2d');\n  if (!context) {\n    throw new Error('Could not get canvas context');\n  }\n  context.drawImage(image, 0, 0);\n\n  // Convert to the requested format\n  return new Promise<Blob>((resolve, reject) => {\n    canvas.toBlob(\n      result => {\n        if (result) {\n          resolve(result);\n        } else {\n          reject(new Error('Failed to convert image format'));\n        }\n      },\n      format,\n      format === 'image/jpeg' ? 1.0 : undefined\n    );\n  });\n}\n\nexport async function convertImageFormat(source: BlobRef, format: ImageFormatType = 'image/png'): Promise<BlobRef | null> {\n  try {\n    const sourceBlob = await blobStore.getBlob(source);\n    if (!sourceBlob) return null;\n\n    const convertedBlob = await convertBlobToFormat(sourceBlob, format);\n\n    return await blobStore.getRef(convertedBlob);\n  } catch (error) {\n    console.error('Image format conversion failed:', error);\n    return null;\n  }\n}\n\n/**\n * Rasterizes an SVG image to PNG format\n * @param svgBlobRef - The BlobRef of the SVG image\n * @returns A Promise that resolves to a BlobRef to the rasterized PNG image\n */\n//TODO: Add parameter to render a certain size\nexport async function rasterizeSvg(svgBlobRef: BlobRef): Promise<BlobRef> {\n  const url = await blobStore.borrowUrl(svgBlobRef);\n  if (!url) {\n    throw new Error('Failed to get URL for SVG');\n  }\n\n  try {\n    // Create an image element to load the SVG\n    const maxDimension = 1024;\n    const img = new Image(maxDimension, maxDimension);\n    img.crossOrigin = 'anonymous';\n\n    // Load the SVG and convert to PNG\n    return await new Promise<BlobRef>((resolve, reject) => {\n      img.onload = async () => {\n        // Create a canvas to draw the SVG\n        const canvas = document.createElement('canvas');\n        // Set maximum dimensions to 1024x1024 while preserving aspect ratio\n        const aspectRatio = img.width / img.height;\n\n        if (img.width > img.height) {\n          canvas.width = Math.min(img.width, maxDimension);\n          canvas.height = canvas.width / aspectRatio;\n        } else {\n          canvas.height = Math.min(img.height, maxDimension);\n          canvas.width = canvas.height * aspectRatio;\n        }\n\n        const ctx = canvas.getContext('2d');\n        if (!ctx) {\n          reject(new Error('Failed to get canvas context'));\n          return;\n        }\n\n        // Draw the SVG on the canvas\n        ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\n\n        // Convert to PNG\n        canvas.toBlob(async blob => {\n          if (!blob) {\n            reject(new Error('Failed to convert SVG to PNG'));\n            return;\n          }\n\n          // Store the PNG in the blob store\n          const blobRef = await blobStore.getRef(blob);\n          resolve(blobRef);\n        }, 'image/png');\n      };\n\n      img.onerror = () => reject(new Error('Failed to load SVG'));\n      img.src = url;\n    });\n  } finally {\n    // Always return the borrowed URL\n    blobStore.returnUrl(url);\n  }\n}\n\n/**\n * Crops an image to a specified rectangle\n * @param fileRef - The BlobRef of the image to crop\n * @param rect - The rectangle to crop the image to\n * @returns A Promise that resolves to a BlobRef to the cropped image or null if the request fails for any reason.\n */\nexport async function cropImage(fileRef: BlobRef, rect: { x: number; y: number; width: number; height: number }): Promise<BlobRef | null> {\n  const blobMimeType = await getMimeType(fileRef);\n  if (!blobMimeType) return null;\n\n  const url = await blobStore.borrowUrl(fileRef);\n  if (!url) return null;\n\n  try {\n    const canvas = document.createElement('canvas');\n    let ctx: CanvasRenderingContext2D | null = null;\n\n    const image = await loadImage(url);\n\n    if (rect.x === 0 && rect.y === 0 && image.width === rect.width && image.height === rect.height) {\n      // console.warn('Nothing changed in crop, returning original fileRef.');\n      return fileRef;\n    }\n\n    canvas.width = rect.width;\n    canvas.height = rect.height;\n    ctx = canvas.getContext('2d');\n    if (!ctx) return null;\n\n    ctx.drawImage(image, rect.x, rect.y, rect.width, rect.height, 0, 0, rect.width, rect.height);\n\n    const blob = await new Promise<Blob | null>(resolve => canvas.toBlob(resolve, blobMimeType));\n\n    if (!blob) return null;\n\n    return await blobStore.getRef(blob);\n  } catch (error) {\n    return null;\n  } finally {\n    blobStore.returnUrl(url);\n  }\n}\n\n/**\n * Calculates the standard Hamming distance between two strings\n * @param a - First string to compare\n * @param b - Second string to compare\n * @returns The number of positions where the characters differ\n */\nfunction hammingDistance(a: string, b: string): number {\n  return [...a].reduce((sum, c, i) => sum + (c !== b[i] ? 1 : 0), 0);\n}\n\n/**\n * Converts a Blob to a dHash (difference hash) string for perceptual image comparison\n * @param blob - The image blob to convert to dHash\n * @returns A promise that resolves to a hexadecimal dHash string\n */\nasync function blobToDHash(blob: Blob): Promise<string> {\n  const img = await createImageBitmap(blob);\n  const canvas = new OffscreenCanvas(9, 8);\n  const ctx = canvas.getContext('2d');\n  if (!ctx) {\n    return Promise.reject(new Error('Failed to get canvas context'));\n  }\n  ctx.drawImage(img, 0, 0, 9, 8);\n  const { data } = ctx.getImageData(0, 0, 9, 8);\n  let bits = '';\n\n  // Convert RGB to grayscale using standard ITU-R BT.709 luminance weights (R: 0.299, G: 0.587, B: 0.114)\n  for (let y = 0; y < 8; y++) {\n    for (let x = 0; x < 8; x++) {\n      const i = (y * 9 + x) * 4;\n      const j = i + 4;\n      const g1 = 0.299 * data[i] + 0.587 * data[i + 1] + 0.114 * data[i + 2];\n      const g2 = 0.299 * data[j] + 0.587 * data[j + 1] + 0.114 * data[j + 2];\n      bits += g1 > g2 ? '1' : '0';\n    }\n  }\n\n  const match = bits.match(/.{4}/g);\n  if (!match) {\n    return Promise.reject(new Error('Failed to process image hash'));\n  }\n  return match.map(b => parseInt(b, 2).toString(16)).join('');\n}\n\n/**\n * Compares two image blobs using perceptual hashing (dHash) to determine if they are visually similar\n * @param blob1 - First image blob to compare\n * @param blob2 - Second image blob to compare\n * @param threshold - Maximum allowed Hamming distance for images to be considered similar (default: 5)\n * @returns A promise that resolves to true if the images are perceptually similar, false otherwise\n */\nexport async function compareImageBlobsByDHash(blob1: Blob, blob2: Blob, threshold = 5): Promise<boolean> {\n  const [h1, h2] = await Promise.all([blobToDHash(blob1), blobToDHash(blob2)]);\n  const distance = hammingDistance(h1, h2);\n  return distance <= threshold;\n}\n\n/**\n * Performs a centered crop of an image to a specified size.\n * The output will be scaled to the exact size specified.\n * @param blobRef - The BlobRef of the image to crop\n * @param size - The size to crop the image to\n * @param type - The MIME type of the image to return\n * @returns A promise that resolves to a BlobRef to the cropped image or undefined if the request fails for any reason.\n */\nexport const cropImageToSize = memoize(\n  'cropImageToSize:v1',\n  async (blobRef: BlobRef, size: Size, type?: string): Promise<BlobRef | undefined> => {\n    const url = await blobStore.borrowUrl(blobRef);\n    if (!url) return undefined;\n\n    if (!type) type = (await getMimeType(blobRef)) ?? undefined;\n    if (!type) return undefined;\n\n    try {\n      const img = await loadImage(url);\n      const context = createCanvasContext();\n      if (!context) return undefined;\n\n      const inputSize = await getMediaSize(blobRef);\n      if (!inputSize) return undefined;\n\n      // First we need to determine the how to scale `size` to fit within the input image.\n\n      // Pick the largest source rectangle that will fit along both axes.\n      const scale = Math.min(inputSize.width / size.width, inputSize.height / size.height);\n\n      // The dimensions of the source rectangle to crop from the input image\n      const sourceWidth = Math.floor(size.width * scale);\n      const sourceHeight = Math.floor(size.height * scale);\n\n      // The top-left corner of the source rectangle to crop from the input image\n      const sourceX = Math.max(0, Math.floor((inputSize.width - sourceWidth) / 2));\n      const sourceY = Math.max(0, Math.floor((inputSize.height - sourceHeight) / 2));\n\n      const canvas = context.canvas;\n      canvas.width = size.width;\n      canvas.height = size.height;\n      context.drawImage(img, sourceX, sourceY, sourceWidth, sourceHeight, 0, 0, size.width, size.height);\n\n      return new Promise(resolve => {\n        canvas.toBlob(async blob => {\n          if (blob) {\n            resolve(blobStore.getRef(blob));\n          } else {\n            resolve(undefined);\n          }\n        }, type);\n      });\n    } catch (error) {\n      console.error('Failed to crop image:', error);\n      return undefined;\n    } finally {\n      blobStore.returnUrl(url);\n    }\n  }\n);\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { cropImage } from './image-functions.js';\nimport { BlobRef } from '@adobe/data/cache';\n\nexport type Rectangle = {\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n};\n\n/**\n * Everything needed to compute an edited file.\n */\nexport type FileEditorSettings = {\n  baseFileRef: BlobRef;\n  crop?: {\n    rect: Rectangle;\n  };\n};\n\nexport async function getEditedFile(editorSettings: FileEditorSettings): Promise<BlobRef | null> {\n  const { baseFileRef, crop } = editorSettings;\n\n  if (crop) {\n    return cropImage(baseFileRef, crop.rect);\n  }\n\n  return baseFileRef;\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\n/**\n * Clamps a value between a minimum and maximum\n * @param value Value to clamp\n * @param min Minimum allowed value\n * @param max Maximum allowed value\n * @returns Clamped value\n */\nexport function clamp(value: number, min: number, max: number): number {\n  return Math.max(min, Math.min(max, value));\n}\n\n/**\n * Calculates the aproximate integral of the squared difference between a curve and a function.\n */\nexport function getSquareError(curve: { x: number; y: number }[], fn: (x: number) => number) {\n  const errorAt = (point: { x: number; y: number }) => {\n    const y = fn(point.x);\n    const dy = point.y - y;\n    return dy * dy;\n  };\n  let error = 0;\n  for (let i = 0; i < curve.length - 1; i++) {\n    const c0 = curve[i];\n    const c1 = curve[i + 1];\n    const dx = c1.x - c0.x;\n    // Trapezoidal integration rule.\n    error += ((errorAt(c0) + errorAt(c1)) / 2) * dx;\n  }\n  return error;\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { clamp } from '../../functions/math-functions.js';\n\n/* eslint-disable @typescript-eslint/no-namespace */ // The alternatives are ugly or less readable.\n/* eslint-disable @typescript-eslint/no-redeclare */ // The methods namespace pattern is worth it.\n\nexport type Vec2 = { readonly x: number; readonly y: number };\nexport type Rect = readonly [Vec2, Vec2];\nexport type Interval = readonly [number, number];\nexport type Line = { readonly direction: Vec2; readonly point: Vec2 };\nexport type LineSegment = readonly [Vec2, Vec2];\n\nexport namespace Vec2 {\n  export function add(a: Vec2, b: Vec2): Vec2 {\n    return {\n      x: a.x + b.x,\n      y: a.y + b.y,\n    };\n  }\n\n  export function sub(a: Vec2, b: Vec2): Vec2 {\n    return {\n      x: a.x - b.x,\n      y: a.y - b.y,\n    };\n  }\n\n  export function mul(a: Vec2, b: Vec2): Vec2 {\n    return {\n      x: a.x * b.x,\n      y: a.y * b.y,\n    };\n  }\n\n  export function scale(vec: Vec2, scale: number): Vec2 {\n    return {\n      x: vec.x * scale,\n      y: vec.y * scale,\n    };\n  }\n\n  export function max(a: Vec2, b: Vec2): Vec2 {\n    return {\n      x: Math.max(a.x, b.x),\n      y: Math.max(a.y, b.y),\n    };\n  }\n\n  export function abs(vec: Vec2): Vec2 {\n    return {\n      x: Math.abs(vec.x),\n      y: Math.abs(vec.y),\n    };\n  }\n\n  export function sign(vec: Vec2): Vec2 {\n    return {\n      x: Math.sign(vec.x),\n      y: Math.sign(vec.y),\n    };\n  }\n\n  export function equals(a: Vec2, b: Vec2, epsilon = 0.0001): boolean {\n    return Math.abs(a.x - b.x) < epsilon && Math.abs(a.y - b.y) < epsilon;\n  }\n\n  export function lengthSquared(vec: Vec2): number {\n    return vec.x * vec.x + vec.y * vec.y;\n  }\n\n  export function dot(a: Vec2, b: Vec2): number {\n    return a.x * b.x + a.y * b.y;\n  }\n\n  export function project(vec: Vec2, direction: Vec2): Vec2 {\n    const lengthSquared = Vec2.lengthSquared(direction);\n    if (lengthSquared === 0) {\n      return { x: 0, y: 0 };\n    }\n    const scalar = Vec2.dot(vec, direction) / lengthSquared;\n    return Vec2.scale(direction, scalar);\n  }\n\n  export function projectToLine(point: Vec2, origin: Vec2, direction: Vec2): Vec2 {\n    const projectedDifference = Vec2.project(Vec2.sub(point, origin), direction);\n    return Vec2.add(origin, projectedDifference);\n  }\n\n  export function clampToRect(point: Vec2, bounds: Rect): Vec2 {\n    return {\n      x: clamp(point.x, bounds[0].x, bounds[1].x),\n      y: clamp(point.y, bounds[0].y, bounds[1].y),\n    };\n  }\n}\n\nexport namespace Rect {\n  export function translate(rect: Rect, delta: Vec2): Rect {\n    return [Vec2.add(rect[0], delta), Vec2.add(rect[1], delta)];\n  }\n\n  export function getWidth(rect: Rect): number {\n    return rect[1].x - rect[0].x;\n  }\n\n  export function getHeight(rect: Rect): number {\n    return rect[1].y - rect[0].y;\n  }\n\n  export function getSize(rect: Rect): Vec2 {\n    return {\n      x: Rect.getWidth(rect),\n      y: Rect.getHeight(rect),\n    };\n  }\n\n  /**\n   * Clamps a rectangle to fit in another.\n   */\n  export function clampToRect(rect: Rect, bounds: Rect): Rect {\n    return [Vec2.clampToRect(rect[0], bounds), Vec2.clampToRect(rect[1], bounds)];\n  }\n\n  export function translateToBounds(rect: Rect, bounds: Rect): Rect {\n    // How far to push a point to the bounds\n    function clampDela(vec: Vec2, min: Vec2, max: Vec2): Vec2 {\n      return {\n        x: clamp(vec.x, min.x, max.x) - vec.x,\n        y: clamp(vec.y, min.y, max.y) - vec.y,\n      };\n    }\n\n    // Nudge the min point to the bounds\n    rect = Rect.translate(rect, clampDela(rect[0], bounds[0], bounds[1]));\n\n    // Nudge the max point to the bounds\n    rect = Rect.translate(rect, clampDela(rect[1], bounds[0], bounds[1]));\n\n    return rect;\n  }\n\n  /**\n   * Tries to keep the rectangle's original dimensions if possible.\n   * Clamps `rect` to `bounds` after trying to translate it into `bounds`.\n   */\n  export function fitToBounds(rect: Rect, bounds: Rect): Rect {\n    return Rect.clampToRect(Rect.translateToBounds(rect, bounds), bounds);\n  }\n\n  /**\n   * Clamps the width and height of a rect to fit an aspect ratio.\n   * Always shrinks the rect to fit the aspect ratio.\n   * Keeps the center of the rect in the same place.\n   */\n  export function clampAspect(rect: Rect, aspectRatio: number): Rect {\n    const size = Rect.getSize(rect);\n    const clampedSize = size.x < size.y * aspectRatio ? { x: size.x, y: size.x / aspectRatio } : { x: size.y * aspectRatio, y: size.y };\n    const delta = Vec2.sub(clampedSize, size);\n    return [Vec2.add(rect[0], Vec2.scale(delta, -0.5)), Vec2.add(rect[1], Vec2.scale(delta, 0.5))];\n  }\n\n  export function boundingBox(points: Array<Vec2>): Rect {\n    const xs = points.map(p => p.x);\n    const ys = points.map(p => p.y);\n\n    const minX = Math.min(...xs);\n    const minY = Math.min(...ys);\n    const maxX = Math.max(...xs);\n    const maxY = Math.max(...ys);\n\n    return [\n      { x: minX, y: minY },\n      { x: maxX, y: maxY },\n    ];\n  }\n\n  export function intersectLine(rect: Rect, line: Line): LineSegment {\n    const dir = line.direction;\n\n    // Compute the times of intersection for each axis and intersect the resulting intervals to get the interval of intersection (times).\n    const [t0, t1] = Interval.intersect(\n      Interval.create((rect[0].x - line.point.x) / dir.x, (rect[1].x - line.point.x) / dir.x),\n      Interval.create((rect[0].y - line.point.y) / dir.y, (rect[1].y - line.point.y) / dir.y)\n    );\n\n    return [Vec2.add(line.point, Vec2.scale(dir, t0)), Vec2.add(line.point, Vec2.scale(dir, t1))];\n  }\n}\n\nexport namespace Interval {\n  export function create(a: number, b: number): Interval {\n    return [Math.min(a, b), Math.max(a, b)];\n  }\n\n  export function intersect(a: Interval, b: Interval): Interval {\n    return [Math.max(a[0], b[0]), Math.min(a[1], b[1])];\n  }\n}\n\nexport namespace LineSegment {\n  export function nearestPoint(line: LineSegment, point: Vec2): Vec2 {\n    const dir = Vec2.sub(line[1], line[0]);\n\n    let t = Vec2.dot(Vec2.sub(point, line[0]), dir) / Vec2.lengthSquared(dir);\n    const tClamped = Math.max(0, Math.min(t, 1));\n\n    return Vec2.add(line[0], Vec2.scale(dir, tClamped));\n  }\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\n// This file is generated. Do not edit.\nimport { TemplateResult, html } from 'lit';\nimport { customElement } from 'lit/decorators.js';\n\nimport { IconBase } from '@spectrum-web-components/icon';\n\nconst tagName = 'firefly-icon-checkmark';\n\n@customElement(tagName)\nexport class IconCheckmark extends IconBase {\n  protected override render(): TemplateResult {\n    return html`\n      <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"none\">\n        <path\n          d=\"M5.86418 14.1152C5.52922 14.1152 5.21086 13.9658 4.99602 13.7079L1.24895 9.2099C0.848558 8.73041 0.913988 8.01752 1.39348 7.6181C1.872 7.21576 2.58489 7.28216 2.98528 7.76263L5.8388 11.1874L12.9872 2.08784C13.373 1.59663 14.0839 1.51069 14.5741 1.89741C15.0653 2.28315 15.1503 2.99311 14.7646 3.48432L6.75285 13.6826C6.54191 13.9511 6.2216 14.1103 5.88078 14.1152L5.86418 14.1152Z\"\n          fill=\"currentColor\" />\n      </svg>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    [tagName]: IconCheckmark;\n  }\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { css } from 'lit';\n\nexport const styles = css`\n  :host {\n    --firefly-grid-template-columns: var(--firefly-tray-panel-grid-template-columns, 1fr 1fr 1fr);\n  }\n\n  .tray-content {\n    --mod-tray-top-to-content-area: 0;\n    display: flex;\n    flex-direction: column;\n    width: 100%;\n    padding: var(--firefly-tray-panel-padding, var(--spectrum-spacing-300));\n    background-color: var(--firefly-tray-panel-background-color, var(--spectrum-tray-background-color));\n    overflow-x: hidden;\n    overflow-y: auto;\n  }\n\n  .header {\n    display: grid;\n    grid-template-columns: var(--firefly-grid-template-columns);\n    align-items: center;\n    justify-content: space-between;\n    width: 100%;\n    position: relative;\n    padding: var(\n      --firefly-tray-panel-header-padding,\n      var(--spectrum-spacing-300) var(--spectrum-spacing-300) var(--spectrum-spacing-100) var(--spectrum-spacing-300)\n    );\n    user-select: none;\n  }\n\n  /* Position dismiss button absolutely when no title or back button */\n  .header-empty {\n    display: block;\n    padding: 0;\n    height: 0;\n    min-height: 0;\n  }\n\n  ::slotted([slot='trigger']) {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n  }\n\n  ::slotted([slot='back']) {\n    position: relative;\n    width: fit-content;\n    justify-self: flex-start;\n    grid-column: 1;\n  }\n\n  ::slotted([slot='title']) {\n    position: relative;\n    grid-column: 2;\n    font-size: var(--firefly-tray-panel-title-font-size, var(--spectrum-font-size-300));\n    font-weight: var(--firefly-tray-panel-title-font-weight, var(--spectrum-bold-font-weight));\n    color: var(--firefly-tray-panel-title-color, var(--spectrum-global-color-gray-900));\n    text-align: center;\n    white-space: nowrap;\n  }\n\n  ::slotted([slot='dismiss']) {\n    position: relative;\n    width: fit-content;\n    justify-self: flex-end;\n    grid-column: 3;\n  }\n\n  .header-empty ::slotted([slot='dismiss']) {\n    position: absolute;\n    top: var(--spectrum-spacing-50);\n    right: var(--spectrum-spacing-50);\n    z-index: 1;\n  }\n\n  .content {\n    user-select: none;\n    -webkit-user-select: none;\n    -webkit-touch-callout: none;\n  }\n\n  sp-tray {\n    --mod-tray-corner-radius-portrait: var(--firefly-tray-panel-border-radius, var(--firefly-primary-border-radius));\n    --mod-tray-corner-radius: var(--firefly-tray-panel-border-radius, var(--firefly-primary-border-radius));\n    --mod-tray-spacing-edge-to-tray-safe-zone: var(\n      --firefly-tray-spacing-edge-to-tray,\n      var(--spectrum-tray-spacing-edge-to-tray-safe-zone)\n    );\n    --mod-tray-bottom-to-content-area: var(--firefly-tray-panel-bottom-to-content-padding, var(--spectrum-tray-top-to-content-area));\n    /* stylelint-disable color-function-notation */\n    --mod-underlay-background-color: var(\n      --firefly-tray-panel-underlay-background-color,\n      rgba(var(--spectrum-black-rgb), var(--spectrum-overlay-opacity))\n    );\n  }\n\n  @media (max-width: 768px) {\n    /** disabled focus outline in mobile mode */\n    ::slotted([slot='dismiss']) {\n      --spectrum-actionbutton-focus-indicator-color: transparent;\n      --spectrum-actionbutton-background-color-focus: transparent;\n    }\n  }\n`;\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { styles } from './tray-panel.css.js';\nimport { LitElement, html } from 'lit';\nimport { customElement, property, query, state } from 'lit/decorators.js';\nimport { classMap } from 'lit/directives/class-map.js';\nimport { ifDefined } from 'lit/directives/if-defined.js';\n\nimport '@spectrum-web-components/overlay/overlay-trigger.js';\nimport '@spectrum-web-components/tray/sp-tray.js';\n\nimport { commonStyles } from '../common/styles.css.js';\n\nexport const tagName = 'firefly-tray-panel';\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    [tagName]: TrayPanel;\n  }\n}\n\n/**\n * @description A tray panel to be used on mobile devices. Can be used in an overlay-trigger component, or in a toast-panel.\n *\n * @element firefly-tray-panel\n *\n * @property {boolean} [isOpenByDefault] - Whether the tray panel should be open by default\n * @property {boolean} [visible] - Whether the tray panel should be visible. Allows for conditional rendering without changing DOM structure (can lead to state leakage in lit).\n * @property {boolean} [disabled] - Whether the tray panel should be disabled from opening\n *\n * @slot trigger - Element that triggers the tray panel to open (only used when type=\"trigger\")\n * @slot back - Back button/element shown in header\n * @slot title - Title content displayed in the header\n * @slot dismiss - Dismiss button/element shown in header\n * @slot content - Main content area of the panel\n *\n * @fires {Event} dismissed - Fired when the panel is manually dismissed\n * @fires {Event} sp-closed - Fired when the panel is closed by any means\n * @fires {Event} sp-opened - Fired when the panel is opened by any means\n *\n * @cssprop --firefly-tray-panel-border-radius - Border radius of the overlay (default: var(--firefly-primary-border-radius))\n * @cssprop --firefly-tray-panel-title-font-size - Font size of the title (default: var(--spectrum-font-size-300))\n * @cssprop --firefly-tray-panel-title-font-weight - Font weight of the title (default: var(--spectrum-bold-font-weight))\n * @cssprop --firefly-tray-panel-title-color - Color of the title (default: var(--spectrum-global-color-gray-900))\n * @cssprop --firefly-tray-panel-title-line-height - Line height of the title (default: 130%)\n * @cssprop --firefly-tray-panel-header-padding - Padding of the header (default: var(--spectrum-spacing-400) var(--spectrum-spacing-400) var(--spectrum-spacing-300) var(--spectrum-spacing-400))\n * @cssprop --firefly-tray-panel-dismiss-width - Width of the dismiss button (default: var(--spectrum-checkmark-icon-size-400))\n * @cssprop --firefly-tray-panel-dismiss-height - Height of the dismiss button (default: var(--spectrum-checkmark-icon-size-400))\n * @cssprop --firefly-tray-panel-dismiss-right - Right position of the dismiss button (default: var(--spectrum-spacing-400))\n * @cssprop --firefly-tray-panel-background-color - Background color of the tray panel (default: var(--spectrum-tray-background-color))\n * @cssprop --firefly-tray-spacing-edge-to-tray - spacing between edge of the tray and the screen (default: var(--spectrum-tray-spacing-edge-to-tray-safe-zone))\n * @cssprop --firefly-tray-panel-underlay-background-color - Background color of the underlay (default: rgba(var(--spectrum-black-rgb), var(--spectrum-overlay-opacity)))\n * @cssprop --firefly-tray-panel-bottom-to-content-padding - Bottom padding of the tray content area (default: var(--spectrum-tray-top-to-content-area))\n */\n@customElement(tagName)\nexport class TrayPanel extends LitElement {\n  static styles = [commonStyles, styles];\n\n  @property({ type: Boolean })\n  isOpenByDefault?: boolean;\n\n  @property({ type: Boolean })\n  disabled?: boolean;\n\n  private _isOpen?: boolean | undefined;\n\n  @property({ type: Boolean })\n  public get isOpen(): boolean | undefined {\n    return this._isOpen;\n  }\n\n  public set isOpen(value: boolean | undefined) {\n    this._isOpen = value;\n    this.updateOpenState();\n  }\n\n  private updateOpenState() {\n    if (this._isOpen === undefined) return;\n    if (this._isOpen) {\n      this.open();\n    } else {\n      this.close(undefined, true);\n    }\n  }\n\n  @query('overlay-trigger')\n  private overlayTrigger?: HTMLElement;\n\n  @query('#tray-panel-trigger')\n  private trayPanelTrigger?: HTMLElement;\n\n  @property({ type: Boolean, reflect: true })\n  visible = true;\n\n  @property({ type: String })\n  testId?: string;\n\n  @state()\n  private hasHeaderContent = false;\n\n  @query('slot[name=\"title\"]')\n  private titleSlot?: HTMLSlotElement;\n\n  @query('slot[name=\"back\"]')\n  private backSlot?: HTMLSlotElement;\n\n  private checkHeaderContent() {\n    const hasTitleContent = (this.titleSlot?.assignedNodes().length ?? 0) > 0;\n    const hasBackContent = (this.backSlot?.assignedNodes().length ?? 0) > 0;\n    this.hasHeaderContent = hasTitleContent || hasBackContent;\n  }\n\n  firstUpdated() {\n    // needs to handle initial state after overlay-trigger is mounted\n    this.updateOpenState();\n    this.checkHeaderContent();\n  }\n\n  updated() {\n    this.checkHeaderContent();\n  }\n\n  public isOwnCloseEvent = (event?: Event) => {\n    const isOverlay = this.trayPanelTrigger === event?.target;\n    const isDismissButton = (event?.target as HTMLElement)?.getAttribute('slot') === 'dismiss';\n    return isOverlay || isDismissButton;\n  };\n\n  // Do we need this forceDismiss parameter?\n  // The only use is in toast-panel, where we could just remove the event to make sure it always closes.\n  public close = (event?: Event, forceDismiss = false) => {\n    if (event && !this.isOwnCloseEvent(event) && !forceDismiss) return;\n    if (!event && !forceDismiss) return;\n    this.overlayTrigger?.removeAttribute('open');\n    this.dispatchEvent(new Event('dismissed', { bubbles: true, composed: true }));\n  };\n\n  public open = () => {\n    if (this.disabled) return;\n    if (this.overlayTrigger) {\n      this.overlayTrigger.setAttribute('open', 'click');\n    }\n  };\n\n  render() {\n    return html`<overlay-trigger\n      style=\"display: ${this.visible ? 'block' : 'none'}; ${this.disabled ? 'pointer-events: none;' : ''}\"\n      aria-hidden=${!this.visible}\n      type=\"modal\"\n      open=${ifDefined(this.isOpenByDefault && !this.disabled ? 'click' : undefined)}\n      @sp-closed=${this.close}>\n      <div slot=\"trigger\" id=\"tray-panel-trigger\" data-testid=\"tray-panel-trigger\">\n        <slot name=\"trigger\"></slot>\n      </div>\n      <sp-tray slot=\"click-content\" data-testid=${this.testId !== undefined ? this.testId : 'tray-panel'}>\n        <div class=\"tray-content\" data-testid=\"tray-panel-content\">\n          <div class=${classMap({ header: true, 'header-empty': !this.hasHeaderContent })}>\n            <slot name=\"back\"></slot>\n            <slot name=\"title\"></slot>\n            <slot name=\"dismiss\" @click=${this.close} @keydown=${this.close}></slot>\n          </div>\n          <div class=\"content\">\n            <slot name=\"content\"></slot>\n          </div>\n        </div>\n      </sp-tray>\n    </overlay-trigger>`;\n  }\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { css } from 'lit';\n\nexport const styles = css`\n  sp-overlay {\n    --mod-modal-confirm-border-radius: var(--firefly-primary-border-radius);\n  }\n\n  .dialog {\n    width: var(--spectrum-alert-dialog-maximum-width);\n    height: fit-content;\n    padding: var(--spectrum-global-dimension-size-400);\n    background: var(--firefly-primary-background-color);\n    border-radius: var(--firefly-primary-border-radius);\n    color: var(--spectrum-gray-800);\n    text-align: left;\n  }\n\n  .dialog:focus-visible {\n    outline: none;\n  }\n\n  .dialog-button-group {\n    display: flex;\n    flex-direction: row;\n    justify-content: flex-end;\n    gap: var(--spectrum-spacing-300);\n  }\n\n  .dialog-header {\n    font-size: var(--spectrum-font-size-500);\n    width: 100%;\n\n    h4 {\n      margin: 0;\n    }\n  }\n\n  .dialog-description {\n    display: block;\n    font-size: var(--spectrum-font-size-200);\n    line-height: var(--spectrum-spacing-400);\n\n    p {\n      margin-bottom: var(--spectrum-spacing-500);\n    }\n  }\n\n  /* Mobile */\n  @media (max-width: 768px) {\n    sp-overlay {\n      --mod-modal-max-width: 90%;\n    }\n\n    .dialog {\n      width: 100%;\n    }\n  }\n`;\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { DNIFlaggedCancelEvent, DNIFlaggedConfirmEvent } from './events.js';\nimport { styles } from './modals.css.js';\nimport { LitElement, html } from 'lit';\nimport { customElement, property } from 'lit/decorators.js';\n\nimport { localizeBundleDefault } from '../../services/locale-service/index.js';\nimport '@spectrum-web-components/button/sp-button.js';\nimport '@spectrum-web-components/dialog/sp-dialog-base.js';\nimport '@spectrum-web-components/overlay/sp-overlay.js';\n\nimport { Host } from '../../services/environment-service/environment-service.js';\nimport { getCompleteGoURL } from '../../services/host-service/host-service-functions.js';\nimport { Localized, Unlocalized } from '../../services/locale-service/locale-service.js';\nimport { commonStyles } from '../common/styles.css.js';\n\n/**\n * See src/applications/README.md#localization for more information.\n */\nexport const unlocalized = {\n  title: 'Upload another image',\n  description: (_: { link: string }) => `This image has <a href=\"{link}\" target=\"_blank\"> Content Credentials</a> that\n    indicate it can't be used with generative AI features.`,\n  primaryButton: 'Upload another image',\n  secondaryButton: 'Cancel',\n} as const satisfies Unlocalized;\n\nconst tagName = 'firefly-dni-flagged-modal';\n\n@customElement(tagName)\nexport class DNIFlaggedModal extends LitElement {\n  static styles = [styles, commonStyles];\n\n  /**\n   * The localized strings for the component.\n   * These can be provided by the consuming application normally\n   * but this one will be provided by the container upload element.\n   */\n  @property({ type: Object })\n  localized: Localized<typeof unlocalized> = localizeBundleDefault(unlocalized);\n\n  @property({ type: String })\n  hostType: Host = 'web';\n\n  render() {\n    return html`\n      <sp-overlay type=\"modal\" .open=${true}>\n        <sp-dialog-base underlay>\n          <div class=\"dialog\">\n            <div slot=\"heading\" class=\"dialog-header\">\n              <h4 .innerHTML=${this.localized.title}></h4>\n            </div>\n            <div class=\"dialog-description\">\n              <p .innerHTML=${this.localized.description({ link: getCompleteGoURL('firefly_about_cai', this.hostType) })}></p>\n            </div>\n            <div slot=\"button\" class=\"dialog-button-group\">\n              <sp-button\n                variant=\"secondary\"\n                data-testid=\"dni-flagged-modal-cancel\"\n                @click=${() => this.dispatchEvent(new DNIFlaggedCancelEvent())}\n                treatment=\"outline\"\n                .innerHTML=${this.localized.secondaryButton}>\n              </sp-button>\n              <sp-button\n                variant=\"accent\"\n                data-testid=\"dni-flagged-modal-confirm\"\n                @click=${() => this.dispatchEvent(new DNIFlaggedConfirmEvent())}\n                .innerHTML=${this.localized.primaryButton}>\n              </sp-button>\n            </div>\n          </div>\n        </sp-dialog-base>\n      </sp-overlay>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    [tagName]: DNIFlaggedModal;\n  }\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { HostService } from './host-service.js';\nimport { GoUrl } from './types.js';\nimport { fromProperties, toPromise, withMapData } from '@adobe/data/observe';\nimport { getAppLocaleFromIMS, normalize, region } from '@intl/adobe-locales';\n\nimport { isFederatedUser } from '../authentication-service/authentication-service-functions.js';\nimport { Host } from '../environment-service/environment-service.js';\n\nexport async function getLocaleWithCountryCode(host: HostService): Promise<string> {\n  const appCode = 'adobedotcom';\n  const userProfile = await toPromise(host.authentication.userProfile);\n  const environmentLocale = await toPromise(host.environment.localeCode);\n  const countryCode = userProfile?.countryCode ?? region(navigator.language) ?? region(environmentLocale) ?? 'US';\n  const baseLocale = environmentLocale ?? navigator.language;\n  return normalize(getAppLocaleFromIMS(appCode, baseLocale, countryCode).locale, appCode);\n}\n\nexport function getCompleteGoURL(goUrl: GoUrl, host: Host) {\n  const suffix = host === 'native' ? '_linkfree' : '';\n  return `https://www.adobe.com/go/${goUrl}${suffix}`;\n}\n\nexport const isNonAdobeOrgUser = (host: HostService) =>\n  withMapData(\n    fromProperties({\n      isOrgUser: host.authentication.isOrgUser,\n      userProfile: host.authentication.userProfile,\n      isProd: host.environment.production,\n    }),\n    ({ isOrgUser, userProfile, isProd }) => isOrgUser && !isFederatedUser(userProfile?.authId ?? null, isProd)\n  );\n\nexport const isBlockedByAdmin = (host: HostService) =>\n  withMapData(\n    fromProperties({\n      entitlement: host.entitlement.entitlement,\n      isOrgUser: host.authentication.isOrgUser,\n    }),\n    ({ entitlement, isOrgUser }) => !entitlement?.isEntitled && isOrgUser\n  );\n\nexport const canUserSubmitToGallery = (host: HostService) =>\n  withMapData(\n    fromProperties({\n      entitlement: host.entitlement.entitlement,\n      isNonAdobeOrgUser: isNonAdobeOrgUser(host),\n    }),\n    ({ entitlement, isNonAdobeOrgUser }) => !entitlement?.isK12 && !isNonAdobeOrgUser\n  );\n\nexport async function signIn(host: HostService) {\n  const hostType = await toPromise(host.environment.host);\n  if (hostType === 'native') {\n    host.nativeBridge.signIn({ redirectRoute: window.location.pathname });\n  } else {\n    host.authentication.showSignInDialog();\n  }\n}\n\n/**\n * Higher order function that you can wrap around an action to ensure that the user is signed in.\n */\nexport function ensureSignedIn<S extends { host: HostService }, Args extends unknown[]>(\n  fn: (this: S, ...args: Args) => unknown\n): (this: S, ...args: Args) => unknown {\n  return async function (this: { host: HostService }, ...args: unknown[]) {\n    const isSignedIn = await toPromise(this.host.authentication.isSignedIn);\n\n    if (isSignedIn) {\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any -- signature already checks type.\n      return (fn as any).call(this, ...args);\n    } else {\n      await signIn(this.host);\n    }\n  } as (this: S, ...args: Args) => unknown;\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { html, nothing } from 'lit';\nimport { when } from 'lit/directives/when.js';\n\nimport { ButtonTreatments, ButtonVariants } from '@spectrum-web-components/button';\nimport '@spectrum-web-components/button/sp-button.js';\nimport '@spectrum-web-components/dropzone/sp-dropzone.js';\n\nexport { styles } from './empty-state.css.js';\n\nexport interface EmptyStateRenderParams {\n  // Fallbacks if slots are not provided\n  uploadButtonLabel?: string;\n  browseButtonLabel?: string;\n  disabled?: boolean;\n  showUploadOptions?: boolean;\n  onDragZoneDrop: (event: Event) => void | Promise<void>;\n  onUploadButtonClick: () => void;\n  onBrowseFilesClick?: () => void;\n  onFileInputChange: (event: Event) => void;\n  acceptedFileTypes: string;\n  uploadButtonTreatment?: ButtonTreatments;\n  browseButtonTreatment?: ButtonTreatments;\n  uploadButtonSize?: string;\n  browseButtonSize?: string;\n  uploadButtonVariant?: ButtonVariants;\n  isMobile?: boolean;\n}\n\nexport function render(args: EmptyStateRenderParams) {\n  const {\n    disabled,\n    showUploadOptions,\n    onDragZoneDrop,\n    onUploadButtonClick,\n    onBrowseFilesClick,\n    uploadButtonLabel,\n    browseButtonLabel,\n    onFileInputChange,\n    acceptedFileTypes,\n    uploadButtonTreatment,\n    browseButtonTreatment,\n    uploadButtonVariant,\n    uploadButtonSize,\n    browseButtonSize,\n    isMobile,\n  } = args;\n\n  const content = html` <div class=\"empty-state-content\">\n      <slot name=\"empty-state-icon\"></slot>\n      <div class=\"empty-state-title-description-container\">\n        <slot name=\"empty-state-title\"></slot>\n        <slot name=\"empty-state-description\"></slot>\n      </div>\n      <div class=\"empty-state-actions\">\n        <sp-button\n          size=\"${uploadButtonSize ?? 'm'}\"\n          treatment=\"${uploadButtonTreatment ?? 'fill'}\"\n          variant=\"${uploadButtonVariant ?? 'accent'}\"\n          ?disabled=${disabled}\n          @click=${onUploadButtonClick}\n          data-testid=\"empty-state-upload-button\">\n          ${uploadButtonLabel}\n          <slot name=\"uploadButtonIcon\" slot=\"icon\"></slot>\n        </sp-button>\n        ${showUploadOptions && onBrowseFilesClick\n          ? html`<sp-button\n              size=\"${browseButtonSize ?? 'm'}\"\n              treatment=\"${browseButtonTreatment ?? 'fill'}\"\n              variant=\"primary\"\n              ?disabled=${disabled}\n              @click=${onBrowseFilesClick}\n              data-testid=\"empty-state-browse-button\">\n              ${browseButtonLabel}\n            </sp-button>`\n          : nothing}\n      </div>\n      <slot name=\"empty-state-hint\"></slot>\n    </div>\n    <div class=\"empty-state-background\">\n      <slot name=\"empty-state-background\"></slot>\n    </div>`;\n\n  return html`\n    <div class=\"empty-state-container\">\n      <input type=\"file\" id=\"file-input\" style=\"display: none\" @change=${onFileInputChange} accept=${acceptedFileTypes} />\n      ${when(\n        isMobile,\n        () => html`${content}`,\n        () => html`<sp-dropzone class=\"empty-state-dropzone\" @sp-dropzone-drop=${onDragZoneDrop}>${content}</sp-dropzone>`\n      )}\n    </div>\n  `;\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { css } from 'lit';\n\nexport const styles = css`\n  :host([variant='empty-state']) {\n    position: relative;\n    width: 100%;\n    height: 100%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    color: var(--spectrum-gray-800);\n  }\n\n  .empty-state-container {\n    max-width: var(--firefly-upload-empty-state-max-width, 100%);\n    max-height: var(--firefly-upload-empty-state-max-height, 100%);\n    width: 100%;\n    height: 100%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    position: relative;\n    overflow: hidden;\n  }\n\n  .empty-state-dropzone {\n    width: 100%;\n    height: 100%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    padding: var(--firefly-upload-empty-state-dropzone-padding, var(--spectrum-spacing-700));\n  }\n\n  .empty-state-content {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    text-align: center;\n\n    gap: var(--firefly-upload-empty-state-gap, var(--spectrum-spacing-100));\n  }\n\n  .empty-state-icon {\n    margin-bottom: var(--spectrum-spacing-300);\n  }\n\n  .empty-state-title-description-container {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    gap: var(--firefly-upload-empty-state-title-description-gap, var(--spectrum-spacing-75));\n  }\n\n  .empty-state-title {\n    font-size: var(--spectrum-font-size-500);\n    font-weight: var(--spectrum-bold-font-weight);\n  }\n\n  .empty-state-description {\n    font-size: var(--spectrum-font-size-200);\n  }\n\n  .empty-state-actions {\n    display: flex;\n    flex-flow: row wrap;\n    justify-content: center;\n    align-items: center;\n\n    /* Note 10px is not a spectrum variable */\n    gap: 10px;\n  }\n\n  .empty-state-hint {\n    font-size: var(--spectrum-font-size-100);\n  }\n\n  .empty-state-background {\n    width: 100%;\n    height: 100%;\n    position: absolute;\n    top: 0;\n    left: 0;\n    z-index: -1;\n  }\n`;\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { html, nothing } from 'lit';\n\nimport '@spectrum-web-components/action-button/sp-action-button.js';\n\nimport '../../../icons/icon-file-upload.js';\nimport '../../../icons/icon-upload-to-cloud.js';\n\nexport { styles } from './popover-menu.css.js';\n\nexport interface PopoverMenuRenderParams {\n  uploadButtonLabel?: string;\n  browseButtonLabel?: string;\n  showUploadOptions?: boolean;\n  onUploadButtonClick: () => void;\n  onBrowseFilesClick?: () => void;\n  onFileInputChange: (event: Event) => void;\n  acceptedFileTypes: string;\n}\n\nexport function render(args: PopoverMenuRenderParams) {\n  const {\n    uploadButtonLabel,\n    browseButtonLabel,\n    onUploadButtonClick,\n    onBrowseFilesClick,\n    onFileInputChange,\n    acceptedFileTypes,\n    showUploadOptions,\n  } = args;\n\n  return html`<div class=\"popover-menu-container\">\n    <input type=\"file\" id=\"file-input\" style=\"display: none\" @change=${onFileInputChange} accept=${acceptedFileTypes} />\n\n    <div class=\"label\">\n      <slot name=\"label\"></slot>\n    </div>\n    <sp-action-button\n      size=\"m\"\n      id=${`upload-button`}\n      data-testid=${`upload-button`}\n      aria-label=${uploadButtonLabel ?? 'upload button'}\n      quiet\n      @click=${onUploadButtonClick}>\n      <firefly-icon-file-upload slot=\"icon\"></firefly-icon-file-upload>\n      ${uploadButtonLabel ? html`${uploadButtonLabel}` : nothing}\n    </sp-action-button>\n    <sp-action-button\n      size=\"m\"\n      id=${`cloud-upload-button`}\n      data-testid=${`cloud-upload-button`}\n      aria-label=${browseButtonLabel ?? 'upload button'}\n      quiet\n      @click=${showUploadOptions && onBrowseFilesClick}>\n      <firefly-icon-upload-to-cloud slot=\"icon\"></firefly-icon-upload-to-cloud>\n      ${browseButtonLabel ? html`${browseButtonLabel}` : nothing}\n    </sp-action-button>\n  </div>`;\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\n// This file is generated. Do not edit.\nimport { TemplateResult, html } from 'lit';\nimport { customElement } from 'lit/decorators.js';\n\nimport { IconBase } from '@spectrum-web-components/icon';\n\nconst tagName = 'firefly-icon-file-upload';\n\n@customElement(tagName)\nexport class IconFileUpload extends IconBase {\n  protected override render(): TemplateResult {\n    return html`\n      <svg\n        role=\"img\"\n        aria-label=\"Upload file image\"\n        xmlns=\"http://www.w3.org/2000/svg\"\n        width=\"20\"\n        height=\"20\"\n        viewBox=\"0 0 20 20\"\n        fill=\"none\">\n        <path\n          d=\"M13.5273 10.4912L10.5249 7.49317C10.2319 7.20019 9.75781 7.20019 9.46484 7.49317L6.46728 10.4912C6.17431 10.7842 6.17431 11.2588 6.46728 11.5518C6.61376 11.6982 6.80566 11.7715 6.99755 11.7715C7.18944 11.7715 7.38134 11.6983 7.52782 11.5518L9.24999 9.8296V18.0098C9.24999 18.4238 9.58593 18.7598 9.99999 18.7598C10.4141 18.7598 10.75 18.4238 10.75 18.0098V9.83693L12.4678 11.5518C12.7607 11.8447 13.2353 11.8447 13.5283 11.5518C13.8208 11.2588 13.8208 10.7832 13.5273 10.4912Z\"\n          fill=\"currentColor\" />\n        <path\n          d=\"M15.75 17H12.9512C12.5371 17 12.2012 16.6641 12.2012 16.25C12.2012 15.8359 12.5371 15.5 12.9512 15.5H15.75C16.1636 15.5 16.5 15.1631 16.5 14.75V4.25C16.5 3.83691 16.1636 3.5 15.75 3.5H4.25C3.83643 3.5 3.5 3.83691 3.5 4.25V14.75C3.5 15.1631 3.83643 15.5 4.25 15.5H6.97559C7.38965 15.5 7.72559 15.8359 7.72559 16.25C7.72559 16.6641 7.38965 17 6.97559 17H4.25C3.00928 17 2 15.9902 2 14.75V4.25C2 3.00977 3.00928 2 4.25 2H15.75C16.9907 2 18 3.00977 18 4.25V14.75C18 15.9902 16.9907 17 15.75 17Z\"\n          fill=\"currentColor\" />\n      </svg>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    [tagName]: IconFileUpload;\n  }\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\n// This file is generated. Do not edit.\nimport { TemplateResult, html } from 'lit';\nimport { customElement } from 'lit/decorators.js';\n\nimport { IconBase } from '@spectrum-web-components/icon';\n\nconst tagName = 'firefly-icon-upload-to-cloud';\n\n@customElement(tagName)\nexport class IconUploadToCloud extends IconBase {\n  protected override render(): TemplateResult {\n    return html`\n      <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 20 20\">\n        <path\n          d=\"m19.73877,11.66797c0,1.15771-.45068,2.24561-1.26904,3.06348s-1.90625,1.26855-3.06348,1.26855h-.65723c-.41406,0-.75-.33594-.75-.75s.33594-.75.75-.75h.65723c.75635,0,1.46777-.29443,2.00293-.82959.53516-.53467.82959-1.24561.82959-2.00244,0-.72754-.27686-1.41748-.7793-1.94189-.50146-.52393-1.17676-.8335-1.90234-.87207-.25439-.01367-.48486-.15576-.61133-.37695-.12646-.22168-.13184-.49219-.01367-.71826.12549-.24121.22217-.48975.28711-.73877.06836-.25977.10303-.52588.10303-.7915,0-.89355-.34766-1.7334-.979-2.36523-1.20801-1.20703-3.29639-1.27393-4.56787-.14062-.60059.53662-.98975,1.27246-1.09424,2.07275-.03076.23584-.17188.44336-.37988.55859-.20752.11572-.45752.12549-.6748.02686-.16846-.07666-.3418-.13574-.5166-.17529-.86035-.1958-1.7417.06934-2.34863.66211-.47461.46289-.73584,1.07666-.73584,1.72803,0,.16748.01807.33496.05322.49854.03467.1582.08643.31543.15283.46582.09961.22412.08301.48291-.04395.69287-.12744.20996-.34912.34424-.59375.35986-.49609.03174-.95654.24707-1.29785.60596-.34131.36035-.52979.83252-.52979,1.32959,0,.52148.20312,1.01172.57178,1.38037.36865.36816.8584.57129,1.37988.57129h2.09961c.41406,0,.75.33594.75.75s-.33594.75-.75.75h-2.09961c-.92188,0-1.78857-.35889-2.44043-1.01074-.65234-.65186-1.01123-1.51904-1.01123-2.44092,0-.88281.33447-1.72119.94141-2.36182.38721-.40771.86084-.71045,1.38232-.88965-.04297-.23145-.06445-.46631-.06445-.70117,0-1.05908.42188-2.0542,1.18848-2.80176.95605-.93408,2.3335-1.3501,3.67627-1.0625.26416-.81494.74072-1.55127,1.38672-2.12793.88184-.78613,2.01855-1.21924,3.20166-1.21924,1.29346,0,2.51025.50391,3.42529,1.41846.91455.91504,1.41846,2.13184,1.41846,3.42578,0,.39453-.05127.78906-.15234,1.17236-.01074.04199-.02246.08398-.03467.12549.72119.21191,1.37793.60889,1.90771,1.16211.771.80518,1.1958,1.86328,1.1958,2.97949Z\"\n          fill=\"currentColor\" />\n        <path\n          d=\"m13.85352,10.82373l-3.00293-2.99756c-.29297-.29199-.76709-.29248-1.06006.00049l-2.99707,2.99756c-.29297.29297-.29297.76758,0,1.06055.14648.14648.33838.21973.53027.21973s.38379-.07324.53027-.21973l1.72217-1.72253v8.18347c0,.41406.33594.75.75.75s.75-.33594.75-.75v-8.17517l1.71777,1.71472c.29248.29199.76709.29199,1.06055-.00098.29248-.29297.29248-.76807-.00098-1.06055Z\"\n          fill=\"currentColor\" />\n      </svg>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    [tagName]: IconUploadToCloud;\n  }\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { css } from 'lit';\n\nexport const styles = css`\n  :host([variant='popover-menu']) {\n    position: relative;\n    width: fit-content;\n    height: fit-content;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  }\n\n  .popover-menu-container {\n    display: flex;\n    flex-direction: column;\n    align-items: flex-start;\n    justify-content: center;\n    gap: var(--spectrum-spacing-100);\n  }\n\n  .popover-menu-container .label {\n    color: var(--spectrum-gray-700);\n    font-size: 12px;\n    font-style: normal;\n    font-weight: 400;\n    line-height: 130%;\n  }\n\n  :host([variant='popover-menu']) sp-action-button {\n    justify-content: left;\n    width: 100%;\n  }\n`;\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { css } from 'lit';\n\nexport const styles = css`\n  .upload-preview-file-container {\n    box-sizing: border-box;\n    position: relative;\n    display: flex;\n    align-items: center;\n    width: 100%;\n    height: 100%;\n    justify-content: center;\n  }\n\n  .upload-preview-file {\n    background: transparent;\n    padding: 0;\n    overflow: hidden;\n    cursor: pointer;\n    height: calc(100% - var(--firefly-upload-preview-border-width) * 2);\n    width: calc(100% - var(--firefly-upload-preview-border-width) * 2);\n    outline: var(--firefly-upload-preview-border-width) solid var(--firefly-upload-preview-filled-border-color);\n    border: var(--firefly-upload-preview-border-width) solid var(--firefly-upload-preview-file-highlight-color);\n    border-radius: var(--firefly-upload-preview-border-radius);\n\n    &:focus,\n    &:focus-visible {\n      outline-color: var(--spectrum-alias-focus-ring-color);\n    }\n  }\n\n  .upload-preview-file.border-none {\n    /* we make the color transparent so we don't deal with positioning issues */\n    outline-color: transparent;\n    border-color: transparent;\n\n    &:focus,\n    &:focus-visible {\n      /* we keep the focus ring color the same as the border color */\n      outline-color: var(--spectrum-alias-focus-ring-color);\n    }\n  }\n\n  .upload-preview-file img {\n    width: var(--firefly-upload-preview-image-width, 100%);\n    max-width: 100%;\n    height: 100%;\n    object-fit: var(--firefly-upload-preview-object-fit, cover);\n    display: block;\n  }\n\n  .upload-preview-file.loading img {\n    animation: pulse-brightness 2s ease-in-out infinite;\n    will-change: filter;\n  }\n\n  .upload-preview-clear {\n    position: absolute;\n    top: var(--firefly-upload-preview-border-width);\n    right: var(--firefly-upload-preview-border-width);\n    border: none;\n    color: var(--firefly-upload-preview-remove-button-color);\n    padding: 0;\n    font-size: 0;\n    border-radius: 50%;\n    background: transparent;\n    cursor: pointer;\n\n    /* Button must be at least this size to be accessible */\n    width: 24px;\n    height: 24px;\n\n    &:focus,\n    &:focus-visible {\n      outline: none;\n    }\n\n    &:focus-visible {\n      &::before {\n        content: '';\n        position: absolute;\n        top: calc(-1 * var(--spectrum-focus-indicator-thickness));\n        left: calc(-1 * var(--spectrum-focus-indicator-thickness));\n        width: 100%;\n        height: 100%;\n        border-radius: 50%;\n        border: var(--spectrum-focus-indicator-thickness) solid var(--spectrum-alias-focus-ring-color);\n      }\n    }\n  }\n\n  .upload-preview-clear sp-icon {\n    position: relative;\n\n    &::before {\n      content: '';\n      position: absolute;\n      background: var(--spectrum-gray-50);\n      width: calc(100% - 8px);\n      height: calc(100% - 8px);\n      z-index: 0;\n      inset: 0;\n      margin: auto;\n    }\n\n    sp-icon-close-circle {\n      position: relative;\n    }\n  }\n\n  .upload-preview-clear-centered {\n    background: var(--spectrum-global-color-static-gray-200);\n    border: none;\n    position: absolute;\n    border-radius: 50%;\n    width: var(--spectrum-global-dimension-size-350);\n    height: var(--spectrum-global-dimension-size-350);\n    opacity: 0;\n    transition: opacity 0.3s ease-in-out 0.1s;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n\n    &:hover {\n      opacity: 1;\n    }\n\n    &:focus {\n      opacity: 1;\n    }\n\n    &:focus-visible {\n      opacity: 1;\n    }\n  }\n\n  .upload-preview-clear-centered sp-icon {\n    position: relative;\n    background: var(--spectrum-global-color-static-gray-800);\n    border-radius: 50%;\n    width: var(--spectrum-global-dimension-size-200);\n    height: var(--spectrum-global-dimension-size-200);\n\n    &::before {\n      content: '';\n      position: absolute;\n      z-index: 0;\n      margin: auto;\n    }\n\n    sp-icon-close-circle {\n      color: var(--spectrum-global-color-static-gray-200);\n      position: relative;\n    }\n  }\n\n  @keyframes pulse-brightness {\n    0% {\n      filter: brightness(0.35);\n    }\n\n    50% {\n      filter: brightness(0.55);\n    }\n\n    100% {\n      filter: brightness(0.35);\n    }\n  }\n`;\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport {\n  FilePreviewImageClickEvent,\n  FilePreviewPointerOutEvent,\n  FilePreviewPointerOverEvent,\n  FilePreviewRemoveClickEvent,\n} from './events.js';\nimport { styles } from './file-preview.css.js';\nimport { BlobRef } from '@adobe/data/cache';\nimport { LitElement, html, nothing } from 'lit';\nimport { customElement, property } from 'lit/decorators.js';\nimport { classMap } from 'lit/directives/class-map.js';\nimport { when } from 'lit/directives/when.js';\n\nimport { localizeBundleDefault } from '../../services/locale-service/index.js';\nimport '@spectrum-web-components/icon/sp-icon.js';\nimport '@spectrum-web-components/icons-workflow/icons/sp-icon-close-circle.js';\nimport '@spectrum-web-components/icons-workflow/icons/sp-icon-file-txt.js';\n\nimport { getPreviewImage, isMediaType } from '../../functions/image-functions.js';\nimport { Localized, Unlocalized } from '../../services/locale-service/locale-service.js';\nimport { commonStyles } from '../common/styles.css.js';\nimport { useBorrowUrl } from '../hooks/use-borrow-url.js';\nimport { usePromise } from '../hooks/use-promise.js';\nimport { withHooks } from '../hooks/with-hooks.js';\n\nexport type FileInfo = {\n  ref: BlobRef | null;\n  name: string;\n  type: string;\n};\n\nexport type FilePreviewProps = {\n  fileInfo: FileInfo;\n  centerClearButton?: boolean;\n};\n\n/**\n * See src/applications/README.md#localization for more information.\n */\nexport const unlocalized = {\n  fileNameLabel: (_: { fileName: string }) => `{fileName}`,\n  loadingAltLabel: (_: { fileName: string }) => `Loading preview for {fileName}`,\n  replaceAltLabel: (_: { fileName: string }) => `Replace {fileName}`,\n  removeAltLabel: (_: { fileName: string }) => `Remove {fileName}`,\n} as const satisfies Unlocalized;\n\nconst tagName = 'firefly-file-preview';\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    [tagName]: FilePreview;\n  }\n}\n\n@customElement(tagName)\nexport class FilePreview extends LitElement implements FilePreviewProps {\n  static styles = [commonStyles, styles];\n\n  /**\n   * The localized strings for the component.\n   * These can be provided by the consuming application normally\n   * but this one will be provided by the container upload element.\n   */\n  @property({ type: Object })\n  localized: Localized<typeof unlocalized> = localizeBundleDefault(unlocalized);\n\n  @property({ type: Object, reflect: true }) fileInfo: FileInfo = { ref: null, name: '', type: '' };\n\n  @property({ type: Boolean, reflect: true }) centerClearButton = false;\n\n  @property({ type: String, reflect: false }) borderType: 'solid' | 'none' = 'solid';\n\n  @property({ type: Boolean, reflect: false }) loading = false;\n\n  private renderNonMediaPreview() {\n    return html`<sp-icon size=\"xl\" label=${this.localized.fileNameLabel({ fileName: this.fileInfo.name })}>\n      <sp-icon-file-txt></sp-icon-file-txt>\n    </sp-icon>`;\n  }\n\n  private renderMediaPreview(previewUrl?: string | null) {\n    if (!previewUrl) return nothing;\n\n    return html`<img data-testid=\"uploaded-image-preview\" src=${previewUrl} alt=${this.fileInfo.name} />`;\n  }\n\n  @withHooks\n  render() {\n    const imagePreviewRef = usePromise(() => getPreviewImage(this.fileInfo.ref), [this.fileInfo.ref]);\n    // Always use useBorrowUrl to get a URL for rendering as it safely releases the url\n    // when no longer used to avoid memory leaks\n    const previewUrl = useBorrowUrl(imagePreviewRef);\n\n    const handleClickClear = (e: Event) => {\n      e.stopPropagation();\n      this.dispatchEvent(new FilePreviewRemoveClickEvent());\n    };\n\n    return html`<div class=\"upload-preview-file-container\">\n      <button\n        class=${classMap({\n          'upload-preview-file': true,\n          'border-none': this.borderType === 'none',\n          loading: this.loading,\n        })}\n        aria-label=${this.localized.replaceAltLabel({ fileName: this.fileInfo.name })}\n        data-testid=\"uploaded-image\"\n        @click=${() => this.dispatchEvent(new FilePreviewImageClickEvent())}\n        @pointerover=${() => this.dispatchEvent(new FilePreviewPointerOverEvent())}\n        @pointerout=${() => this.dispatchEvent(new FilePreviewPointerOutEvent())}>\n        ${isMediaType(this.fileInfo.type) || previewUrl ? this.renderMediaPreview(previewUrl) : this.renderNonMediaPreview()}\n      </button>\n      ${when(\n        !this.loading,\n        () =>\n          html`<button\n            class=${classMap({\n              'upload-preview-clear-centered': this.centerClearButton,\n              'upload-preview-clear': !this.centerClearButton,\n            })}\n            aria-label=${this.localized.removeAltLabel({ fileName: this.fileInfo.name })}\n            data-testid=\"uploaded-image-remove-button\"\n            @click=${handleClickClear}>\n            <sp-icon><sp-icon-close-circle></sp-icon-close-circle></sp-icon>\n          </button>`\n      )}\n    </div>`;\n  }\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nexport const uploadValidationErrors = {\n  fileTooLarge: 'firefly_upload_file_too_large',\n  fileTypeNotAccepted: 'firefly_upload_file_type_not_accepted',\n} as const;\n\nexport type UploadValidationError = (typeof uploadValidationErrors)[keyof typeof uploadValidationErrors];\n\nexport const uploadProcessingErrors = {\n  samFetchFailed: 'sam-fetch-failed',\n  samFetchError: 'sam-fetch-error',\n} as const;\n\nexport type UploadProcessingError = (typeof uploadProcessingErrors)[keyof typeof uploadProcessingErrors];\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { css } from 'lit';\n\nexport const styles = css`\n  :host {\n    font-size: 0;\n    margin-top: var(--firefly-upload-preview-margin-top, 0);\n\n    --firefly-upload-font: var(--spectrum-font-family);\n    --firefly-upload-font-size: var(--spectrum-font-size-75);\n    --firefly-upload-font-weight: var(--spectrum-regular-font-weight);\n    --firefly-upload-font-color: var(--spectrum-gray-800);\n    --firefly-upload-column-spacing-internal: var(--firefly-upload-column-spacing, var(--spectrum-spacing-400));\n    --firefly-upload-preview-width-internal: var(--firefly-upload-preview-width, var(--spectrum-global-dimension-size-900));\n    --firefly-upload-preview-height-internal: var(--firefly-upload-preview-height, var(--spectrum-global-dimension-size-900));\n    --firefly-upload-preview-height-new: var(--spectrum-global-dimension-size-450);\n    --firefly-upload-preview-width-with-file: var(--firefly-upload-preview-width-internal);\n    --firefly-upload-preview-border-width: var(--spectrum-border-width-200);\n    --firefly-upload-preview-border-radius: var(--spectrum-corner-radius-200);\n    --firefly-upload-preview-filled-border-color: var(--spectrum-gray-700);\n    --firefly-upload-preview-hover-background-color: var(--spectrum-gray-200);\n    --firefly-upload-preview-file-highlight-color: var(--spectrum-gray-50);\n    --firefly-upload-preview-remove-button-color: var(--spectrum-gray-800);\n    --firefly-upload-actions-row-gap: var(--spectrum-spacing-100);\n    --firefly-upload-actions-min-width-internal: var(--firefly-upload-actions-min-width, 150px);\n    --firefly-upload-button-padding-label-to-icon: var(--spectrum-text-to-visual-300);\n    --firefly-upload-preview-flex-direction: column;\n    --firefly-upload-preview-gap: var(--spectrum-spacing-100);\n    --firefly-upload-preview-padding: 0;\n    --firefly-upload-preview-border-color-internal: var(--firefly-upload-preview-border-color, var(--spectrum-gray-600));\n    --firefly-upload-disabled-opacity: 1;\n    --firefly-upload-font-color-disabled: var(--spectrum-gray-300);\n  }\n\n  .upload-container * {\n    font-family: var(--firefly-upload-font);\n    font-size: var(--firefly-upload-font-size);\n    font-weight: var(--firefly-upload-font-weight);\n  }\n\n  .upload-options-trigger {\n    width: 100%;\n    height: 100%;\n    display: flex;\n    flex-direction: column;\n\n    & firefly-file-preview {\n      width: 100%;\n      height: 100%;\n    }\n  }\n\n  .upload-options-menu {\n    text-align: left;\n  }\n\n  .upload-options-item-icon {\n    align-self: auto;\n  }\n\n  .upload-container {\n    box-sizing: border-box;\n    display: inline-block;\n    color: var(--firefly-upload-font-color);\n    font-size: var(--firefly-upload-font-size);\n    font-weight: var(--firefly-upload-font-weight);\n    --mod-button-padding-label-to-icon: var(--firefly-upload-button-padding-label-to-icon);\n\n    &__uploader {\n      margin-top: 3px;\n\n      &:first-of-type {\n        margin-top: 0;\n      }\n    }\n  }\n\n  .upload-container.disabled {\n    opacity: var(--firefly-upload-disabled-opacity);\n    pointer-events: none;\n    cursor: not-allowed;\n    color: var(--firefly-upload-font-color-disabled);\n  }\n\n  .upload-container.button,\n  .upload-container.icon-button {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n  }\n\n  .icon-preview {\n    border: none;\n    outline: none;\n  }\n\n  .upload-dropzone {\n    border: 0;\n    padding: 0;\n    width: auto;\n    display: grid;\n    column-gap: var(--firefly-upload-column-spacing-internal);\n    background: transparent;\n    justify-items: center;\n    grid-auto-flow: column;\n  }\n\n  .upload-preview {\n    width: var(--firefly-upload-preview-width-internal);\n    height: var(--firefly-upload-preview-height-internal);\n    overflow: hidden;\n    cursor: pointer;\n\n    &--small {\n      height: var(--firefly-upload-preview-height-new);\n    }\n\n    /* control width when file is uploaded to allow flexible text but constrain image */\n    &--with-file {\n      width: var(--firefly-upload-preview-width-with-file, var(--firefly-upload-preview-width-internal));\n    }\n  }\n\n  .upload-preview-placeholder {\n    display: flex;\n    cursor: pointer;\n    flex-direction: var(--firefly-upload-preview-flex-direction);\n    gap: var(--firefly-upload-preview-gap);\n    height: 100%;\n    width: 100%;\n    padding: var(--firefly-upload-preview-padding, 0);\n    background: var(--firefly-upload-preview-background-color, transparent);\n    justify-content: center;\n    align-items: center;\n    border-radius: var(--firefly-upload-preview-border-radius);\n    border: var(--firefly-upload-preview-border-width) dashed var(--firefly-upload-preview-border-color-internal);\n    color: var(--spectrum-gray-900-rgb);\n\n    &:hover {\n      background: var(--firefly-upload-preview-hover-background-color);\n    }\n\n    &:focus,\n    &:focus-visible {\n      outline-color: var(--spectrum-alias-focus-ring-color);\n    }\n  }\n\n  .icon .upload-preview-placeholder {\n    border-style: none;\n  }\n\n  sp-popover {\n    --mod-popover-corner-radius: var(--spectrum-global-dimension-size-125);\n    padding: var(--spectrum-spacing-100);\n\n    sp-menu {\n      gap: 1px;\n\n      sp-menu-item {\n        font-weight: var(--spectrum-medium-font-weight) !important;\n        line-height: normal;\n      }\n\n      @media (max-width: 768px) {\n        sp-menu-item {\n          --mod-menu-item-top-edge-to-text: var(--spectrum-component-top-to-text-200);\n          --mod-menu-item-label-inline-edge-to-content: var(--spectrum-component-edge-to-text-200);\n          --mod-menu-item-bottom-edge-to-text: var(--spectrum-component-bottom-to-text-200);\n          --mod-menu-item-label-font-size: var(--spectrum-font-size-200);\n          --mod-menu-item-label-text-to-visual: var(--spectrum-text-to-visual-75);\n\n          &:active {\n            border-radius: var(--spectrum-corner-radius-200);\n          }\n        }\n      }\n\n      @media (min-width: 769px) {\n        sp-menu-item {\n          --mod-menu-item-bottom-edge-to-text: var(--spectrum-global-dimension-size-100);\n          --mod-menu-item-label-font-size: var(--spectrum-font-size-100);\n          --mod-menu-item-label-text-to-visual: var(--spectrum-text-to-visual-50);\n          --mod-menu-item-min-height: 0;\n\n          &:hover {\n            border-radius: var(--spectrum-corner-radius-200);\n          }\n        }\n      }\n    }\n  }\n\n  sp-popover.upload-cropper-popover {\n    width: fit-content;\n    height: fit-content;\n    padding: var(--spectrum-global-dimension-size-150);\n    background-color: color-mix(in srgb, var(--spectrum-global-color-static-gray-800) 75%, transparent);\n    backdrop-filter: blur(4px);\n    border: none;\n\n    position: relative;\n\n    .upload-cropper-close-button {\n      position: absolute;\n      top: var(--spectrum-global-dimension-size-25);\n      right: var(--spectrum-global-dimension-size-25);\n      padding: var(--spectrum-global-dimension-size-50);\n      aspect-ratio: 1;\n      border-radius: 50%;\n      color: var(--spectrum-global-color-static-gray-200);\n      background-color: color-mix(in srgb, var(--spectrum-global-color-static-gray-800) 50%, transparent);\n      transition: background-color 0.1s ease-in-out;\n      border: none;\n      outline: none;\n      cursor: pointer;\n\n      &:hover {\n        background-color: var(--spectrum-global-color-gray-700);\n      }\n\n      z-index: 1;\n\n      display: flex;\n      align-items: center;\n      justify-content: center;\n    }\n  }\n\n  .upload-preview-placeholder-loading-no-border {\n    border-color: transparent;\n\n    &:focus,\n    &:focus-visible {\n      outline-color: var(--spectrum-alias-focus-ring-color);\n    }\n  }\n\n  .upload-container-actions {\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    gap: var(--firefly-upload-actions-row-gap);\n    min-width: var(--firefly-upload-actions-min-width-internal);\n  }\n\n  .upload-options-container {\n    display: flex;\n    gap: var(--firefly-upload-actions-row-gap);\n    min-width: var(--firefly-upload-actions-min-width);\n    margin-left: var(--spectrum-global-dimension-size-50);\n    padding: var(--spectrum-global-dimension-size-100);\n    background: var(--firefly-prompt-background-color);\n    border-radius: var(--firefly-upload-preview-border-radius);\n    border: var(--firefly-upload-preview-border-width) solid var(--firefly-upload-preview-border-color-internal);\n  }\n\n  .upload-container sp-action-button {\n    background-color: var(--firefly-upload-button-background, var(--spectrum-button-background-color-default));\n    color: var(--firefly-upload-button-color, var(--spectrum-button-content-color-default));\n  }\n\n  .upload-container sp-button {\n    background-color: var(--firefly-upload-button-background, var(--spectrum-button-background-color-default));\n    border-color: var(--firefly-upload-button-border, var(--spectrum-button-border-color-default));\n    color: var(--firefly-upload-button-color, var(--spectrum-button-content-color-default));\n  }\n`;\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport './crop-overlay.js';\nimport { CropOverlay } from './crop-overlay.js';\nimport { unlocalized as cropOverlayUnlocalized } from './crop-overlay.js';\nimport './dni-flagged-modal.js';\nimport { unlocalized as dniFlaggedModalUnlocalized } from './dni-flagged-modal.js';\nimport * as emptyStatePresentation from './elements/empty-state/empty-state-presentation.js';\nimport { styles as emptyStateStyles } from './elements/empty-state/empty-state.css.js';\nimport * as popoverMenuPresentation from './elements/popover-menu/popover-menu-presentation.js';\nimport { styles as popoverMenuStyles } from './elements/popover-menu/popover-menu.css.js';\nimport {\n  DNIFlaggedEvent,\n  FileChangeEvent,\n  FileSelectedEvent,\n  FileTypeNotAcceptedEvent,\n  UploadEditedEvent,\n  UploadProcessingErrorEvent,\n  UploadSourceOpenedEvent,\n  UploadValidationErrorEvent,\n} from './events.js';\nimport './file-preview.js';\nimport { unlocalized as filePreviewUnlocalized } from './file-preview.js';\nimport { uploadProcessingErrors, uploadValidationErrors } from './types.js';\nimport { styles } from './upload.css.js';\nimport { equals } from '@adobe/data';\nimport { BlobRef, blobStore } from '@adobe/data/cache';\nimport { LitElement, TemplateResult, html, nothing } from 'lit';\nimport { customElement, property, query, state } from 'lit/decorators.js';\nimport { classMap } from 'lit/directives/class-map.js';\n\nimport { localizeBundleDefault } from '../../services/locale-service/index.js';\nimport '@spectrum-web-components/action-button/sp-action-button.js';\nimport '@spectrum-web-components/action-group/sp-action-group.js';\nimport { ButtonTreatments, ButtonVariants } from '@spectrum-web-components/button';\nimport '@spectrum-web-components/button/sp-button.js';\nimport { DropzoneEventDetail } from '@spectrum-web-components/dropzone';\nimport '@spectrum-web-components/dropzone/sp-dropzone.js';\nimport '@spectrum-web-components/icon/sp-icon.js';\nimport '@spectrum-web-components/icons-workflow/icons/sp-icon-file-txt.js';\nimport '@spectrum-web-components/menu/sp-menu-item.js';\nimport '@spectrum-web-components/menu/sp-menu.js';\nimport type { Placement } from '@spectrum-web-components/overlay';\nimport '@spectrum-web-components/overlay/overlay-trigger.js';\nimport '@spectrum-web-components/popover/sp-popover.js';\n\nimport { getNumericAspectRatio } from '../../functions/aspect-ratio-functions.js';\nimport { FileEditorSettings, getEditedFile } from '../../functions/file-edit-functions.js';\nimport { getMediaSize, getMimeType, isImageType } from '../../functions/image-functions.js';\nimport { AuthenticationService } from '../../services/authentication-service/authentication-service.js';\nimport { ContentAuthenticityService } from '../../services/content-authenticity-service/content-authenticity-service.js';\nimport { EnvironmentService } from '../../services/environment-service/environment-service.js';\nimport { Host } from '../../services/environment-service/environment-service.js';\nimport { Localized, Unlocalized } from '../../services/locale-service/locale-service.js';\nimport { SamService } from '../../services/sam-service/sam-service.js';\nimport { commonStyles } from '../common/styles.css.js';\nimport '../icons/icon-adobe-cloud-storage.js';\nimport '../icons/icon-file-import.js';\nimport { AssetSelectedEvent } from '../uap/events.js';\nimport '../uap/uap.js';\n\n/**\n * The extract-strings script has a very limited ability to traverse referenced bundles.\n * See src/applications/README.md#localization for more information.\n */\nexport const unlocalized = {\n  dniFlaggedModal: dniFlaggedModalUnlocalized,\n  filePreview: filePreviewUnlocalized,\n  yourDevice: 'Your device',\n  adobeCloudStorage: 'Adobe cloud storage',\n  cropOverlay: cropOverlayUnlocalized,\n  uploadAriaLabel: 'Upload a file',\n  includesGenerationHistory: 'Includes generation history',\n} as const satisfies Unlocalized;\n\ntype Variant = 'full' | 'compact' | 'button' | 'action-button' | 'icon' | 'empty-state' | 'popover-menu';\n// TODO: This should use same Size as SWC\nexport type Size = 'l' | 'm' | 's';\n\nexport type UploadViewProps = {\n  placeholder?: string;\n  uploadButtonLabel?: string;\n  browseButtonLabel?: string;\n  variant?: Variant;\n  fileRef: BlobRef | null;\n  acceptedFileTypes?: string;\n  contentAuthenticity?: ContentAuthenticityService;\n  authentication?: AuthenticationService;\n  environment?: EnvironmentService;\n  sam?: SamService;\n  enablePermissionsModal?: boolean;\n  disabled?: boolean;\n  isMobile?: boolean;\n  aspectRatio?: number | null;\n  centerClearButton?: boolean;\n  size?: Size;\n  buttonVariant?: ButtonVariants;\n  previewLoading?: boolean;\n  enableEditing?: boolean;\n  editorSettings?: FileEditorSettings;\n  testIdPrefix?: string;\n  canBrowseFiles?: () => Promise<boolean>;\n};\n\nconst tagName = 'firefly-upload';\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    [tagName]: UploadView;\n  }\n\n  interface GlobalEventHandlersEventMap {\n    [FileSelectedEvent.EVENT_NAME]: FileSelectedEvent;\n    [FileChangeEvent.EVENT_NAME]: FileChangeEvent;\n    [FileTypeNotAcceptedEvent.EVENT_NAME]: FileTypeNotAcceptedEvent;\n    [DNIFlaggedEvent.EVENT_NAME]: DNIFlaggedEvent;\n    [UploadValidationErrorEvent.EVENT_NAME]: UploadValidationErrorEvent;\n    [UploadProcessingErrorEvent.EVENT_NAME]: UploadProcessingErrorEvent;\n    [UploadSourceOpenedEvent.EVENT_NAME]: UploadSourceOpenedEvent;\n  }\n}\n\nfunction blobToFile(blob: Blob, fileName: string) {\n  return new File([blob], fileName, { type: blob.type });\n}\n/**\n * @description `firefly-upload` is a custom web component for file upload functionality.\n * It provides a drag and drop zone for file upload and also allows file selection through a file picker dialog.\n * It supports six variants:\n * - 'full': Shows both drag-drop zone and upload button\n * - 'compact': Shows only drag-drop zone\n * - 'button': Shows a single button that opens file picker, transforms to preview when file selected\n * - 'action-button': Shows a single action button that opens file picker, does not transform to preview when file selected\n * - 'icon': Same as 'compact' but without the dropzone, drag-and-drop, or crop overlay functionality.\n * - 'empty-state': Centered layout with title, description, drag-drop zone and upload button for empty state scenarios\n *\n * @fires fileSelected - Fired when a user selects a file, before validation. Always fires when file is selected regardless of validation outcome.\n * @fires fileChanged - Fired when a new file is selected or the current file is removed. The detail of the event contains the new file.\n * @fires fileTypeNotAccepted - Fired when a file of a type not included in `acceptedFileTypes` is dropped in the dropzone. The detail of the event contains the file type.\n * @fires uploadSourceOpened - Fired when the upload source is opened. The detail of the event contains the source.\n * @fires uploadValidationError - Fired when a file fails validation (e.g., file too large, wrong type, custom validation). The detail contains error type, message, and source.\n * @fires uploadProcessingError - Fired when a file fails during processing (e.g., SAM service errors, blob conversion failures). The detail contains error type, message, and source.\n * @fires dniFlagged - Fired when a file is blocked by DNI (Do Not Infer) policy. The detail contains the source of the upload.\n *\n * @cssprop [--firefly-upload-font-size] - Font size of the upload component\n * @cssprop [--firefly-upload-font-color] - Font color of the upload component\n * @cssprop [--firefly-upload-column-spacing] - Column spacing of the upload component\n * @cssprop [--firefly-upload-preview-width] - Width of the upload preview\n * @cssprop [--firefly-upload-preview-width-with-file] - Width of the upload preview when a file is uploaded (overrides default width)\n * @cssprop [--firefly-upload-preview-height] - Height of the upload preview\n * @cssprop [--firefly-upload-preview-border-width] - Border width of the upload preview\n * @cssprop [--firefly-upload-preview-border-radius] - Border radius of the upload preview\n * @cssprop [--firefly-upload-preview-border-color] - Border color of the upload preview\n * @cssprop [--firefly-upload-preview-filled-border-color] - Filled border color of the upload preview\n * @cssprop [--firefly-upload-preview-background-color] - Background color of the upload preview\n * @cssprop [--firefly-upload-preview-hover-background-color] - Hover background color of the upload preview\n * @cssprop [--firefly-upload-preview-file-highlight-color] - File highlight color of the upload preview\n * @cssprop [--firefly-upload-preview-remove-button-color] - Remove button color of the upload preview\n * @cssprop [--firefly-upload-actions-row-gap] - Row gap of the upload actions\n * @cssprop [--firefly-upload-actions-min-width] - Minimum width of the upload actions\n * @cssprop [--firefly-upload-button-background] - Background color of the button/action-button. Falls back to default button styling if not set.\n * @cssprop [--firefly-upload-button-border] - Border color of the button/action-button. Falls back to default button styling if not set.\n * @cssprop [--firefly-upload-button-color] - Color of the button/action-button. Falls back to default button styling if not set.\n * @cssprop [--firefly-upload-empty-state-width] - Width of the empty state drop zone\n * @cssprop [--firefly-upload-empty-state-height] - Height of the empty state drop zone\n * @cssprop [--firefly-upload-empty-state-max-width] - Max width of the empty state drop zone, falls back to default of 512px\n * @cssprop [--firefly-upload-empty-state-max-height] - Max height of the empty state drop zone, falls back to default of 512px\n * @cssprop [--firefly-upload-empty-state-dropzone-padding] - Padding of the empty state drop zone\n * @element firefly-upload\n *\n * @property {BlobRef} fileRef - A blob reference to the currently selected file.\n * @property {string} variant - The variant of the upload component. Can be 'full', 'compact', 'button', or 'action-button'.\n * @property {string} placeholder - The label to be displayed in the placeholder.\n * @property {string} uploadButtonLabel - The label for the upload button.\n * @property {string} acceptedFileTypes - A string of comma-separated MIME types that the upload component should accept.\n * @property {number} aspectRatio - The aspect ratio expected for media files. Currently only enforced in upload cropper.\n * @property {boolean} isMobile - Whether the upload component is in mobile mode.\n * @property {boolean} enableEditing - Whether the upload component is in editing mode.\n * @property {FileEditorSettings} editorSettings - The base file and editor settings for the current uploaded file.\n * @property {string} buttonVariant - The variant of the button. Can be 'primary', 'secondary', 'accent', etc.\n * @property {function} canBrowseFiles - Optional callback to validate before file browsing. Returns Promise<boolean> where true allows browsing, false prevents it.\n *\n * @slot placeHolderIcon - Slot for the placeholder icon.\n * @slot uploadButtonIcon - Slot for the upload button icon.\n * @slot secondaryAction - Slot for secondary action button.\n *\n * @example\n * <firefly-upload\n *   variant=\"full\"\n *   placeholder=\"Drag and drop or click to upload\"\n *   uploadButtonLabel=\"Upload\"\n *   acceptedFileTypes=\"image/jpeg, image/png\">\n *   <sp-icon slot=\"uploadButtonIcon\" size=\"l\"><firefly-icon-upload-to-cloud></firefly-icon-upload-to-cloud></sp-icon>\n *   <sp-icon slot=\"placeHolderIcon\" size=\"xl\"><firefly-icon-upload-to-cloud></firefly-icon-upload-to-cloud></sp-icon>\n * </firefly-upload>\n *\n * @example\n * <firefly-upload\n *   variant=\"action-button\"\n *   uploadButtonLabel=\"Upload File\"\n *   buttonVariant=\"accent\"\n *   acceptedFileTypes=\"image/jpeg, image/png\">\n *   <sp-icon slot=\"uploadButtonIcon\" size=\"l\"><firefly-icon-upload-to-cloud></firefly-icon-upload-to-cloud></sp-icon>\n * </firefly-upload>\n *\n * @example\n * <firefly-upload\n *   variant=\"icon\"\n *   placeholder=\"Upload\"\n *   size=\"s\"\n *   acceptedFileTypes=\"image/jpeg, image/png\">\n *   <sp-icon slot=\"placeHolderIcon\" size=\"m\"><firefly-icon-upload-to-cloud></firefly-icon-upload-to-cloud></sp-icon>\n * </firefly-upload>\n *\n * @example\n * <firefly-upload\n *   variant=\"empty-state\"\n *   uploadButtonLabel=\"Upload image\"\n *   placeholder=\"or drag image file here\"\n *   acceptedFileTypes=\"image/jpeg, image/png\">\n *   <sp-icon slot=\"placeHolderIcon\" size=\"xl\"><firefly-icon-upload-to-cloud></firefly-icon-upload-to-cloud></sp-icon>\n * </firefly-upload>\n */\n\n@customElement(tagName)\nexport class UploadView extends LitElement implements UploadViewProps {\n  static styles = [commonStyles, styles, emptyStateStyles, popoverMenuStyles];\n\n  @property({ type: String }) testIdPrefix?: string;\n\n  @query('#file-input')\n  fileInput!: HTMLInputElement;\n\n  @query('firefly-crop-overlay')\n  cropOverlay!: CropOverlay | null;\n\n  private _fileRef: BlobRef | null = null;\n\n  // Needs custom accessor to ensure fileRef's provided by the consumer affect the fileType.\n  @property({ type: Object, reflect: true })\n  get fileRef(): BlobRef | null {\n    return this._fileRef;\n  }\n\n  set fileRef(value: BlobRef | null) {\n    this.setFile(value);\n  }\n\n  @property({ type: String, reflect: true }) variant: Variant = 'compact';\n\n  @property({ type: String }) placeholder?: string;\n\n  @property({ type: String }) uploadButtonLabel?: string;\n\n  @property({ type: String }) uploadButtonSize?: Size;\n\n  @property({ type: String }) browseButtonSize?: Size;\n\n  @property({ type: String }) uploadButtonTreatment?: ButtonTreatments;\n\n  @property({ type: String }) uploadButtonVariant?: ButtonVariants;\n\n  @property({ type: String }) browseButtonTreatment?: ButtonTreatments;\n\n  @property({ type: String }) browseButtonLabel?: string;\n\n  @property({ type: String }) acceptedFileTypes = '';\n\n  @property({ type: Object }) contentAuthenticity?: ContentAuthenticityService = undefined;\n\n  @property({ type: Object }) authentication?: AuthenticationService = undefined;\n\n  @property({ type: Object }) environment?: EnvironmentService = undefined;\n\n  @property({ type: Object }) sam?: SamService = undefined;\n\n  @property({ type: Boolean }) enableUniversalAssetPicker = false;\n\n  @property({ type: Boolean }) enableUniversalAssetPickerMobile = false;\n\n  @property({ type: Boolean }) enableAddToBoard = false;\n\n  @property({ type: Boolean }) enableAddToCloud = false;\n\n  @property({ type: Boolean }) enableSharePublicLink = false;\n\n  @property({ type: Boolean }) enableProjectsTabInDocumentPicker = false;\n\n  @property({ type: Boolean }) disabled = false;\n\n  @property({ type: Boolean }) isMobile = false;\n\n  @property({ type: Boolean, reflect: true }) centerClearButton = false;\n\n  @property({ type: String, reflect: true }) size = 'm' as Size;\n\n  @property({ type: Number }) aspectRatio: number | null = null;\n\n  @property({ type: String }) hostType: Host = 'web';\n\n  @property({ type: String, reflect: true }) previewBorderType: 'solid' | 'none' = 'solid';\n\n  @property({ type: Boolean, reflect: true }) previewLoading = false;\n\n  // Currently, our blob hashing function can only handle files up to 200MB.\n  @property({ type: Number, reflect: true }) maxFileSize = 200 * 1024 * 1024;\n\n  /**\n   * The localized strings for the component.\n   * These can be provided by the consuming application.\n   */\n  @property({ type: Object })\n  localized: Localized<typeof unlocalized> = localizeBundleDefault(unlocalized);\n\n  /**\n   * The settings needed to produce the current file (if it was edited).\n   */\n  @property({ type: Object }) editorSettings?: FileEditorSettings;\n\n  @property({ type: Boolean }) enableEditing = false;\n\n  @property({ attribute: false }) validate?: (file: File) => Promise<{ error: string; message?: string } | undefined>;\n\n  @state() fileName = '';\n\n  /** Unreliable but synchronous. Only use for UI rendering. Use fileTypeAsync() for business logic. */\n  @state() fileType = '';\n\n  @state() private showDNIFlaggedModal = false;\n\n  @state() private showUniversalAssetPicker = false;\n\n  @state() private showingUploadOptions = false;\n\n  @property({ type: String })\n  buttonVariant: ButtonVariants = 'primary';\n\n  @property({ type: String }) emptyStateTitle?: string;\n\n  @property({ type: String }) emptyStateDescription?: string;\n\n  @property({ attribute: false }) canBrowseFiles?: () => Promise<boolean>;\n\n  @property({ type: Boolean }) hideOverlays = false;\n\n  @property({ type: String }) cropOverlayPlacement?: Placement;\n\n  async fileTypeAsync() {\n    if (!this.fileRef) return null;\n    return getMimeType(this.fileRef);\n  }\n\n  /** Unreliable but synchronous. Only use for UI rendering. Use isUploadImageAsync() for business logic. */\n  get isUploadImage() {\n    return isImageType(this.fileType);\n  }\n\n  async isUploadImageAsync() {\n    const mimeType = await this.fileTypeAsync();\n    if (!mimeType) return false;\n    return isImageType(mimeType);\n  }\n\n  /**\n   * `true` if the user should be shown the option to upload from their device\n   * or from their Adobe cloud storage. `false` to only upload from their device.\n   */\n  get showUploadOptions() {\n    return this.isMobile ? this.enableUniversalAssetPickerMobile : this.enableUniversalAssetPicker;\n  }\n\n  editorSettingsOrDefault() {\n    return this.editorSettings ?? (this.fileRef ? { baseFileRef: this.fileRef } : undefined);\n  }\n\n  async onDragZoneDrop(event: Event & { detail: DropzoneEventDetail }) {\n    if (this.disabled) return;\n    const files = event.detail.dataTransfer?.files;\n    const droppedFile = files?.item(0);\n    if (!droppedFile) return;\n\n    // Dispatch fileSelected event BEFORE validation - this always fires when user selects a file\n    this.dispatchEvent(new FileSelectedEvent(droppedFile, 'drag'));\n\n    if (this.acceptedFileTypes && !this.acceptedFileTypes.includes(droppedFile.type)) {\n      this.dispatchEvent(new FileTypeNotAcceptedEvent(droppedFile.type, 'drag'));\n      return;\n    }\n\n    await this.handleFileChanged(droppedFile, 'drag');\n  }\n\n  clearFileInput() {\n    this.fileInput.value = '';\n    this.fileInput.files = null;\n  }\n\n  clearFileInfo(source?: 'click' | 'drag') {\n    this.fileName = '';\n    this.fileRef = null;\n    this.dispatchEvent(new FileChangeEvent(undefined, source));\n  }\n\n  async onRemoveButtonClick(event: Event) {\n    event.preventDefault();\n    event.stopPropagation();\n\n    this.clearFileInput();\n\n    await this.handleFileChanged(undefined);\n  }\n\n  async onFileInputChange() {\n    // Dispatch fileSelected event BEFORE validation - this always fires when user selects a file\n    if (this.fileInput.files && this.fileInput.files.length > 0) {\n      const file = this.fileInput.files[0];\n      this.dispatchEvent(new FileSelectedEvent(file, 'click'));\n    }\n\n    if (this.acceptedFileTypes && this.fileInput.files) {\n      for (let i = 0; i < this.fileInput.files.length; i++) {\n        const file = this.fileInput.files[i];\n        if (!file.type || !this.acceptedFileTypes.includes(file.type)) {\n          this.dispatchEvent(new FileTypeNotAcceptedEvent(file.type, 'click'));\n          return;\n        }\n      }\n    }\n\n    if (this.fileInput.files && this.fileInput.files.length > 0) {\n      const file = this.fileInput.files[0];\n      this.clearFileInput();\n\n      await this.handleFileChanged(file, 'click');\n      this.maybeTriggerEditor();\n    }\n  }\n\n  triggerFilePicker() {\n    if (this.disabled) return;\n    this.dispatchEvent(new UploadSourceOpenedEvent('device'));\n    this.fileInput.click();\n    if (this.variant === 'popover-menu') {\n      this.dispatchEvent(\n        new Event('close', {\n          bubbles: true,\n          composed: true,\n        })\n      );\n    }\n  }\n\n  async triggerUAP() {\n    if (this.disabled) return;\n    this.showUniversalAssetPicker = true;\n  }\n\n  async handleBrowseFilesClick() {\n    if (this.canBrowseFiles) {\n      // If a callback is provided, use it to check if the user can browse files\n      const result = await this.canBrowseFiles();\n      if (!result) return;\n    }\n    this.dispatchEvent(new UploadSourceOpenedEvent('cloud'));\n    this.triggerUAP();\n  }\n\n  /**\n   * If the file needs to be edited to satisfy constraints, this will show the user the editor.\n   * (For example, cropping an image if the aspect ratio is wrong.)\n   */\n  async maybeTriggerEditor() {\n    if (!(await this.isUploadImageAsync()) || !this.aspectRatio) return;\n\n    const size = await getMediaSize(this.fileRef);\n    if (!size) return;\n\n    const epsilon = 0.01;\n    const uploadHasExpectedAspectRatio = Math.abs(getNumericAspectRatio(size) - this.aspectRatio) <= epsilon;\n    if (!uploadHasExpectedAspectRatio) this.cropOverlay?.activate();\n  }\n\n  private currentUploadSource?: 'click' | 'drag';\n\n  async validateFile(newFile: File): Promise<boolean> {\n    // Size validation\n    if (newFile.size > this.maxFileSize) {\n      this.dispatchEvent(\n        new UploadValidationErrorEvent(\n          uploadValidationErrors.fileTooLarge,\n          `File is too large to upload. Maximum file size is ${this.maxFileSize / 1000_000} MB.`,\n          this.currentUploadSource\n        )\n      );\n      return false;\n    }\n    // File type validation\n    if (this.acceptedFileTypes && !this.acceptedFileTypes.includes(newFile.type)) {\n      this.dispatchEvent(\n        new UploadValidationErrorEvent(\n          uploadValidationErrors.fileTypeNotAccepted,\n          `File type ${newFile.type} is not accepted. Expected types: ${this.acceptedFileTypes}`,\n          this.currentUploadSource\n        )\n      );\n      return false;\n    }\n    // Custom validation function\n    if (this.validate) {\n      const validationResult = await this.validate(newFile);\n      if (validationResult) {\n        this.dispatchEvent(new UploadValidationErrorEvent(validationResult.error, validationResult.message, this.currentUploadSource));\n        return false;\n      }\n    }\n    return true;\n  }\n\n  setFile(value: BlobRef | null) {\n    if (equals(value, this._fileRef)) return;\n    const oldValue = this._fileRef;\n    this._fileRef = value;\n    // Because this is async, we cannot rely on fileType except for UI rendering. Perhaps the name should reflect that?\n    if (value) getMimeType(value).then(mimeType => (this.fileType = mimeType ?? ''));\n    this.maybeTriggerEditor();\n    this.requestUpdate('fileRef', oldValue);\n  }\n\n  async handleFileChanged(newFile: File | undefined, source?: 'click' | 'drag', editorSettings?: FileEditorSettings) {\n    if (!newFile) {\n      this.clearFileInfo(source);\n      return;\n    }\n\n    // Store the source for validation error events\n    this.currentUploadSource = source;\n\n    // It *may* make sense to move this into setFile, but that would incur extra (sometimes slow) operation\n    // on files that are already validated except in some edge cases like deep linking.\n    if (!(await this.validateFile(newFile))) {\n      return;\n    }\n\n    const blobRef = await blobStore.getRef(newFile);\n\n    const skipDNI = !!editorSettings; // We know this is valid because it's an edited valid file.\n    if (blobRef && this.contentAuthenticity && !skipDNI) {\n      const canInfer = await this.contentAuthenticity.isInferenceAllowed(blobRef);\n      if (!canInfer) {\n        this.dispatchEvent(new DNIFlaggedEvent(this.currentUploadSource));\n        this.showDNIFlaggedModal = true;\n        return;\n      }\n    }\n\n    this.setFile(blobRef);\n    this.editorSettings = editorSettings;\n    this.fileName = newFile.name;\n\n    this.dispatchEvent(new FileChangeEvent(newFile, source, this.editorSettingsOrDefault()));\n  }\n\n  async handleUploadEdited(event: UploadEditedEvent) {\n    const editedBlobRef = await getEditedFile(event.detail.editorSettings);\n\n    if (JSON.stringify(editedBlobRef) === JSON.stringify(this.fileRef)) return;\n\n    const blob = await blobStore.getBlob(editedBlobRef);\n\n    if (!blob) return;\n\n    const file = blobToFile(blob, this.fileName);\n    // Source should not be `click`, but the 'click' | 'drag' type is pasted verbatim throughout the codebase, so that will have to change later.\n    this.handleFileChanged(file, 'click', event.detail.editorSettings);\n  }\n\n  closeModal(showModalType: 'showDNIFlaggedModal') {\n    this[showModalType] = false;\n  }\n\n  handleDNIFlaggedModalCancel() {\n    this.closeModal('showDNIFlaggedModal');\n  }\n\n  handleDNIFlaggedModalConfirm() {\n    this.closeModal('showDNIFlaggedModal');\n    this.triggerFilePicker();\n  }\n\n  renderDNIFlaggedModal() {\n    return html`\n      <firefly-dni-flagged-modal\n        .localized=${this.localized.dniFlaggedModal}\n        .hostType=${this.hostType}\n        @dniFlaggedCancel=${this.handleDNIFlaggedModalCancel}\n        @dniFlaggedConfirm=${this.handleDNIFlaggedModalConfirm}>\n      </firefly-dni-flagged-modal>\n    `;\n  }\n\n  renderPlaceHolder() {\n    // UAP does not support a mobile UI yet, so disable UAP on mobile.\n    if (this.showUploadOptions) {\n      if (this.authentication && this.environment) {\n        return this.renderUploadOptionsOverlayTrigger(html`\n          <button\n            class=\"upload-preview-placeholder\"\n            aria-label=${this.localized.uploadAriaLabel}\n            data-testid=\"placeholder-upload-button\"\n            ?disabled=${this.disabled}>\n            <slot name=\"placeHolderIcon\"></slot>${this.placeholder ? html`<span>${this.placeholder}</span>` : nothing}\n          </button>\n        `);\n      } else {\n        console.warn('Component Service not provided. UAP will not be available.');\n      }\n    }\n\n    return html`<slot name=\"placeholder\">\n      <button\n        class=${classMap({\n          'upload-preview-placeholder': true,\n          'upload-preview-placeholder-loading-no-border': this.previewBorderType === 'none' && this.previewLoading,\n        })}\n        aria-label=${this.localized.uploadAriaLabel}\n        data-testid=\"placeholer-upload-button\"\n        @click=${this.triggerFilePicker}\n        ?disabled=${this.disabled}>\n        <slot name=\"placeHolderIcon\"></slot> ${this.placeholder ? html`<span>${this.placeholder}</span>` : nothing}\n      </button>\n    </slot>`;\n  }\n\n  renderUploadOptionsOverlayTrigger(trigger: TemplateResult) {\n    const handleOpened = () => (this.showingUploadOptions = true);\n    const onOverlayClosed = () => (this.showingUploadOptions = false);\n    const stopCloseEventPropagation = (e: Event) => {\n      e.stopPropagation();\n      onOverlayClosed();\n    };\n    return html`\n      <overlay-trigger\n        triggered-by=\"click\"\n        placement=${this.isMobile ? 'top' : 'top-start'}\n        @sp-opened=${handleOpened}\n        @sp-closed=${onOverlayClosed}\n        @close=${stopCloseEventPropagation}>\n        <div slot=\"trigger\" class=\"upload-options-trigger\" data-testid=\"upload-button-trigger\">${trigger}</div>\n        <sp-popover slot=\"click-content\">${this.renderUploadOptions()}</sp-popover>\n      </overlay-trigger>\n    `;\n  }\n\n  renderUploadOptions() {\n    const testIdPrefix = this.testIdPrefix ? `${this.testIdPrefix}-` : '';\n    return html`\n      <sp-menu class=\"upload-options-menu\" data-testid=\"${testIdPrefix}upload-options-menu\">\n        <sp-menu-item\n          data-testid=\"${testIdPrefix}local-file-picker-button\"\n          @click=${this.triggerFilePicker}\n          onClick=\"\n                this.dispatchEvent(\n                    new Event('close', {\n                        bubbles: true,\n                        composed: true,\n                    })\n                );\n            \">\n          <sp-icon slot=\"icon\" size=\"s\" class=\"upload-options-item-icon\">\n            <firefly-icon-file-import></firefly-icon-file-import>\n          </sp-icon>\n          ${this.localized.yourDevice}\n        </sp-menu-item>\n        <sp-menu-item data-testid=\"${testIdPrefix}cloud-storage-button\" @click=${this.handleBrowseFilesClick}>\n          <sp-icon slot=\"icon\" size=\"s\" class=\"upload-options-item-icon\">\n            <firefly-icon-adobe-cloud-storage></firefly-icon-adobe-cloud-storage>\n          </sp-icon>\n          ${this.localized.adobeCloudStorage}\n          <span slot=\"description\">${this.localized.includesGenerationHistory}</span>\n        </sp-menu-item>\n      </sp-menu>\n    `;\n  }\n\n  renderFilePreview(options: { onImageClick?: () => void } = {}) {\n    return html`<firefly-file-preview\n      id=\"file-preview\"\n      .fileInfo=${{\n        ref: this.fileRef,\n        type: this.fileType,\n        name: this.fileName,\n      }}\n      .centerClearButton=${this.centerClearButton}\n      .localized=${this.localized.filePreview}\n      @imageClick=${options.onImageClick}\n      @removeClick=${this.onRemoveButtonClick}></firefly-file-preview>`;\n  }\n\n  renderPreviewCropOverlay() {\n    if (this.hideOverlays) {\n      return this.renderFilePreview({ onImageClick: this.isMobile ? undefined : this.triggerFilePicker });\n    }\n\n    // On mobile, when editing is enabled, don't wrap the preview in upload options trigger\n    // to avoid conflict between crop overlay tray and upload options menu\n    const shouldWrapInUploadOptions = this.showUploadOptions && !(this.isMobile && this.enableEditing);\n\n    return html`<firefly-crop-overlay\n      .editorSettings=${this.editorSettingsOrDefault()}\n      .aspectRatio=${this.aspectRatio}\n      .isMobile=${this.isMobile}\n      .localized=${this.localized.cropOverlay}\n      .placement=${this.cropOverlayPlacement ?? 'top'}\n      ?disabled=${!this.enableEditing || this.showingUploadOptions}\n      @uploadEdited=${this.handleUploadEdited}>\n      ${shouldWrapInUploadOptions\n        ? this.renderUploadOptionsOverlayTrigger(this.renderFilePreview())\n        : this.renderFilePreview({ onImageClick: this.isMobile ? undefined : this.triggerFilePicker })}\n    </firefly-crop-overlay> `;\n  }\n\n  renderActionsContainer() {\n    return html`<div class=\"upload-container-actions\">\n      ${this.showUploadOptions\n        ? this.renderUploadOptionsOverlayTrigger(html`\n            <sp-button size=\"s\" treatment=\"fill\" variant=\"primary\" data-testid=\"add-image-upload-button\">\n              <slot slot=\"icon\" name=\"uploadButtonIcon\"></slot> ${this.uploadButtonLabel}\n            </sp-button>\n          `)\n        : html`<sp-button\n            size=\"${this.uploadButtonSize ?? 's'}\"\n            treatment=\"fill\"\n            variant=\"${this.buttonVariant ?? 'primary'}\"\n            @click=${this.triggerFilePicker}\n            data-testid=\"file-picker-upload-button\">\n            <slot slot=\"icon\" name=\"uploadButtonIcon\"></slot> ${this.uploadButtonLabel}\n          </sp-button>`}\n      <slot name=\"secondaryAction\"></slot>\n    </div>`;\n  }\n\n  renderButton() {\n    return this.showUploadOptions\n      ? this.renderUploadOptionsOverlayTrigger(html`\n          <sp-button size=${this.size} treatment=\"fill\" variant=\"primary\" data-testid=\"add-image-upload-button\">\n            <slot slot=\"icon\" name=\"uploadButtonIcon\"></slot> ${this.uploadButtonLabel}\n          </sp-button>\n        `)\n      : html`<sp-button\n          size=${this.size}\n          treatment=\"fill\"\n          variant=${this.buttonVariant}\n          @click=${this.triggerFilePicker}\n          data-testid=\"upload-button\">\n          <slot slot=\"icon\" name=\"uploadButtonIcon\"></slot> ${this.uploadButtonLabel}\n        </sp-button>`;\n  }\n\n  renderActionButton() {\n    return html`<sp-button\n      size=${this.size}\n      treatment=\"fill\"\n      ?icon-only=${this.isMobile}\n      ?disabled=${this.disabled}\n      variant=${this.buttonVariant}\n      @click=${this.triggerFilePicker}\n      data-testid=\"upload-action-button\">\n      <slot slot=\"icon\" name=\"uploadButtonIcon\"></slot> ${this.uploadButtonLabel}\n    </sp-button>`;\n  }\n\n  renderPreview() {\n    return html` <div\n      class=${classMap({\n        'upload-preview': true,\n        'upload-preview--medium': this.size === 'm',\n        'upload-preview--large': this.size === 'l',\n        'upload-preview--small': this.size === 's',\n        'upload-preview--with-file': !!this.fileRef,\n      })}>\n      ${this.fileRef ? this.renderPreviewCropOverlay() : this.renderPlaceHolder()}\n    </div>`;\n  }\n\n  renderIconVariant() {\n    return html` <div\n      class=${classMap({\n        'upload-preview': true,\n        'upload-preview--medium': this.size === 'm',\n        'upload-preview--large': this.size === 'l',\n        'upload-preview--small': this.size === 's',\n        'upload-preview--with-file': !!this.fileRef,\n      })}>\n      ${this.fileRef ? this.renderFilePreview() : this.renderPlaceHolder()}\n    </div>`;\n  }\n\n  // Since we have so many variants, instead of handling each one in the render function, we'll use a switch statement and return the appropriate template.\n  renderUploadVariant = () => {\n    switch (this.variant) {\n      case 'empty-state':\n        return emptyStatePresentation.render({\n          uploadButtonLabel: this.uploadButtonLabel,\n          browseButtonLabel: this.browseButtonLabel,\n          disabled: this.disabled,\n          showUploadOptions: this.showUploadOptions,\n          onDragZoneDrop: (e: Event) => this.onDragZoneDrop(e as unknown as Event & { detail: DropzoneEventDetail }),\n          onUploadButtonClick: this.triggerFilePicker,\n          onBrowseFilesClick: this.showUploadOptions ? this.handleBrowseFilesClick : undefined,\n          onFileInputChange: this.onFileInputChange,\n          acceptedFileTypes: this.acceptedFileTypes,\n          uploadButtonVariant: this.uploadButtonVariant,\n          uploadButtonSize: this.uploadButtonSize,\n          browseButtonSize: this.browseButtonSize,\n          uploadButtonTreatment: this.uploadButtonTreatment,\n          browseButtonTreatment: this.browseButtonTreatment,\n          isMobile: this.isMobile,\n        });\n      case 'popover-menu':\n        return popoverMenuPresentation.render({\n          uploadButtonLabel: this.uploadButtonLabel,\n          browseButtonLabel: this.browseButtonLabel,\n          onUploadButtonClick: this.triggerFilePicker,\n          onBrowseFilesClick: this.showUploadOptions ? this.handleBrowseFilesClick : undefined,\n          onFileInputChange: this.onFileInputChange,\n          acceptedFileTypes: this.acceptedFileTypes,\n          showUploadOptions: this.showUploadOptions,\n        });\n      default:\n        return html`\n          <div\n            class=${classMap({\n              'upload-container': true,\n              button: this.variant === 'button',\n              icon: this.variant === 'icon',\n              disabled: this.disabled,\n            })}>\n            <input type=\"file\" id=\"file-input\" style=\"display: none\" @change=${this.onFileInputChange} accept=${this.acceptedFileTypes} />\n            <!-- TODO: Refactor this nested ternary into the switch statement above -->\n            ${this.variant === 'button'\n              ? this.fileRef\n                ? this.renderPreview()\n                : this.renderButton()\n              : this.variant === 'action-button'\n                ? this.renderActionButton() // if variant is action-button, no file preview is shown\n                : this.variant === 'icon'\n                  ? this.renderIconVariant()\n                  : html`<sp-dropzone class=\"upload-dropzone\" dragged=\"true\" @sp-dropzone-drop=${this.onDragZoneDrop}>\n                      ${this.renderPreview()} ${this.variant === 'full' ? this.renderActionsContainer() : nothing}\n                    </sp-dropzone>`}\n          </div>\n        `;\n    }\n  };\n\n  render() {\n    return html`\n      <!-- Render the upload variant -->\n      ${this.renderUploadVariant()}\n      <!-- Render the universal asset picker -->\n      ${this.showUniversalAssetPicker\n        ? html`<firefly-uap\n            .authentication=${this.authentication}\n            .environment=${this.environment}\n            ?enableUniversalAssetPickerMobile=${this.enableUniversalAssetPickerMobile}\n            ?enableProjectsTabInDocumentPicker=${this.enableProjectsTabInDocumentPicker}\n            ?enableAddToBoard=${this.enableAddToBoard}\n            ?enableAddToCloud=${this.enableAddToCloud}\n            ?enableSharePublicLink=${this.enableSharePublicLink}\n            .accept=${this.acceptedFileTypes ? this.acceptedFileTypes.split(',').map(type => type.trim()) : undefined}\n            ?isMobile=${this.isMobile}\n            @close=${(e: Event) => {\n              e.stopPropagation();\n              this.showUniversalAssetPicker = false;\n              // Dispatch a close event so any containing overlay/popover can close.\n              if (this.variant === 'popover-menu') {\n                this.dispatchEvent(\n                  new Event('close', {\n                    bubbles: true,\n                    composed: true,\n                  })\n                );\n              }\n            }}\n            @openFileInput=${(e: Event) => {\n              e.stopPropagation();\n              this.triggerFilePicker();\n            }}\n            @assetSelected=${async (e: AssetSelectedEvent) => {\n              e.stopPropagation();\n              // Retrieve file from Adobe cloud storage\n              try {\n                const file = await this.sam?.getFileFromAsset(e.detail.asset);\n                if (!file) {\n                  // Track when cloud storage returns no file\n                  this.dispatchEvent(\n                    new UploadProcessingErrorEvent(\n                      uploadProcessingErrors.samFetchFailed,\n                      'Unable to retrieve file from Adobe cloud storage',\n                      undefined\n                    )\n                  );\n                  this.showUniversalAssetPicker = false;\n                  if (this.variant === 'popover-menu') {\n                    this.dispatchEvent(new Event('close', { bubbles: true, composed: true }));\n                  }\n                  return;\n                }\n                // Dispatch fileSelected event when file is retrieved from cloud storage\n                this.dispatchEvent(new FileSelectedEvent(file, undefined));\n                await this.handleFileChanged(file);\n              } catch (error) {\n                // Track service errors (503, network failures, etc.)\n                const errorMessage = error instanceof Error ? error.message : String(error);\n                this.dispatchEvent(\n                  new UploadProcessingErrorEvent(uploadProcessingErrors.samFetchError, `Error retrieving file: ${errorMessage}`, undefined)\n                );\n                this.showUniversalAssetPicker = false;\n                if (this.variant === 'popover-menu') {\n                  this.dispatchEvent(new Event('close', { bubbles: true, composed: true }));\n                }\n                throw error;\n              }\n            }}>\n          </firefly-uap>`\n        : nothing}\n      <!-- Render the DNI flagged modal -->\n      ${this.showDNIFlaggedModal ? this.renderDNIFlaggedModal() : nothing}\n    `;\n  }\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\n// This file is generated. Do not edit.\nimport { TemplateResult, html } from 'lit';\nimport { customElement } from 'lit/decorators.js';\n\nimport { IconBase } from '@spectrum-web-components/icon';\n\nconst tagName = 'firefly-icon-adobe-cloud-storage';\n\n@customElement(tagName)\nexport class IconAdobeCloudStorage extends IconBase {\n  protected override render(): TemplateResult {\n    return html`\n      <svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n        <path\n          d=\"M16.4593 0H3.54065C1.5852 0 0 1.64392 0 3.67179V16.3282C0 18.3561 1.5852 20 3.54065 20H16.4593C18.4148 20 20 18.3561 20 16.3282V3.67179C20 1.64392 18.4148 0 16.4593 0Z\"\n          fill=\"#EB1000\" />\n        <path\n          d=\"M15.506 15.1851H13.1767C13.0755 15.187 12.976 15.1575 12.891 15.1003C12.8059 15.043 12.7391 14.9607 12.699 14.8637L10.1703 8.69315C10.1637 8.66913 10.1499 8.64797 10.1308 8.6328C10.1118 8.61763 10.0886 8.60926 10.0646 8.60893C10.0407 8.60861 10.0173 8.61634 9.99789 8.63099C9.97849 8.64564 9.96412 8.66642 9.95692 8.69025L8.38106 12.6081C8.37251 12.6293 8.36911 12.6523 8.37117 12.6752C8.37323 12.6981 8.38069 12.7201 8.39288 12.7393C8.40506 12.7584 8.4216 12.7742 8.44102 12.785C8.46044 12.7959 8.48213 12.8016 8.50416 12.8016H10.2363C10.2888 12.8016 10.3401 12.8177 10.3839 12.848C10.4276 12.8782 10.4619 12.9212 10.4823 12.9716L11.2407 14.733C11.2608 14.7824 11.2689 14.8363 11.2642 14.8897C11.2595 14.9432 11.2421 14.9946 11.2138 15.0394C11.1854 15.0842 11.1468 15.1209 11.1015 15.1463C11.0562 15.1718 11.0055 15.1851 10.9541 15.1851H4.64808C4.60065 15.1848 4.55403 15.1723 4.51237 15.1486C4.47071 15.1249 4.4353 15.0909 4.40931 15.0495C4.38332 15.0081 4.36755 14.9606 4.3634 14.9113C4.35926 14.862 4.36687 14.8124 4.38556 14.7669L8.39667 4.79786C8.43766 4.69235 8.50818 4.60219 8.59903 4.53915C8.68988 4.47612 8.79682 4.44313 8.90591 4.4445H11.2194C11.3285 4.44299 11.4355 4.47592 11.5264 4.53898C11.6173 4.60203 11.6878 4.69227 11.7287 4.79786L15.7676 14.7669C15.7863 14.8123 15.7939 14.8618 15.7898 14.9111C15.7857 14.9603 15.77 15.0078 15.7441 15.0491C15.7182 15.0905 15.6829 15.1246 15.6414 15.1483C15.5998 15.172 15.5533 15.1847 15.506 15.1851Z\"\n          fill=\"white\" />\n      </svg>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    [tagName]: IconAdobeCloudStorage;\n  }\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\n// This file is generated. Do not edit.\nimport { TemplateResult, html } from 'lit';\nimport { customElement } from 'lit/decorators.js';\n\nimport { IconBase } from '@spectrum-web-components/icon';\n\nconst tagName = 'firefly-icon-file-import';\n\n@customElement(tagName)\nexport class IconFileImport extends IconBase {\n  protected override render(): TemplateResult {\n    return html`\n      <svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n        <mask id=\"mask0_2107_7009\" style=\"mask-type:alpha\" maskUnits=\"userSpaceOnUse\" x=\"0\" y=\"0\" width=\"20\" height=\"20\">\n          <path\n            d=\"M8.3252 12.4697C8.03223 12.7627 8.03223 13.2373 8.3252 13.5303C8.47168 13.6768 8.66309 13.75 8.85547 13.75C9.04785 13.75 9.23926 13.6768 9.38574 13.5303L12.3857 10.5303C12.6787 10.2373 12.6787 9.7627 12.3857 9.46973L9.38574 6.46973C9.09277 6.17676 8.61816 6.17676 8.32519 6.46973C8.03222 6.7627 8.03222 7.23731 8.32519 7.53028L10.0449 9.25001H0.894531C0.480471 9.25001 0.144531 9.58595 0.144531 10C0.144531 10.4141 0.480471 10.75 0.894531 10.75H10.0449L8.3252 12.4697Z\"\n            fill=\"currentColor\" />\n          <path\n            d=\"M14.75 2.02148H6.25C5.00977 2.02148 4 3.03125 4 4.27148V6.23925C4 6.65331 4.33594 6.98925 4.75 6.98925C5.16406 6.98925 5.5 6.65331 5.5 6.23925V4.27148C5.5 3.85839 5.83691 3.52148 6.25 3.52148H14.75C15.1631 3.52148 15.5 3.85839 15.5 4.27148V15.7715C15.5 16.1846 15.1631 16.5215 14.75 16.5215H6.45312C6.04003 16.5215 5.70312 16.1846 5.70312 15.7715V13.7275C5.70312 13.3135 5.36718 12.9775 4.95312 12.9775C4.53906 12.9775 4.20312 13.3135 4.20312 13.7275V15.7715C4.20312 17.0117 5.21289 18.0215 6.45312 18.0215H14.75C15.9902 18.0215 17 17.0117 17 15.7715V4.27148C17 3.03125 15.9902 2.02148 14.75 2.02148Z\"\n            fill=\"currentColor\" />\n        </mask>\n        <g mask=\"url(#mask0_2107_7009)\">\n          <rect width=\"20\" height=\"20\" fill=\"currentColor\" />\n        </g>\n      </svg>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    [tagName]: IconFileImport;\n  }\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport type { SAM } from '@ccx-public/collaboration-sdk';\n\nexport class AssetSelectedEvent extends CustomEvent<{ asset: SAM.AdobeAsset }> {\n  static readonly EVENT_NAME = 'assetSelected';\n\n  constructor(asset: SAM.AdobeAsset) {\n    super(AssetSelectedEvent.EVENT_NAME, {\n      bubbles: true,\n      composed: true,\n      detail: { asset },\n    });\n  }\n}\n\nexport class CloseEvent extends Event {\n  static readonly EVENT_NAME = 'close';\n\n  constructor() {\n    super(CloseEvent.EVENT_NAME, { bubbles: true, composed: true });\n  }\n}\n\nexport class OpenFileInputEvent extends Event {\n  static readonly EVENT_NAME = 'openFileInput';\n\n  constructor() {\n    super(OpenFileInputEvent.EVENT_NAME, { bubbles: true, composed: true });\n  }\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\n/**\n * Supported image file types that can be handled by the UAP component.\n */\nexport const SUPPORTED_IMAGE_TYPES = [\n  'document/vnd.adobe.cpsd+dcx',\n  'application/vnd.adobe.hz.express+dcx',\n  'document/vnd.adobe.illustrator+dcx',\n  'application/vnd.adobe.firefly-generation-image+dcx',\n  'application/pdf',\n  'image/jpeg',\n  'image/png',\n  'image/jpg',\n  'image/webp',\n  'image/svg+xml',\n] as const;\n\n/**\n * Supported video file types that can be handled by the UAP component.\n */\nexport const SUPPORTED_VIDEO_TYPES = ['video/mp4', 'video/quicktime', 'application/vnd.adobe.firefly-generation-video+dcx'] as const;\n\nexport function getCompatibleTypes(acceptedTypes: string[]): string[] {\n  const compatibleTypes = new Set(acceptedTypes);\n\n  // if any image types are accepted, include all supported image types\n  const hasImageTypes = acceptedTypes.some(type => type.startsWith('image/'));\n\n  if (hasImageTypes) {\n    SUPPORTED_IMAGE_TYPES.forEach(type => compatibleTypes.add(type));\n  }\n\n  // if any video types are accepted, include all supported video types\n  const hasVideoTypes = acceptedTypes.some(type => type.startsWith('video/'));\n\n  if (hasVideoTypes) {\n    SUPPORTED_VIDEO_TYPES.forEach(type => compatibleTypes.add(type));\n  }\n\n  return Array.from(compatibleTypes);\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { type AssetBrowser } from '@ccx-public/collaboration-sdk';\n\nconst API_KEY = 'clio-playground-web';\n\n// This method returns type `IUAPHostProductData`, but that type is not exposed\n// through the collaboration-sdk.\n// https://git.corp.adobe.com/CCX/cloud-shared-components/blob/main/packages/uap/src/interfaces/IUAPHostProductData.ts#L23\nexport function getUAPConfig(featureFlags?: AssetBrowser.ICDOHostProductData['featureFlags']) {\n  return {\n    apiKey: API_KEY,\n    clientId: API_KEY,\n    dcxId: API_KEY,\n    documentFilter: [],\n    productId: API_KEY,\n    productName: 'GenAI Playground',\n    platform: 'Web',\n    platformVersion: '',\n    productLocation: API_KEY,\n    samLogLevel: 2,\n    cdoLogLevel: 0,\n    linkableTypes: [],\n    featureFlags: {\n      cdpTabs: true,\n      disableACPL: true,\n      disableCloudDocPrefetch: true,\n      disableRecentsTab: false,\n      disableSharedWithYouTab: false,\n      emptyViewLoggedOutMessage: true,\n      enableAssetRef: false,\n      enableCDPOnboarding: false,\n      enableCloudDocExport: true,\n      enableCloudDocFolders: true,\n      enableCloudDocMultiSelectOpen: false,\n      enableCloudDocPinning: false,\n      enableCloudDocRename: true,\n      enablePlaceEmbedWarningToast: false,\n      enableProjects: true,\n      enableCloudFiles: false,\n      enableSAM: true,\n      enableSAMJS: true,\n      useLegacySWY: false,\n      focusManagementEnabled: true,\n      useAdobeReactVirtualized: false,\n      useCDPDeletedTab: false,\n      useOrganizerMode: false,\n      enableFilter: true,\n      enableCloudDocPreview: false,\n      isLinkMode: false,\n      disableLinkCheckbox: false,\n      useCCDmode: false,\n      useCCDAssetContext: true,\n      useMobxStrictMode: false,\n      enableCloudDocImport: true,\n      enableDragDrop: false,\n      enableImportDrop: false,\n      useHostCallbackForImport: true,\n      useDiscardedSource: true,\n      enableFloatingToasts: true,\n      enableContextMenu: false,\n      enableSWYAndRLFilters: false,\n      enableCDOActionBar: false,\n      enableIconsWithActions: false,\n      enableUnifiedSelectionUX: false,\n      enableGenerationHistoryTab: true,\n      enableAddToBoard: false,\n      enableAddToCloud: false,\n      enableSharePublicLink: false,\n      enableProjectsTab: false,\n      hideRecentsHeader: true,\n      hideGridItemAppIcon: true,\n      ...featureFlags,\n    },\n  };\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { AssetBrowser, ColorScheme, SAM, SharedContext } from '@ccx-public/collaboration-sdk';\nimport { html } from 'lit';\n\nimport '@spectrum-web-components/dialog/sp-dialog-base.js';\nimport '@spectrum-web-components/overlay/sp-overlay.js';\n\nimport '../tray-panel/tray-panel.js';\n\n// This type is pulled from the UAP codebase:\n// https://github.com/aup-sdk-collab/cloud-shared-components/blob/main/packages/uap/src/enums/PickerViewAction.ts\n// Replace this type when it is exposed from the collab-sdk / component-types.\n// Only exported for testing.\nexport const enum PickerViewAction {\n  // Place mode that is for the 2020 Place workflow (@deprecated).\n  place = 'place',\n  // Place mode that is for the 2021 Place workflow. For link or embed of documents.\n  placeLinkOrEmbed = 'placeLinkOrEmbed',\n  // Save a file with the `action`, `name` and `folder` properties in the actionState.\n  saveAs = 'save',\n  // Save a copy of a file with the `action`, `name` and `folder` properties in the actionState.\n  saveAsCopy = 'saveAsCopy',\n  // Save a copy of a file with the `action`, `name` and `folder` properties in the actionState.\n  saveToFolder = 'choose',\n  // Export a copy of a file with the `action`, `name` and `folder` properties in the actionState.\n  export = 'export',\n  // cancel without opening/saving or other actions\n  cancel = 'cancel',\n  // switch to local file picker\n  switchToOSPicker = 'switchToOSPicker',\n  // switch to sketch libraries picker\n  switchToSketchLibrariesImport = 'switchToSketchLibrariesImport',\n  // Copy item(s) to the selected location.\n  copy = 'copy',\n  // Move item(s) to new location. Can move to space, team,...\n  move = 'move',\n  // Move item(s) to a target location. (e.g. assets from Files to Projects)\n  moveFrom = 'moveFrom',\n}\n\ntype RenderParams = {\n  theme: ColorScheme;\n  cdoHostProductData: AssetBrowser.ICDOHostProductData;\n  compatibleTypes: string[];\n  sharedContext?: SharedContext<AssetBrowser.ConfigSharedContextData>;\n  onClose?: () => void;\n  onAsset?: (asset: SAM.AdobeAsset) => void;\n  onOpenOSFilePicker?: () => void;\n  isMobile?: boolean;\n};\n\nexport function render({\n  theme,\n  cdoHostProductData,\n  compatibleTypes,\n  sharedContext,\n  onClose,\n  onAsset,\n  onOpenOSFilePicker,\n  isMobile = false,\n}: RenderParams) {\n  const pickerInfo = JSON.stringify({\n    mode: 'add',\n    route: '/cloud-documents',\n    initialView: {\n      name: 'generation-history',\n    },\n  });\n\n  const renderDocumentPicker = () => {\n    return html` <cc-document-picker\n      theme=${theme === 'dark' ? 'darkest' : theme}\n      pickerInfo=${pickerInfo}\n      cdoHostProductData=${JSON.stringify(cdoHostProductData)}\n      compatible-types=${JSON.stringify(compatibleTypes)}\n      shared-context-id=${sharedContext?.referenceId}\n      .executePickerAction=${(event: { action: PickerViewAction; selectedItems: SAM.AdobeAsset[] }) => {\n        if (event.action === PickerViewAction.switchToOSPicker) {\n          onOpenOSFilePicker?.();\n        } else if (event.action !== PickerViewAction.cancel && event.selectedItems.length > 0) {\n          onAsset?.(event.selectedItems[0]);\n        }\n        onClose?.();\n      }}\n      .closeDialog=\"${() => onClose?.()}\"\n      ?mobile=${isMobile}>\n    </cc-document-picker>`;\n  };\n\n  return isMobile\n    ? html`<firefly-tray-panel isOpenByDefault=${true} @dismissed=${() => onClose?.()}>\n        <div slot=\"content\" class=\"uap-mobile-container\" data-testid=\"uap-container\">${renderDocumentPicker()}</div>\n      </firefly-tray-panel>`\n    : html`\n        <sp-overlay type=\"modal\" .open=${true} data-testid=\"uap-overlay\">\n          <sp-dialog-base dismissable underlay @close=${() => onClose?.()}>\n            <div class=\"uap-container\" data-testid=\"uap-container\">${renderDocumentPicker()}</div>\n          </sp-dialog-base>\n        </sp-overlay>\n      `;\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { css } from 'lit';\n\nexport const styles = css`\n  sp-dialog-base {\n    --mod-modal-confirm-border-radius: var(--spectrum-spacing-200);\n  }\n\n  .uap-container {\n    width: min(90vw, var(--uap-width, 914px)); /* Width from designs */\n    height: min(90vh, var(--uap-height, 644px)); /* Height from designs */\n    text-align: initial;\n    border-radius: var(--spectrum-spacing-200);\n    overflow: hidden;\n\n    /*\n    This padding fixes an issue where the UAP modal has black\n    background or something showing behind the rounded corners.\n    The issue only happens on Safari at certain window sizes.\n    */\n    padding: 1px;\n  }\n\n  .uap-mobile-container {\n    display: flex;\n    flex-direction: column;\n    text-align: initial;\n    width: 100%;\n    height: calc(100dvh - 24px);\n  }\n\n  .uap-mobile-container cc-document-picker {\n    height: 100%;\n  }\n\n  /* Override tray-panel styles */\n  firefly-tray-panel {\n    --firefly-tray-panel-background-color: var(--spectrum-gray-50);\n    --firefly-tray-panel-padding: 0;\n    --firefly-tray-panel-header-padding: 0;\n    --firefly-tray-spacing-edge-to-tray: 0;\n    --firefly-tray-panel-bottom-to-content-padding: 0;\n  }\n`;\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { AssetSelectedEvent, CloseEvent, OpenFileInputEvent } from './events.js';\nimport { SUPPORTED_IMAGE_TYPES, getCompatibleTypes } from './functions.js';\nimport { getUAPConfig } from './uap-config.js';\nimport * as presentation from './uap-presentation.js';\nimport { styles } from './uap.css.js';\nimport { AssetBrowser, ColorScheme } from '@ccx-public/collaboration-sdk';\nimport { LitElement } from 'lit';\nimport { customElement, property, state } from 'lit/decorators.js';\n\nimport { getAUPSDKManager } from '../../functions/aup-sdk-functions.js';\nimport { AuthenticationService } from '../../services/authentication-service/authentication-service.js';\nimport { EnvironmentService } from '../../services/environment-service/environment-service.js';\nimport { useObservedValues } from '../hooks/use-observed-values.js';\nimport { useSpectrumTheme } from '../hooks/use-spectrum-theme.js';\nimport { withHooks } from '../hooks/with-hooks.js';\n\nexport const tagName = 'firefly-uap';\n\n@customElement(tagName)\nexport class FireflyUAP extends LitElement {\n  static styles = [styles];\n\n  @property({ type: Array }) accept?: string[];\n\n  @property({ type: Object }) authentication?: AuthenticationService;\n\n  @property({ type: Object }) environment?: EnvironmentService;\n\n  @property({ type: Boolean }) enableAddToBoard? = false;\n\n  @property({ type: Boolean }) enableAddToCloud? = false;\n\n  @property({ type: Boolean }) enableSharePublicLink? = false;\n\n  @property({ type: Boolean }) enableUniversalAssetPickerMobile? = false;\n\n  @property({ type: Boolean }) enableProjectsTabInDocumentPicker? = false;\n\n  @property({ type: Boolean }) isMobile = false;\n\n  @state() private _loaded = false;\n\n  @withHooks\n  render() {\n    const { authentication, environment } = this;\n    if (!authentication || !environment) {\n      return null;\n    }\n\n    const aupSDK = getAUPSDKManager({ authentication, environment });\n\n    if (!this._loaded) {\n      aupSDK.loadComponent('cc-document-picker').then(() => (this._loaded = true));\n      return null;\n    }\n\n    let theme;\n    try {\n      theme = useSpectrumTheme();\n    } catch (error) {\n      theme = { color: 'light', scale: 'medium', direction: 'ltr' };\n      console.warn('No sp-theme found, using default theme:', theme);\n    }\n\n    const values = useObservedValues(() => ({\n      production: environment.production,\n      locale: environment.localeCode,\n    }));\n\n    if (values) {\n      const hostProductData = getUAPConfig({\n        enableMobileView: this.enableUniversalAssetPickerMobile,\n        enableAddToBoard: this.enableAddToBoard,\n        enableAddToCloud: this.enableAddToCloud,\n        enableSharePublicLink: this.enableSharePublicLink,\n        enableProjectsTab: this.enableProjectsTabInDocumentPicker,\n      });\n\n      return presentation.render({\n        theme: theme.color as ColorScheme,\n        cdoHostProductData: {\n          ...hostProductData,\n          environment: values.production ? 'prod' : 'stage',\n          locale: values.locale,\n          uiLocale: values.locale,\n        } as AssetBrowser.ICDOHostProductData,\n        compatibleTypes: this.accept ? getCompatibleTypes(this.accept) : [...SUPPORTED_IMAGE_TYPES],\n        onAsset: asset => this.dispatchEvent(new AssetSelectedEvent(asset)),\n        onClose: () => this.dispatchEvent(new CloseEvent()),\n        onOpenOSFilePicker: () => this.dispatchEvent(new OpenFileInputEvent()),\n        isMobile: this.isMobile,\n      });\n    }\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    [tagName]: FireflyUAP;\n  }\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { createObservableState, fromProperties, toPromise, withFilter } from '@adobe/data/observe';\nimport type { Observe } from '@adobe/data/observe';\nimport type { Config, ICollaborationSDK, Profile, TagName } from '@ccx-public/collaboration-sdk';\nimport { CollaborationSDK, SAM } from '@ccx-public/collaboration-sdk';\n\nimport type { UserProfile } from '../types/authentication-types.js';\n\ntype AUPSDKManagerConfig = {\n  authentication: {\n    accessToken: Observe<string | null>;\n    userProfile: Observe<UserProfile | null>;\n  };\n  environment: {\n    clientId: Observe<string>;\n    localeCode: Observe<string>;\n    production: Observe<boolean>;\n  };\n};\n\nexport type AUPSDKManager = {\n  loadComponent(tag: TagName): Promise<void>;\n  getGenerationHistoryContext(): Promise<SAM.GenerationHistoryContext>;\n};\nlet manager: AUPSDKManager | null = null;\n\ntype ContextProperties = {\n  clientId: string;\n  locale: string;\n  production: boolean;\n  accessToken: string | null;\n  userProfile: UserProfile | null;\n};\nlet init: Observe<ContextProperties> | null = null;\n\nconst [sdkObservable, setSdkObservable] = createObservableState<ICollaborationSDK | null>(null);\nconst _waitForSdk = () => toPromise(withFilter(sdkObservable, sdk => sdk ?? undefined));\n\n/**\n * Converts a Firefly UserProfile to a Collaboration SDK Profile object.\n */\nconst _convertUserProfile = (profile: UserProfile): Profile => ({\n  ...profile,\n  account_type: profile.accountType,\n  first_name: profile.firstName,\n  last_name: profile.lastName,\n  emailVerified: profile.emailVerified ? 'true' : 'false',\n  mrktPerm: '',\n  mrktPermEmail: null,\n  name: '',\n  phoneNumber: null,\n  preferred_languages: null,\n  tags: [],\n  utcOffset: null,\n});\n\n/**\n * Gets the singleton AUP SDK manager, initializing it if necessary.\n *\n * @param config - Configuration object containing authentication and environment services\n * @returns The AUP SDK manager instance\n */\nexport function getAUPSDKManager(config: AUPSDKManagerConfig): AUPSDKManager {\n  if (manager) {\n    return manager;\n  }\n\n  const { authentication, environment } = config;\n\n  const _loadSDK = async (): Promise<ICollaborationSDK> => {\n    if (!init) {\n      init = fromProperties({\n        clientId: environment.clientId,\n        locale: environment.localeCode,\n        production: environment.production,\n        accessToken: authentication.accessToken,\n        userProfile: authentication.userProfile,\n      });\n\n      init(async ({ clientId, locale, production, accessToken, userProfile }) => {\n        if (!accessToken || !userProfile) {\n          return;\n        }\n\n        const sdkConfig = {\n          appId: 'firefly',\n          appName: 'Firefly',\n          apiKey: clientId,\n          cdnEnvironment: production ? 'prod' : 'stage',\n          clientId,\n          environment: production ? 'prod' : 'stage',\n          locale,\n          getAccessToken: accessToken ? () => Promise.resolve(accessToken) : undefined,\n          getProfile: userProfile ? () => Promise.resolve(_convertUserProfile(userProfile)) : undefined,\n          // TODO: Bind these theme configs to an observable. We have to set\n          // UAP's theme directly on `<cc-document-picker>` unfortunately.\n          // But we should still update the collab SDK's config with theme info.\n          // colorScheme: 'dark',\n          // theme: 'dark',\n          // context: {\n          //   theme: 'dark',\n          // },\n          // TODO: Add these flags to component-types\n          featureFlags: {\n            graphQL: true,\n            plsSwy: true,\n            plsRecents: true,\n            graphQLCache: true,\n          } as unknown as Config['featureFlags'],\n        } as Config;\n\n        const currentSdk = await toPromise(sdkObservable);\n        if (!currentSdk) {\n          setSdkObservable(CollaborationSDK.getCollaborationSDK('firefly-stable', sdkConfig));\n        } else {\n          currentSdk.updateConfig(sdkConfig);\n        }\n      });\n    }\n\n    return _waitForSdk();\n  };\n\n  manager = {\n    getGenerationHistoryContext: () => _loadSDK().then(sdk => sdk.getGenerationHistoryContext()),\n    loadComponent: tag => _loadSDK().then(sdk => sdk.loadUIComponent(tag)),\n  };\n\n  return manager;\n}\n\n/**\n * Only exposed to help with unit testing. Do not use outside of tests.\n */\nexport function _resetManager(): void {\n  manager = null;\n  init = null;\n  setSdkObservable(null);\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport {\n  AdvancedSettingChangeItem,\n  ApplicationConfig,\n  PromptAdvancedInteractionEventType,\n  SingleApplicationSelectedSettings,\n} from './prompt-advanced.types.js';\n\ntype PromptChangeEventDetail = {\n  value: string;\n};\n\nexport class PromptChangeEvent extends CustomEvent<PromptChangeEventDetail> {\n  static readonly eventName = 'prompt-advanced-prompt-change';\n\n  constructor({ value }: PromptChangeEventDetail) {\n    super(PromptChangeEvent.eventName, {\n      detail: { value },\n      bubbles: true,\n      composed: true,\n    });\n  }\n}\n\ntype ApplicationChangeEventDetail = {\n  applicationId: string;\n};\n\nexport class ApplicationChangeEvent extends CustomEvent<ApplicationChangeEventDetail> {\n  static readonly eventName = 'prompt-advanced-application-change';\n\n  constructor({ applicationId }: ApplicationChangeEventDetail) {\n    super(ApplicationChangeEvent.eventName, {\n      detail: { applicationId },\n      bubbles: true,\n      composed: true,\n    });\n  }\n}\n\ntype AdvancedSettingChangeEventDetail = {\n  applicationId: string;\n  settingId: string;\n  item: AdvancedSettingChangeItem | AdvancedSettingChangeItem[];\n};\n\nexport class AdvancedSettingChangeEvent extends CustomEvent<AdvancedSettingChangeEventDetail> {\n  static readonly eventName = 'prompt-advanced-setting-change';\n\n  constructor(detail: AdvancedSettingChangeEventDetail) {\n    super(AdvancedSettingChangeEvent.eventName, {\n      detail,\n      bubbles: true,\n      composed: true,\n    });\n  }\n}\n\ntype MoreButtonClickEventDetail<T extends ApplicationConfig> = {\n  applicationId: T['id'];\n  prompt: string;\n  settings: SingleApplicationSelectedSettings<T>;\n};\nexport class MoreButtonClickEvent<T extends ApplicationConfig> extends CustomEvent<MoreButtonClickEventDetail<T>> {\n  static readonly eventName = 'prompt-advanced-more-button-click';\n\n  constructor(detail: MoreButtonClickEventDetail<T>) {\n    super(MoreButtonClickEvent.eventName, {\n      detail,\n      bubbles: true,\n      composed: true,\n    });\n  }\n}\n\ntype GenerateEventDetail<T extends ApplicationConfig> = {\n  applicationId: T['id'];\n  prompt: string;\n  settings: SingleApplicationSelectedSettings<T>;\n};\n\nexport class GenerateEvent<T extends ApplicationConfig> extends CustomEvent<GenerateEventDetail<T>> {\n  static readonly eventName = 'prompt-advanced-generate';\n\n  constructor(detail: GenerateEventDetail<T>) {\n    super(GenerateEvent.eventName, {\n      detail,\n      bubbles: true,\n      composed: true,\n    });\n  }\n}\n\ntype SettingInteractEventDetail = {\n  applicationId: string;\n  settingId: string;\n  type: PromptAdvancedInteractionEventType;\n  value?: string | string[];\n  item?: AdvancedSettingChangeItem | AdvancedSettingChangeItem[];\n};\n\nexport class SettingInteractEvent extends CustomEvent<SettingInteractEventDetail> {\n  static readonly eventName = 'prompt-advanced-setting-interact';\n\n  constructor(detail: SettingInteractEventDetail) {\n    super(SettingInteractEvent.eventName, {\n      detail,\n      bubbles: true,\n      composed: true,\n    });\n  }\n}\n", "import { TemplateResult, html } from 'lit';\n\nimport { getAspectRatioCode } from '../../../functions/aspect-ratio-functions.js';\nimport '../../icons/icon-ai-effects.js';\nimport '../../icons/icon-aspect-landscape.js';\nimport '../../icons/icon-aspect-portrait.js';\nimport '../../icons/icon-aspect-ratio.js';\nimport '../../icons/icon-aspect-square.js';\nimport '../../icons/icon-aspect-tallscreen.js';\nimport '../../icons/icon-aspect-widescreen.js';\nimport '../../icons/icon-audio-wave.js';\nimport '../../icons/icon-crown.js';\nimport '../../icons/icon-image.js';\nimport '../../icons/icon-models.js';\nimport '../../icons/icon-vector-draw.js';\nimport '../../icons/icon-vector.js';\n// TODO: replace with correct icon\nimport '../../icons/icon-video.js';\nimport '../../image-icon/image-icon.js';\nimport { defaultThumbnail, imageModelThumbnails, vectorModelThumbnails, videoModelThumbnails } from '../constants.js';\n\n// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details\nexport const imageIcon = html`<firefly-icon-image></firefly-icon-image>`;\nexport const videoIcon = html`<firefly-icon-video></firefly-icon-video>`;\nexport const aspectRatioIcon = html`<firefly-icon-aspect-ratio></firefly-icon-aspect-ratio>`;\nexport const vectorIcon = html`<firefly-icon-vector></firefly-icon-vector>`;\nexport const soundFxIcon = html`<firefly-icon-audio-wave></firefly-icon-audio-wave>`;\n\n// get custom model icon\nexport function getModelIcon(modelId: string): TemplateResult {\n  let thumbnailSrc =\n    imageModelThumbnails[modelId as keyof typeof imageModelThumbnails] ??\n    vectorModelThumbnails[modelId as keyof typeof vectorModelThumbnails] ??\n    videoModelThumbnails[modelId as keyof typeof videoModelThumbnails] ??\n    defaultThumbnail;\n\n  return html`\n    <div style=\"display: flex; align-items: center; justify-content: center;\">\n      <firefly-image-icon size=\"xl\" src=\"${thumbnailSrc}\"> </firefly-image-icon>\n    </div>\n  `;\n}\n\nexport function getAspectRatioIcon({ size }: { size: { width: number; height: number } }): TemplateResult {\n  const { code } = getAspectRatioCode({ size });\n  switch (code) {\n    case '9:21':\n    case '9:16':\n      return html`<firefly-icon-aspect-tallscreen></firefly-icon-aspect-tallscreen>`;\n    case '2:3':\n    case '3:4':\n    case '4:5':\n      return html`<firefly-icon-aspect-portrait></firefly-icon-aspect-portrait>`;\n    case '1:1':\n      return html`<firefly-icon-aspect-square></firefly-icon-aspect-square>`;\n    case '5:4':\n    case '4:3':\n    case '3:2':\n      return html`<firefly-icon-aspect-landscape></firefly-icon-aspect-landscape>`;\n    case '16:9':\n    case '21:9':\n    default:\n      return html`<firefly-icon-aspect-widescreen></firefly-icon-aspect-widescreen>`;\n  }\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\n// This file is generated. Do not edit.\nimport { TemplateResult, html } from 'lit';\nimport { customElement } from 'lit/decorators.js';\n\nimport { IconBase } from '@spectrum-web-components/icon';\n\nconst tagName = 'firefly-icon-ai-effects';\n\n@customElement(tagName)\nexport class IconAIEffects extends IconBase {\n  protected override render(): TemplateResult {\n    return html`\n      <svg id=\"a\" data-name=\"paths\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 20 20\">\n        <path\n          d=\"m6.75,18h-2.5c-1.24023,0-2.25-1.00977-2.25-2.25v-2.5c0-1.24023,1.00977-2.25,2.25-2.25h2.5c1.24023,0,2.25,1.00977,2.25,2.25v2.5c0,1.24023-1.00977,2.25-2.25,2.25Zm-2.5-5.5c-.41309,0-.75.33691-.75.75v2.5c0,.41309.33691.75.75.75h2.5c.41309,0,.75-.33691.75-.75v-2.5c0-.41309-.33691-.75-.75-.75h-2.5Z\"\n          fill=\"currentColor\"\n          strokeWidth=\"0\" />\n        <path\n          d=\"m6.75,9h-2.5c-1.24023,0-2.25-1.00977-2.25-2.25v-2.5c0-1.24023,1.00977-2.25,2.25-2.25h2.5c1.24023,0,2.25,1.00977,2.25,2.25v2.5c0,1.24023-1.00977,2.25-2.25,2.25Zm-2.5-5.5c-.41309,0-.75.33691-.75.75v2.5c0,.41309.33691.75.75.75h2.5c.41309,0,.75-.33691.75-.75v-2.5c0-.41309-.33691-.75-.75-.75h-2.5Z\"\n          fill=\"currentColor\"\n          strokeWidth=\"0\" />\n        <rect x=\"4.5\" y=\"13.5\" width=\"2\" height=\"2\" rx=\"1\" ry=\"1\" fill=\"currentColor\" strokeWidth=\"0\" />\n        <path d=\"m12.5,2h.8v2.3h-2.3v-.8c0-.82787.67213-1.5,1.5-1.5Z\" fill=\"currentColor\" strokeWidth=\"0\" />\n        <rect x=\"13.375\" y=\"4.375\" width=\"2.25\" height=\"2.25\" fill=\"currentColor\" strokeWidth=\"0\" />\n        <path d=\"m15.7,2h.8c.82787,0,1.5.67213,1.5,1.5v.8h-2.3V2h0Z\" fill=\"currentColor\" strokeWidth=\"0\" />\n        <path d=\"m11,6.7h2.3v2.3h-.8c-.82787,0-1.5-.67213-1.5-1.5v-.8h0Z\" fill=\"currentColor\" strokeWidth=\"0\" />\n        <path d=\"m15.7,6.7h2.3v.8c0,.82787-.67213,1.5-1.5,1.5h-.8v-2.3h0Z\" fill=\"currentColor\" strokeWidth=\"0\" />\n        <path\n          d=\"m15.75,11h-2.5c-1.24023,0-2.25,1.00977-2.25,2.25v2.5c0,1.24023,1.00977,2.25,2.25,2.25h2.5c1.24023,0,2.25-1.00977,2.25-2.25v-2.5c0-1.24023-1.00977-2.25-2.25-2.25Zm-2.5,1.5h2.5c.41309,0,.75.33691.75.75v1.75h-4v-1.75c0-.41309.33691-.75.75-.75Z\"\n          fill=\"currentColor\"\n          strokeWidth=\"0\" />\n      </svg>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    [tagName]: IconAIEffects;\n  }\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\n// This file is generated. Do not edit.\nimport { TemplateResult, html } from 'lit';\nimport { customElement } from 'lit/decorators.js';\n\nimport { IconBase } from '@spectrum-web-components/icon';\n\nconst tagName = 'firefly-icon-aspect-landscape';\n\n@customElement(tagName)\nexport class AspectLandscape extends IconBase {\n  protected override render(): TemplateResult {\n    return html`\n      <svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n        <path\n          d=\"M16.75 17H3.25C2.00928 17 1 15.9907 1 14.75V5.25C1 4.00928 2.00928 3 3.25 3H16.75C17.9907 3 19 4.00928 19 5.25V14.75C19 15.9907 17.9907 17 16.75 17ZM3.25 4.5C2.83643 4.5 2.5 4.83643 2.5 5.25V14.75C2.5 15.1636 2.83643 15.5 3.25 15.5H16.75C17.1636 15.5 17.5 15.1636 17.5 14.75V5.25C17.5 4.83643 17.1636 4.5 16.75 4.5H3.25Z\"\n          fill=\"currentColor\" />\n      </svg>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    [tagName]: AspectLandscape;\n  }\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\n// This file is generated. Do not edit.\nimport { TemplateResult, html } from 'lit';\nimport { customElement } from 'lit/decorators.js';\n\nimport { IconBase } from '@spectrum-web-components/icon';\n\nconst tagName = 'firefly-icon-aspect-portrait';\n\n@customElement(tagName)\nexport class AspectPortrait extends IconBase {\n  protected override render(): TemplateResult {\n    return html`\n      <svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n        <path\n          d=\"M14.25 19H5.75C4.50928 19 3.5 17.9907 3.5 16.75V3.25C3.5 2.00928 4.50928 1 5.75 1H14.25C15.4907 1 16.5 2.00928 16.5 3.25V16.75C16.5 17.9907 15.4907 19 14.25 19ZM5.75 2.5C5.33643 2.5 5 2.83643 5 3.25V16.75C5 17.1636 5.33643 17.5 5.75 17.5H14.25C14.6636 17.5 15 17.1636 15 16.75V3.25C15 2.83643 14.6636 2.5 14.25 2.5H5.75Z\"\n          fill=\"currentColor\" />\n      </svg>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    [tagName]: AspectPortrait;\n  }\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\n// This file is generated. Do not edit.\nimport { TemplateResult, html } from 'lit';\nimport { customElement } from 'lit/decorators.js';\n\nimport { IconBase } from '@spectrum-web-components/icon';\n\nconst tagName = 'firefly-icon-aspect-ratio';\n\n@customElement(tagName)\nexport class AspectRatio extends IconBase {\n  protected override render(): TemplateResult {\n    return html`\n      <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\">\n        <path\n          d=\"M6.75 18H3.25C2.00928 18 1 16.9907 1 15.75V12.25C1 11.0093 2.00928 10 3.25 10H6.75C7.99072 10 9 11.0093 9 12.25V15.75C9 16.9907 7.99072 18 6.75 18ZM3.25 11.5C2.83643 11.5 2.5 11.8364 2.5 12.25V15.75C2.5 16.1636 2.83643 16.5 3.25 16.5H6.75C7.16357 16.5 7.5 16.1636 7.5 15.75V12.25C7.5 11.8364 7.16357 11.5 6.75 11.5H3.25Z\"\n          fill=\"currentColor\" />\n        <path\n          d=\"M12.75 15H11.2188C10.8047 15 10.4688 14.6641 10.4688 14.25C10.4688 13.8359 10.8047 13.5 11.2188 13.5H12.75C13.1636 13.5 13.5 13.1636 13.5 12.75V8.25001C13.5 7.83644 13.1636 7.50001 12.75 7.50001H3.25002C2.88332 7.50001 2.57277 7.76124 2.51076 8.1211C2.44045 8.52979 2.05275 8.80225 1.64455 8.7334C1.23586 8.66309 0.961928 8.27539 1.03225 7.86719C1.21829 6.78516 2.15139 6 3.25002 6H12.75C13.9907 6 15 7.00928 15 8.25V12.75C15 13.9907 13.9907 15 12.75 15Z\"\n          fill=\"currentColor\" />\n        <path\n          d=\"M17.3345 10.8823C17.042 10.8823 16.7646 10.7109 16.6435 10.4248C16.4819 10.0435 16.6601 9.60351 17.0415 9.44189C17.3198 9.32373 17.5 9.05224 17.5 8.75V4.25C17.5 3.83643 17.1636 3.5 16.75 3.5H3.24999C2.88476 3.5 2.5664 3.771 2.50927 4.13037C2.44433 4.53906 2.06493 4.81982 1.65087 4.75342C1.24169 4.68848 0.962882 4.3042 1.02782 3.89502C1.20214 2.79688 2.13671 2 3.24999 2H16.75C17.9907 2 19 3.00928 19 4.25V8.75C19 9.65576 18.4609 10.4692 17.6265 10.8228C17.5312 10.8633 17.4321 10.8823 17.3345 10.8823Z\"\n          fill=\"currentColor\" />\n      </svg>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    [tagName]: AspectRatio;\n  }\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\n// This file is generated. Do not edit.\nimport { TemplateResult, html } from 'lit';\nimport { customElement } from 'lit/decorators.js';\n\nimport { IconBase } from '@spectrum-web-components/icon';\n\nconst tagName = 'firefly-icon-aspect-square';\n\n@customElement(tagName)\nexport class AspectSquare extends IconBase {\n  protected override render(): TemplateResult {\n    return html`\n      <svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n        <path\n          d=\"M15.75 18H4.25C3.00928 18 2 16.9907 2 15.75V4.25C2 3.00928 3.00928 2 4.25 2H15.75C16.9907 2 18 3.00928 18 4.25V15.75C18 16.9907 16.9907 18 15.75 18ZM4.25 3.5C3.83643 3.5 3.5 3.83643 3.5 4.25V15.75C3.5 16.1636 3.83643 16.5 4.25 16.5H15.75C16.1636 16.5 16.5 16.1636 16.5 15.75V4.25C16.5 3.83643 16.1636 3.5 15.75 3.5H4.25Z\"\n          fill=\"currentColor\" />\n      </svg>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    [tagName]: AspectSquare;\n  }\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\n// This file is generated. Do not edit.\nimport { TemplateResult, html } from 'lit';\nimport { customElement } from 'lit/decorators.js';\n\nimport { IconBase } from '@spectrum-web-components/icon';\n\nconst tagName = 'firefly-icon-aspect-tallscreen';\n\n@customElement(tagName)\nexport class AspectTallscreen extends IconBase {\n  protected override render(): TemplateResult {\n    return html`\n      <svg width=\"18\" height=\"18\" viewBox=\"0 0 18 18\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n        <path\n          d=\"M12.1094 17.1004H5.89023C4.8751 17.1004 4.0498 16.2751 4.0498 15.26V2.74082C4.0498 1.72568 4.8751 0.900391 5.89023 0.900391H12.1094C13.1245 0.900391 13.9498 1.72568 13.9498 2.74082V15.26C13.9498 16.2751 13.1245 17.1004 12.1094 17.1004ZM5.89023 2.25039C5.61953 2.25039 5.3998 2.47012 5.3998 2.74082V15.26C5.3998 15.5307 5.61953 15.7504 5.89023 15.7504H12.1094C12.3801 15.7504 12.5998 15.5307 12.5998 15.26V2.74082C12.5998 2.47012 12.3801 2.25039 12.1094 2.25039H5.89023Z\"\n          fill=\"currentColor\" />\n      </svg>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    [tagName]: AspectTallscreen;\n  }\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\n// This file is generated. Do not edit.\nimport { TemplateResult, html } from 'lit';\nimport { customElement } from 'lit/decorators.js';\n\nimport { IconBase } from '@spectrum-web-components/icon';\n\nconst tagName = 'firefly-icon-aspect-widescreen';\n\n@customElement(tagName)\nexport class AspectWidescreen extends IconBase {\n  protected override render(): TemplateResult {\n    return html`\n      <svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n        <path\n          d=\"M17.25 15.5H2.75C1.50928 15.5 0.5 14.4907 0.5 13.25V6.75C0.5 5.50928 1.50928 4.5 2.75 4.5H17.25C18.4907 4.5 19.5 5.50928 19.5 6.75V13.25C19.5 14.4907 18.4907 15.5 17.25 15.5ZM2.75 6C2.33643 6 2 6.33643 2 6.75V13.25C2 13.6636 2.33643 14 2.75 14H17.25C17.6636 14 18 13.6636 18 13.25V6.75C18 6.33643 17.6636 6 17.25 6H2.75Z\"\n          fill=\"currentColor\" />\n      </svg>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    [tagName]: AspectWidescreen;\n  }\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { TemplateResult, html } from 'lit';\nimport { customElement } from 'lit/decorators.js';\n\nimport { IconBase } from '@spectrum-web-components/icon';\n\nconst tagName = 'firefly-icon-audio-wave';\n\n@customElement(tagName)\nexport class IconAudioWave extends IconBase {\n  protected override render(): TemplateResult {\n    return html`\n      <svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n        <g id=\"Frame\">\n          <path\n            id=\"iconPrimary\"\n            d=\"M2.75 11.75C2.33594 11.75 2 11.4141 2 11V8.5C2 8.08594 2.33594 7.75 2.75 7.75C3.16406 7.75 3.5 8.08594 3.5 8.5V11C3.5 11.4141 3.16406 11.75 2.75 11.75Z\"\n            fill=\"currentColor\" />\n          <path\n            id=\"iconPrimary_2\"\n            d=\"M16.75 12.75C16.3359 12.75 16 12.4141 16 12V7.5C16 7.08594 16.3359 6.75 16.75 6.75C17.1641 6.75 17.5 7.08594 17.5 7.5V12C17.5 12.4141 17.1641 12.75 16.75 12.75Z\"\n            fill=\"currentColor\" />\n          <path\n            id=\"iconPrimary_3\"\n            d=\"M6.25 16.5C5.83594 16.5 5.5 16.1641 5.5 15.75V3.75C5.5 3.33594 5.83594 3 6.25 3C6.66406 3 7 3.33594 7 3.75V15.75C7 16.1641 6.66406 16.5 6.25 16.5Z\"\n            fill=\"currentColor\" />\n          <path\n            id=\"iconPrimary_4\"\n            d=\"M9.75 14.5C9.33594 14.5 9 14.1641 9 13.75V5.75C9 5.33594 9.33594 5 9.75 5C10.1641 5 10.5 5.33594 10.5 5.75V13.75C10.5 14.1641 10.1641 14.5 9.75 14.5Z\"\n            fill=\"currentColor\" />\n          <path\n            id=\"iconPrimary_5\"\n            d=\"M13.25 19C12.8359 19 12.5 18.6641 12.5 18.25V1.75C12.5 1.33594 12.8359 1 13.25 1C13.6641 1 14 1.33594 14 1.75V18.25C14 18.6641 13.6641 19 13.25 19Z\"\n            fill=\"currentColor\" />\n        </g>\n      </svg>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    [tagName]: IconAudioWave;\n  }\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\n// This file is generated. Do not edit.\nimport { TemplateResult, html } from 'lit';\nimport { customElement } from 'lit/decorators.js';\n\nimport { IconBase } from '@spectrum-web-components/icon';\n\nconst tagName = 'firefly-icon-crown';\n\n@customElement(tagName)\nexport class IconCrown extends IconBase {\n  protected override render(): TemplateResult {\n    return html`\n      <svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n        <mask id=\"mask0_6305_9661\" style=\"mask-type:alpha\" maskUnits=\"userSpaceOnUse\" x=\"0\" y=\"0\" width=\"20\" height=\"20\">\n          <path\n            d=\"M3.12068 16.1731L1.02477 6.48463C0.809104 5.48768 2.05144 4.81672 2.81664 5.51688L6.27751 8.68357L9.02751 3.05185C9.41542 2.25745 10.5846 2.25745 10.9725 3.05185L13.7225 8.68357L17.1834 5.51688C17.9486 4.81672 19.1909 5.48768 18.9752 6.48463L16.8793 16.1731C16.7751 16.6548 16.3358 16.9999 15.8267 16.9999H4.17329C3.66421 16.9999 3.22489 16.6548 3.12068 16.1731Z\"\n            fill=\"currentColor\" />\n        </mask>\n        <g mask=\"url(#mask0_6305_9661)\">\n          <rect width=\"20\" height=\"20\" fill=\"currentColor\" />\n        </g>\n      </svg>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    [tagName]: IconCrown;\n  }\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\n// This file is generated. Do not edit.\nimport { TemplateResult, html } from 'lit';\nimport { customElement } from 'lit/decorators.js';\n\nimport { IconBase } from '@spectrum-web-components/icon';\n\nconst tagName = 'firefly-icon-image';\n\n@customElement(tagName)\nexport class IconImage extends IconBase {\n  protected override render(): TemplateResult {\n    return html`\n      <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 20 20\">\n        <path\n          data-name=\"Path 1005062\"\n          d=\"m14.5,7.52114c0,.82843-.67157,1.5-1.5,1.5-.82843,0-1.5-.67157-1.5-1.5,0-.82843.67157-1.5,1.5-1.5s1.5.67157,1.5,1.5h0\"\n          fill=\"currentColor\" />\n        <path\n          d=\"m16.75,3H3.25c-1.24023,0-2.25,1.00977-2.25,2.25v9.5c0,1.24023,1.00977,2.25,2.25,2.25h13.5c1.24023,0,2.25-1.00977,2.25-2.25V5.25c0-1.24023-1.00977-2.25-2.25-2.25Zm-13.5,1.5h13.5c.41309,0,.75.33691.75.75v8.21094l-1.90918-1.90918c-.87695-.87695-2.30469-.87695-3.18164,0l-1.23145,1.23145c-.09961.09766-.25684.09668-.35449.00098l-3.23242-3.23242c-.84961-.84961-2.33203-.84961-3.18164,0l-1.90918,1.90918v-6.21094c0-.41309.33691-.75.75-.75Zm0,11c-.41309,0-.75-.33691-.75-.75v-1.16797l2.96973-2.96973c.29297-.29297.76758-.29297,1.06055,0l3.2334,3.2334c.68164.67969,1.79199.68066,2.47363-.00098l1.23242-1.23242c.29297-.29297.76758-.29297,1.06055,0l2.70068,2.70068c-.1311.11206-.29565.18701-.48096.18701H3.25Z\"\n          fill=\"currentColor\" />\n      </svg>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    [tagName]: IconImage;\n  }\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\n// This file is generated. Do not edit.\nimport { TemplateResult, html } from 'lit';\nimport { customElement } from 'lit/decorators.js';\n\nimport { IconBase } from '@spectrum-web-components/icon';\n\nconst tagName = 'firefly-icon-models';\n\n@customElement(tagName)\nexport class IconModels extends IconBase {\n  protected override render(): TemplateResult {\n    return html`\n      <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 20 20\">\n        <path\n          d=\"M17.75 12.4255V7.57445C18.3391 7.29241 18.75 6.69542 18.75 5.99999C18.75 5.03515 17.9648 4.24999 17 4.24999C16.6289 4.24999 16.2857 4.36797 16.0022 4.56585L11.729 2.12402C11.7373 2.05529 11.75 1.98791 11.75 1.91699C11.75 0.952152 10.9648 0.166992 9.99999 0.166992C9.03515 0.166992 8.24999 0.952152 8.24999 1.91699C8.24999 1.98791 8.26269 2.0553 8.27099 2.12402L3.9978 4.56585C3.71423 4.36797 3.37109 4.24999 3 4.24999C2.03516 4.24999 1.25 5.03515 1.25 5.99999C1.25 6.69542 1.66089 7.29241 2.25 7.57445V12.4255C1.66089 12.7076 1.25 13.3046 1.25 14C1.25 14.9648 2.03516 15.75 3 15.75C3.37109 15.75 3.71423 15.632 3.9978 15.4341L8.26294 17.8714C8.25977 17.9146 8.25 17.956 8.25 18C8.25 18.9648 9.03516 19.75 10 19.75C10.9648 19.75 11.75 18.9648 11.75 18C11.75 17.956 11.7402 17.9146 11.7371 17.8714L16.0022 15.4341C16.2858 15.632 16.6289 15.75 17 15.75C17.9648 15.75 18.75 14.9648 18.75 14C18.75 13.3046 18.3391 12.7076 17.75 12.4255ZM17 5.24998C17.4131 5.24998 17.75 5.58641 17.75 5.99998C17.75 6.41355 17.4131 6.74998 17 6.74998C16.5869 6.74998 16.25 6.41355 16.25 5.99998C16.25 5.58641 16.5869 5.24998 17 5.24998ZM15.263 5.87107C15.2597 5.9144 15.25 5.95585 15.25 5.99998C15.25 6.69541 15.6609 7.2924 16.25 7.57444V11.7355L10.7443 3.47868C10.8052 3.44914 10.8717 3.43022 10.9286 3.39433L15.263 5.87107ZM9.99998 1.16697C10.4131 1.16697 10.75 1.5034 10.75 1.91697C10.75 2.33054 10.4131 2.66697 9.99998 2.66697C9.58689 2.66697 9.24998 2.33054 9.24998 1.91697C9.24998 1.5034 9.58689 1.16697 9.99998 1.16697ZM4.74998 5.99998C4.74998 5.95585 4.74021 5.91441 4.73692 5.87107L9.07139 3.39432C9.13163 3.43228 9.20188 3.45279 9.26652 3.48361L3.74998 11.7499V7.57444C4.33909 7.2924 4.74998 6.69541 4.74998 5.99998ZM2.99998 5.24998C3.41307 5.24998 3.74998 5.58641 3.74998 5.99998C3.74998 6.41355 3.41307 6.74998 2.99998 6.74998C2.58689 6.74998 2.24998 6.41355 2.24998 5.99998C2.24998 5.58641 2.58689 5.24998 2.99998 5.24998ZM2.99998 14.75C2.58689 14.75 2.24998 14.4136 2.24998 14C2.24998 13.5864 2.58689 13.25 2.99998 13.25C3.41307 13.25 3.74998 13.5864 3.74998 14C3.74998 14.4136 3.41307 14.75 2.99998 14.75ZM9.99998 18.75C9.58689 18.75 9.24998 18.4136 9.24998 18C9.24998 17.5864 9.58689 17.25 9.99998 17.25C10.4131 17.25 10.75 17.5864 10.75 18C10.75 18.4136 10.4131 18.75 9.99998 18.75ZM10.9979 16.566C10.7143 16.368 10.3712 16.25 9.99998 16.25C9.62877 16.25 9.28562 16.368 9.00206 16.566L4.73692 14.1289C4.74022 14.0856 4.74998 14.0441 4.74998 14C4.74998 13.6242 4.62315 13.2829 4.41990 12.9988L10.0073 4.62644L15.5857 12.9924C15.3794 13.2778 15.25 13.6211 15.25 14C15.25 14.0441 15.2597 14.0856 15.263 14.1289L10.9979 16.566ZM17 14.75C16.5869 14.75 16.25 14.4136 16.25 14C16.25 13.5864 16.5869 13.25 17 13.25C17.4131 13.25 17.75 13.5864 17.75 14C17.75 14.4136 17.4131 14.75 17 14.75Z\"\n          fill=\"currentColor\" />\n      </svg>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    [tagName]: IconModels;\n  }\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\n// This file is generated. Do not edit.\nimport { TemplateResult, html } from 'lit';\nimport { customElement } from 'lit/decorators.js';\n\nimport { IconBase } from '@spectrum-web-components/icon';\n\nconst tagName = 'firefly-icon-vector-draw';\n\n@customElement(tagName)\nexport class IconVectorDraw extends IconBase {\n  protected override render(): TemplateResult {\n    return html`\n      <svg id=\"a\" data-name=\"ICONS\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 20 20\">\n        <path\n          d=\"m17.67773,5.25098l-2.95898-2.95898c-.84961-.84961-2.33301-.85059-3.18262,0l-1.24609,1.24707c-.00708.00708-.00928.01685-.01611.02417l-4.48389,2.44556c-.57422.31445-1.01953.82324-1.25293,1.43555l-3.31738,8.71777c-.27734.73242-.09961,1.5625.4541,2.11816.38184.38184.88965.58398,1.4082.58398.25098,0,.50293-.04688.74512-.14355l9.24805-3.71973c.62305-.25,1.13281-.71875,1.43457-1.32227l2.07812-4.15625,1.08984-1.08984c.87695-.87598.87695-2.30371,0-3.18164Zm-4.50977,7.75684c-.13672.27441-.36816.4873-.65234.60059l-8.43457,3.39258,4.2616-4.26172c.05383.00732.10156.03174.15735.03174.69043,0,1.25-.55957,1.25-1.25,0-.69019-.55957-1.25-1.25-1.25s-1.25.55981-1.25,1.25c0,.05615.02466.104.03186.1582l-4.4408,4.44067,3.09839-8.14136c.10547-.27832.30859-.51074.56934-.65332l4.35742-2.37695,4.22168,4.22168-1.91992,3.83789Zm3.44922-5.63574l-.60303.60303-4.01978-4.01978.60229-.60278c.2832-.2832.77734-.2832,1.06055,0l2.95898,2.95898c.29297.29199.29297.76855.00098,1.06055Z\"\n          fill=\"currentColor\"\n          stroke-width=\"0\" />\n      </svg>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    [tagName]: IconVectorDraw;\n  }\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\n// This file is generated. Do not edit.\nimport { TemplateResult, html } from 'lit';\nimport { customElement } from 'lit/decorators.js';\n\nimport { IconBase } from '@spectrum-web-components/icon';\n\nconst tagName = 'firefly-icon-vector';\n\n@customElement(tagName)\nexport class IconVector extends IconBase {\n  protected override render(): TemplateResult {\n    return html`\n      <svg width=\"18\" height=\"18\" viewBox=\"0 0 18 18\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n        <path\n          d=\"M12.1402 5.62478H14.5871C14.8209 6.02666 15.2514 6.29978 15.7499 6.29978C16.4955 6.29978 17.0999 5.69532 17.0999 4.94978C17.0999 4.20425 16.4955 3.59978 15.7499 3.59978C15.2514 3.59978 14.8209 3.87291 14.5871 4.27478H11.2518C11.1436 3.91114 10.9569 3.56638 10.6703 3.27986C9.77817 2.38689 8.22163 2.38777 7.32954 3.27898C7.04285 3.56572 6.85619 3.91091 6.74798 4.27478H3.41269C3.17885 3.87291 2.74835 3.59978 2.2499 3.59978C1.50432 3.59978 0.899902 4.20425 0.899902 4.94978C0.899902 5.69532 1.50432 6.29978 2.2499 6.29978C2.74835 6.29978 3.17886 6.02666 3.41269 5.62478H5.85962C2.40563 8.29534 1.19691 14.8348 1.13545 15.182C1.06998 15.5485 1.31475 15.8992 1.68169 15.9642C2.04951 16.0293 2.39888 15.7858 2.46435 15.4184C2.47902 15.3363 3.77063 8.38081 7.14288 6.39119C7.20302 6.46853 7.2584 6.54873 7.32954 6.61971C7.77559 7.06619 8.36885 7.31228 8.9999 7.31228C9.63095 7.31228 10.2242 7.06619 10.6703 6.61971C10.7413 6.54852 10.7967 6.46853 10.8568 6.39119C14.2291 8.38081 15.5208 15.3363 15.5355 15.4184C15.5939 15.7454 15.8782 15.9748 16.199 15.9748C16.2386 15.9748 16.2781 15.9713 16.3181 15.9642C16.6851 15.8992 16.9298 15.5485 16.8644 15.182C16.8029 14.8348 15.5942 8.29533 12.1402 5.62478ZM9.95439 5.9043V5.90527C9.4443 6.41535 8.55549 6.41631 8.04541 5.9043C7.79036 5.64926 7.6499 5.3108 7.6499 4.9503C7.6499 4.58979 7.79036 4.25133 8.04541 3.99532C8.30045 3.74028 8.63939 3.6003 8.9999 3.6003C9.36042 3.6003 9.69936 3.74028 9.9544 3.99629C10.2094 4.25133 10.3499 4.58979 10.3499 4.9503C10.3499 5.3108 10.2094 5.64926 9.95439 5.9043Z\"\n          fill=\"currentColor\" />\n      </svg>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    [tagName]: IconVector;\n  }\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\n// This file is generated. Do not edit.\nimport { TemplateResult, html } from 'lit';\nimport { customElement } from 'lit/decorators.js';\n\nimport { IconBase } from '@spectrum-web-components/icon';\n\nconst tagName = 'firefly-icon-video';\n\n@customElement(tagName)\nexport class IconVideo extends IconBase {\n  protected override render(): TemplateResult {\n    return html`\n      <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 20 20\">\n        <path\n          d=\"m15.75,18H4.25c-1.24023,0-2.25-1.00977-2.25-2.25V4.25c0-1.24023,1.00977-2.25,2.25-2.25h11.5c1.24023,0,2.25,1.00977,2.25,2.25v11.5c0,1.24023-1.00977,2.25-2.25,2.25ZM4.25,3.5c-.41309,0-.75.33691-.75.75v11.5c0,.41309.33691.75.75.75h11.5c.41309,0,.75-.33691.75-.75V4.25c0-.41309-.33691-.75-.75-.75H4.25Z\"\n          fill=\"currentColor\" />\n        <path\n          d=\"m13.07307,9.11916l-4.59971-2.47212c-.66621-.35806-1.47342.12451-1.47342.88085v4.94424c0,.75633.80721,1.2389,1.47342.88085l4.59972-2.47213c.70212-.37736.70212-1.38433,0-1.76169Z\"\n          fill=\"currentColor\" />\n      </svg>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    [tagName]: IconVideo;\n  }\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { css } from 'lit';\n\nexport const styles = css`\n  :host {\n    /* Specify the border radius of the icon */\n    --firefly-image-icon-border-radius: var(--spectrum-corner-radius-100);\n  }\n\n  .icon {\n    border-radius: var(--firefly-image-icon-border-radius);\n    display: block;\n\n    --mod-icon-size: var(--firefly-image-icon-size);\n  }\n`;\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { styles } from './image-icon.css.js';\nimport { BlobRef } from '@adobe/data/cache';\nimport { LitElement, html } from 'lit';\nimport { customElement, property } from 'lit/decorators.js';\nimport { styleMap } from 'lit/directives/style-map.js';\n\nimport { Icon as IconType } from '@spectrum-web-components/icon';\nimport '@spectrum-web-components/icon/sp-icon.js';\n\nimport { createJSONConverter } from '../../functions/lit-functions.js';\nimport { commonStyles } from '../common/styles.css.js';\n\nexport type SpriteArea = {\n  /** The x coordinate of the sprite in pixels. */\n  x: number;\n  /** The y coordinate of the sprite in pixels. */\n  y: number;\n  /** The width of each sprite in pixels. */\n  width: number;\n  /** The height of each sprite in pixels. */\n  height: number;\n};\n\nexport type ImageIconProps = {\n  spriteArea?: SpriteArea;\n  src?: string | BlobRef;\n  label?: string;\n  size?: IconType['size'];\n};\n\nexport const tagName = 'firefly-image-icon';\nconst defaultSize = 'l';\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    [tagName]: ImageIcon;\n  }\n}\n\n/**\n * @description `firefly-image-icon` is a simple custom web component to display an image or a part of a spritesheet.\n *\n * @element firefly-image-icon\n *\n * @cssprop --firefly-image-icon-border-radius - The border radius of the image icon component.\n * @cssprop --firefly-image-icon-size - The size of the image icon component.\n *\n * @property {string} src - The source of the image.\n * @property {SpriteArea} spriteArea - The location of the sprite if src is a spritesheet, defined by r (row), c (column), width, and height.\n * @property {string} label - The label of the image icon.\n * @property {ElementSize} size - The size of the image icon.\n */\n@customElement(tagName)\nexport class ImageIcon extends LitElement implements ImageIconProps {\n  static styles = [commonStyles, styles];\n\n  @property({ type: String }) src = '';\n\n  @property({ type: String }) label = '';\n\n  @property({ type: String }) size: IconType['size'] = defaultSize;\n\n  @property({\n    type: Object,\n    attribute: 'sprite-area',\n    converter: createJSONConverter<SpriteArea>(),\n  })\n  spriteArea?: SpriteArea;\n\n  // Add a method to get the effective size\n  private getEffectiveSize(): number {\n    // Our custom CSS property takes precedence.\n    const size = parseFloat(getComputedStyle(this).getPropertyValue('--firefly-image-icon-size'));\n    if (size) {\n      return size;\n    }\n\n    // Fall back to size attribute mapping\n    const iconSizeMap = {\n      xxs: 12,\n      xs: 14,\n      s: 16,\n      m: 18,\n      l: 20,\n      xl: 22,\n      xxl: 32,\n    };\n    return iconSizeMap[this.size || defaultSize];\n  }\n\n  render() {\n    const { src, spriteArea, size, label } = this;\n    if (!this.src) {\n      return html``;\n    }\n\n    if (spriteArea) {\n      const { x, y, width, height } = spriteArea;\n      const iconSize = this.getEffectiveSize();\n      const scaleFactor = iconSize / width;\n\n      const imageStyle = {\n        'object-fit': 'none',\n        'object-position': `-${x}px -${y}px`,\n        transform: `scale(${scaleFactor})`,\n        'transform-origin': 'top left',\n        width: `${width}px`,\n        height: `${height}px`,\n      };\n\n      return html`\n        <sp-icon .size=${size} class=\"icon\" label=${label}>\n          <img src=\"${src}\" alt=\"${label}\" style=${styleMap(imageStyle)} />\n        </sp-icon>\n      `;\n    }\n\n    return html`<sp-icon .size=${size} src=${src} label=${label} class=\"icon\"></sp-icon>`;\n  }\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\n\n/**\n * Creates a JSON converter for compound Lit property attributes\n * @returns A converter object that can parse JSON from attributes and stringify values to attributes\n */\nexport function createJSONConverter<T>() {\n  return {\n    fromAttribute: (value: string | null) => (value ? JSON.parse(value) : undefined) as T | undefined,\n    toAttribute: (value: T | undefined) => (value ? JSON.stringify(value) : null),\n  };\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { getAspectRatioIcon } from './icon-functions.js';\nimport { blobStore } from '@adobe/data/cache';\nimport { html } from 'lit';\n\nimport { localizeBundleDefault } from '../../../services/locale-service/index.js';\n\nimport { getAspectRatioCode, getDefaultAspectRatioPriority, getSortedAspectRatioSizes } from '../../../functions/aspect-ratio-functions.js';\nimport { FileEditorSettings } from '../../../functions/file-edit-functions.js';\nimport { getDimensionKey } from '../../../functions/nano-banana-constants.js';\nimport {\n  ImageGenerationModelId,\n  ImageGenerationModelIdSchema,\n} from '../../../services/image-generation-service/image-generation-service.js';\nimport { Localized } from '../../../services/locale-service/locale-service.js';\nimport { VectorGenerationModelId } from '../../../services/vector-generation-service/vector-generation-service.js';\nimport {\n  VideoGenerationModelId,\n  VideoGenerationModelIdSchema,\n  VideoGenerationReferenceImage,\n} from '../../../services/video-generation-service/video-generation-service.js';\nimport { AspectRatioCode } from '../../../types/graphics-types.js';\nimport { PromptProps } from '../../prompt/prompt.js';\nimport {\n  IMAGE_APPLICATION_KEY,\n  MODEL_KEY,\n  SCREENWIDTH,\n  SOUND_FX_APPLICATION_KEY,\n  VECTOR_APPLICATION_KEY,\n  VIDEO_APPLICATION_KEY,\n  VIDEO_REFERENCE_FRAMES_FIRST_FRAME_KEY,\n  VIDEO_REFERENCE_FRAMES_KEY,\n} from '../constants.js';\nimport '../elements/effect-thumbnail-item/effect-thumbnail-item.js';\nimport { unlocalized } from '../prompt-advanced-unlocalized.js';\nimport {\n  AdvancedSettingItem,\n  AdvancedSettingSection,\n  AllApplicationSelectedSettings,\n  ApplicationConfig,\n  FrameChangeItem,\n  PromptAdvancedSettingValue,\n  SerializableFrameValue,\n  SingleApplicationSelectedSettings,\n} from '../prompt-advanced.types.js';\n\nexport const PROMPT_BREAKPOINT_M = SCREENWIDTH.SM;\nexport const PROMPT_BREAKPOINT_S = SCREENWIDTH.MOBILE_S;\n\nexport type BreakpointKey = keyof typeof SCREENWIDTH;\n\nexport const PROMPT_MAXLENGTH_IMAGE = 1024;\nexport const PROMPT_MAXLENGTH_VIDEO = 1800;\nexport const PROMPT_MAXROWS = 2;\n\nexport function getPromptConfig(currentApplication: ApplicationConfig | undefined): Partial<PromptProps> {\n  if (!currentApplication) return { maxlength: PROMPT_MAXLENGTH_IMAGE };\n  return { maxlength: currentApplication.id === VIDEO_APPLICATION_KEY ? PROMPT_MAXLENGTH_VIDEO : PROMPT_MAXLENGTH_IMAGE };\n}\n\n// NOTE: this _should_ go in prompt-advanced.types.ts but I don't want to create a circular dependency\nexport type PromptAdvancedApplicationId =\n  | typeof VECTOR_APPLICATION_KEY\n  | typeof IMAGE_APPLICATION_KEY\n  | typeof VIDEO_APPLICATION_KEY\n  | typeof SOUND_FX_APPLICATION_KEY;\n\n// helper function to create a map of setting id to setting value\nexport function createSettingValueMap(settings: ApplicationConfig['settings']): Record<string, PromptAdvancedSettingValue> {\n  function extractMap(items: Array<AdvancedSettingItem> | Array<AdvancedSettingSection>): Record<string, PromptAdvancedSettingValue> {\n    return items.reduce(\n      (acc, item) => {\n        if ('value' in item) {\n          // this is an item, not a section\n          acc[item.id] = item.value;\n          return acc;\n        } else {\n          // this is a section, so we need to extract the map from the items\n          const newMap = extractMap(item.items);\n          return { ...acc, ...newMap };\n        }\n      },\n      {} as Record<string, PromptAdvancedSettingValue>\n    );\n  }\n\n  return settings.reduce(\n    (acc, setting) => {\n      const items = extractMap(setting.items);\n      return { ...acc, ...items };\n    },\n    {} as Record<string, PromptAdvancedSettingValue>\n  );\n}\n\nexport async function getSerializableFrameValue({\n  frameChangeItem,\n}: {\n  frameChangeItem?: FrameChangeItem;\n}): Promise<SerializableFrameValue> {\n  if (!frameChangeItem) return { fileRef: undefined, editorSettings: undefined };\n  const file = frameChangeItem.value.file;\n  const fileRef = file ? await blobStore.getRef(file) : undefined;\n  return {\n    fileRef,\n    editorSettings: frameChangeItem.value.editorSettings,\n  };\n}\n\nexport function getDisplayRatioForSize(\n  size: { width: number; height: number },\n  sizeMap?: Record<string, { displayRatio: string; [key: string]: unknown }>\n): string {\n  // If a size map is provided (for model-specific display), use it\n  if (sizeMap) {\n    const sizeKey = getDimensionKey(size);\n    const sizeInfo = sizeMap[sizeKey];\n    if (sizeInfo) {\n      return sizeInfo.displayRatio;\n    }\n  }\n  // Fallback to calculated ratio for other models\n  return getAspectRatioCode({ size }).code;\n}\n\nexport function getAspectRatioId({\n  size,\n  sizeMap,\n}: {\n  size: { width: number; height: number };\n  sizeMap?: Record<string, { displayRatio: string; [key: string]: unknown }>;\n}): string {\n  const code = getDisplayRatioForSize(size, sizeMap);\n  return `aspect-ratio-${code}`;\n}\n\nexport function createAspectRatioItem({\n  size,\n  isDefault,\n  sizeMap,\n}: {\n  size: { width: number; height: number };\n  isDefault?: boolean;\n  sizeMap?: Record<string, { displayRatio: string; [key: string]: unknown }>;\n}): AdvancedSettingItem {\n  return {\n    id: getAspectRatioId({ size, sizeMap }),\n    label: getDisplayRatioForSize(size, sizeMap),\n    icon: getAspectRatioIcon({ size }),\n    value: size,\n    isDefault,\n  };\n}\n\n/**\n * Checks if all items in the array are premium\n */\nexport function areAllItemsPremium(\n  items: AdvancedSettingItem[],\n  modelDictionary: Record<string, { name: string; isThirdParty?: boolean; isPremium?: boolean }>\n): boolean {\n  return (\n    items.length > 0 &&\n    items.every(item => {\n      const model = modelDictionary[item.value.id];\n      return model?.isPremium;\n    })\n  );\n}\n\nexport function parseAspectRatioItems({\n  sizes,\n  defaultAspectRatioPriority = getDefaultAspectRatioPriority({ isMobile: false, type: 'image' }),\n  availableAspects,\n  sizeMap,\n}: {\n  sizes: readonly { width: number; height: number }[];\n  order?: AspectRatioCode[];\n  defaultAspectRatioPriority?: AspectRatioCode[];\n  availableAspects?: readonly AspectRatioCode[];\n  sizeMap?: Record<string, { displayRatio: string; [key: string]: unknown }>;\n}) {\n  const { smallestResolutionPerAspectRatio } = getSortedAspectRatioSizes({\n    sizes,\n    defaultAspectRatioPriority,\n    availableAspects,\n    sizeMap,\n  });\n  let aspectRatioItems = smallestResolutionPerAspectRatio.map(({ size, isDefault }) => createAspectRatioItem({ size, isDefault, sizeMap }));\n  return aspectRatioItems;\n}\n\nexport function getModelSections({\n  _items,\n  modelDictionary,\n  isPaidPremium,\n  showCrowns = false,\n  localized = localizeBundleDefault(unlocalized),\n}: {\n  _items: AdvancedSettingItem[];\n  modelDictionary: Record<string, { name: string; isThirdParty?: boolean; isPremium?: boolean }>;\n  isPaidPremium?: boolean;\n  showCrowns: boolean;\n  localized?: Localized<typeof unlocalized>;\n}): AdvancedSettingSection[] {\n  // TODO: handle localization and links\n  const adobeItems = _items.filter(item => !modelDictionary[item.value.id]?.isThirdParty);\n  const partnerItems = _items.filter(item => modelDictionary[item.value.id]?.isThirdParty);\n  const sections = [];\n\n  const createItems = (items: AdvancedSettingItem[]) => {\n    if (!showCrowns) {\n      return items;\n    }\n    const allArePremium = areAllItemsPremium(items, modelDictionary);\n\n    if (allArePremium) {\n      // all items are premium, section crown instead of item crown\n      return items;\n    }\n\n    return items.map(item => {\n      const model = modelDictionary[item.value.id];\n      const showCrownIcon = model?.isPremium && !isPaidPremium;\n\n      if (showCrownIcon) {\n        return {\n          ...item,\n          iconEnd: html`<firefly-icon-crown style=\"color: #686df4;\"></firefly-icon-crown>`,\n        };\n      }\n      return item;\n    });\n  };\n\n  const createSectionLabel = (titleText: string, descriptionText: string, descriptionUrl: string, items: AdvancedSettingItem[]) => {\n    const allArePremium = areAllItemsPremium(items, modelDictionary);\n    const shouldShowSectionCrown = showCrowns && allArePremium && !isPaidPremium;\n\n    return html`<div class=\"section-container\">\n      <span class=\"section-title\" style=\"display: flex; align-items: center; gap: 6px;\">\n        ${titleText} ${shouldShowSectionCrown ? html`<firefly-icon-crown style=\"color: #686df4;\"></firefly-icon-crown>` : ''}\n      </span>\n      ${html`<a class=\"section-link-text\" href=\"${descriptionUrl}\" target=\"_blank\" rel=\"noopener noreferrer\">${descriptionText}</a>`}\n    </div>`;\n  };\n\n  if (adobeItems.length > 0) {\n    sections.push({\n      label: createSectionLabel(\n        localized.adobeModelsLabel,\n        localized.adobeModelsDescription,\n        localized.adobeModelsDescriptionUrl,\n        adobeItems\n      ),\n      items: createItems(adobeItems),\n    });\n  }\n  if (partnerItems.length > 0) {\n    sections.push({\n      label: createSectionLabel(\n        localized.partnerModelsLabel,\n        localized.partnerModelsDescription,\n        localized.partnerModelsDescriptionUrl,\n        partnerItems\n      ),\n      items: createItems(partnerItems),\n    });\n  }\n  return sections;\n}\n\nfunction getModelPrefix(applicationId: PromptAdvancedApplicationId) {\n  const applictationPrefix =\n    applicationId === IMAGE_APPLICATION_KEY ? 'image' : applicationId === VIDEO_APPLICATION_KEY ? 'video' : 'vector';\n  return `${applictationPrefix}-model`;\n}\n\nexport function getModelSettingKey({ modelId, applicationId }: { modelId: string; applicationId: PromptAdvancedApplicationId }) {\n  const prefix = getModelPrefix(applicationId);\n  return `${prefix}-${modelId}`;\n}\n\nexport function getModelIdFromSettings<T extends ImageGenerationModelId | VideoGenerationModelId | VectorGenerationModelId>({\n  settings,\n  applicationId,\n}: {\n  settings: AllApplicationSelectedSettings<ApplicationConfig>;\n  applicationId: PromptAdvancedApplicationId;\n}) {\n  const prefix = getModelPrefix(applicationId);\n  const settingsModelKey = settings[applicationId]?.[MODEL_KEY];\n  if (typeof settingsModelKey === 'string') {\n    return settingsModelKey.split(`${prefix}-`)[1] as T;\n  }\n  return undefined;\n}\n\nexport function getReferenceVideoFramesFromValues(values: Record<string, PromptAdvancedSettingValue | undefined>): {\n  referenceFrames: Array<VideoGenerationReferenceImage>;\n  referenceFrameEditorSettings: Array<FileEditorSettings | null>;\n} {\n  const frameValues: Array<SerializableFrameValue | undefined> | undefined = values[VIDEO_REFERENCE_FRAMES_KEY];\n  const referenceFrames = frameValues?.map(frame => frame?.fileRef ?? null);\n  const referenceFrameEditorSettings = frameValues?.map(frame => frame?.editorSettings ?? null);\n\n  return {\n    referenceFrames: referenceFrames ?? [],\n    referenceFrameEditorSettings: referenceFrameEditorSettings ?? [],\n  };\n}\n\nexport function extractSettingsValues({\n  settings = {},\n  settingValueMap = {},\n}: {\n  settings?: SingleApplicationSelectedSettings<ApplicationConfig>;\n  settingValueMap?: Record<string, PromptAdvancedSettingValue>;\n}): Record<string, PromptAdvancedSettingValue> {\n  const values = Object.entries(settings).reduce(\n    (acc, [settingId, settingItemId]) => {\n      if (!settingItemId) return acc;\n      if (Array.isArray(settingItemId)) {\n        // item is an array of ids (ie. multi-select)\n        return {\n          ...acc,\n          [settingId]: settingItemId.map(id => settingValueMap?.[id]),\n        };\n      } else {\n        // item is a single id (ie. single select)\n        const settingValue = settingValueMap?.[settingItemId];\n        return {\n          ...acc,\n          [settingId]: settingValue,\n        };\n      }\n      return acc;\n    },\n    {} as Record<string, PromptAdvancedSettingValue>\n  );\n\n  return values;\n}\n\nexport function getCurrentScreenWidthId(width: number): BreakpointKey {\n  if (width <= SCREENWIDTH.MOBILE_XXXS) return 'MOBILE_XXXS';\n  if (width <= SCREENWIDTH.MOBILE_XXS) return 'MOBILE_XXS';\n  if (width <= SCREENWIDTH.MOBILE_XS) return 'MOBILE_XS';\n  if (width <= SCREENWIDTH.MOBILE_S) return 'MOBILE_S';\n  if (width <= SCREENWIDTH.MOBILE_M) return 'MOBILE_M';\n  if (width <= SCREENWIDTH.MOBILE_L) return 'MOBILE_L';\n  if (width <= SCREENWIDTH.XS) return 'XS';\n  if (width <= SCREENWIDTH.SM) return 'SM';\n  if (width <= SCREENWIDTH.MD) return 'MD';\n  if (width <= SCREENWIDTH.LG) return 'LG';\n  return 'XL';\n}\nexport function isGenerateVisible(breakpoint: BreakpointKey): boolean {\n  // show text only for larger screens\n  return SCREENWIDTH[breakpoint] >= SCREENWIDTH.MD;\n}\n\nexport function getReferenceFrameConfig({\n  isFirstFrameSupported,\n  isLastFrameSupported,\n  isGuidedTransformsFeatureEnabled,\n  userInputValues,\n  incompatibleVideoSettings = {},\n}: {\n  isFirstFrameSupported: boolean;\n  isLastFrameSupported: boolean;\n  isGuidedTransformsFeatureEnabled: boolean;\n  userInputValues: Record<string, PromptAdvancedSettingValue>;\n  incompatibleVideoSettings?: Record<string, string | object | number | boolean | undefined> | null;\n}) {\n  const frameConfig: Array<{ disabled: boolean }> = [];\n  if (!incompatibleVideoSettings?.disableUploadImage) {\n    if (isFirstFrameSupported) {\n      frameConfig.push({ disabled: false });\n    }\n\n    if (isGuidedTransformsFeatureEnabled && isLastFrameSupported) {\n      const firstFrame = userInputValues[VIDEO_REFERENCE_FRAMES_FIRST_FRAME_KEY];\n      const firstFrameHasData = firstFrame?.fileRef || firstFrame?.editorSettings;\n      frameConfig.push({\n        disabled: !firstFrameHasData,\n      });\n    }\n  }\n\n  return frameConfig;\n}\n\nexport function isImageModelId(modelId?: string): modelId is ImageGenerationModelId {\n  return modelId ? ImageGenerationModelIdSchema.enum.includes(modelId as ImageGenerationModelId) : false;\n}\n\nexport function isVideoModelId(modelId?: string): modelId is VideoGenerationModelId {\n  return modelId ? VideoGenerationModelIdSchema.enum.includes(modelId as VideoGenerationModelId) : false;\n}\n\nexport function isApplicationId(applicationId: string): applicationId is PromptAdvancedApplicationId {\n  return [IMAGE_APPLICATION_KEY, VIDEO_APPLICATION_KEY, VECTOR_APPLICATION_KEY, SOUND_FX_APPLICATION_KEY].includes(\n    applicationId as PromptAdvancedApplicationId\n  );\n}\n\nexport function isFrameChangeItem(item: unknown): item is FrameChangeItem {\n  return (\n    typeof item === 'object' &&\n    item !== null &&\n    'id' in item &&\n    'value' in item &&\n    typeof item.value === 'object' &&\n    item.value !== null &&\n    'file' in item.value &&\n    'editorSettings' in item.value &&\n    'index' in item.value\n  );\n}\n\nexport function isSection(item: AdvancedSettingItem | AdvancedSettingSection): item is AdvancedSettingSection {\n  return 'items' in item;\n}\n\nexport function isItem(item: AdvancedSettingItem | AdvancedSettingSection): item is AdvancedSettingItem {\n  return !isSection(item);\n}\n\nexport function getDefaultItem({ items }: { items: AdvancedSettingItem[] | AdvancedSettingSection[] }): AdvancedSettingItem | undefined {\n  let firstSeenItem: AdvancedSettingItem | undefined = undefined;\n  let defaultItem: AdvancedSettingItem | undefined = undefined;\n\n  function maybeSetDefault({ item }: { item: AdvancedSettingItem | AdvancedSettingSection }): void {\n    if (isItem(item)) {\n      firstSeenItem = firstSeenItem ?? item;\n    }\n    if ('isDefault' in item) {\n      if (item.isDefault) {\n        defaultItem = defaultItem ?? item;\n      }\n    }\n  }\n\n  items.forEach(item => {\n    // handle sections\n    if (isSection(item)) {\n      item.items.forEach(nestedItem => maybeSetDefault({ item: nestedItem }));\n    } else {\n      maybeSetDefault({ item });\n    }\n  });\n  return defaultItem ?? firstSeenItem;\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { FromSchema, Schema } from '@adobe/data/schema';\n\nconst ReferenceUsageConfigSchema = {\n  type: 'object',\n  properties: {\n    limit: { type: 'integer', minimum: 0 },\n  },\n  required: ['limit'],\n  additionalProperties: false,\n} as const satisfies Schema;\n\nexport const ReferenceSupportSchema = {\n  type: 'object',\n  properties: {\n    subject: ReferenceUsageConfigSchema,\n    style: ReferenceUsageConfigSchema,\n    structure: ReferenceUsageConfigSchema,\n    imagePrompt: ReferenceUsageConfigSchema,\n    mask: ReferenceUsageConfigSchema,\n    general: ReferenceUsageConfigSchema,\n    unknown: ReferenceUsageConfigSchema,\n    nonGenRef: ReferenceUsageConfigSchema,\n  },\n  required: [],\n  additionalProperties: false,\n} as const satisfies Schema;\n\nexport type ReferenceSupport = FromSchema<typeof ReferenceSupportSchema>;\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { ReferenceSupportSchema } from './types/reference-support.js';\nimport { BlobRef, BlobRefSchema } from '@adobe/data/cache';\nimport { FromSchema, Schema } from '@adobe/data/schema';\nimport { Nullable, TrueSchema, U32Schema } from '@adobe/data/schema';\n\nimport { AspectRatioCode, Size, SizeSchema } from '../../types/graphics-types.js';\nimport { ReferenceBlobsDefault, ReferenceBlobsSchema } from '../../types/reference-blob-types.js';\nimport { CommerceStatusSchema } from '../commerce-data-service/commerce-data-types.js';\nimport {\n  GraphicGenerationErrorSchema,\n  GraphicGenerationModeSchema,\n  GraphicGenerationModel,\n  GraphicGenerationService,\n} from '../graphic-generation-service/graphic-generation-service.js';\nimport {\n  ErrorResultLegacy,\n  IntermediateResultLegacy,\n  ProgressiveResultLegacy,\n  ProgressiveResultSchemaLegacy,\n  SuccessResultLegacy,\n} from '../types.js';\n\nexport { type Size };\n\nexport type SupportedSettings = {\n  readonly supportsContentType: boolean;\n  readonly supportsSubjectReference: boolean;\n  readonly supportsComposition: boolean;\n  readonly supportsStylePresets: boolean;\n  readonly supportsImagePrompt: boolean;\n  readonly supportsAspectRatio: boolean;\n  readonly supportsSizeForEdits: boolean;\n  readonly supportsShortPromptWarning: boolean;\n};\n\nexport const SupportedSettingsDefault: SupportedSettings = {\n  supportsContentType: true,\n  supportsSubjectReference: true,\n  supportsComposition: true,\n  supportsStylePresets: true,\n  supportsImagePrompt: false,\n  supportsAspectRatio: true,\n  supportsSizeForEdits: true,\n  supportsShortPromptWarning: true,\n};\n\nconst ModelVersionConfigSchema = {\n  type: 'object',\n  properties: {\n    version: { type: 'string' },\n    versionWithRefs: { type: 'string' },\n  },\n  additionalProperties: false,\n} as const satisfies Schema;\n\nconst ImageGenerationModelSchema = {\n  type: 'object',\n  required: ['contentTypes', 'supportsGeneratingSimilarImages'],\n  additionalProperties: false,\n  properties: {\n    contentTypes: { type: 'array', items: { enum: ['photo', 'art', 'vector', 'raw', 'scene', 'subject'] } },\n    // Whether the model supports instruct edit mode. If the model has subject reference\n    supportsInstructEditMode: { type: 'boolean' },\n    supportsGeneratingSimilarImages: { type: 'boolean' },\n    supportsVisualIntensity: { type: 'boolean' },\n    supportsPromptRewrite: { type: 'boolean' },\n    supportsShortPromptWarning: { type: 'boolean' },\n    supportsAspectRatio: { type: 'boolean' },\n    referenceSupport: ReferenceSupportSchema,\n    // When true (default), a size may be sent on instruct edits. When false, omit size\n    // for instruct edits that provide an input image, as such size will be derived from image context.\n    supportsSizeForEdits: { type: 'boolean' },\n    // Automatically use the generated image as the subject. Normally used for third party models.\n    useGenerationAsSubject: { type: 'boolean' },\n    // Automatically use the generated image as the image prompt. Normally used for third party models.\n    useGenerationAsImagePrompt: { type: 'boolean' },\n    defaultGenerationMode: Nullable(GraphicGenerationModeSchema),\n    // Metadata for model versioning.\n    modelVersion: ModelVersionConfigSchema,\n    // If true, this model is a custom model.\n    isCustomModel: { type: 'boolean' },\n    // The sample prompt for the model.\n    samplePrompt: Nullable({ type: 'string' }),\n    // The concept ID for the model.\n    conceptId: Nullable({ type: 'string' }),\n    // The thumbnail URL for the model.\n    thumbnailUrl: Nullable({ type: 'string' }),\n    defaultSize: Nullable(SizeSchema),\n    defaultContentType: Nullable({ type: 'string', enum: ['photo', 'art', 'vector', 'raw', 'scene', 'subject'] }),\n    defaultVisualIntensity: Nullable({ type: 'number' }),\n    customModelId: Nullable({ type: 'string' }),\n    supportsUpsampler: Nullable({ type: 'boolean' }),\n    defaultUpsamplerState: Nullable({ type: 'boolean' }),\n    // Quality ranking for sorting (lower = higher quality, 0 = highest)\n    quality: { type: 'number' },\n    supportedAspectRatios: Nullable({\n      type: 'array',\n      items: { type: 'string' },\n    }),\n    aspectRatioSizeMap: Nullable({\n      type: 'object',\n      additionalProperties: {\n        type: 'object',\n        required: ['displayRatio'],\n        properties: {\n          displayRatio: { type: 'string' },\n        },\n        additionalProperties: true,\n      },\n    }),\n  },\n} as const satisfies Schema;\n\nexport type ImageGenerationModel = GraphicGenerationModel &\n  FromSchema<typeof ImageGenerationModelSchema> &\n  Partial<SupportedSettings> & {\n    supportedAspectRatios?: readonly AspectRatioCode[];\n    aspectRatioSizeMap?: Record<string, { displayRatio: string; [key: string]: unknown }>;\n  };\n\nexport const ImageGenerationModelIdInternalSchema = {\n  enum: [\n    'adobe:firefly:colligo:image3',\n    'adobe:firefly:colligo:image4',\n    'adobe:firefly:colligo:image4:ultra',\n    'adobe:firefly:colligo:image5',\n  ],\n} as const satisfies Schema;\n\nexport type ImageGenerationModelIdInternal = FromSchema<typeof ImageGenerationModelIdInternalSchema>;\n\nexport const geminiFlashModelId = 'google:firefly:colligo:gemini-flash' as const satisfies ImageGenerationModelIdThirdParty;\n\nexport const ImageGenerationModelIdThirdPartySchema = {\n  enum: [\n    'google:firefly:colligo:imagen3',\n    'google:firefly:colligo:imagen4',\n    'google:firefly:colligo:gemini-flash',\n    'google:firefly:colligo:nano-banana-pro',\n    'ideogram:firefly:colligo:ideogram3',\n    'openai:firefly:colligo:gpt-4o',\n    'blackforest:firefly:colligo:flux-pro',\n    'blackforest:firefly:colligo:flux-ultra',\n    'blackforest:firefly:colligo:flux-ultra-raw',\n    'blackforest:firefly:colligo:flux2-pro',\n    'runway:firefly:colligo:gen4',\n    'blackforest:firefly:colligo:flux-kontext-max',\n    'blackforest:firefly:colligo:flux-kontext-pro',\n  ],\n} as const satisfies Schema;\n\nexport type ImageGenerationModelIdThirdParty = FromSchema<typeof ImageGenerationModelIdThirdPartySchema>;\n\nexport const thirdPartyGeneralTermsOfUseId = '3p:general';\n\nexport type TermsOfUseId = ImageGenerationModelIdThirdParty | typeof thirdPartyGeneralTermsOfUseId;\n\nexport const getTermsOfUseAcceptanceKey = (id: TermsOfUseId) => `accepted terms of use ${id}` as const;\nexport type ImageGenerationTermsOfUseAcceptance = { [K in ReturnType<typeof getTermsOfUseAcceptanceKey>]: boolean };\nexport const DefaultImageGenerationTermsOfUseAcceptance: ImageGenerationTermsOfUseAcceptance = {\n  'accepted terms of use google:firefly:colligo:imagen3': false,\n  'accepted terms of use google:firefly:colligo:imagen4': false,\n  'accepted terms of use google:firefly:colligo:gemini-flash': false,\n  'accepted terms of use google:firefly:colligo:nano-banana-pro': false,\n  'accepted terms of use ideogram:firefly:colligo:ideogram3': false,\n  'accepted terms of use openai:firefly:colligo:gpt-4o': false,\n  'accepted terms of use blackforest:firefly:colligo:flux-pro': false,\n  'accepted terms of use blackforest:firefly:colligo:flux-ultra': false,\n  'accepted terms of use blackforest:firefly:colligo:flux-ultra-raw': false,\n  'accepted terms of use blackforest:firefly:colligo:flux2-pro': false,\n  'accepted terms of use runway:firefly:colligo:gen4': false,\n  'accepted terms of use blackforest:firefly:colligo:flux-kontext-max': false,\n  'accepted terms of use blackforest:firefly:colligo:flux-kontext-pro': false,\n  'accepted terms of use 3p:general': false,\n};\n\nexport const ImageGenerationModelIdSchema = {\n  enum: [...ImageGenerationModelIdInternalSchema.enum, ...ImageGenerationModelIdThirdPartySchema.enum],\n} as const satisfies Schema;\n/**\n * These are defined here only so that localization in UI elements can handle them.\n * Unknown models would just use the name on the model without translation.\n */\nexport type ImageGenerationModelId = FromSchema<typeof ImageGenerationModelIdSchema>;\n\nexport const DefaultImageGenerationModelId = 'adobe:firefly:colligo:image4' as const satisfies ImageGenerationModelId;\nexport const image5ModelId = 'adobe:firefly:colligo:image5' as const satisfies ImageGenerationModelId;\nexport const GeminiImageGenerationModelId = 'google:firefly:colligo:gemini-flash' as const satisfies ImageGenerationModelId;\nexport const NanoBananaProModelId = 'google:firefly:colligo:nano-banana-pro' as const satisfies ImageGenerationModelId;\n\nexport const ImageGenerationSeedSchema = U32Schema;\nexport type ImageGenerationSeed = FromSchema<typeof ImageGenerationSeedSchema>;\n\nexport const ImageGenerationSeedsSchema = {\n  type: 'array',\n  items: ImageGenerationSeedSchema,\n} as const satisfies Schema;\nexport type ImageGenerationSeeds = FromSchema<typeof ImageGenerationSeedsSchema>;\n\nexport const AspectRatioSchema = {\n  enum: ['square', 'portrait', 'landscape', 'widescreen', 'vertical'],\n} as const satisfies Schema;\nexport type AspectRatio = FromSchema<typeof AspectRatioSchema>;\nexport const AspectRatioDefault: AspectRatio = 'square';\n\nexport const ContentTypeSchema = {\n  enum: ['photo', 'art', 'vector', 'raw', 'scene', 'subject'],\n} as const satisfies Schema;\nexport type ContentType = FromSchema<typeof ContentTypeSchema>;\n\nexport const ImageGenerationIdSchema = U32Schema;\nexport type ImageGenerationId = FromSchema<typeof ImageGenerationIdSchema>;\n\n// Legacy Firefly v3 aspect ratio mappings\n// Note: landscape (2304x1792) is 9:7, not 4:3; portrait (1792x2304) is 7:9, not 3:4\nexport const imageAspectRatioMapping = {\n  square: { width: 2048, height: 2048 },\n  landscape: { width: 2304, height: 1792 }, // 9:7 ratio (legacy)\n  portrait: { width: 1792, height: 2304 }, // 7:9 ratio (legacy)\n  widescreen: { width: 2688, height: 1536 },\n  vertical: { width: 1792, height: 2304 }, // 7:9 ratio (legacy)\n} satisfies Record<AspectRatio, Size>;\n\nexport const ExifTypeSchema = {\n  required: ['aperture', 'fieldOfView', 'shutterSpeed'],\n  properties: {\n    aperture: { type: 'number', minimum: 0, maximum: 25 },\n    fieldOfView: { type: 'number', minimum: 0, maximum: 1900 },\n    shutterSpeed: { type: 'number', minimum: 1 / 8000, maximum: 32 },\n  },\n} as const satisfies Schema;\nexport type ExifType = FromSchema<typeof ExifTypeSchema>;\n\nexport const DetailLevelSchema = {\n  enum: ['preview', 'full'],\n} as const satisfies Schema;\nexport type Resolution = FromSchema<typeof DetailLevelSchema>;\nexport const ResolutionDefault: Resolution = 'full';\n\nexport const ImageGenerationReferenceImageSchema = Nullable(BlobRefSchema);\nexport type ImageGenerationReferenceImage = FromSchema<typeof ImageGenerationReferenceImageSchema>;\nexport const ImageGenerationReferenceImageDefault: ImageGenerationReferenceImage = null;\n\nexport type ImageGenerationPreset = string;\nexport const ImageGenerationStyleSchema = {\n  type: 'object',\n  properties: {\n    presets: { type: 'array', items: { type: 'string' } },\n    // @deprecated: reference image for style will be stored in the referenceBlobs array\n    referenceImage: ImageGenerationReferenceImageSchema,\n    //  Adjust adherence to guide image, lower values do maximum changes and higher values make minimal changes\n    strength: { type: 'integer', minimum: 0, maximum: 100 },\n    visualIntensity: { type: 'number', minimum: 2, maximum: 10 },\n  },\n  required: ['presets', 'strength', 'visualIntensity'],\n  additionalProperties: false,\n} as const satisfies Schema;\nexport type ImageGenerationStyle = FromSchema<typeof ImageGenerationStyleSchema>;\nexport const ImageGenerationStyleDefault: ImageGenerationStyle = {\n  presets: [],\n  referenceImage: ImageGenerationReferenceImageDefault,\n  strength: 50,\n  visualIntensity: 8,\n};\n\n// @deprecated: reference image for subject will be stored in the referenceBlobs array\nexport const ImageGenerationSubjectSchema = {\n  type: 'object',\n  properties: {\n    referenceImage: ImageGenerationReferenceImageSchema,\n  },\n  // @deprecated: reference image for subject will be stored in the referenceBlobs array\n  required: [],\n  additionalProperties: false,\n} as const satisfies Schema;\nexport type ImageGenerationSubject = FromSchema<typeof ImageGenerationSubjectSchema>;\nexport const ImageGenerationSubjectDefault: ImageGenerationSubject = {\n  referenceImage: ImageGenerationReferenceImageDefault,\n};\n\nexport const ImageGenerationStructureSchema = {\n  type: 'object',\n  properties: {\n    // @deprecated: reference image for structure will be stored in the referenceBlobs array\n    referenceImage: ImageGenerationReferenceImageSchema,\n    //  0 = no adherence, 1 = default value, 2 = full adherence\n    strength: { type: 'integer', minimum: 0, maximum: 2 },\n  },\n  required: ['strength'],\n  additionalProperties: false,\n} as const satisfies Schema;\nexport type ImageGenerationStructure = FromSchema<typeof ImageGenerationStructureSchema>;\nexport const ImageGenerationStructureDefault: ImageGenerationStructure = {\n  referenceImage: ImageGenerationReferenceImageDefault,\n  strength: 1,\n};\n\n// @deprecated: reference image for image prompt will be stored in the referenceBlobs array\nexport const ImageGenerationImagePromptSchema = {\n  type: 'object',\n  properties: {\n    referenceImage: ImageGenerationReferenceImageSchema,\n  },\n  required: [],\n  additionalProperties: false,\n} as const satisfies Schema;\nexport type ImageGenerationImagePrompt = FromSchema<typeof ImageGenerationImagePromptSchema>;\nexport const ImageGenerationImagePromptDefault: ImageGenerationImagePrompt = {\n  referenceImage: ImageGenerationReferenceImageDefault,\n};\n\nexport const ImageGenerationOptionsSchema = {\n  type: 'object',\n  properties: {\n    debias: TrueSchema,\n    autoContentType: TrueSchema,\n  },\n  required: [],\n  additionalProperties: false,\n} as const satisfies Schema;\nexport type ImageGenerationOptions = FromSchema<typeof ImageGenerationOptionsSchema>;\nexport const ImageGenerationOptionsDefault: ImageGenerationOptions = { autoContentType: true };\n\n// Image generation input / output schemas\nexport const ImageGenerationSettingsSchema = {\n  type: 'object',\n  properties: {\n    aspectRatio: AspectRatioSchema,\n    size: SizeSchema,\n    avoidKeywords: { type: 'object', additionalProperties: TrueSchema },\n    contentType: ContentTypeSchema,\n    resolution: DetailLevelSchema,\n    locale: { type: 'string' },\n    model: ImageGenerationModelIdSchema,\n    mode: GraphicGenerationModeSchema,\n    options: ImageGenerationOptionsSchema,\n    predictedContentType: Nullable(ContentTypeSchema),\n    prompt: { type: 'string' },\n    enhancePrompt: { type: 'boolean' },\n    enhancedPrompt: { type: 'string' },\n    referenceBlobs: ReferenceBlobsSchema,\n    subject: ImageGenerationSubjectSchema,\n    structure: ImageGenerationStructureSchema,\n    style: ImageGenerationStyleSchema,\n    imagePrompt: ImageGenerationImagePromptSchema,\n    // if present, allows overriding the generation endpoint.\n    debugGenerationEndpoint: { type: 'string' },\n    // if present, these properties are merged into the API request as is.\n    // as in { ...normalProperties, ...debugBodyProperties }\n    // they could also be merged into it using JSON Merge Patch semantics.\n    debugBodyProperties: { type: 'object' },\n    // if present, these headers are added to the API request's x-colligo-debug-input header.\n    debugHeaderProperties: { type: 'object' },\n    // if present, use this as the starting seed for generation\n    debugSeed: Nullable({ type: 'number' }),\n    upsamplerEnabled: { type: 'boolean' },\n  },\n  required: [\n    'aspectRatio',\n    'avoidKeywords',\n    'contentType',\n    'resolution',\n    'locale',\n    'mode',\n    'options',\n    'prompt',\n    'subject',\n    'structure',\n    'style',\n    'imagePrompt',\n  ],\n  additionalProperties: false,\n} as const satisfies Schema;\nexport type ImageGenerationSettings = FromSchema<typeof ImageGenerationSettingsSchema>;\nexport const ImageGenerationSettingsDefault: ImageGenerationSettings = {\n  aspectRatio: 'landscape',\n  avoidKeywords: {},\n  contentType: 'photo',\n  resolution: ResolutionDefault,\n  locale: 'en-US',\n  model: DefaultImageGenerationModelId,\n  mode: 'standard',\n  options: ImageGenerationOptionsDefault,\n  predictedContentType: null,\n  prompt: '',\n  enhancePrompt: false,\n  referenceBlobs: ReferenceBlobsDefault,\n  subject: ImageGenerationSubjectDefault,\n  structure: ImageGenerationStructureDefault,\n  style: ImageGenerationStyleDefault,\n  imagePrompt: ImageGenerationImagePromptDefault,\n  size: { width: 2304, height: 1792 },\n  upsamplerEnabled: false,\n};\n\nexport const PersistedMediaSchema = {\n  type: 'object',\n  properties: {\n    blob: BlobRefSchema,\n    assetId: { type: 'string' },\n    error: {\n      type: 'object',\n      properties: {\n        message: { type: 'string' },\n        error_code: { type: 'string' },\n      },\n    },\n  },\n  required: ['blob'],\n  additionalProperties: false,\n} as const satisfies Schema;\n\nexport const ImageGenerationSuccessMetaSchema = {\n  type: 'object',\n  properties: {\n    promptHasDeniedWords: { type: 'boolean' },\n    promptHasBlockedArtists: { type: 'boolean' },\n    storageQuotaExceeded: { type: 'boolean' },\n    storageFailed: { type: 'boolean' },\n  },\n} as const satisfies Schema;\nexport type ImageGenerationSuccessMeta = FromSchema<typeof ImageGenerationSuccessMetaSchema>;\n\nexport const ImageGenerationSuccessSchema = {\n  type: 'object',\n  properties: {\n    outputs: { type: 'array', items: PersistedMediaSchema },\n    assetIds: { type: 'array', items: { type: 'string' } },\n    predictedContentClass: ContentTypeSchema,\n    enhancedPrompt: { type: 'string' },\n    predictedPhotoSettings: ExifTypeSchema,\n    meta: ImageGenerationSuccessMetaSchema,\n    size: SizeSchema,\n    version: { type: 'string' },\n    commerce: CommerceStatusSchema,\n  },\n  required: ['version', 'size', 'outputs'],\n  additionalProperties: false,\n} as const satisfies Schema;\nexport type ImageGenerationSuccess = FromSchema<typeof ImageGenerationSuccessSchema>;\n\nexport const ImageSpecificErrorCodeSchema = {\n  enum: ['insufficient_credits'],\n} as const satisfies Schema;\nexport type ImageSpecificErrorCode = FromSchema<typeof ImageSpecificErrorCodeSchema>;\n\nexport const BasicErrorSchema = {\n  type: 'object',\n  properties: {\n    code: ImageSpecificErrorCodeSchema,\n  },\n  required: ['code'],\n  additionalProperties: false,\n} as const satisfies Schema;\nexport type BasicError = FromSchema<typeof BasicErrorSchema>;\n\nexport const ImageGenerationErrorSchema = {\n  oneOf: [BasicErrorSchema, GraphicGenerationErrorSchema],\n} as const satisfies Schema;\n\nexport type ImageGenerationError = FromSchema<typeof ImageGenerationErrorSchema>;\n\nexport const ImageGenerationIntermediateSchema = {\n  ...ImageGenerationSuccessSchema,\n  required: [],\n} as const satisfies Schema;\nexport type ImageGenerationIntermediate = FromSchema<typeof ImageGenerationIntermediateSchema>;\n\nexport const ImageGenerationResultSchema = ProgressiveResultSchemaLegacy(\n  ImageGenerationSuccessSchema,\n  ImageGenerationErrorSchema,\n  ImageGenerationIntermediateSchema\n);\n\nexport type ImageGenerationIntermediateResult<X = undefined> = X extends undefined\n  ? IntermediateResultLegacy<ImageGenerationIntermediate>\n  : IntermediateResultLegacy<ImageGenerationIntermediate & X>;\nexport type ImageGenerationSuccessResult = SuccessResultLegacy<ImageGenerationSuccess>;\nexport type ImageGenerationErrorResult = ErrorResultLegacy<ImageGenerationError>;\nexport type ImageGenerationResult = ProgressiveResultLegacy<ImageGenerationSuccess, ImageGenerationError, ImageGenerationIntermediate>;\n\nexport interface ImageGenerationService extends GraphicGenerationService<ImageGenerationModel> {\n  /**\n   * Generates a new image from a text prompt and an optional reference image.\n   * The order of the images in the output matches the order of the seeds in the input.\n   * @param prompt the text to generate the image from.\n   * @returns the generated image.\n   */\n  generateImage(props: {\n    settings: ImageGenerationSettings;\n    seeds: ImageGenerationSeed[];\n    similarTo?: BlobRef;\n  }): Promise<ImageGenerationResult>;\n  /**\n   * Given an intermediate result, returns either a final result or a new intermediate result.\n   * This can be polled around once per second.\n   * The intermediate result *could* be serialized or otherwise persisted to be used later.\n   * The service ought to handle that correctly.\n   */\n  checkImageGeneration(result: ImageGenerationIntermediateResult): Promise<ImageGenerationResult>;\n  /**\n   * Cancels the image generation operation.\n   */\n  cancelImageGeneration(result: ImageGenerationIntermediateResult): Promise<void>;\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { FromSchema, Schema } from '@adobe/data/schema';\n\nexport const SizeSchema = {\n  properties: {\n    height: { type: 'number' },\n    width: { type: 'number' },\n  },\n  required: ['height', 'width'],\n  additionalProperties: false,\n} as const satisfies Schema;\nexport type Size = FromSchema<typeof SizeSchema>;\n\nexport const RectangleSchema = {\n  type: 'object',\n  properties: {\n    x: { type: 'number' },\n    y: { type: 'number' },\n    width: { type: 'number' },\n    height: { type: 'number' },\n  },\n  required: ['x', 'y', 'width', 'height'],\n  additionalProperties: false,\n} as const satisfies Schema;\nexport type Rectangle = FromSchema<typeof RectangleSchema>;\n\nexport const MediaSizeSchema = {\n  properties: {\n    height: { type: 'number' },\n    width: { type: 'number' },\n    duration: { type: 'number' },\n  },\n  required: ['height', 'width'],\n  additionalProperties: false,\n} as const satisfies Schema;\nexport type MediaSize = FromSchema<typeof MediaSizeSchema>;\n\nexport const AspectRatioSchema = {\n  enum: ['square', 'portrait', 'landscape', 'widescreen', 'vertical', 'ultraWide', 'ultraTall'],\n} as const satisfies Schema;\n\n// TODO: Rename to AspectRatioDescriptor\nexport type AspectRatio = FromSchema<typeof AspectRatioSchema>;\n// There is no default, the default would depend at runtime on mobile (portrait) vs desktop (landscape).\n\n/**\n * Aspect ratio codes. Models specify which subset they support via `supportedAspectRatios`.\n */\nexport type AspectRatioCode = '21:9' | '16:9' | '4:3' | '1:1' | '3:4' | '9:16' | '9:21' | '3:2' | '5:4' | '4:5' | '2:3';\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { SizeSchema } from './graphics-types.js';\nimport { BlobRefSchema } from '@adobe/data/cache';\nimport { FromSchema, Nullable, Schema } from '@adobe/data/schema';\n\n/**\n * Reference blob usage labels for different use cases in image generation\n * - subject: Reference image for subject/person\n * - style: Reference image for style guidance\n * - structure: Reference image for composition/structure\n * - imagePrompt: Reference image as a prompt\n * - mask: Mask or selection area\n * - general: General purpose reference\n * - unknown: Usage not yet determined\n * - nonGenRef: Non-generative reference (e.g., for display only)\n */\nexport const ReferenceBlobUsageSchema = {\n  type: 'string',\n  enum: ['subject', 'style', 'structure', 'imagePrompt', 'mask', 'general', 'unknown', 'nonGenRef'] as const,\n  default: 'unknown',\n} as const satisfies Schema;\n\nexport const ReferenceBlobSchema = {\n  type: 'object',\n  properties: {\n    id: { type: 'string' },\n    ref: Nullable(BlobRefSchema),\n    isPrimary: { type: 'boolean', default: false },\n    usage: ReferenceBlobUsageSchema,\n    size: SizeSchema,\n  },\n  required: ['id', 'ref'],\n  additionalProperties: false,\n} as const satisfies Schema;\n\nexport const ReferenceBlobsSchema = {\n  type: 'array',\n  items: ReferenceBlobSchema,\n} as const satisfies Schema;\n\nexport type ReferenceBlobUsage = FromSchema<typeof ReferenceBlobUsageSchema>;\nexport type ReferenceBlob = FromSchema<typeof ReferenceBlobSchema>;\nexport type ReferenceBlobs = FromSchema<typeof ReferenceBlobsSchema>;\n\n/**\n * Default empty reference images array\n */\nexport const ReferenceBlobsDefault: ReferenceBlobs = [];\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { FromSchema, Schema } from '@adobe/data/schema';\n\n// These types are not directly used by the commerce data service\n// But are likely returned in common from generation services\nexport const ConsumptionStatusValues = [\n  'QUOTA_WARNING_HARD_CAP',\n  'QUOTA_EXHAUSTED_USING_DAILY_CREDITS',\n  'QUOTA_EXHAUSTED',\n  'QUOTA_AVAILABLE',\n] as const;\nexport const ConsumptionStatusSchema = {\n  enum: ConsumptionStatusValues,\n} as const satisfies Schema;\n\nexport type ConsumptionStatus = FromSchema<typeof ConsumptionStatusSchema>;\n\nexport const CommerceStatusSchema = {\n  type: 'object',\n  properties: {\n    consumptionStatus: ConsumptionStatusSchema,\n    appliedUntilDate: { type: 'number' },\n  },\n  additionalProperties: false,\n} as const satisfies Schema;\n\nexport type CommerceStatus = FromSchema<typeof CommerceStatusSchema>;\n\n/**\n * Paywall reason codes for premium features that have quota exhaustion\n */\nexport const PREMIUM_QUOTA_EXHAUSTED_PAYWALL_REASON_CODE = {\n  useCredits: 'firefly_quota_exhausted_premium_paid_user',\n  complimentary: 'firefly_quota_exhausted_premium',\n} as const;\n\n// Reason codes\n\n/**\n * Paywall reason codes for standard features that have quota exhaustion\n */\nexport const STANDARD_QUOTA_EXHAUSTED_PAYWALL_REASON_CODE = {\n  useCredits: 'firefly_quota_exhausted_paid_user',\n  complimentary: 'firefly_quota_exhausted',\n} as const;\n\n/**\n * Paywall reason codes for upsell upgrade scenarios\n */\nexport const UPSELL_UPGRADE_PAYWALL_REASON_CODE = {\n  useCredits: 'ff_paid_user_upgrade',\n  complimentary: 'ff_free_user_upgrade',\n} as const;\n\n/**\n * Paywall reason codes for user banner scenarios\n */\nexport const USER_BANNER_PAYWALL_REASON_CODE = {\n  useCredits: 'ff_paid_user_banner',\n  complimentary: 'ff_free_user_banner',\n} as const;\n\n// Analytics types\n\n/**\n * Analytics types for standard ran out of credit scenarios\n */\nexport const RAN_OUT_OF_CREDIT_ANALYTICS_TYPE = {\n  useCredits: 'paid-ran-out-of-credit',\n  complimentary: 'free-ran-out-of-credit',\n} as const;\n\n/**\n * Analytics types for 3rd party image model scenarios\n */\nexport const IMAGE_3P_ANALYTICS_TYPE = {\n  useCredits: 'paid-ran-out-of-credit-image-3rd-party',\n  complimentary: 'free-out-of-credit-image-3rd-party',\n} as const;\n\n/**\n * Analytics types for 3rd party video model scenarios\n */\nexport const VIDEO_3P_ANALYTICS_TYPE = {\n  useCredits: 'paid-ran-out-of-credit-video-3rd-party',\n  complimentary: 'free-out-of-credit-video-3rd-party',\n} as const;\n\n/**\n * Analytics types for creative production scenarios\n */\nexport const CREATIVE_PRODUCTION_ANALYTICS_TYPE = {\n  useCredits: 'paid-creative-production',\n  complimentary: 'free-creative-production',\n} as const;\n\n/**\n * Analytics types for user banner scenarios\n */\nexport const USER_BANNER_ANALYTICS_TYPE = {\n  useCredits: 'paid-user-banner',\n  complimentary: 'free-user-banner',\n} as const;\n\n/**\n * Analytics types for premium model access scenarios\n */\nexport const ACCESS_PREMIUM_MODEL_ANALYTICS_TYPE = {\n  useCredits: 'paid-access-premium-model',\n  complimentary: 'free-access-premium-model',\n} as const;\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { normalize } from '@adobe/data';\nimport { jsonToHash, memoize } from '@adobe/data/cache';\nimport { Expand, Replace } from '@adobe/data/types';\n\nimport { Mutable } from '../types/meta-types.js';\n\n/**\n * Given an object containing function properties,\n * returns a new object of the same type but with every function\n * bound to a new `this` object.\n */\nexport function bindAllFunctions<T extends object>(unboundFunctions: T, bindToThis: unknown): T {\n  return Object.fromEntries(\n    Object.entries(unboundFunctions).map(([key, value]) => [key, typeof value === 'function' ? value.bind(bindToThis) : value])\n  ) as T;\n}\n\n/**\n * Returns a mutable clone of the given object.\n */\nexport function mutableClone<T extends object>(obj: T): Mutable<T> {\n  return structuredClone(obj);\n}\n\nexport const getUniqueIdFromObject = memoize('getUniqueIdFromObject:v0', async (settings: unknown) => jsonToHash(JSON.stringify(settings)));\n\nexport function typedKeys<T extends object>(obj: T): (keyof T)[] {\n  return Object.keys(obj) as (keyof T)[];\n}\n\nexport function typedEntries<T extends object>(obj: T): [keyof T, T[keyof T]][] {\n  return Object.entries(obj) as [keyof T, T[keyof T]][];\n}\n\n/**\n * Create a new object with the specified keys removed\n */\nexport function omitKeys<T extends object, K extends keyof T>(obj: T, keys: K[]): Expand<Omit<T, K>> {\n  const result: Partial<T> = { ...obj };\n  for (const key of keys) delete result[key];\n  return result as Expand<Omit<T, K>>;\n}\n\nexport function compareNormalized<T extends object>(a: T, b: T): boolean {\n  return JSON.stringify(normalize(a)) === JSON.stringify(normalize(b));\n}\n\nexport function compareWithoutKeys<T extends object, K extends keyof T>(a: T, b: T, keys: K[]): boolean {\n  return compareNormalized(omitKeys(a, keys), omitKeys(b, keys));\n}\n\n/**\n * Create a new object with only the specified keys\n */\nexport function pickKeys<T extends object, K extends keyof T>(obj: T, keys: K[]): Expand<Pick<T, K>> {\n  const result: Partial<T> = {};\n  for (const key of keys) result[key] = obj[key];\n  return result as Expand<Pick<T, K>>;\n}\n\n/**\n * The result of zipping two objects.\n * Contains tuples of values for common keys.\n * (a, b) -> { [key]: [a[key], b[key]] }\n */\ntype ZipObjects<A extends Record<string, unknown>, B extends Record<string, unknown>> = Record<keyof A & keyof B, [A[keyof A], B[keyof B]]>;\n\n/**\n * Create a new object with the values of two objects zipped together.\n * Contains tuples of values for common keys.\n * (a, b) -> { [key]: [a[key], b[key]] }\n */\nexport function zipObjects<A extends Record<string, unknown>, B extends Record<string, unknown>>(a: A, b: B): ZipObjects<A, B> {\n  const aKeys = new Set(Object.keys(a));\n  const commonKeys = Object.keys(b).filter(key => aKeys.has(key));\n  return Object.fromEntries(commonKeys.map(key => [key, [a[key], b[key]]])) as ZipObjects<A, B>;\n}\n\nexport function mapObject<A extends Record<string, unknown>, B>(a: A, map: (value: A[keyof A], key: keyof A) => B): Record<keyof A, B> {\n  return Object.fromEntries(Object.entries(a).map(([key, value]) => [key, map(value as A[keyof A], key as keyof A)])) as Record<keyof A, B>;\n}\n\nexport function partitionObject<T extends Record<string, unknown>, K extends keyof T>(\n  obj: T,\n  predicate: (key: string, value: T[K]) => boolean\n): { true: Partial<T>; false: Partial<T> } {\n  const trueObj: Partial<T> = {};\n  const falseObj: Partial<T> = {};\n\n  for (const [key, value] of Object.entries(obj)) {\n    if (predicate(key, value as T[K])) {\n      trueObj[key as K] = value as T[K];\n    } else {\n      falseObj[key as K] = value as T[K];\n    }\n  }\n\n  return { true: trueObj, false: falseObj };\n}\n\n/**\n * Recursively replaces all instances of the given type with the new type.\n */\nexport function replaceDeep<V, S, T>(value: V, predicate: (v: unknown) => v is S, map: (v: S) => T): Replace<V, S, T> {\n  if (predicate(value)) {\n    return map(value) as Replace<V, S, T>;\n  }\n\n  if (Array.isArray(value)) {\n    let changed = false;\n    const result = value.map(v => {\n      const next = replaceDeep(v, predicate, map);\n      if (next !== v) changed = true;\n      return next;\n    });\n    return (changed ? result : value) as Replace<V, S, T>;\n  }\n\n  if (value && typeof value === 'object') {\n    let changed = false;\n    const result: Record<string, unknown> = {};\n    for (const [k, v] of Object.entries(value)) {\n      const next = replaceDeep(v, predicate, map);\n      if (next !== v) changed = true;\n      result[k] = next;\n    }\n    return (changed ? result : value) as Replace<V, S, T>;\n  }\n\n  return value as Replace<V, S, T>;\n}\n\nexport async function replaceDeepAsync<V extends object, S, T>(\n  value: V,\n  predicate: (v: unknown) => v is S,\n  map: (v: S) => Promise<T>\n): Promise<Replace<V, S, T>> {\n  const toReplace = new Map<S, Promise<T>>();\n\n  // 1\uFE0F\u20E3 First pass: collect all matches, don\u2019t modify structure\n  replaceDeep(value, predicate, v => {\n    if (!toReplace.has(v)) toReplace.set(v, map(v));\n    return v as unknown as T; // no replacement yet\n  });\n\n  // 2\uFE0F\u20E3 Resolve all replacements concurrently\n  const resolvedEntries = await Promise.all(Array.from(toReplace.entries()).map(async ([orig, promise]) => [orig, await promise] as const));\n  const resolved = new Map(resolvedEntries);\n\n  // 3\uFE0F\u20E3 Second pass: perform actual replacements using resolved map\n  const result = replaceDeep(\n    value,\n    (v): v is S => resolved.has(v as S),\n    v => {\n      const replacement = resolved.get(v as S);\n      if (replacement === undefined) {\n        throw new Error('Expected replacement value not found in resolved map');\n      }\n      return replacement;\n    }\n  );\n\n  return result as Replace<V, S, T>;\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\n// TODO [FFP-52929]: move all of these to one outbound api, add Squrral, PremPRo, Board\nimport { ExpressOpenWithMetadata } from './ffp-host-service/express-open-with/express-open-with-types.js';\nimport { ExternalAppOpenWithMetadata, FireflyGenerationTypeValues } from './types.js';\nimport { BlobRef } from '@adobe/data/cache';\nimport { Schema } from '@adobe/data/schema';\nimport { Service } from '@adobe/data/service';\n\nimport { typedKeys } from '../../functions/object-functions.js';\nimport { CommunityHubSubmitPayload } from '../../types/community-hub-submit-types.js';\nimport { AnalyticsService } from '../analytics-service/analytics-service.js';\nimport { AuthenticationService } from '../authentication-service/authentication-service.js';\nimport { CommerceDataService } from '../commerce-data-service/commerce-data-service.js';\nimport { ContentAuthenticityService } from '../content-authenticity-service/content-authenticity-service.js';\nimport { DataService } from '../data-service/data-service.js';\nimport { DeviceService } from '../device-service/device-service.js';\nimport { EntitlementService } from '../entitlement-service/entitlement-service.js';\nimport { EnvironmentService } from '../environment-service/environment-service.js';\nimport { ExperimentsService } from '../experiments-service/experiments-service.js';\nimport { GeoBlockService } from '../geo-block-service/geo-block-service.js';\nimport { LoggingService } from '../logging-service/logging-service.js';\nimport { NativeBridgeService } from '../native-bridge-service/native-bridge-service.js';\nimport { ReportAbuseService } from '../report-abuse/report-abuse-service.js';\nimport { SamService } from '../sam-service/sam-service.js';\nimport { SatelliteService } from '../satellite-service/satellite-service.js';\nimport { TemporaryStorageService } from '../temporary-storage-service/temporary-storage-service.js';\nimport { ToastService } from '../toast-service/toast-service.js';\nimport { VectorizationService } from '../vectorization-service/vectorization-service.js';\n\nexport type {\n  BaseExternalAppMetadata,\n  ExternalAppOpenWithMetadata,\n  PsWebMetadata,\n  PremiereProMetadata,\n  SquirrelMetadata,\n  BoardsMetadata,\n  IllustratorDesktopMetadata,\n} from './types.js';\nexport { PSWebTrafficOrigin } from './types.js';\n\n// This setting is only relevant for local development. On prod/stage, the feature flags are determined via AEP.\n// If the flag is set to true here, it will be on by default on localhost. Otherwise, it needs to be enabled via the\n// debugger.\nexport const HostFeatureFlagsDefault = {\n  commercePremium: true,\n  persistentHistoryStoreDisabled: false,\n  fireflyRebrand: true,\n  nbcuVideoEndpoint: false,\n  galleryExpansion: true,\n  isFireflyFeaturesAllowed: false,\n  relaxedModeEnterpriseAndTeams: false,\n  altEnvironment: false,\n  videoAltEnvironment: false,\n  enableUniversalAssetPicker: true,\n  gpt4oModel: true,\n  imagen3Model: true,\n  imagen4Model: true,\n  geminiFlashModel: true,\n  nanoBananaProModel: true,\n  nanoBananaProGroundSearchEnabled: true,\n  uploadCropper: true,\n  veo31Model: true,\n  veo31FastModel: true,\n  veo3Model: false,\n  enableVeo31ReferenceImage: false,\n  veo2Model: true,\n  pika22Model: true,\n  ray2Model: true,\n  ray3Model: true,\n  ray3FlashModel: true,\n  ray3HDRModel: true,\n  enableCaiModalUpdate: true,\n  enableMotionReference: true,\n  suppressIntroOverlays: false,\n  enableCustomModels: false,\n  fluxProModel: true,\n  fluxUltraModel: true,\n  fluxUltraRawModel: true,\n  flux2ProModel: false,\n  runwayGen4Model: true,\n  videoRunwayGen45Model: true,\n  videoRunwayGen45TurboModel: true,\n  videoRunwayGen4AlephModel: true,\n  fluxKontextMaxModel: true,\n  fluxKontextProModel: true,\n  fireflyImage5Model: true,\n  ideogram3Model: false,\n  ideogram3ImageModel: true,\n  enableUniversalAssetPickerMobile: false,\n  enableAddToBoard: false,\n  enableAddToCloud: false,\n  enableSharePublicLink: false,\n  mobileWebSfxSupport: true,\n  mobileAppSfxSupport: false,\n  image3pExperiment: true,\n  image3pDefaultExperiment: false,\n  generationHistoryVectors: false,\n  enableGenerateAsyncForVectorForAdobeModel: false,\n  enableElevenlabsModel: false,\n  enableOpenInFireflyVideoEditorGenerateSpeech: false,\n  enableBetaExcludedLanguagesForSpeech: false,\n  fireflyGlobalUdsKey: true,\n  enableCustomModelStoreHistory: false,\n  enableProjectsTabInDocumentPicker: false,\n  video3pPromo: false,\n  enable3pTasteForVideoGeneration: false,\n  enable3pFreeTasteForImageGeneration: false,\n  enable3pFreeTasteForInstructEdit: false,\n  enable3pFreeTasteForGeminiFlashCCI: false,\n  enable3pFreeTasteForVeo3CCI: false,\n  sora2Model: true,\n  sora2ProModel: true,\n  hideCostIndicatorAccountMenuLink: false,\n  multipleReferenceImagesEnabled: true,\n  persistentModelSelection: false,\n  thirdPartyModel: true,\n  enableMaxPromoUnlimitedGenerationsToast: false,\n  c2paWebContentAuthentication: false,\n  imsGuestSession: false,\n  enableMaxPromoExtension: false,\n  fireflyUserDirectCCT: false,\n  enableCreditTypeInCostApi: false,\n};\n\nexport type HostFeatureFlags = typeof HostFeatureFlagsDefault;\n\nexport const HostFeatureFlagsSophia = {\n  commercePremium: 'firefly-commerce-premium',\n  persistentHistoryStoreDisabled: 'firefly-persistent-history-store-disabled',\n  fireflyRebrand: 'firefly-homepage-redesign',\n  nbcuVideoEndpoint: 'firefly-nbcu-video-endpoint',\n  galleryExpansion: 'firefly-gallery-expansion',\n  isFireflyFeaturesAllowed: 'firefly-is-allowed',\n  relaxedModeEnterpriseAndTeams: 'firefly-commerce-cce-cct-premium-relaxed-mode',\n  altEnvironment: 'firefly-alt-environment',\n  videoAltEnvironment: 'firefly-video-alt-environment',\n  enableUniversalAssetPicker: 'firefly-enable-universal-asset-picker',\n  gpt4oModel: 'firefly-image-gpt-4o-model',\n  imagen3Model: 'firefly-image-imagen3-model',\n  imagen4Model: 'firefly-image-imagen4-model',\n  geminiFlashModel: 'firefly-image-gemini-flash-model',\n  nanoBananaProModel: 'firefly-image-nano-banana-pro-model',\n  nanoBananaProGroundSearchEnabled: 'firefly-image-nano-banana-pro-ground-search-enabled',\n  uploadCropper: 'firefly-upload-cropper',\n  veo31Model: 'firefly-video-veo31-model',\n  veo31FastModel: 'firefly-video-veo31-fast-model',\n  veo3Model: 'firefly-video-veo3-model',\n  enableVeo31ReferenceImage: 'firefly-video-enable-veo31-reference-image',\n  veo2Model: 'firefly-video-veo2-model',\n  pika22Model: 'firefly-video-pika22-model',\n  ray2Model: 'firefly-video-ray2-model',\n  ray3Model: 'firefly-video-ray3-model',\n  ray3FlashModel: 'firefly-video-ray3-flash-model',\n  ray3HDRModel: 'firefly-video-ray3-hdr-model',\n  video3pPromo: 'firefly-video-3p-promo',\n  enableCaiModalUpdate: 'firefly-enable-cai-modal-update',\n  enableMotionReference: 'firefly-camera-motion-reference',\n  suppressIntroOverlays: 'firefly-suppress-intro-overlays',\n  enableCustomModels: 'firefly-cm-enable-mfe-inference',\n  fluxProModel: 'firefly-image-flux-pro',\n  fluxUltraModel: 'firefly-image-flux-ultra',\n  fluxUltraRawModel: 'firefly-image-flux-ultra-raw',\n  flux2ProModel: 'firefly-image-flux2-pro',\n  runwayGen4Model: 'firefly-image-runway',\n  videoRunwayGen45Model: 'firefly-video-runway-gen45',\n  videoRunwayGen45TurboModel: 'firefly-video-runway-gen45-turbo',\n  videoRunwayGen4AlephModel: 'firefly-video-runway-gen4-aleph',\n  fluxKontextMaxModel: 'firefly-image-flux-kontext-max',\n  fluxKontextProModel: 'firefly-image-flux-kontext-pro',\n  fireflyImage5Model: 'firefly-image5-model',\n  ideogram3Model: 'firefly-vector-ideogram3-model',\n  ideogram3ImageModel: 'firefly-image-ideogram3-model',\n  enableUniversalAssetPickerMobile: 'firefly-mobile-cloud-asset-picker',\n  enableAddToBoard: 'firefly-files-action-add-to-board',\n  enableAddToCloud: 'firefly-files-action-add-to-cc',\n  enableSharePublicLink: 'firefly-history-asset-action-public-share',\n  mobileWebSfxSupport: 'firefly-t2sfx-mobile-support',\n  mobileAppSfxSupport: 'firefly-t2sfx-mobile-app',\n  image3pExperiment: 'firefly-image-3p-experiment',\n  image3pDefaultExperiment: 'firefly-image-3p-default-experiment',\n  generationHistoryVectors: 'generation-history-vectors',\n  enableGenerateAsyncForVectorForAdobeModel: 'enable-generate-async-for-vector-for-adobe-model',\n  enableElevenlabsModel: 'firefly-speech-elevenlabs-model',\n  enableOpenInFireflyVideoEditorGenerateSpeech: 'firefly-open-in-video-editor-generate-speech',\n  enableBetaExcludedLanguagesForSpeech: 'firefly-speech-enable-beta-excluded-languages',\n  fireflyGlobalUdsKey: 'firefly-global-uds-key',\n  enableCustomModelStoreHistory: 'firefly-cm-enable-store-history',\n  enableProjectsTabInDocumentPicker: 'firefly-files-collab-tabs',\n  enable3pTasteForVideoGeneration: 'firefly-enable-3p-free-taste-for-video-generation',\n  enable3pFreeTasteForImageGeneration: 'firefly-enable-3p-free-taste-for-image-generation',\n  enable3pFreeTasteForGeminiFlashCCI: 'enable-3p-free-taste-for-gemini-flash-cci',\n  enable3pFreeTasteForVeo3CCI: 'enable-3p-free-taste-for-veo-3-cci',\n  enable3pFreeTasteForInstructEdit: 'firefly-enable-3p-free-taste-for-instruct-edit',\n  sora2Model: 'firefly-video-sora2-model',\n  sora2ProModel: 'firefly-video-sora2-pro-model',\n  hideCostIndicatorAccountMenuLink: 'firefly-hide-generation-cost-account-link',\n  multipleReferenceImagesEnabled: 'firefly-image-multiple-reference-images-enabled',\n  persistentModelSelection: 'firefly-persistent-model-selection',\n  thirdPartyModel: 'firefly-image-third-party-models',\n  enableMaxPromoUnlimitedGenerationsToast: 'firefly-max-promo-unlimited-generations-toast',\n  c2paWebContentAuthentication: 'firefly-c2pa-web-content-authentication',\n  imsGuestSession: 'firefly-ims-guest-session',\n  enableMaxPromoExtension: 'firefly-enable-max-promo-extension',\n  fireflyUserDirectCCT: 'firefly-user-direct-cct-user',\n  enableCreditTypeInCostApi: 'firefly-enable-credit-type-in-cost-api',\n} as const satisfies Record<keyof HostFeatureFlags, string>;\n\nexport const HostFeatureFlagsKeysSchema = {\n  enum: typedKeys(HostFeatureFlagsDefault),\n} as const satisfies Schema;\n\nexport type HostUserData = { 'accepted terms of use 3p:general': boolean };\nexport const DefaultHostUserData: HostUserData = { 'accepted terms of use 3p:general': false } as const;\n\nexport interface HostSubServices {\n  features: DataService<HostFeatureFlags>;\n  experiments: ExperimentsService;\n  satellite: SatelliteService;\n  environment: EnvironmentService;\n  authentication: AuthenticationService;\n  contentAuthenticity: ContentAuthenticityService;\n  entitlement: EntitlementService;\n  commerceData: CommerceDataService;\n  analytics: AnalyticsService;\n  logging: LoggingService;\n  geoBlock: GeoBlockService;\n  toast: ToastService;\n  device: DeviceService;\n  report: ReportAbuseService;\n  sam: SamService;\n  nativeBridge: NativeBridgeService;\n  temporaryStorage: TemporaryStorageService;\n  userData: DataService<HostUserData>;\n  vectorization: VectorizationService;\n}\n\nexport interface HostActions {\n  /**\n   * Opens the host applications generation history view.\n   * This may navigate away from the current page.\n   * In principle, it could also just open up a modal dialog.\n   */\n  openGenerationHistory(filter?: FireflyGenerationTypeValues): void;\n\n  /**\n   * Opens the host applications persistent favorites view.\n   */\n  openPersistentFavorites(filter?: FireflyGenerationTypeValues): void;\n\n  /**\n   * Opens the Adobe account menu in the parent application.\n   */\n  openAccountMenu(): void;\n\n  /**\n   * Submit Asset To Community Gallery\n   */\n  submitToGallery(payload: CommunityHubSubmitPayload): Promise<{ success: boolean; message: string }>;\n\n  /**\n   * Opens the target application (Adobe Express) with the given data blob.\n   */\n  openWithExpress(props: { blob: BlobRef; metadata: ExpressOpenWithMetadata; isProduction: boolean }): Promise<void>;\n  getOpenExpressUrl(props: { blob: BlobRef; metadata: ExpressOpenWithMetadata; isProduction: boolean }): Promise<string>;\n\n  /**\n   * Opens the target application with the given data metadata.\n   */\n  openWithExternalApp(props: ExternalAppOpenWithMetadata): void;\n\n  /**\n   * Opens video generation app with pre-selected image and prompt\n   */\n  openVideoGenerationApp: (state: { image?: BlobRef; prompt?: string; enableTransparentVideo?: boolean }) => void;\n\n  /**\n   * Opens sound effects generation app with pre-selected video and prompt\n   */\n  openSoundEffectsGenerationApp: (state: { video?: BlobRef; prompt?: string }) => void;\n\n  /**\n   * Opens generative fill app with pre-selected image\n   */\n  openGenerativeFillApp: (state: { image: BlobRef; contextGuid?: string }) => void;\n\n  /**\n   * Opens the home page of the host application.\n   */\n  openHomePage(): void;\n}\n\n/**\n * Represents the host application service interface.\n * Provides functions which can be invoked from hosted applications.\n */\nexport interface HostService extends HostActions, HostSubServices, Service {}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { Observe } from '@adobe/data/observe';\nimport { FromSchema, Schema } from '@adobe/data/schema';\nimport { Service } from '@adobe/data/service';\n\nimport { SizeSchema } from '../../types/graphics-types.js';\nimport { HostFeatureFlagsKeysSchema } from '../host-service/host-service.js';\n\nexport const GraphicGenerationModeSchema = {\n  enum: ['fast', 'standard'],\n} as const satisfies Schema;\nexport type GraphicGenerationMode = FromSchema<typeof GraphicGenerationModeSchema>;\n\nconst GraphicGenerationModeConfigSchema = {\n  type: 'object',\n  required: ['outputSizes'],\n  additionalProperties: false,\n  properties: {\n    // The sizes that this mode can output.\n    outputSizes: {\n      type: 'array',\n      items: SizeSchema,\n    },\n    // Whether this mode supports upscale.\n    upscale: { type: 'boolean' },\n    // The number of generations per prompt.\n    generations: { type: 'number' },\n    defaultSizeMobile: SizeSchema,\n    defaultSizeDesktop: SizeSchema,\n  },\n} as const satisfies Schema;\n\nexport type GraphicGenerationModeConfig = FromSchema<typeof GraphicGenerationModeConfigSchema>;\n\nexport const GraphicGenerationModelSchema = {\n  type: 'object',\n  required: ['name', 'description', 'modes'],\n  additionalProperties: false,\n  properties: {\n    // Unlocalized model name.\n    name: { type: 'string' },\n    // Optional display name for UI, overrides name\n    displayName: { type: 'string' },\n    // Unlocalized model description.\n    description: { type: 'string' },\n    // Optional thumbnail for UI.\n    thumbnail: { type: 'string' },\n    // Company name that created this model (e.g., \"Adobe\", \"Google\", \"Luma AI\")\n    // Optional: Currently only used by video generation for CAI modal\n    companyName: { type: 'string' },\n    // Whether this model supports async generation.\n    async: { type: 'boolean' },\n    // The modes that this model supports.\n    modelId: { type: 'string' },\n    modes: {\n      type: 'object',\n      required: ['standard'],\n      additionalProperties: GraphicGenerationModeConfigSchema,\n      properties: {\n        standard: GraphicGenerationModeConfigSchema,\n      },\n    },\n    // If true, this model is a premium model\n    isPremium: { type: 'boolean' },\n    // If true, this model is a free taste model.\n    isFreeTasteAvailable: { type: 'boolean' },\n    // If present, enables the experimental settings panel for this model.\n    experimental: { type: 'boolean' },\n    // If present, these headers are added to the API request's x-colligo-debug-input header.\n    debugHeaders: { type: 'object', additionalProperties: { type: 'string' } },\n    // If true, this model is a third party model.\n    isThirdParty: { type: 'boolean' },\n    featureFlag: HostFeatureFlagsKeysSchema,\n    // Quality ranking for sorting (lower = higher quality, 0 = highest)\n    quality: { type: 'number' },\n  },\n} as const satisfies Schema;\n\nexport type GraphicGenerationModel = FromSchema<typeof GraphicGenerationModelSchema>;\n\nconst GraphicGenerationErrorCodeSchema = {\n  enum: [\n    'unknown',\n    'access_error',\n    'too_many_requests',\n    'service_error',\n    'language_not_supported',\n    'user_profile_denied',\n    'user_not_entitled',\n    'user_blocked_by_admin',\n    'user_blocked_violation',\n    'prompt_too_long',\n    'prompt_unsafe',\n    'blocked_artists',\n    'denied_words',\n    'image_too_small',\n    'unsupported_aspect_ratio',\n    'output_unsafe',\n    'reference_image_unsafe_error',\n    'region_blocked',\n    'token_invalid',\n    'invalid_scope',\n    'job_timeout',\n    'job_canceled',\n    'daily_limit',\n    'network_disconnected',\n  ],\n} as const satisfies Schema;\n\nconst RateLimitedErrorCodeSchema = {\n  enum: ['rate_limited'],\n} as const satisfies Schema;\n\nexport const RateLimitedErrorSchema = {\n  type: 'object',\n  properties: {\n    code: RateLimitedErrorCodeSchema,\n    retryTime: { type: 'string', pattern: '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}Z$' },\n  },\n  required: ['code', 'retryTime'],\n  additionalProperties: false,\n} as const satisfies Schema;\nexport type RateLimitedError = FromSchema<typeof RateLimitedErrorSchema>;\n\nexport const BasicGraphicGenerationErrorSchema = {\n  type: 'object',\n  properties: {\n    code: GraphicGenerationErrorCodeSchema,\n  },\n  required: ['code'],\n  additionalProperties: false,\n} as const satisfies Schema;\nexport type BasicGraphicGenerationError = FromSchema<typeof BasicGraphicGenerationErrorSchema>;\n\nexport const GraphicGenerationErrorSchema = {\n  oneOf: [RateLimitedErrorSchema, BasicGraphicGenerationErrorSchema],\n} as const satisfies Schema;\nexport type GraphicGenerationError = FromSchema<typeof GraphicGenerationErrorSchema>;\n\nexport interface GraphicGenerationService<Model extends GraphicGenerationModel> extends Service {\n  /**\n   * Returns an observable list of all models supported by this service.\n   */\n  models: Observe<Record<string, Model>>;\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { Schema } from '@adobe/data/schema';\n\n/**\n * A function that represents a transient, sequential series of actions that must end with a commit or cancel.\n * This is the only service action which can return a value other than void.\n * It is intended to be used for multiframe transactions.\n */\nexport type SequentialAction<Args extends unknown[]> = (...args: Args) => SequentialActionResult<Args>;\nexport type SequentialActionResult<Args extends unknown[]> = {\n  update: (...args: Args) => SequentialActionResult<Args>;\n  cancel: () => void;\n  commit: () => void;\n};\n\n/**\n * Returns a json schema for an intermediate result with the specified value schema which defaults to null.\n */\nexport function IntermediateResultSchemaLegacy<T extends Schema = { type: 'null' }>(valueSchema: T) {\n  return {\n    type: 'object',\n    properties: {\n      value: valueSchema,\n      progress: { type: 'number', minimum: 0.0, maximum: 1.0 },\n      retryAfter: { type: 'number', minimum: 0 },\n    },\n    required: ['value', 'progress'],\n    additionalProperties: false,\n  } as const;\n}\n\n/**\n * Represents an intermediate result of a progressive operation.\n */\nexport type IntermediateResultLegacy<Value = null> = {\n  /**\n   * The current intermediate value if any.\n   */\n  readonly value: Value;\n  /**\n   * The progress of the operation from 0.0 to 1.0.\n   */\n  readonly progress: number;\n  /**\n   * The number of seconds to wait before retrying the operation.\n   */\n  readonly retryAfter?: number;\n};\n\n/**\n * Returns a json schema for an final result with the specified value schema.\n */\nexport function SuccessResultSchemaLegacy<T extends Schema>(valueSchema: T) {\n  return {\n    type: 'object',\n    properties: {\n      value: valueSchema,\n      progress: { const: 1.0 },\n    },\n    required: ['value', 'progress'],\n    additionalProperties: false,\n  } as const;\n}\n\n/**\n * Represents a final result of a progressive operation.\n */\nexport type SuccessResultLegacy<Value> = {\n  readonly value: Value;\n  readonly progress: 1.0;\n};\n\n/**\n * Returns a json schema for an error result with the specified value schema.\n */\nexport function ErrorResultSchemaLegacy<T extends Schema>(valueSchema: T) {\n  return {\n    type: 'object',\n    properties: {\n      error: valueSchema,\n    },\n    required: ['error'],\n    additionalProperties: false,\n  } as const;\n}\nexport type ErrorResultLegacy<Value> = {\n  readonly value?: never;\n  readonly progress?: never;\n  readonly error: Value;\n};\n\n/**\n * These types and functions are used to represent intermediate and final results of a progressive operation.\n * This will commonly be used in situations where you start a service interaction and then poll for results.\n */\nexport type ProgressiveResultLegacy<FinalValue, ErrorValue = never, IntermediateValue = null> =\n  | IntermediateResultLegacy<IntermediateValue>\n  | SuccessResultLegacy<FinalValue>\n  | ErrorResultLegacy<ErrorValue>;\n\nexport function ProgressiveResultSchemaLegacy<T extends Schema, E extends Schema, U extends Schema>(\n  successSchema: T,\n  errorSchema: E,\n  intermediateSchema: U\n) {\n  return {\n    oneOf: [\n      IntermediateResultSchemaLegacy(intermediateSchema),\n      SuccessResultSchemaLegacy(successSchema),\n      ErrorResultSchemaLegacy(errorSchema),\n    ],\n  } as const;\n}\n\n/**\n * Checks if the result is an error result.\n */\nexport function isErrorResultLegacy<FinalValue, ErrorValue, IntermediateValue>(\n  result: ProgressiveResultLegacy<FinalValue, ErrorValue, IntermediateValue>\n): result is ErrorResultLegacy<ErrorValue> {\n  return 'error' in result;\n}\n\n/**\n * Checks if the result is not started. We check progress < 0.0 to mean not started.\n */\nexport function isNotStartedLegacy<FinalValue, ErrorValue, IntermediateValue>(\n  result: ProgressiveResultLegacy<FinalValue, ErrorValue, IntermediateValue>\n): result is IntermediateResultLegacy<IntermediateValue> {\n  return !isErrorResultLegacy(result) && result.progress < 0.0;\n}\n\n/**\n * Checks if the result is an intermediate result.\n */\nexport function isIntermediateResultLegacy<FinalValue, ErrorValue, IntermediateValue>(\n  result: ProgressiveResultLegacy<FinalValue, ErrorValue, IntermediateValue>\n): result is IntermediateResultLegacy<IntermediateValue> {\n  return !isErrorResultLegacy(result) && result.progress < 1.0;\n}\n\n/**\n * Checks if the result is a final result.\n */\nexport function isSuccessResultLegacy<FinalValue, ErrorValue = unknown, IntermediateValue = unknown>(\n  result: ProgressiveResultLegacy<FinalValue, ErrorValue, IntermediateValue>\n): result is SuccessResultLegacy<FinalValue> {\n  return !isErrorResultLegacy(result) && result.progress === 1.0;\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { VideoGenerationModel } from './video-generation-model.js';\nimport { BlobRefSchema } from '@adobe/data/cache';\nimport { FromSchema, Nullable, Schema } from '@adobe/data/schema';\n\nimport { ClinetoSize } from '../../openapi/colligo-video/index.js';\n\nimport { AspectRatioSchema, Size, SizeSchema } from '../../types/graphics-types.js';\nimport { CommerceStatusSchema } from '../commerce-data-service/commerce-data-types.js';\nimport { CreditCostPayload } from '../credit-cost-service/credit-cost-service.js';\nimport { Entitlement } from '../entitlement-service/entitlement-service.js';\nimport {\n  BasicGraphicGenerationErrorSchema,\n  GraphicGenerationService,\n  RateLimitedError,\n  RateLimitedErrorSchema,\n} from '../graphic-generation-service/graphic-generation-service.js';\nimport {\n  ErrorResultLegacy,\n  IntermediateResultLegacy,\n  ProgressiveResultLegacy,\n  ProgressiveResultSchemaLegacy,\n  SuccessResultLegacy,\n} from '../types.js';\n\nexport * from '../commerce-data-service/commerce-data-types.js';\n\nexport * from './video-generation-model.js';\n\nexport type { ClinetoSize as Size };\n\n// TODO: [FFP-63375] increase this once we enable video strip samjs.\nexport const NUM_OF_VIDEOS_PRELOAD = 1;\n\nexport const VideoGenerationModelIdInternalSchema = {\n  enum: ['adobe:firefly:colligo:video1'],\n} as const satisfies Schema;\nexport type VideoGenerationModelIdInternal = FromSchema<typeof VideoGenerationModelIdInternalSchema>;\n\nexport const VideoGenerationModelIdThirdPartySchema = {\n  enum: [\n    'pika:firefly:colligo:pika22',\n    'luma:firefly:colligo:ray2',\n    'luma:firefly:colligo:ray3',\n    'luma:firefly:colligo:ray3-flash',\n    'luma:firefly:colligo:ray3-hdr',\n    'google:firefly:colligo:veo31',\n    'google:firefly:colligo:veo31-fast',\n    'google:firefly:colligo:veo3',\n    'google:firefly:colligo:veo2',\n    'video:runway:firefly:colligo:gen4_aleph',\n    'video:runway:firefly:colligo:gen45',\n    'video:runway:firefly:colligo:gen45_turbo',\n    'openai:firefly:colligo:sora2',\n    'openai:firefly:colligo:sora2-pro',\n  ],\n} as const satisfies Schema;\n\nexport type VideoGenerationModelIdThirdParty = FromSchema<typeof VideoGenerationModelIdThirdPartySchema>;\n\nexport const VideoGenerationModelIdSchema = {\n  enum: [...VideoGenerationModelIdInternalSchema.enum, ...VideoGenerationModelIdThirdPartySchema.enum],\n} as const satisfies Schema;\nexport type VideoGenerationModelId = FromSchema<typeof VideoGenerationModelIdSchema>;\n\nexport const DefaultVideoGenerationModelId = 'adobe:firefly:colligo:video1' as const satisfies VideoGenerationModelId;\nexport const DefaultVideoGenerationModelVersion = 'video1_8_standard';\n\nexport const JobModeSchema = {\n  enum: ['standard', 'relaxed'],\n} as const satisfies Schema;\n\nexport type JobMode = FromSchema<typeof JobModeSchema>;\n\nexport const VideoSpecificErrorCodeSchema = {\n  enum: ['daily_limit', 'relaxed_mode_limit_exhausted', 'insufficient_credits', 'partner_3p_service_unavailable'],\n} as const satisfies Schema;\nexport type VideoSpecificErrorCode = FromSchema<typeof VideoSpecificErrorCodeSchema>;\n\nexport const VideoProgressTypeSchema = {\n  enum: ['none', 'queued', 'determinate', 'indeterminate'],\n} as const satisfies Schema;\n\nexport type VideoProgressType = FromSchema<typeof VideoProgressTypeSchema>;\n\nexport const BasicErrorSchema = {\n  type: 'object',\n  properties: {\n    code: VideoSpecificErrorCodeSchema,\n    jobMode: JobModeSchema,\n  },\n  required: ['code'],\n  additionalProperties: false,\n} as const satisfies Schema;\nexport type BasicError = FromSchema<typeof BasicErrorSchema>;\n\nconst VideoRateLimitedErrorSchema = {\n  type: 'object',\n  properties: {\n    ...RateLimitedErrorSchema.properties,\n    jobMode: JobModeSchema,\n  },\n  required: [...RateLimitedErrorSchema.required],\n  additionalProperties: false,\n} as const satisfies Schema;\n\nexport type VideoRateLimitedError = RateLimitedError & FromSchema<typeof VideoRateLimitedErrorSchema>;\n\nconst VideoClientCancelledGenerationErrorSchema = {\n  type: 'object',\n  properties: {\n    code: { type: 'string', enum: ['client_cancelled_generation'] },\n  },\n  required: ['code'],\n} as const satisfies Schema;\n\nexport const VideoGenerationErrorSchema = {\n  oneOf: [BasicErrorSchema, BasicGraphicGenerationErrorSchema, VideoRateLimitedErrorSchema, VideoClientCancelledGenerationErrorSchema],\n} as const satisfies Schema;\nexport type VideoGenerationError = FromSchema<typeof VideoGenerationErrorSchema>;\n\nexport const FPSSchema = { type: 'number', enum: [24] } as const satisfies Schema;\nexport type Fps = FromSchema<typeof FPSSchema>;\n\nexport const VideoAspectRatioSchema = {\n  enum: [...AspectRatioSchema.enum, 'ultraWide', 'ultraTall'],\n} as const satisfies Schema;\nexport type VideoAspectRatio = FromSchema<typeof VideoAspectRatioSchema>;\n\nexport const AspectRatioDisplaySchema = {\n  type: 'object',\n  properties: {\n    name: VideoAspectRatioSchema,\n    format: { type: 'string' },\n  },\n  required: ['name'],\n} as const satisfies Schema;\nexport type AspectRatioDisplay = FromSchema<typeof AspectRatioDisplaySchema>;\n\nexport const CameraMotionSchema = {\n  enum: [\n    'camera zoom in',\n    'camera zoom out',\n    'camera pan left',\n    'camera pan right',\n    'camera tilt up',\n    'camera tilt down',\n    'camera static',\n    'camera handheld',\n  ],\n} as const satisfies Schema;\nexport type CameraMotion = FromSchema<typeof CameraMotionSchema>;\n\nexport const CameraAngleSchema = {\n  enum: ['none', 'aerial shot', 'eye_level shot', 'high angle shot', 'low angle shot', 'top-down shot'],\n} as const satisfies Schema;\nexport type CameraAngle = FromSchema<typeof CameraAngleSchema>;\nexport const CameraAngleDefault: CameraAngle = 'none';\n\nexport const CameraShotSizeSchema = {\n  enum: ['none', 'extreme close-up', 'close-up shot', 'medium shot', 'long shot', 'extreme long shot'],\n} as const satisfies Schema;\nexport type CameraShotSize = FromSchema<typeof CameraShotSizeSchema>;\nexport const CameraShotSizeDefault: CameraShotSize = 'none';\n\nexport const VideoPromptStyleSchema = {\n  enum: ['2d', '3d', 'anime', 'black and white', 'cinematic', 'claymation', 'fantasy', 'line art', 'stop motion', 'vector art'],\n} as const satisfies Schema;\nexport type VideoPromptStyle = FromSchema<typeof VideoPromptStyleSchema>;\n\nexport const CameraSchema = {\n  type: 'object',\n  properties: {\n    motion: Nullable(CameraMotionSchema),\n    angle: CameraAngleSchema,\n    shotSize: CameraShotSizeSchema,\n    promptStyle: Nullable(VideoPromptStyleSchema),\n  },\n  required: ['motion', 'angle', 'shotSize'],\n  additionalProperties: false,\n} as const satisfies Schema;\nexport type Camera = FromSchema<typeof CameraSchema>;\nexport const CameraDefault: Camera = {\n  motion: null,\n  angle: CameraAngleDefault,\n  shotSize: CameraShotSizeDefault,\n  promptStyle: null,\n};\n\nexport const VideoGenerationReferenceImageSchema = Nullable(BlobRefSchema);\nexport const VideoGenerationReferenceVideoSchema = Nullable(BlobRefSchema);\nexport type VideoGenerationReferenceImage = FromSchema<typeof VideoGenerationReferenceImageSchema>;\nexport type VideoGenerationReferenceVideo = FromSchema<typeof VideoGenerationReferenceVideoSchema>;\nexport const VideoGenerationReferenceImageDefault: VideoGenerationReferenceImage = null;\nexport const VideoGenerationReferenceVideoDefault: VideoGenerationReferenceVideo = null;\nexport const VideoGenerationCameraMotionReferenceVideoDefault: VideoGenerationReferenceVideo = null;\n\nexport const VideoGenerationSettingsSchema = {\n  type: 'object',\n  properties: {\n    model: { type: 'string' },\n    size: SizeSchema,\n    prompt: { type: 'string' },\n    negativePrompt: { type: 'string' },\n    referenceFrames: { type: 'array', items: VideoGenerationReferenceImageSchema },\n    referenceVideo: VideoGenerationReferenceVideoSchema,\n    cameraMotionReferenceVideo: VideoGenerationReferenceVideoSchema,\n    seed: { type: 'string' },\n    generateAudio: { type: 'boolean' },\n    generateLoop: { type: 'boolean' },\n    transparentBackground: { type: 'boolean' },\n    // if present, allows overriding the video generation endpoint.\n    debugGenerationEndpoint: { type: 'string' },\n    fps: FPSSchema,\n    camera: CameraSchema,\n    locale: { type: 'string' },\n    jobMode: JobModeSchema,\n    duration: { type: 'number' },\n    // Edit tab fields\n    editReferenceVideo: VideoGenerationReferenceVideoSchema,\n    editAction: { type: 'string', enum: ['modify', 'extend'] },\n    referenceImages: { type: 'array', items: BlobRefSchema },\n  },\n  required: ['model', 'seed', 'prompt', 'negativePrompt', 'fps', 'camera', 'referenceFrames', 'locale', 'jobMode'],\n  additionalProperties: false,\n} as const satisfies Schema;\nexport type VideoGenerationSettings = FromSchema<typeof VideoGenerationSettingsSchema>;\nexport const VideoGenerationSettingsDefault: VideoGenerationSettings = {\n  model: '',\n  prompt: '',\n  negativePrompt: 'cartoon, vector art, & bad aesthetics & poor aesthetic',\n  referenceFrames: [VideoGenerationReferenceImageDefault, VideoGenerationReferenceImageDefault],\n  referenceVideo: VideoGenerationReferenceVideoDefault,\n  cameraMotionReferenceVideo: VideoGenerationCameraMotionReferenceVideoDefault,\n  seed: '',\n  generateAudio: false,\n  generateLoop: false,\n  transparentBackground: false,\n  fps: 24,\n  camera: CameraDefault,\n  locale: 'en-US',\n  jobMode: 'standard',\n  debugGenerationEndpoint: '',\n  duration: 5,\n  // Edit tab defaults\n  editReferenceVideo: null,\n  editAction: 'modify',\n  referenceImages: [],\n};\n\nexport type SettingsKey = keyof VideoGenerationSettings;\n\nconst VideoGenerationSuccessMetaSchema = {\n  type: 'object',\n  properties: {\n    promptHasDeniedWords: { type: 'boolean' },\n    promptHasBlockedArtists: { type: 'boolean' },\n    storageQuotaExceeded: { type: 'boolean' },\n    storageFailed: { type: 'boolean' },\n  },\n  additionalProperties: false,\n} as const satisfies Schema;\n\nexport const VideoGenerationSuccessSchema = {\n  type: 'object',\n  properties: {\n    video: BlobRefSchema,\n    alphaVideo: BlobRefSchema,\n    buildVersion: { type: 'string' },\n    modelVersion: { type: 'string' },\n    meta: VideoGenerationSuccessMetaSchema,\n    commerce: CommerceStatusSchema,\n    thumbnail: BlobRefSchema,\n    /**\n     * Creative Cloud File Id such as \"urn:aaid:sc:VA6C2:72eebeb9-88d4-3f9b-80ed-88ef22542152\"\n     * Only present for persisted videos.\n     */\n    fileId: { type: 'string' },\n    /**\n     * The job mode used for this video generation.\n     * This can change during generation if the server decides to use a different mode.\n     */\n    jobMode: JobModeSchema,\n    /*\n     *\n     * This indicates whether the video is a community gallery asset\n     */\n    isCommunityAsset: { type: 'boolean' },\n    /*\n     *\n     * This indicates whether the video is owned by user\n     */\n    isOwnedByCurrentUser: { type: 'boolean' },\n    /**\n     * Localized prompts for video. Applicable only for community gallery assets.\n     */\n    promptLocalization: {\n      type: 'object',\n      additionalProperties: { type: 'string' },\n    },\n  },\n  required: ['video', 'modelVersion', 'fileId'],\n  additionalProperties: false,\n} as const satisfies Schema;\n\nexport type VideoGenerationSuccess = FromSchema<typeof VideoGenerationSuccessSchema>;\n\n/**\n * Intermediate result may have video but not be final yet because it has not been persisted\n * so fileId is still missing. We can still show the video to the user at this point.\n */\nexport const VideoGenerationIntermediateSchema = {\n  ...VideoGenerationSuccessSchema,\n  required: [],\n} as const satisfies Schema;\n\nexport type VideoGenerationIntermediate = FromSchema<typeof VideoGenerationIntermediateSchema>;\n\n//  X generic parameter is for service specific extensions.\n//  not to be used by consumer, but only for services internal usage, for instance to track urls/ids for checking progress.\nexport type VideoGenerationIntermediateResult<X = undefined> = X extends undefined\n  ? IntermediateResultLegacy<VideoGenerationIntermediate>\n  : IntermediateResultLegacy<VideoGenerationIntermediate & X>;\nexport type VideoGenerationSuccessResult = SuccessResultLegacy<VideoGenerationSuccess>;\nexport type VideoGenerationErrorResult = ErrorResultLegacy<VideoGenerationError>;\nexport type VideoGenerationResult = ProgressiveResultLegacy<VideoGenerationSuccess, VideoGenerationError, VideoGenerationIntermediate>;\n\nexport const VideoGenerationResultSchema = ProgressiveResultSchemaLegacy(\n  VideoGenerationSuccessSchema,\n  VideoGenerationErrorSchema,\n  VideoGenerationIntermediateSchema\n);\n\n/**\n * Validation error codes that can be returned by model validators.\n * These represent validation failures that should be communicated to the user.\n * The video application MUST support all of these as TransientEvents.\n */\nexport const validationErrors = ['transparent_background_png_only', 'first_frame_dimensions_mismatch'] as const;\nexport type ValidationError = (typeof validationErrors)[number];\n\n/**\n * Video-specific parameters for credit cost calculation\n */\n// TODO - make this simpler and pass the full settings in. The payload creation and the cost params creation generate the same outputs and can be shared.\nexport interface VideoCreditCostParams {\n  models: Partial<Record<VideoGenerationModelId, VideoGenerationModel>>;\n  model: VideoGenerationModelId | null;\n  size: Size;\n  generateAudio: boolean | undefined;\n  videoDuration: number; // in seconds\n  isSignedIn: boolean;\n  entitlement: Entitlement;\n  isRelaxedMode: boolean;\n}\n\nexport interface VideoGenerationService extends GraphicGenerationService<VideoGenerationModel> {\n  /**\n   * Generates a new video from a text prompt and an optional reference image.\n   * @param prompt the text to generate the video from.\n   * @param duration the duration of the video to generate in seconds.\n   * @returns the generated video blob.\n   */\n  generateVideo(props: VideoGenerationSettings): Promise<VideoGenerationResult>;\n\n  /**\n   * Given an intermediate result, returns either a final result or a new intermediate result.\n   * This can be polled around once per second.\n   * The intermediate result *could* be serialized or otherwise persisted to be used later.\n   * The service ought to handle that correctly.\n   */\n  checkVideoGeneration(result: VideoGenerationIntermediateResult): Promise<VideoGenerationResult>;\n\n  /**\n   * Cancels the video generation operation.\n   */\n  cancelVideoGeneration(result: VideoGenerationIntermediateResult): Promise<void>;\n\n  /**\n   * Validates the video generation settings for a given model.\n   * @param settings the settings to validate.\n   * @returns an array of validation error codes.\n   */\n  validateVideoGenerationSettings(settings: VideoGenerationSettings): Promise<readonly ValidationError[]>;\n\n  // I don't like this. We're exposing types that consumer's really shouldn't have to know or care about.\n  // I think we should just provide an async API to fetch the credit cost directly.\n  // Then we can rework the credit-cost-service to use this API with some added caching and debouncing.\n  /**\n   * Creates a credit cost payload from the video generation parameters.\n   * @param params the parameters to create the payload from.\n   * @returns the credit cost payload.\n   */\n  createVideoCreditCostPayload(params: VideoCreditCostParams): CreditCostPayload;\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details\nimport { FromSchema, Schema } from '@adobe/data/schema';\n\nimport { GraphicGenerationModelSchema } from '../graphic-generation-service/graphic-generation-service.js';\n\n// Todo: Pull allowed values for settings out of SupportedSettings.\nexport const BooleanInputSchema = {\n  type: 'object',\n  properties: {\n    supported: { oneOf: [{ type: 'boolean' }, { type: 'string' }] },\n    // allowedValues == [true] => constrained to true, [true, false] => user choice\n    allowedValues: { type: 'array', items: { type: 'boolean' } },\n    defaultValue: { type: 'boolean' },\n  },\n  required: ['supported', 'allowedValues', 'defaultValue'],\n  additionalProperties: false,\n} as const satisfies Schema;\n\nexport type BooleanInput = FromSchema<typeof BooleanInputSchema>;\n\n// Todo: Make all these properties plain booleans. Use patch configs rather than feature flags.\nexport const SupportedSettingsSchema = {\n  type: 'object',\n  properties: {\n    supportsCamera: { type: 'boolean' },\n    supportsStyle: { type: 'boolean' },\n    supportsSubjectReference: { type: 'boolean' },\n    supportsEditReferenceVideo: { oneOf: [{ type: 'boolean' }, { type: 'string' }] },\n    supportsFirstFrame: { oneOf: [{ type: 'boolean' }, { type: 'string' }] },\n    supportsLastFrame: { oneOf: [{ type: 'boolean' }, { type: 'string' }] },\n    supportsSeed: { type: 'boolean' },\n    supportsDeterminateProgress: { type: 'boolean' },\n    supportsAudio: { oneOf: [{ type: 'boolean' }, { type: 'string' }, BooleanInputSchema] },\n    supportsLoop: { oneOf: [{ type: 'boolean' }, { type: 'string' }, BooleanInputSchema] },\n    supportsTransparency: { oneOf: [{ type: 'boolean' }, { type: 'string' }, BooleanInputSchema] },\n  },\n  additionalProperties: false,\n} as const satisfies Schema;\n\nexport type SupportedSettings = FromSchema<typeof SupportedSettingsSchema>;\n\nexport const SupportedSettingsDefault: Record<keyof SupportedSettings, boolean> = {\n  supportsCamera: false,\n  supportsStyle: false,\n  supportsSeed: true,\n  supportsLoop: false,\n  supportsFirstFrame: false,\n  supportsLastFrame: false,\n  supportsSubjectReference: false,\n  supportsEditReferenceVideo: false,\n  supportsAudio: false,\n  supportsTransparency: false,\n  supportsDeterminateProgress: false,\n};\n\n// Represents a range of numbers with inclusive bounds and a step size. A step size of 0 indicates that the range is continuous.\nexport const RangeSchema = {\n  type: 'object',\n  properties: {\n    min: { type: 'number' },\n    max: { type: 'number' },\n    step: { type: 'number' },\n  },\n  required: ['min', 'max', 'step'],\n} as const satisfies Schema;\nexport type Range = FromSchema<typeof RangeSchema>;\n\nexport const DurationSchema = {\n  type: 'object',\n  properties: {\n    default: { type: 'number' },\n    range: RangeSchema,\n    twoFrameRange: RangeSchema,\n  },\n  required: ['default', 'range'],\n} as const satisfies Schema;\n\nexport const StructureReferenceSchema = {\n  type: 'object',\n  properties: {\n    mimeTypes: { type: 'array', items: { type: 'string' } },\n    minDuration: { type: 'number' },\n    maxDuration: { type: 'number' },\n    minFrameRate: { type: 'number' },\n    maxFrameRate: { type: 'number' },\n    minResolution: { type: 'number' },\n    maxResolution: { type: 'number' },\n    maxFileSize: { type: 'number' },\n  },\n  required: ['mimeTypes', 'minDuration', 'maxDuration', 'minFrameRate', 'maxFrameRate', 'minResolution', 'maxResolution', 'maxFileSize'],\n  additionalProperties: false,\n} as const satisfies Schema;\n\nexport const VideoGenerationModelSettingsSchema = {\n  type: 'object',\n  properties: {\n    duration: DurationSchema,\n    structureReference: StructureReferenceSchema,\n    requiresEditReferenceVideo: { type: 'boolean' },\n    referencesMustMatchOutputResolution: { type: 'boolean' },\n    referenceImagesLimit: { type: 'number' },\n  },\n  required: ['duration'],\n  additionalProperties: false,\n} as const satisfies Schema;\n\nexport type VideoGenerationModelSettings = FromSchema<typeof VideoGenerationModelSettingsSchema>;\n\nexport const VideoGenerationModelSettingsDefault = {\n  duration: {\n    default: 5,\n    range: { min: 5, max: 5, step: 1 },\n  },\n  structureReference: {\n    mimeTypes: ['video/mp4', 'video/quicktime'],\n    minDuration: 5,\n    maxDuration: 20,\n    minFrameRate: 12 - 0.499,\n    maxFrameRate: 40 + 0.499,\n    minResolution: 40,\n    maxResolution: 5000,\n    maxFileSize: 200_000_000,\n  },\n  requiresEditReferenceVideo: false,\n  referencesMustMatchOutputResolution: false,\n  referenceImagesLimit: 3,\n} as const satisfies VideoGenerationModelSettings;\n\n// Todo: Fix FromSchema's interaction with allOf field so we don't have to construct the type intersection like this.\nexport const VideoGenerationModelSchema = {\n  properties: {\n    ...GraphicGenerationModelSchema.properties,\n    ...SupportedSettingsSchema.properties,\n    ...VideoGenerationModelSettingsSchema.properties,\n  },\n  required: [...GraphicGenerationModelSchema.required, ...VideoGenerationModelSettingsSchema.required],\n  additionalProperties: false,\n} as const satisfies Schema;\n\nexport type VideoGenerationModel = FromSchema<typeof VideoGenerationModelSchema>;\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { css } from 'lit';\n\nexport const styles = css`\n  :host {\n    --firefly-effect-thumbnail-gap: 2px;\n    --firefly-effect-thumbnail-size: 72px;\n    --firefly-effect-thumbnail-border-radius: 8px;\n  }\n\n  .container {\n    display: flex;\n    flex-direction: column;\n    gap: var(--firefly-effect-thumbnail-gap, 2px);\n    width: fit-content;\n    max-width: calc(var(--firefly-effect-thumbnail-size) + var(--spectrum-spacing-50));\n  }\n\n  .thumbnail {\n    --firefly-image-icon-size: var(--firefly-effect-thumbnail-size);\n    --firefly-image-icon-border-radius: var(--firefly-effect-thumbnail-border-radius, 8px);\n\n    border: var(--spectrum-spacing-50) solid transparent;\n    border-radius: var(--spectrum-spacing-100);\n    overflow: hidden;\n  }\n\n  .container.selected .thumbnail {\n    outline: var(--spectrum-spacing-50) solid var(--spectrum-gray-700);\n  }\n\n  .label {\n    height: 14px;\n    margin: 0 0 3px;\n    text-align: center;\n    font-size: var(--spectrum-font-size-75);\n    color: var(--spectrum-gray-800);\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    width: 100%;\n    user-select: none;\n  }\n`;\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { styles } from './effect-thumbnail-item.css.js';\nimport { LitElement, TemplateResult, html } from 'lit';\nimport { customElement, property } from 'lit/decorators.js';\n\nimport '../../../../elements/image-icon/image-icon.js';\nimport { StyleItem } from '../../../../services/asset-service/asset-service.js';\nimport { LoadedDirectoryItem } from '../../../../services/directory-service/directory-functions.js';\n\nexport const tagName = 'firefly-effect-thumbnail-item';\n\nexport type EffectThumbnailItemType = LoadedDirectoryItem<StyleItem>;\n@customElement(tagName)\nexport class EffectThumbnailItem extends LitElement {\n  static styles = styles;\n\n  @property({ type: Object })\n  effect!: EffectThumbnailItemType;\n\n  @property({ type: Boolean })\n  selected = false;\n\n  render(): TemplateResult {\n    if (!this.effect.thumbnail) {\n      return html``;\n    }\n\n    return html`\n      <div id=${this.effect.id} class=\"container ${this.selected ? 'selected' : ''}\">\n        <firefly-image-icon\n          class=\"thumbnail\"\n          data-testid=\"asset-${this.effect.id}\"\n          src=\"${this.effect.thumbnail}\"\n          label=\"${this.effect.title ?? ''}\"\n          .spriteArea=${this.effect.thumbnailSrcRect}>\n        </firefly-image-icon>\n        <p class=\"label\">${this.effect.title}</p>\n      </div>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    [tagName]: EffectThumbnailItem;\n  }\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { unlocalized as uploadUnlocalized } from '../../elements/upload/upload.js';\nimport { type Unlocalized } from '../../services/locale-service/locale-service.js';\n\nexport const unlocalized = {\n  more: 'More',\n  generate: 'Generate',\n  prompt: 'Prompt',\n  placeholder: 'Describe what you want to generate',\n  placeholderSoundFx: 'Describe the sound effect you want to generate',\n  theme: 'Theme',\n  adobeModelsLabel: 'Adobe models',\n  partnerModelsLabel: 'Partner models',\n  adobeModelsDescription: 'Commercially safe',\n  adobeModelsDescriptionUrl: 'https://www.adobe.com/ai/overview/firefly/gen-ai-approach.html',\n  partnerModelsDescription: 'Models created by others',\n  partnerModelsDescriptionUrl: 'https://helpx.adobe.com/firefly/web/get-started/learn-the-basics/non-adobe-models-in-adobe-products.html',\n  firstFrame: 'First frame',\n  endFrame: 'End frame',\n  image: 'Image',\n  video: 'Video',\n  vector: 'Vector',\n  soundFx: 'Sound effects',\n  model: 'Model',\n  aspectRatio: 'Aspect ratio',\n  modelPreviewSuffix: '(preview)',\n  uploadUnlocalized,\n} as const satisfies Unlocalized;\n", "import { css } from 'lit';\n\nexport const styles = css`\n  :host {\n    /* defaults (light) */\n    --firefly-picker-container-background-color: rgb(255 255 255 / 55%);\n    --firefly-popover-background-color: rgb(255 255 255);\n    --firefly-container-inner-background-color: rgb(255 255 255 / 55%);\n    --firefly-container-outer-background: linear-gradient(180deg, rgb(255 255 255 / 25%) 0%, rgb(255 255 255 / 10%) 100%);\n    --firefly-picker-color: #000;\n    --firefly-picker-background-transparency: 0.66;\n    --firefly-prompt-input-top-padding: 0;\n  }\n\n  :host(.dark) {\n    /* dark mode colors */\n    --firefly-picker-container-background-color: rgb(17 17 17 / 55%);\n    --firefly-popover-background-color: rgb(0 0 0);\n    --firefly-container-inner-background-color: rgb(17 17 17 / 55%);\n    --firefly-container-outer-background: linear-gradient(180deg, rgb(0 0 0 / 4%) 0%, rgb(0 0 0 / 20%) 100%);\n    --firefly-picker-color: #fff;\n    --firefly-picker-background-transparency: 0.11;\n  }\n\n  sp-picker {\n    --mod-picker-border-color-default: transparent;\n    --mod-picker-border-color-hover: transparent;\n    --highcontrast-picker-border-color-default: transparent;\n    --highcontrast-picker-border-color-hover: transparent;\n    --mod-picker-border-radius: 8px;\n    --mod-popover-border-color: transparent;\n    --mod-popover-border-width: 0;\n    --mod-popover-corner-radius: 8px;\n    --mod-popover-filter: none;\n    --spectrum-popover-filter: none;\n    --mod-popover-content-area-spacing-vertical: 0;\n    --mod-picker-spacing-text-to-icon: 6px;\n    --mod-popover-background-color: var(--firefly-popover-background-color);\n    width: fit-content;\n\n    --highcontrast-picker-background-color: rgb(255 255 255 / var(--firefly-picker-background-transparency, 11%));\n    --highcontrast-picker-content-color-default: var(--spectrum-gray-800);\n  }\n\n  .app-picker {\n    --mod-picker-font-weight: var(--spectrum-bold-font-weight);\n  }\n\n  .settings-picker {\n    --highcontrast-picker-background-color: transparent;\n    --mod-picker-spacing-edge-to-disclosure-icon: 0;\n    --mod-picker-spacing-edge-to-text: 0;\n  }\n\n  .settings-picker.icon-only {\n    min-width: auto;\n    width: auto;\n    --mod-picker-spacing-text-to-icon: 6px;\n  }\n\n  .picker-menu {\n    gap: 2px;\n    padding: 8px;\n\n    /* 124px menu item width + 8px padding on each side */\n    min-width: 140px;\n    --mod-menu-checkmark-display: none;\n    --mod-menu-item-label-inline-edge-to-content: 12px;\n    --mod-menu-item-selectable-edge-to-text-not-selected: 12px;\n    --mod-menu-item-top-edge-to-text: 7px;\n    --mod-menu-item-bottom-edge-to-text: 7px;\n    --mod-menu-item-focus-indicator-width: 0;\n    text-align: left;\n\n    sp-menu-item {\n      height: 18px;\n      border-radius: 8px;\n      text-align: left;\n    }\n\n    .picker-menu-item-icon {\n      height: 18px;\n    }\n  }\n\n  .picker-menu.icon-only {\n    min-width: auto;\n    --mod-menu-item-selectable-edge-to-text-not-selected: 8px;\n    --mod-menu-item-label-inline-edge-to-content: 8px;\n  }\n\n  .picker-menu-model {\n    --mod-menu-item-selectable-edge-to-text-not-selected: 40px;\n    --mod-menu-item-label-inline-edge-to-content: 20px;\n    padding-top: 8px;\n    padding-bottom: 8px;\n\n    sp-menu-item {\n      /* 248 base + 40 padding */\n      min-width: 288px;\n    }\n  }\n\n  .picker-menu.icon-only sp-menu-item {\n    min-width: auto;\n    width: auto;\n    padding: 8px;\n    justify-content: center;\n  }\n\n  .picker-menu-model.icon-only {\n    --mod-menu-item-selectable-edge-to-text-not-selected: 6px;\n    --mod-menu-item-label-inline-edge-to-content: 6px;\n  }\n\n  .picker-menu-model.icon-only sp-menu-item {\n    min-width: 288px;\n    width: auto;\n    padding: 8px;\n    justify-content: center;\n  }\n\n  .picker-menu-divider {\n    background-color: var(--spectrum-gray-200);\n    margin: 5px 20px;\n    inline-size: unset;\n  }\n\n  .container-outer {\n    display: flex;\n    flex-direction: column;\n    padding: 19px;\n    border: 1px solid rgb(255 255 255 / 8%);\n    backdrop-filter: var(--firefly-prompt-advanced-outer-backdrop-filter, none);\n    position: relative;\n    gap: 10px;\n    background: var(--firefly-container-outer-background);\n  }\n\n  /* Inner container common styles */\n  .container-inner {\n    display: flex;\n    flex-direction: column;\n    position: relative;\n    padding: 4px;\n    backdrop-filter: var(--firefly-prompt-advanced-inner-backdrop-filter, none);\n    background: var(--firefly-container-inner-background-color);\n  }\n\n  .action-row-container {\n    max-height: 0;\n    transition: max-height 0.3s ease;\n    left: 0;\n    right: 0;\n    top: 0;\n    bottom: 0;\n    display: flex;\n    align-self: center;\n    flex: 1;\n    width: 100%;\n    padding: 12px;\n  }\n\n  .action-row {\n    display: flex;\n    flex: 1;\n    flex-direction: row;\n    gap: 10px;\n    justify-content: space-between;\n    align-items: center;\n  }\n\n  .advanced-settings-container {\n    transition: opacity 0.3s ease;\n    opacity: 0;\n    display: flex;\n    gap: 12px;\n  }\n\n  .prompt-row-container {\n    display: flex;\n    flex-direction: row;\n    gap: 16px;\n    position: relative;\n  }\n\n  .cta-container {\n    pointer-events: auto;\n  }\n\n  .cta-container .round {\n    width: 2.5em !important;\n    height: 2.5em !important;\n    min-width: 2.5em !important;\n    min-height: 2.5em !important;\n    max-width: 2.5em !important;\n    max-height: 2.5em !important;\n    border-radius: 50% !important;\n    padding: 0 !important;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    box-sizing: border-box;\n  }\n\n  .prompt-input {\n    flex: 1;\n    --firefly-prompt-input-vertical-padding: 12px;\n    --firefly-prompt-input-horizontal-padding: 12px;\n    --firefly-prompt-background-color: unset;\n    --firefly-prompt-box-shadow: unset;\n    --firefly-textfield-overflow-shadow-background: transparent;\n    --firefly-textfield-overflow-shadow-transition: none;\n    --firefly-textfield-placeholder-color: transparent;\n    --firefly-textfield-placeholder-opacity: 0;\n  }\n\n  .more-button {\n    padding: 0;\n    --spectrum-button-background-color-default: transparent;\n    --spectrum-button-background-color-hover: transparent;\n    --spectrum-button-background-color-down: transparent;\n    --spectrum-button-background-color-key-focus: transparent;\n    --spectrum-button-background-color-focus: transparent;\n    --spectrum-button-background-color-disabled: transparent;\n    --spectrum-button-background-color-selected: transparent;\n    --mod-button-content-color-default: var(--spectrum-gray-800);\n    --mod-button-content-color-hover: var(--spectrum-gray-800);\n    --mod-button-content-color-down: var(--spectrum-gray-800);\n    font-weight: var(--spectrum-regular-font-weight);\n  }\n\n  .prompt-selectable-grid {\n    --firefly-selectable-grid-selected-border: none;\n    --firefly-selectable-grid-padding: var(--spectrum-spacing-200);\n    --firefly-selectable-grid-selected-border-size: 0;\n    --firefly-selectable-grid-selected-border-color: transparent;\n    --firefly-selectable-grid-item-icon-right: var(--spectrum-spacing-75);\n    --firefly-selectable-grid-item-icon-top: var(--spectrum-spacing-75);\n    --firefly-selectable-grid-selected-border-width: 0;\n    --firefly-selectable-grid-title-margin: 0 0 var(--spectrum-spacing-75) 0;\n  }\n\n  .more-button.icon-only {\n    min-width: auto;\n    width: auto;\n    padding: 0;\n    --mod-button-spacing-text-to-icon: 0;\n  }\n\n  .section-container {\n    padding: 6px 20px 8px;\n    display: flex;\n    flex-direction: column;\n  }\n\n  .section-title {\n    margin: 0;\n    padding: 0;\n    font-size: var(--spectrum-font-size-100, 14px);\n    font-style: normal;\n    font-weight: 700;\n    line-height: 1.5;\n  }\n\n  .section-link-text {\n    color: var(--spectrum-gray-700);\n    font-size: var(--font-size-75, 12px);\n    font-style: normal;\n    font-weight: 400;\n    text-decoration-line: underline;\n    text-decoration-style: solid;\n    text-decoration-skip-ink: none;\n    text-decoration-thickness: auto;\n    text-underline-offset: auto;\n    text-underline-position: from-font;\n    line-height: 1.5;\n  }\n\n  .premium-label {\n    display: flex;\n    align-items: center;\n    gap: 4px;\n  }\n\n  .picker-indicator {\n    --firefly-coach-indicator-border-radius: 8px;\n\n    /* color must be in this RGB format since rgb() rgba() applied in coach indicator */\n    --firefly-coach-indicator-outline-color: 75, 117, 255;\n  }\n\n  .placeholder-overlay {\n    position: absolute;\n    inset: 0;\n    display: block;\n    pointer-events: none;\n    padding-top: var(--firefly-prompt-input-top-padding, var(--firefly-prompt-input-vertical-padding, 12px));\n    padding-left: var(--firefly-prompt-input-horizontal-padding, 12px);\n    padding-right: var(--firefly-prompt-input-horizontal-padding, 12px);\n    padding-bottom: var(--firefly-prompt-input-vertical-padding, 12px);\n  }\n\n  .placeholder-text {\n    font-family: var(--firefly-textfield-font-family, var(--spectrum-font-family));\n    font-size: var(--firefly-textfield-font-size, var(--spectrum-font-size-200));\n    line-height: var(--firefly-textfield-line-height, var(--spectrum-line-height-200));\n    font-weight: 400;\n    color: var(--firefly-textfield-text-color, var(--spectrum-gray-900));\n    white-space: normal;\n    margin: 0;\n    padding: 0;\n    display: -webkit-box;\n    -webkit-line-clamp: 2; \n    -webkit-box-orient: vertical;\n  }\n\n  .prompt-input::placeholder {\n    color: var(--spectrum-neutral-content-color-default);\n    white-space: normal;\n  }\n\n  .prompt-label {\n    color: var(--spectrum-neutral-subdued-content-color-default);\n    font-size: var(--spectrum-font-size-100);\n    padding-left: var(--firefly-prompt-input-horizontal-padding, 12px);\n    padding-top: var(--firefly-prompt-input-vertical-padding, 10px);\n    font-weight: 400;\n  }\n\n  .cta-container sp-button {\n    position: relative;\n  }\n\n  .cta-container sp-button.generating firefly-icon-ai-generate,\n  .cta-container sp-button.generating span {\n    opacity: 0;\n  }\n\n  .cta-container sp-button sp-progress-circle {\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n  }\n`;\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { APPLICATION_KEY, ASPECT_RATIO_KEY, MODEL_KEY, PROMPT_KEY } from './constants.js';\nimport './elements/reference-frame-picker/reference-frame-picker.js';\nimport {\n  AdvancedSettingChangeEvent,\n  ApplicationChangeEvent,\n  GenerateEvent,\n  MoreButtonClickEvent,\n  PromptChangeEvent,\n  SettingInteractEvent,\n} from './events.js';\nimport {\n  PROMPT_BREAKPOINT_M,\n  PROMPT_BREAKPOINT_S,\n  PROMPT_MAXROWS,\n  getCurrentScreenWidthId,\n  getDefaultItem,\n  getPromptConfig,\n  isGenerateVisible,\n  isItem,\n} from './functions/utils.js';\nimport { unlocalized } from './prompt-advanced-unlocalized.js';\nimport { styles } from './prompt-advanced.css.js';\nimport {\n  AdvancedSetting,\n  AdvancedSettingChangeItem,\n  AdvancedSettingItem,\n  AdvancedSettingSection,\n  AllApplicationSelectedSettings,\n  ApplicationConfig,\n  PromptAdvancedLocalized,\n  PromptAdvancedProps,\n  PromptAdvancedServices,\n  SingleApplicationSelectedSettings,\n} from './prompt-advanced.types.js';\nimport { LitElement, html, render } from 'lit';\nimport { nothing } from 'lit';\nimport { customElement, property, query, queryAll, state } from 'lit/decorators.js';\nimport { classMap } from 'lit/directives/class-map.js';\nimport { ifDefined } from 'lit/directives/if-defined.js';\nimport { repeat } from 'lit/directives/repeat.js';\nimport { styleMap } from 'lit/directives/style-map.js';\n\nimport { localizeBundleDefault } from '../../services/locale-service/index.js';\nimport { PromptAdvancedFrameSelectionEvent, ReferenceFramePickerInteractEvent } from './elements/reference-frame-picker/index.js';\nimport '@spectrum-web-components/button/sp-button.js';\nimport '@spectrum-web-components/divider/sp-divider.js';\nimport '@spectrum-web-components/field-label/sp-field-label.js';\nimport '@spectrum-web-components/menu/sp-menu-group.js';\nimport '@spectrum-web-components/menu/sp-menu-item.js';\nimport '@spectrum-web-components/menu/sp-menu.js';\nimport '@spectrum-web-components/picker/sp-picker.js';\nimport '@spectrum-web-components/progress-circle/sp-progress-circle.js';\n\nimport '../coach-indicator/coach-indicator.js';\nimport { commonStyles } from '../common/styles.css.js';\nimport { useSpectrumTheme } from '../hooks/use-spectrum-theme.js';\nimport { withHooks } from '../hooks/with-hooks.js';\nimport '../icons/icon-ai-generate.js';\nimport '../icons/icon-ai-sparkles.js';\nimport '../icons/icon-aspect-ratio.js';\nimport '../icons/icon-crown.js';\nimport '../icons/icon-properties.js';\nimport { PromptChangeEvent as PromptChangeEventPrompt, PromptTextAreaKeydownEvent } from '../prompt/events.js';\nimport '../prompt/prompt.js';\nimport { SelectionChangeEvent } from '../selectable-grid/events.js';\nimport '../selectable-grid/selectable-grid.js';\nimport { Item } from '../selectable-grid/selectable-grid.js';\n\nexport * from './prompt-advanced-unlocalized.js';\n\nexport const tagName = 'firefly-prompt-advanced';\ndeclare global {\n  interface HTMLElementTagNameMap {\n    [tagName]: PromptAdvanced<ApplicationConfig>;\n  }\n}\n\n@customElement(tagName)\nexport class PromptAdvanced<T extends ApplicationConfig> extends LitElement implements PromptAdvancedProps<T> {\n  static styles = [commonStyles, styles];\n\n  // NOTE: I would have loved to keep PromptAdvanced \"dumb\", but some sub-components need to access our services\n  // and this seems like the simplest way to do it\n  @property({ type: Object })\n  services?: PromptAdvancedServices;\n\n  @property({ type: Object })\n  selectedSettings: AllApplicationSelectedSettings<T> = {};\n\n  @property({ type: Array })\n  config: T[] = [];\n\n  @property({ type: String })\n  selectedApplicationId: T['id'] = this.config.length ? this.config[0].id : '';\n\n  @property({ type: Boolean })\n  autoFocus = true;\n\n  @property({ type: Boolean })\n  hideMoreButton?: boolean = false;\n\n  @property({ type: String })\n  prompt = '';\n\n  @property({ type: Object, reflect: false }) localized: PromptAdvancedLocalized = localizeBundleDefault(unlocalized);\n\n  @property({ type: Boolean })\n  isGenerating = false;\n\n  @property({ type: Boolean })\n  isMoreButtonLoading = false;\n\n  @state()\n  private userHasFocusedPrompt = true; //FFP-57600 Make prompt bar expanded by default\n\n  @queryAll('sp-picker') private allPickers!: NodeListOf<HTMLElement>;\n\n  @query('firefly-prompt') private promptElement?: HTMLElement & { focusInput: () => void };\n\n  @query('[data-testid=\"firefly-button-generate\"]') private generateButton?: HTMLElement;\n\n  @state()\n  private isAutoFocusInProgress = false;\n\n  @state()\n  private generateButtonWidth?: number;\n\n  firstUpdated() {\n    if (this.autoFocus) {\n      requestAnimationFrame(() => {\n        this.isAutoFocusInProgress = true;\n        this.promptElement?.focusInput();\n      });\n    }\n  }\n\n  private onTextfieldFocus(): void {\n    this.userHasFocusedPrompt = true;\n    // It doesn't count as a user interaction if the focus is triggered by auto-focus\n    if (!this.isAutoFocusInProgress) {\n      this.dispatchEvent(\n        new SettingInteractEvent({ applicationId: this.selectedApplicationId, settingId: PROMPT_KEY, type: 'focus', value: this.prompt })\n      );\n    }\n  }\n\n  private onTextfieldBlur(): void {\n    if (this.isAutoFocusInProgress) {\n      // Reset auto-focus flag on next blur after auto-focus has been triggered\n      this.isAutoFocusInProgress = false;\n    } else {\n      this.dispatchEvent(\n        new SettingInteractEvent({ applicationId: this.selectedApplicationId, settingId: PROMPT_KEY, type: 'blur', value: this.prompt })\n      );\n    }\n  }\n\n  @state()\n  private screenWidth: number = window.innerWidth;\n\n  private get shouldShowAdvancedSettings(): boolean {\n    return this.screenWidth <= PROMPT_BREAKPOINT_M || this.userHasFocusedPrompt;\n  }\n\n  setSelectedSettings({\n    applicationId,\n    settingId,\n    item,\n  }: {\n    applicationId: T['id'];\n    settingId: T['settings'][number]['id'];\n    item: AdvancedSettingChangeItem | AdvancedSettingChangeItem[];\n  }) {\n    const arrayOrSingleItemId = Array.isArray(item) ? item.map(item => item.id) : item.id;\n\n    // make new object to rerender the selectable grid component\n    this.selectedSettings = {\n      ...this.selectedSettings,\n      [applicationId]: {\n        ...this.selectedSettings[applicationId],\n        [settingId]: arrayOrSingleItemId,\n      },\n    };\n    this.dispatchEvent(\n      new AdvancedSettingChangeEvent({\n        applicationId,\n        settingId,\n        item,\n      })\n    );\n  }\n\n  private getSettingsPickerId({ applicationId, settingId }: { applicationId: T['id']; settingId: T['settings'][number]['id'] }) {\n    return `settings-picker-${applicationId}-${settingId}`;\n  }\n\n  renderMoreButton() {\n    const shouldShowMoreText = this.screenWidth >= PROMPT_BREAKPOINT_S;\n    return html`\n      <sp-button\n        data-testid=${`firefly-button-more`}\n        class=\"more-button ${!shouldShowMoreText ? 'icon-only' : ''}\"\n        aria-label=${this.localized.more}\n        variant=\"secondary\"\n        ?disabled=${this.isMoreButtonLoading}\n        @click=${() =>\n          this.dispatchEvent(\n            new MoreButtonClickEvent<T>({\n              applicationId: this.selectedApplicationId,\n              prompt: this.prompt,\n              settings: this.selectedSettings[this.selectedApplicationId] ?? {},\n            })\n          )}>\n        ${this.isMoreButtonLoading\n          ? html`<sp-progress-circle slot=\"icon\" size=\"m\" indeterminate></sp-progress-circle>`\n          : html`<firefly-icon-properties slot=\"icon\"></firefly-icon-properties>`}\n        ${shouldShowMoreText ? this.localized.more : ''}\n      </sp-button>\n    `;\n  }\n\n  renderSettingsPickerItem(item: AdvancedSettingItem) {\n    return html`\n      <sp-menu-item id=${item.id} value=${item.id}>\n        ${item.icon ? html`<span slot=\"icon\" class=\"picker-menu-item-icon\">${item.icon}</span>` : null}\n        ${item.iconEnd\n          ? html`<span class=\"end-icon\" style=\"display: flex; align-items: center; gap: 6px;\"\n              >${item.label} <firefly-icon-crown style=\"color: #686df4;\"></firefly-icon-crown\n            ></span>`\n          : item.label}\n      </sp-menu-item>\n    `;\n  }\n\n  renderSettingsGridMultiPicker(advancedSetting: AdvancedSetting) {\n    const items = advancedSetting.items;\n    const selectedApplicationId = this.selectedApplicationId;\n    const settingId = advancedSetting.id as keyof SingleApplicationSelectedSettings<T>;\n\n    const selectedSettings = this.selectedSettings[selectedApplicationId];\n    const selectedSettingValueIds = selectedSettings?.[settingId];\n    const selectedValuesSet = new Set(selectedSettingValueIds);\n\n    const flatItems = items.flatMap(itemOrSection => (isItem(itemOrSection) ? [itemOrSection] : itemOrSection.items));\n    const itemIdToValue = flatItems.reduce(\n      (acc, item) => {\n        acc[item.id] = item.value;\n        return acc;\n      },\n      {} as Record<string, AdvancedSettingItem['value']>\n    );\n\n    const gridItems: Item[] = items.filter(isItem).map(item => {\n      const itemIsSelected = selectedValuesSet.has(item.id);\n      return {\n        id: item.id,\n        render: () =>\n          item.thumbnail\n            ? typeof item.thumbnail === 'function'\n              ? item.thumbnail({ selected: itemIsSelected })\n              : html`${item.thumbnail}`\n            : html`\n                <sp-menu-item id=${item.id} value=${item.id}>\n                  ${item.icon ? html`<span slot=\"icon\">${item.icon}</span>` : null} ${item.label}\n                </sp-menu-item>\n              `,\n      };\n    });\n\n    const selectedItems = gridItems.filter(item => selectedSettingValueIds?.includes(item.id));\n\n    return html`\n      <sp-picker\n        class=\"settings-picker\"\n        data-testid=${`firefly-picker-setting-select-${selectedApplicationId}-${settingId}`}\n        @sp-opened=${() => {\n          this.dispatchEvent(\n            new SettingInteractEvent({\n              applicationId: selectedApplicationId,\n              settingId,\n              type: 'open',\n            })\n          );\n        }}\n        @sp-closed=${() => {\n          this.dispatchEvent(\n            new SettingInteractEvent({\n              applicationId: selectedApplicationId,\n              settingId,\n              type: 'close',\n            })\n          );\n        }}>\n        <div slot=\"label\" style=\"display: flex; align-items: center; gap: 6px;\">\n          ${advancedSetting.icon ? advancedSetting.icon : null} ${this.localized.theme}\n          ${selectedItems.length > 0 ? `(${selectedItems.length})` : ''}\n        </div>\n        <firefly-selectable-grid\n          class=\"prompt-selectable-grid\"\n          .items=${gridItems}\n          .selected=${selectedItems}\n          .showSelectIcon=${true}\n          rowGap=${6}\n          columnGap=${8}\n          padding=${2}\n          @selectionChange=${(e: SelectionChangeEvent) => {\n            const selectedIds = e.detail.selected.map(item => item.id);\n            const item = selectedIds.map(id => {\n              return { id, value: itemIdToValue[id] };\n            });\n            this.setSelectedSettings({ applicationId: selectedApplicationId, settingId, item });\n            this.dispatchEvent(\n              new SettingInteractEvent({\n                applicationId: selectedApplicationId,\n                settingId,\n                type: 'select',\n                item,\n                value: selectedSettingValueIds,\n              })\n            );\n          }}>\n        </firefly-selectable-grid>\n      </sp-picker>\n    `;\n  }\n\n  renderSettingsPicker(advancedSetting: AdvancedSetting) {\n    const selectedApplicationId = this.selectedApplicationId;\n    const selectedSettings = this.selectedSettings[selectedApplicationId];\n\n    const settingId = advancedSetting.id as keyof SingleApplicationSelectedSettings<T>;\n\n    const items = advancedSetting.items;\n    const isModelSetting = advancedSetting.id === MODEL_KEY;\n    const shouldShowModelText = this.screenWidth >= PROMPT_BREAKPOINT_S;\n\n    const flatItems = items.flatMap(itemOrSection => (isItem(itemOrSection) ? [itemOrSection] : itemOrSection.items));\n    const itemIdToValue = flatItems.reduce(\n      (acc, item) => {\n        acc[item.id] = item.value;\n        return acc;\n      },\n      {} as Record<string, AdvancedSettingItem['value']>\n    );\n\n    const defaultItem = getDefaultItem({ items });\n    const defaultItemId = defaultItem?.id;\n    if (!defaultItemId) return;\n\n    const getSelectedSettingValueId = () => {\n      const selectedSettingValueIds = selectedSettings?.[settingId];\n\n      function allValuesExist(valueIds: string | string[]): boolean {\n        const valueIdArray = typeof valueIds === 'string' ? [valueIds] : valueIds;\n        if (!valueIdArray.length) return false;\n        return valueIdArray.every(id => itemIdToValue[id]);\n      }\n\n      if (selectedSettingValueIds && allValuesExist(selectedSettingValueIds)) {\n        return selectedSettingValueIds;\n      } else {\n        // Dispatch event when the selected setting value id has been defaulted\n        // so that the parent can stay in sync with the selected setting value id\n        const initialItemValue = itemIdToValue[defaultItemId];\n        this.setSelectedSettings({\n          applicationId: selectedApplicationId,\n          settingId,\n          item: { id: defaultItemId, value: initialItemValue },\n        });\n        return defaultItemId;\n      }\n    };\n\n    const selectedSettingValueId = getSelectedSettingValueId();\n\n    const shouldShowCoachIndicator = advancedSetting.highlight;\n\n    if (advancedSetting.hide) {\n      return nothing;\n    }\n\n    return html`\n      <div style=\"position: relative; display: inline-block;\">\n        ${shouldShowCoachIndicator ? html`<firefly-coach-indicator class=\"picker-indicator\" floating></firefly-coach-indicator>` : nothing}\n        <sp-picker\n          id=${this.getSettingsPickerId({ applicationId: selectedApplicationId, settingId })}\n          class=${classMap({\n            'settings-picker': true,\n            'settings-picker-model': isModelSetting,\n            'icon-only': isModelSetting && !shouldShowModelText,\n          })}\n          value=${ifDefined(selectedSettingValueId)}\n          data-testid=${`firefly-picker-setting-select-${selectedApplicationId}-${settingId}`}\n          @sp-opened=${() => {\n            this.dispatchEvent(\n              new SettingInteractEvent({\n                applicationId: selectedApplicationId,\n                settingId,\n                type: 'open',\n              })\n            );\n          }}\n          @sp-closed=${() => {\n            this.dispatchEvent(\n              new SettingInteractEvent({\n                applicationId: selectedApplicationId,\n                settingId,\n                type: 'close',\n              })\n            );\n          }}\n          @change=${(e: Event | CustomEvent) => {\n            const target = e.target as HTMLSelectElement | null;\n            const itemId = 'detail' in e ? e.detail.value : target?.value;\n            const value = itemIdToValue[itemId];\n\n            this.setSelectedSettings({\n              applicationId: selectedApplicationId,\n              settingId,\n              item: { id: itemId, value },\n            });\n            this.dispatchEvent(\n              new SettingInteractEvent({\n                applicationId: selectedApplicationId,\n                settingId,\n                type: 'select',\n                item: { id: itemId, value },\n                value: selectedSettingValueId,\n              })\n            );\n          }}>\n          <sp-menu\n            class=${classMap({\n              'picker-menu': !isModelSetting,\n              'picker-menu-model': isModelSetting,\n            })}>\n            ${repeat(\n              items as (AdvancedSettingItem | AdvancedSettingSection)[],\n              itemOrSection => {\n                const itemOrSectionId = isItem(itemOrSection) ? itemOrSection.id : itemOrSection.items[0]?.id ?? '';\n                return `${this.selectedApplicationId}-${itemOrSectionId}`;\n              },\n              (itemOrSection, index) => {\n                if (isItem(itemOrSection)) {\n                  // this is an item\n                  const advancedSettingItem = itemOrSection;\n                  return this.renderSettingsPickerItem(advancedSettingItem);\n                } else {\n                  // this is a section\n                  const advancedSettingSection = itemOrSection;\n                  return html`\n                    <sp-menu-group selects=\"single\">\n                      <span class=\"menu-group-header\">${advancedSettingSection.label}</span>\n                      ${repeat(\n                        advancedSettingSection.items,\n                        item => `${this.selectedApplicationId}-${item.id}`,\n                        item => {\n                          return this.renderSettingsPickerItem(item);\n                        }\n                      )}\n                      ${index < items.length - 1 ? html`<sp-divider size=\"m\" class=\"picker-menu-divider\"></sp-divider>` : nothing}\n                    </sp-menu-group>\n                  `;\n                }\n              }\n            )}\n          </sp-menu>\n        </sp-picker>\n      </div>\n    `;\n  }\n\n  renderApplicationPicker() {\n    const hasLessThanTwoItems = this.config.length <= 1;\n\n    if (hasLessThanTwoItems) {\n      return nothing;\n    }\n\n    return html`\n      <!-- icons none will hide the icon in the picker but not in dropdown items -->\n      <sp-picker\n        class=${classMap({\n          'app-picker': true,\n        })}\n        icons=\"none\"\n        value=${this.selectedApplicationId}\n        data-testid=${`firefly-picker-application-select`}\n        @sp-opened=${() => {\n          this.dispatchEvent(\n            new SettingInteractEvent({ applicationId: this.selectedApplicationId, settingId: APPLICATION_KEY, type: 'open' })\n          );\n        }}\n        @sp-closed=${() => {\n          this.dispatchEvent(\n            new SettingInteractEvent({ applicationId: this.selectedApplicationId, settingId: APPLICATION_KEY, type: 'close' })\n          );\n        }}\n        @change=${(e: Event | CustomEvent) => {\n          const target = e.target as HTMLSelectElement | null;\n          const value = 'detail' in e ? e.detail.value : target?.value;\n          this.selectedApplicationId = value;\n          this.dispatchEvent(\n            new SettingInteractEvent({\n              applicationId: this.selectedApplicationId,\n              settingId: APPLICATION_KEY,\n              type: 'select',\n              value,\n              item: { id: value, value },\n            })\n          );\n        }}>\n        <sp-menu class=\"picker-menu\">\n          ${repeat(\n            this.config ?? [],\n            item => item.id,\n            item => html`\n              <sp-menu-item id=${item.id} label=${item.label} value=${item.id}>\n                <span slot=\"icon\" class=\"picker-menu-item-icon\">${item.icon}</span> ${item.label}\n              </sp-menu-item>\n            `\n          )}\n        </sp-menu>\n      </sp-picker>\n    `;\n  }\n\n  renderActionRow() {\n    const applicationConfigItem = this.config.find(item => item.id === this.selectedApplicationId);\n    const breakpoint = getCurrentScreenWidthId(this.screenWidth);\n    let availableSettings = applicationConfigItem?.settings ?? [];\n\n    // Hide extra options at medium prompt breakpoint\n    if (this.screenWidth <= PROMPT_BREAKPOINT_M) {\n      availableSettings = availableSettings.filter(s => s.id === MODEL_KEY);\n    }\n\n    // not all applications have a model setting (e.g. sound effects)\n    const modelSetting = applicationConfigItem?.settings.find(setting => setting.id === MODEL_KEY);\n    // wait for application to load in\n    const hasLoadedModels = this.selectedApplicationId !== '' && (!modelSetting || !!modelSetting.items?.length);\n\n    return html`\n      <div class=\"action-row\">\n        <div\n          class=\"advanced-settings-container\"\n          style=${styleMap({\n            opacity: this.shouldShowAdvancedSettings && hasLoadedModels ? 1 : 0,\n          })}>\n          ${this.renderApplicationPicker()}\n          ${repeat(\n            availableSettings ?? [],\n            advancedSetting => `${this.selectedApplicationId}-${advancedSetting.id}`,\n            advancedSetting => {\n              // TODO: add other input types\n              if (advancedSetting.type === 'picker') {\n                return this.renderSettingsPicker(advancedSetting);\n              }\n              if (advancedSetting.type === 'picker-grid-multi') {\n                return this.renderSettingsGridMultiPicker(advancedSetting);\n              }\n              if (advancedSetting.type === 'reference-frames-picker') {\n                const aspectRatioSetting = availableSettings.find(item => {\n                  if (!('id' in item)) return false; // aspect ratios aren't in sections\n                  return item.id === ASPECT_RATIO_KEY;\n                }) as AdvancedSetting | undefined;\n                const aspectRatioId =\n                  this.selectedSettings[this.selectedApplicationId]?.[ASPECT_RATIO_KEY as keyof SingleApplicationSelectedSettings<T>];\n\n                const aspectRatioItem = aspectRatioSetting?.items.find(item => isItem(item) && item.id === aspectRatioId) as\n                  | AdvancedSettingItem\n                  | undefined;\n                return html`<firefly-prompt-advanced-reference-frame-picker\n                  .services=${this.services}\n                  .setting=${advancedSetting}\n                  .aspectRatio=${aspectRatioItem?.value}\n                  .localized=${this.localized}\n                  @prompt-advanced-frame-selection=${(e: PromptAdvancedFrameSelectionEvent) => {\n                    this.setSelectedSettings({\n                      applicationId: this.selectedApplicationId,\n                      settingId: advancedSetting.id,\n                      item: e.detail.value,\n                    });\n                  }}\n                  @prompt-advanced-reference-frame-picker-interact=${(e: ReferenceFramePickerInteractEvent) => {\n                    this.dispatchEvent(\n                      new SettingInteractEvent({\n                        applicationId: this.selectedApplicationId,\n                        settingId: advancedSetting.id,\n                        type: e.detail.type,\n                        value: e.detail.value,\n                        item: e.detail.item,\n                      })\n                    );\n                  }}>\n                </firefly-prompt-advanced-reference-frame-picker>`;\n              }\n            }\n          )}\n          ${this.hideMoreButton ? nothing : this.renderMoreButton()}\n        </div>\n        <div class=\"cta-container\">\n          <sp-button\n            key=${breakpoint}\n            data-testid=${`firefly-button-generate`}\n            size=\"l\"\n            variant=\"white\"\n            aria-label=${this.localized.generate}\n            class=${classMap({\n              round: !isGenerateVisible(breakpoint),\n              generating: this.isGenerating,\n            })}\n            style=${!isGenerateVisible(breakpoint) ? 'border-radius:50%;' : ''}\n            ?disabled=${this.isGenerating}\n            @click=${() =>\n              this.dispatchEvent(\n                new GenerateEvent<T>({\n                  applicationId: this.selectedApplicationId,\n                  prompt: this.prompt,\n                  settings: this.selectedSettings[this.selectedApplicationId] ?? {},\n                })\n              )}>\n            ${isGenerateVisible(breakpoint)\n              ? html`<firefly-icon-ai-generate slot=\"icon\"></firefly-icon-ai-generate><span>${this.localized.generate}</span>`\n              : html`<firefly-icon-ai-generate slot=\"icon\"></firefly-icon-ai-generate>`}\n            ${this.isGenerating ? html`<sp-progress-circle size=\"m\" indeterminate></sp-progress-circle>` : nothing}\n          </sp-button>\n        </div>\n      </div>\n    `;\n  }\n\n  @withHooks\n  render() {\n    // handle dark mode\n    const theme = useSpectrumTheme();\n    const isDark = theme.color === 'dark';\n    this.className = isDark ? 'dark' : '';\n\n    const selectedApplicationConfigItem = this.config.find(item => item.id === this.selectedApplicationId);\n    const outerClass = `container-outer${isDark ? ' dark' : ''}`;\n    const innerClass = `container-inner${isDark ? ' dark' : ''}`;\n\n    const promptConfig = getPromptConfig(selectedApplicationConfigItem);\n\n    const shouldShowGradient = this.screenWidth >= PROMPT_BREAKPOINT_S;\n\n    return html`\n      <div\n        class=${shouldShowGradient ? outerClass : ''}\n        style=${styleMap({\n          borderRadius: this.shouldShowAdvancedSettings ? '20px' : '100px',\n        })}>\n        <div\n          class=${innerClass}\n          style=${styleMap({\n            borderRadius: this.shouldShowAdvancedSettings ? '20px' : '100px',\n          })}>\n          <sp-field-label class=\"prompt-label\"> ${this.localized.prompt} </sp-field-label>\n          <div class=\"prompt-row-container\">\n            <!-- Placeholder overlay -->\n            ${!this.prompt\n              ? html`\n                  <div class=\"placeholder-overlay\">\n                    <span class=\"placeholder-text\">${selectedApplicationConfigItem?.placeholder ?? ''}</span>\n                  </div>\n                `\n              : nothing}\n            <firefly-prompt\n              data-testid=${`firefly-prompt-input`}\n              class=\"prompt-input\"\n              placeholder=${selectedApplicationConfigItem?.placeholder ?? ''}\n              .value=${this.prompt}\n              max-rows=${PROMPT_MAXROWS}\n              maxlength=${ifDefined(promptConfig.maxlength)}\n              shrinkToFitText\n              @focus=${this.onTextfieldFocus}\n              @blur=${this.onTextfieldBlur}\n              @prompt-change=${(e: PromptChangeEventPrompt) => {\n                const value = e.detail.value;\n                this.prompt = value;\n                this.dispatchEvent(new PromptChangeEvent({ value }));\n              }}\n              @textarea-keydown=${(e: PromptTextAreaKeydownEvent) => {\n                const { event } = e.detail;\n                if (event.key === 'Enter' && !event.isComposing) {\n                  event.preventDefault();\n                  this.dispatchEvent(\n                    new GenerateEvent<T>({\n                      applicationId: this.selectedApplicationId,\n                      prompt: this.prompt,\n                      settings: this.selectedSettings[this.selectedApplicationId] ?? {},\n                    })\n                  );\n                }\n              }}>\n            </firefly-prompt>\n          </div>\n          <div\n            class=\"action-row-container\"\n            style=${styleMap({\n              position: this.shouldShowAdvancedSettings ? 'relative' : 'absolute',\n              pointerEvents: this.shouldShowAdvancedSettings ? 'auto' : 'none',\n              maxHeight: this.shouldShowAdvancedSettings ? '500px' : '0',\n            })}>\n            ${this.renderActionRow()}\n          </div>\n        </div>\n      </div>\n    `;\n  }\n\n  private updatePickerLabels() {\n    const shouldHideText = this.screenWidth < PROMPT_BREAKPOINT_S;\n\n    // Find model settings (settings that should show icon-only on small screens)\n    const applicationConfigItem = this.config.find(item => item.id === this.selectedApplicationId);\n\n    const modelSettings = applicationConfigItem?.settings.filter(setting => setting.type === 'picker' && setting.id === MODEL_KEY) ?? [];\n\n    if (modelSettings.length === 0) {\n      return;\n    }\n\n    if (this.allPickers.length === 0) {\n      return;\n    }\n\n    modelSettings.forEach(setting => {\n      const pickerId = this.getSettingsPickerId({\n        applicationId: this.selectedApplicationId,\n        settingId: setting.id,\n      });\n\n      // Find corresponding picker\n      const picker = Array.from(this.allPickers).find(picker => {\n        return picker.id === pickerId;\n      });\n\n      if (!picker) {\n        return;\n      }\n      this.handlePickerTextVisibility(picker, shouldHideText);\n    });\n  }\n\n  private handlePickerTextVisibility(picker: HTMLElement, shouldHideText: boolean) {\n    if (!picker.shadowRoot) {\n      return;\n    }\n\n    const button = picker.shadowRoot.querySelector('button');\n    if (!button) {\n      return;\n    }\n\n    // picker button content is dynamic and extracts from menu items, need to wait until the exact elements are available\n    const labelSpan = button.querySelector('span#label');\n    if (!labelSpan) {\n      requestAnimationFrame(() => this.handlePickerTextVisibility(picker, shouldHideText));\n      return;\n    }\n\n    const labelElement = labelSpan as HTMLElement;\n    if (shouldHideText) {\n      // Hide text on small screens\n      labelElement.style.display = 'none';\n    } else {\n      // Show text on large screens - restore original display\n      labelElement.style.display = '';\n    }\n  }\n\n  private ensureSelectedApplicationId() {\n    if (!this.selectedApplicationId || !this.config.some(item => item.id === this.selectedApplicationId)) {\n      this.selectedApplicationId = this.config.length ? this.config[0].id : '';\n    }\n  }\n\n  private updateModelPickerLabels() {\n    // find model picker settings\n    const applicationConfigItem = this.config.find(item => item.id === this.selectedApplicationId);\n    const setting = applicationConfigItem?.settings.filter(setting => setting.type === 'picker' && setting.id === MODEL_KEY)[0];\n    if (!setting) return;\n\n    // find corresponding picker\n    const picker = Array.from(this.allPickers).find(\n      picker => picker.id === this.getSettingsPickerId({ applicationId: this.selectedApplicationId, settingId: setting.id })\n    );\n\n    if (picker) {\n      const selectedItem = this.getSelectedModelItem(setting);\n      // if the selected item has an iconEnd, remove it from the picker (but it will still be in menu items)\n      if (selectedItem && selectedItem.iconEnd) {\n        this.removeEndIconFromPicker(picker);\n      }\n    }\n  }\n\n  private getSelectedModelItem(setting: AdvancedSetting): AdvancedSettingItem | null {\n    const selectedSettings = this.selectedSettings[this.selectedApplicationId];\n    const selectedValueId = selectedSettings?.[setting.id as keyof SingleApplicationSelectedSettings<T>];\n\n    if (!selectedValueId) return null;\n\n    const flatItems = setting.items.flatMap((itemOrSection: AdvancedSettingItem | AdvancedSettingSection) =>\n      isItem(itemOrSection) ? [itemOrSection] : itemOrSection.items\n    );\n\n    return flatItems.find((item: AdvancedSettingItem) => item.id === selectedValueId) || null;\n  }\n\n  private removeEndIconFromPicker(picker: HTMLElement) {\n    if (!picker.shadowRoot) {\n      return;\n    }\n\n    const button = picker.shadowRoot.querySelector('button');\n    if (!button) {\n      return;\n    }\n\n    // picker button content is dynamic and extracts from menu items, need to wait until the exact elements are available\n    const labelEl = button.querySelector('span#label');\n    if (!labelEl) {\n      requestAnimationFrame(() => this.removeEndIconFromPicker(picker));\n      return;\n    }\n\n    const endIcon = labelEl.querySelector('.end-icon');\n    if (!endIcon) {\n      requestAnimationFrame(() => this.removeEndIconFromPicker(picker));\n      return;\n    }\n\n    if (endIcon.children.length === 0) {\n      // endIcon exists but the icon is not there yet, meaning picker content has not been updated, keep polling\n      requestAnimationFrame(() => this.removeEndIconFromPicker(picker));\n      return;\n    }\n\n    // remove the icon that is currently in the endIcon\n    while (endIcon.children.length > 0) {\n      endIcon.removeChild(endIcon.children[0]);\n    }\n  }\n\n  private updatePickerIcons() {\n    // find settings with icon defined\n    const applicationConfigItem = this.config.find(item => item.id === this.selectedApplicationId);\n    const settingsWithIcons = applicationConfigItem?.settings.filter(setting => setting.type === 'picker' && setting.icon) ?? [];\n\n    settingsWithIcons.forEach(setting => {\n      // find corresponding picker\n      const picker = Array.from(this.allPickers).find(\n        picker => picker.id === this.getSettingsPickerId({ applicationId: this.selectedApplicationId, settingId: setting.id })\n      );\n\n      if (picker && picker.shadowRoot) {\n        const button = picker.shadowRoot.querySelector('button');\n\n        if (button) {\n          const iconSpan = button.querySelector('span#icon');\n\n          if (iconSpan) {\n            // remove the original icon\n            iconSpan.remove();\n\n            // add the setting's custom icon\n            const iconContainer = document.createElement('span');\n            iconContainer.style.marginRight = '6px';\n            iconContainer.style.lineHeight = '1';\n            iconContainer.style.display = 'inline-block';\n            iconContainer.style.width = '20px';\n            iconContainer.style.height = '20px';\n            if (setting.icon) {\n              render(setting.icon, iconContainer);\n            }\n            button.insertBefore(iconContainer, button.firstChild);\n          }\n        }\n      }\n    });\n  }\n\n  private handleResize = () => {\n    this.screenWidth = window.innerWidth; // triggers re-render\n    this.updateComplete.then(() => {\n      this.updatePickerLabels();\n    });\n  };\n\n  connectedCallback() {\n    super.connectedCallback?.();\n    this.ensureSelectedApplicationId();\n\n    // update on mount\n    this.screenWidth = window.innerWidth;\n    this.updateComplete.then(() => {\n      this.updatePickerLabels();\n    });\n\n    window.addEventListener('resize', this.handleResize);\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback?.();\n    window.removeEventListener('resize', this.handleResize);\n  }\n\n  updated(changedProperties: Map<string, unknown>) {\n    if (changedProperties.has('config')) {\n      this.ensureSelectedApplicationId();\n\n      // swap in icons for pickers with defined icons\n      this.updateComplete.then(() => {\n        this.updatePickerIcons();\n        this.updatePickerLabels();\n        this.updateModelPickerLabels();\n      });\n    }\n    if (changedProperties.has('selectedApplicationId')) {\n      const nextId = this.selectedApplicationId;\n      if (!nextId) return;\n\n      // if prompt exceeds character count for application, slice it\n      const selectedApplicationConfigItem = this.config.find(item => item.id === nextId);\n      const promptConfig = getPromptConfig(selectedApplicationConfigItem);\n\n      if (promptConfig.maxlength && this.prompt.length > promptConfig.maxlength) {\n        const slicedPrompt = this.prompt.slice(0, promptConfig.maxlength);\n        this.prompt = slicedPrompt;\n        this.dispatchEvent(new PromptChangeEvent({ value: slicedPrompt }));\n      }\n\n      this.dispatchEvent(new ApplicationChangeEvent({ applicationId: nextId }));\n\n      // Update model picker labels when application changes\n      this.updateComplete.then(() => {\n        this.updateModelPickerLabels();\n        this.updatePickerLabels();\n      });\n    }\n    if (changedProperties.has('screenWidth')) {\n      // Update picker labels when screen width changes\n      this.updateComplete.then(() => {\n        this.updatePickerLabels();\n      });\n    }\n\n    super.updated?.(changedProperties);\n  }\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { css } from 'lit';\n\nexport const styles = css`\n  :host {\n    --firefly-coach-indicator-border-radius: var(--spectrum-global-dimension-size-200);\n    --firefly-coach-indicator-outline-color: var(--spectrum-blue-800-rgb);\n    --firefly-coach-indicator-animation-duration: 0.6s;\n    --firefly-coach-indicator-ring-outline-offset: var(--mod-firefly-coach-indicator-ring-outline-offset, -12px);\n\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    pointer-events: none;\n  }\n\n  :host([floating]) {\n    --firefly-coach-indicator-ring-outline-offset: var(--mod-firefly-coach-indicator-ring-outline-offset, 2px);\n    position: absolute;\n    top: -2px;\n    left: -2px;\n    right: -2px;\n    bottom: -2px;\n    width: auto;\n    height: auto;\n  }\n\n  /* This is used for the new behavior and look of the ring indicator\n  where the highlight target is specified and different from the trigger element\n  and it's not supposed to be floating, but rather highlighting the target element's boundary.\n  Lit would add bind-to-target (kebab-case) attribute when the component has bindToTarget (camelCase) property set true. */\n  :host([bind-to-target]) {\n    position: absolute;\n    width: 100%;\n    height: 100%;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n  }\n\n  .container {\n    display: inline-block;\n    position: relative;\n    box-sizing: border-box;\n    height: 100%;\n    width: 100%;\n  }\n\n  @keyframes small-ring {\n    0% {\n      outline-offset: var(--firefly-coach-indicator-ring-outline-offset);\n    }\n\n    50% {\n      outline-offset: calc(var(--firefly-coach-indicator-ring-outline-offset) + 3px);\n    }\n\n    100% {\n      outline-offset: calc(var(--firefly-coach-indicator-ring-outline-offset) + 4px);\n    }\n  }\n\n  @keyframes large-ring {\n    0% {\n      outline-offset: var(--firefly-coach-indicator-ring-outline-offset);\n      outline-width: 4px;\n    }\n\n    25% {\n      outline-width: 8px;\n    }\n\n    50% {\n      outline-offset: calc(var(--firefly-coach-indicator-ring-outline-offset) + 3px);\n    }\n\n    100% {\n      outline-offset: calc(var(--firefly-coach-indicator-ring-outline-offset) + 8px);\n      outline-width: 8px;\n    }\n  }\n\n  .ring {\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    outline-style: solid;\n    outline-width: 4px;\n    outline-color: rgb(var(--firefly-coach-indicator-outline-color));\n    border-radius: var(--firefly-coach-indicator-border-radius);\n    animation: small-ring var(--firefly-coach-indicator-animation-duration) alternate infinite ease-in-out;\n  }\n\n  .ring:nth-child(2) {\n    /* Required to use comma because spectrum color uses rgb with commas */\n    /* stylelint-disable-next-line color-function-notation */\n    outline-color: rgba(var(--firefly-coach-indicator-outline-color), 0.2);\n    animation: large-ring var(--firefly-coach-indicator-animation-duration) alternate infinite ease-in-out;\n  }\n\n  @media (prefers-reduced-motion: reduce) {\n    .ring {\n      animation: none;\n    }\n  }\n`;\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { styles } from './coach-indicator.css.js';\nimport { LitElement, html } from 'lit';\nimport { customElement, property } from 'lit/decorators.js';\n\n/**\n * design is based off of https://www.figma.com/design/Mngz9H7WZLbrCvGQf3GnsY/S2-%2F-Desktop?node-id=48600-896&p=f&t=bK8JEELvrGrl7U5m-0\n */\n\nexport type CoachIndicatorProps = {\n  floating: boolean;\n  bindToTarget: boolean;\n};\n\nexport const tagName = 'firefly-coach-indicator';\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    [tagName]: CoachIndicator;\n  }\n}\n\n/**\n * @description `firefly-coach-indicator` is a custom LitElement that shows the connection between an object and its explanation in a touring mode - for example, the source of a coach mark in an onboarding tour.\n *\n * @element firefly-coach-indicator\n *\n * @cssprop --firefly-coach-indicator-border-radius - Border radius of the ring indicator.\n * @cssprop --firefly-coach-indicator-outline-color - Color of the ring indicator.\n * @cssprop --firefly-coach-indicator-animation-duration - Duration of the ring indicator animation.\n * @cssprop --firefly-coach-indicator-ring-outline-offset - Outline offset of the ring indicator.\n *\n * @slot - Default slot of the content for the ring indicator to wrap around.\n *\n * @property {boolean} floating - Animate the ring indicator outside of the slot component for floating elements. If not set, the ring indicator will be animated inside the parent component.\n * @property {boolean} bindToTarget - Size the ring indicator to match the target element's dimensions rather than filling a positioned container.\n *\n * @example\n * <sp-button treatment=\"outline\" variant=\"primary\">\n *   <firefly-coach-indicator floating></firefly-coach-indicator>\n *   Floating\n * </sp-button>\n */\n\n@customElement(tagName)\nexport class CoachIndicator extends LitElement {\n  static styles = [styles];\n\n  @property({ type: Boolean, reflect: true })\n  floating = false;\n\n  // When true, the ring indicator will be sized to match the target element's dimensions rather than filling a parent container.\n  // This should be used when highlightTarget is set in step of a tour item.\n  // This is used for the new behavior and look of the ring indicator\n  // where the highlight target is specified and different from the trigger element\n  // and it's not supposed to be floating, but rather highlighting the target element's boundary.\n  // Lit would add bind-to-target (kebab-case) attribute when the component has bindToTarget (camelCase) property set true.\n  @property({ type: Boolean, reflect: true })\n  bindToTarget = false;\n\n  render() {\n    return html`\n      <div class=\"container\">\n        <div class=\"ring\"></div>\n        <div class=\"ring\"></div>\n      </div>\n    `;\n  }\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\n// This file is generated. Do not edit.\nimport { TemplateResult, html } from 'lit';\nimport { customElement } from 'lit/decorators.js';\n\nimport { IconBase } from '@spectrum-web-components/icon';\n\nconst tagName = 'firefly-icon-ai-generate';\n\n@customElement(tagName)\nexport class IconAIGenerate extends IconBase {\n  protected override render(): TemplateResult {\n    return html`\n      <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 20 20\">\n        <path\n          d=\"m13.25,18h-7.5c-2.06787,0-3.75-1.68262-3.75-3.75v-7.5c0-2.06738,1.68213-3.75,3.75-3.75h2.25c.41406,0,.75.33594.75.75s-.33594.75-.75.75h-2.25c-1.24072,0-2.25,1.00977-2.25,2.25v7.5c0,1.24023,1.00928,2.25,2.25,2.25h7.5c1.24072,0,2.25-1.00977,2.25-2.25v-3.75195c0-.41406.33594-.75.75-.75s.75.33594.75.75v3.75195c0,2.06738-1.68213,3.75-3.75,3.75Z\"\n          fill=\"currentColor\" />\n        <path\n          d=\"m12.93994,9.58301c-.19434,0-.39014-.05078-.56787-.15332-.42822-.24707-.646-.7373-.5415-1.2207l.5127-2.375-1.63135-1.7998c-.33203-.36621-.38916-.90039-.1416-1.3291.24805-.42773.7373-.64551,1.22217-.54102l2.37402.51367,1.79932-1.63184c.3667-.33301.90137-.38965,1.32959-.1416.42822.24707.64551.73828.54053,1.22168l-.5127,2.37402,1.63135,1.7998c.33203.36621.38965.89941.14209,1.32812-.24707.42969-.73535.64746-1.22217.54199l-2.37402-.51367-1.79932,1.63184c-.21484.19434-.48682.29492-.76123.29492Zm.90918-3.61621l-.31201,1.44531,1.09521-.99316c.27197-.24609.64453-.34863,1.00244-.26758l1.44287.31152-.99219-1.09473c-.24463-.27051-.34473-.64355-.26855-1l.3125-1.44531-1.09473.99219c-.27148.24512-.64258.34863-1.00293.26758l-1.44287-.31152.99219,1.09473c.24512.26953.3457.64453.26807,1.00098Z\"\n          fill=\"currentColor\" />\n        <path\n          d=\"m8.12012,13.25c-.12891,0-.2583-.0332-.375-.10059-.28223-.16309-.42676-.48926-.35791-.80762l.20264-.93945-.64551-.71191c-.21875-.24219-.25684-.59668-.09375-.87891s.49219-.42188.80811-.3584l.93896.2041.71191-.64551c.2417-.21973.59717-.25684.87891-.09375.28223.16309.42676.48926.35791.80762l-.20264.93945.64551.71191c.21875.24219.25684.59668.09375.87891s-.49121.4209-.80811.3584l-.93945-.2041-.71143.64551c-.1416.12793-.32227.19434-.50391.19434Z\"\n          fill=\"currentColor\" />\n      </svg>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    [tagName]: IconAIGenerate;\n  }\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\n// This file is generated. Do not edit.\nimport { TemplateResult, html } from 'lit';\nimport { customElement } from 'lit/decorators.js';\n\nimport { IconBase } from '@spectrum-web-components/icon';\n\nconst tagName = 'firefly-icon-ai-sparkles';\n\n@customElement(tagName)\nexport class IconAISparkles extends IconBase {\n  protected override render(): TemplateResult {\n    return html`\n      <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 20 20\">\n        <path\n          d=\"m9.91818,13.2491c-.21875,0-.43945-.05664-.63867-.17188-.48145-.27832-.72461-.83008-.60645-1.37305l.72754-3.37402-2.31836-2.55762c-.37305-.41211-.4375-1.01172-.15918-1.49316.27832-.48242.83496-.72559,1.37305-.60645l3.37402.72754,2.55762-2.31836c.41309-.375,1.0127-.43652,1.49316-.15918.48145.27832.72461.83008.60645,1.37305l-.72754,3.37402,2.31836,2.55762c.37305.41113.43652,1.01074.15918,1.49219-.27832.48047-.82812.72559-1.37207.6084l-3.37402-.72949-2.55859,2.31934c-.24121.21875-.54688.33105-.85449.33105Zm.97363-4.71582l-.60449,2.7998,2.12207-1.92383c.30273-.27441.7207-.3877,1.12207-.30176l2.80176.60547-1.92383-2.12207c-.27539-.30469-.3877-.72559-.2998-1.12598l.60352-2.79785-2.12207,1.92383c-.30469.27539-.72461.38672-1.12598.2998l-2.79785-.60352,1.92383,2.12207c.27539.30371.3877.72363.30078,1.12402Zm4.68359-1.75098v.00098-.00098Zm-3.79297-2.35742h.00098-.00098Z\"\n          fill=\"currentColor\" />\n        <path\n          d=\"m3.3457,18.25195c-.12891,0-.25781-.0332-.375-.10059-.28223-.16309-.42676-.48926-.3584-.80762l.30664-1.41797-.97461-1.07422c-.21875-.24121-.25684-.59668-.09375-.87891s.49121-.42285.80762-.3584l1.41797.30664,1.07422-.97461c.24219-.21973.5957-.25684.87891-.09375.28223.16309.42676.48926.3584.80762l-.30664,1.41797.97461,1.07422c.21875.24121.25684.59668.09375.87891s-.49219.4209-.80762.3584l-1.41797-.30664-1.07422.97461c-.1416.12793-.32227.19434-.50391.19434Z\"\n          fill=\"currentColor\" />\n      </svg>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    [tagName]: IconAISparkles;\n  }\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\n// This file is generated. Do not edit.\nimport { TemplateResult, html } from 'lit';\nimport { customElement } from 'lit/decorators.js';\n\nimport { IconBase } from '@spectrum-web-components/icon';\n\nconst tagName = 'firefly-icon-properties';\n\n@customElement(tagName)\nexport class IconProperties extends IconBase {\n  protected override render(): TemplateResult {\n    return html`\n      <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 20 20\">\n        <path\n          d=\"m1.75,6.77148h2.6687c.34064,1.43018,1.62128,2.5,3.15405,2.5s2.81342-1.06982,3.15405-2.5h7.52319c.41406,0,.75-.33594.75-.75s-.33594-.75-.75-.75h-7.52319c-.34064-1.43018-1.62128-2.5-3.15405-2.5s-2.81342,1.06982-3.15405,2.5H1.75c-.41406,0-.75.33594-.75.75s.33594.75.75.75Zm5.82275-2.5c.96484,0,1.75.78516,1.75,1.75s-.78516,1.75-1.75,1.75-1.75-.78516-1.75-1.75.78516-1.75,1.75-1.75Z\"\n          fill=\"currentColor\" />\n        <path\n          d=\"m18.25,13.27148h-2.52319c-.34064-1.43018-1.62128-2.5-3.15405-2.5s-2.81342,1.06982-3.15405,2.5H1.75c-.41406,0-.75.33594-.75.75s.33594.75.75.75h7.6687c.34064,1.43018,1.62128,2.5,3.15405,2.5s2.81342-1.06982,3.15405-2.5h2.52319c.41406,0,.75-.33594.75-.75s-.33594-.75-.75-.75Zm-5.67725,2.5c-.96484,0-1.75-.78516-1.75-1.75s.78516-1.75,1.75-1.75,1.75.78516,1.75,1.75-.78516,1.75-1.75,1.75Z\"\n          fill=\"currentColor\" />\n      </svg>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    [tagName]: IconProperties;\n  }\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\n\nexport class PromptChangeEvent extends CustomEvent<{ value: string }> {\n  static readonly eventName = 'prompt-change';\n\n  constructor(value: string) {\n    super(PromptChangeEvent.eventName, {\n      detail: { value },\n      bubbles: true,\n      composed: true,\n    });\n  }\n}\n\nexport class PromptTextAreaKeydownEvent extends CustomEvent<{ event: KeyboardEvent }> {\n  static readonly eventName = 'textarea-keydown';\n\n  constructor(event: KeyboardEvent) {\n    super(PromptTextAreaKeydownEvent.eventName, {\n      detail: { event },\n      bubbles: true,\n      composed: true,\n    });\n  }\n}\n\nexport class PromptPopupClose extends CustomEvent<{ event: KeyboardEvent | MouseEvent }> {\n  static readonly eventName = 'popup-close';\n\n  constructor(event: KeyboardEvent | MouseEvent) {\n    super(PromptPopupClose.eventName, {\n      detail: { event },\n      bubbles: true,\n      composed: true,\n    });\n  }\n}\n\n/**\n * Creates a keydown event handler that invokes a callback when Enter key is pressed.\n * Prevents default behavior and only triggers when not composing (e.g., IME input).\n *\n * @param onSubmitCallback - The function to call when Enter is pressed\n * @returns Event handler function for textarea-keydown events\n *\n * @example\n * ```typescript\n * @textarea-keydown=${submitOnEnter(() => {\n *   if (isGenerationDisabled) return;\n *   generate();\n * })}\n * ```\n */\nexport function submitOnEnter(onSubmitCallback: () => void) {\n  return (e: PromptTextAreaKeydownEvent) => {\n    const { event } = e.detail;\n    if (event.key === 'Enter' && !event.isComposing) {\n      event.preventDefault();\n      onSubmitCallback();\n    }\n  };\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { css } from 'lit';\n\nexport const styles = css`\n  :host {\n    --firefly-prompt-width: 100%;\n\n    /** background color of the prompt */\n    --firefly-prompt-background-color: var(--firefly-primary-background-color);\n\n    /** Specify the border radius for the prompt */\n    --firefly-prompt-border-radius: var(--firefly-primary-border-radius);\n\n    /** Specify the prompt label color */\n    --firefly-prompt-label-color: var(--spectrum-gray-700);\n\n    /** Specify the prompt label font size */\n    --firefly-prompt-label-font-size: var(--spectrum-font-size-100);\n\n    /** Specify the prompt input font size */\n    --firefly-prompt-input-font-size: var(--spectrum-font-size-200);\n\n    /** Specify the prompt input horizontal padding */\n    --firefly-prompt-input-horizontal-padding: var(--spectrum-spacing-200);\n\n    /** Specify the prompt input textfield padding */\n    --firefly-prompt-input-textfield-padding: 0;\n\n    /** Specify the prompt input vertical padding */\n    --firefly-prompt-input-vertical-padding: var(--spectrum-spacing-100);\n\n\n    /** Specify the prompt input vertical padding */\n    --firefly-prompt-label-container-vertical-padding: 6px;\n\n    /** Specify the preview slot max width */\n    --firefly-prompt-preview-max-width: 150px;\n\n    /** Specify the prompt box shadow */\n    --firefly-prompt-box-shadow: var(--firefly-primary-box-shadow-style);\n\n    /** Specify the prompt popup border radius */\n    --firefly-prompt-popup-border-color: var(--spectrum-global-color-gray-300);\n\n    /** Specify the prompt popup background color */\n    --firefly-prompt-popup-background-color: var(--firefly-primary-background-color);\n\n    /** Specify the prompt popup vertical padding */\n    --firefly-prompt-popup-vertical-padding: var(--spectrum-spacing-100);\n\n    /** Specify the z-index for prompt popup */\n    --firefly-prompt-popup-z-index: 200;\n\n    /** Specify the spacing for prompt popup from prompt */\n    --firefly-prompt-popup-bottom: var(--spectrum-spacing-100);\n\n    /** Specify the color for the divider */\n    --firefly-prompt-preview-divider-background-color: var(--spectrum-gray-300);\n\n    /** Specify the height of the divider */\n    --firefly-prompt-preview-divider-height: 85%;\n\n    /** Specify the duration of the header transition */\n    --firefly-prompt-header-transition-duration: var(--spectrum-animation-duration-600);\n\n    /** Specify the height of the header divider */\n    --firefly-prompt-header-divider-height: var(--spectrum-spacing-50);\n    --firefly-prompt-header-divider-margin: auto var(--spectrum-spacing-50);\n  }\n\n  .root {\n    display: grid;\n    grid-template-areas:\n      'header header header header header header header'\n      'header-divider header-divider header-divider header-divider header-divider header-divider header-divider'\n      'preview left-utility divider input input input input'\n      'preview left-utility divider utility utility secondary-action primary-action';\n    grid-template-columns: auto auto auto 1fr auto auto auto auto;\n    grid-template-rows: auto auto 1fr auto;\n    background-color: var(--firefly-prompt-background-color);\n    gap: 0;\n    border-radius: var(--firefly-prompt-border-radius);\n    width: var(--firefly-prompt-width);\n    box-shadow: var(--firefly-prompt-box-shadow);\n    padding: var(--firefly-prompt-padding, 0);\n  }\n\n  @media (min-width: 768px) {\n    .root {\n      min-height: var(--firefly-prompt-min-height);\n    }\n  }\n\n  .single-row {\n    grid-template-areas:\n      'header header header header header header header header header header'\n      'preview left-utility divider input input input utility utility secondary-action primary-action';\n    grid-template-columns: auto auto auto 1fr auto auto auto;\n    grid-template-rows: auto 1fr;\n  }\n\n  .single-column {\n    grid-template-areas:\n      'preview'\n      'left-utility'\n      'input'\n      'secondary-action'\n      'primary-action';\n    grid-template-columns: 1fr;\n    grid-template-rows: auto auto 1fr auto auto;\n  }\n\n  .input-container {\n    grid-area: input;\n    padding: var(--firefly-prompt-input-top-padding, var(--firefly-prompt-input-vertical-padding)) var(--firefly-prompt-input-right-padding, var(--firefly-prompt-input-horizontal-padding)) var(--firefly-prompt-input-bottom-padding, var(--firefly-prompt-input-vertical-padding)) var(--firefly-prompt-input-left-padding, var(--firefly-prompt-input-horizontal-padding));\n  }\n\n  .input-textfield {\n    padding: var(--firefly-prompt-input-textfield-padding);\n  }\n\n  .preview-divider {\n    grid-area: divider;\n    height: var(--firefly-prompt-preview-divider-height);\n    margin: var(--firefly-prompt-header-divider-margin);\n    background-color: var(--firefly-prompt-preview-divider-background-color);\n  }\n\n  .header-container {\n    grid-area: header;\n    opacity: 1;\n    position: relative;\n    transition:\n      height var(--firefly-prompt-header-transition-duration) ease-in-out,\n      opacity var(--firefly-prompt-header-transition-duration) ease-in-out;\n    overflow: hidden;\n  }\n\n  .header-divider {\n    grid-area: header-divider;\n    height: var(--firefly-prompt-header-divider-height);\n  }\n\n  .header-container-hidden {\n    display: none;\n  }\n\n  /* Base styles for slotted content */\n  ::slotted([slot='label']),\n  ::slotted([slot='label-utility']),\n  ::slotted([slot='secondary-label-utility']),\n  ::slotted([slot='top-right-utility']) {\n    color: var(--firefly-prompt-label-color);\n    font-size: var(--firefly-prompt-label-font-size);\n  }\n\n  ::slotted([slot='utility']) {\n    grid-area: utility;\n  }\n\n  ::slotted([slot='secondary-action']) {\n    grid-area: secondary-action;\n  }\n\n  ::slotted([slot='primary-action']) {\n    grid-area: primary-action;\n  }\n\n  ::slotted([slot='preview']) {\n    grid-area: preview;\n    max-width: var(--firefly-prompt-preview-max-width);\n  }\n\n  ::slotted([slot='left-utility']) {\n    grid-area: left-utility;\n    padding: var(--firefly-prompt-input-vertical-padding) 0;\n  }\n\n  .popup {\n    padding-top: var(--firefly-prompt-popup-vertical-padding);\n    padding-bottom: var(--firefly-prompt-popup-vertical-padding);\n    position: absolute;\n    bottom: var(--firefly-prompt-popup-bottom);\n    background-color: var(--firefly-prompt-popup-background-color);\n    border-radius: var(--firefly-prompt-border-radius);\n    box-shadow: var(--firefly-prompt-box-shadow);\n    overflow: hidden;\n    z-index: var(--firefly-prompt-popup-z-index);\n    width: 100%;\n  }\n\n  .slots-container {\n    display: flex;\n    justify-content: space-between;\n  }\n\n  .slots-group {\n    display: flex;\n    align-items: center;\n    gap: 10px;\n  }\n`;\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { PromptChangeEvent, PromptPopupClose, PromptTextAreaKeydownEvent } from './events.js';\nimport { styles } from './prompt.css.js';\nimport { LitElement, PropertyValues, html } from 'lit';\nimport { customElement, property, query, queryAssignedNodes, state } from 'lit/decorators.js';\nimport { classMap } from 'lit/directives/class-map.js';\nimport { styleMap } from 'lit/directives/style-map.js';\nimport { when } from 'lit/directives/when.js';\n\nimport '@spectrum-web-components/divider/sp-divider.js';\n\nimport { isKeyboardSubmit } from '../../functions/key-functions.js';\nimport { commonStyles } from '../common/styles.css.js';\nimport { TextfieldInputEvent, TextfieldKeydownEvent } from '../textfield/events.js';\nimport { TextfieldProps } from '../textfield/textfield.js';\nimport '../textfield/textfield.js';\n\nexport const tagName = 'firefly-prompt';\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    [tagName]: Prompt;\n  }\n}\n\nexport type PromptProps = {\n  showpopup?: boolean;\n  showHeader?: boolean;\n  inputAriaLabel?: string;\n  layout?: 'grid' | 'single-row' | 'single-column';\n  maxRows?: number;\n} & TextfieldProps;\n\n/**\n * `firefly-prompt` is a component that allows the user to input text and position elements according to prompt design in FF\n *\n * @element firefly-prompt\n *\n * @slot label - Renders the label of the prompt\n * @slot utility - Renders the utility content of the prompt\n * @slot secondary-action - Renders the secondary action of the prompt\n * @slot primary-action - Renders the primary action of the prompt\n * @slot preview - Renders a preview of the content in the left side of the prompt\n * @slot left-utility - Renders utility content on the left side after the preview slot\n * @slot popup - Renders popup content on top of the prompt\n * @slot header - Renders the header content above the prompt\n *\n * @cssprop --firefly-prompt-width - Specify the width of the prompt\n * @cssprop --firefly-prompt-background-color - Background color of the prompt\n * @cssprop --firefly-prompt-border-radius - Specify the border radius for the prompt\n * @cssprop --firefly-prompt-label-color - Specify the prompt label color\n * @cssprop --firefly-prompt-input-font-size - Specify the prompt input font size\n * @cssprop --firefly-prompt-input-textfield-padding - Specify the prompt input textfield padding\n * @cssprop --firefly-prompt-input-horizontal-padding - Specify the input horizontal padding\n * @cssprop --firefly-prompt-input-vertical-padding - Specify the input vertical padding\n * @cssprop --firefly-prompt-preview-max-width - Specify the preview slot max width\n * @cssprop --firefly-prompt-box-shadow - Specify the box shadow for the prompt container\n * @cssprop --firefly-prompt-popup-border-color - Specify the border color for the popup\n * @cssprop --firefly-prompt-popup-background-color - Specify the background color for the popup\n * @cssprop --firefly-prompt-popup-vertical-padding - Specify the vertical padding for the popup\n * @cssprop --firefly-prompt-preview-divider-background-color - Specify the color for the divider\n * @cssprop --firefly-prompt-preview-divider-height - Specify the height of the divider\n * @cssprop --firefly-prompt-header-transition-duration - Specify the duration of the header transition\n *\n * @property {string} inputAriaLabel - The aria label for the prompt input\n * @property {string} value - The value of the prompt\n * @property {boolean} disabled - Whether the prompt is disabled\n * @property {string} placeholder - The placeholder of the prompt\n * @property {number} maxlength - The maximum length of the prompt\n * @property {number} minlength - The minimum length of the prompt\n * @property {boolean} showpopup - Whether the popup should be shown\n * @property {boolean} showHeader - Whether the header should be shown\n * @property {number} rows - The number of rows the text area should have in UI\n * @property {string} layout - Whether the prompt bar should be grid / single row / single column\n * @property {number} maxRows - The maximum number of rows for the textfield after which scrolling starts. Max-rows will take precendence over rows if both parameters are passed.\n * @property {number} tabIndex - The tab index of the prompt\n * @fires prompt-change - Dispatched when the prompt value changes\n * @fires textarea-keydown - Dispatched on keydown of text area\n */\n@customElement(tagName)\nexport class Prompt extends LitElement implements PromptProps {\n  static styles = [commonStyles, styles];\n\n  /** Public properties */\n  @property({ type: String, reflect: true, attribute: 'input-aria-label' })\n  inputAriaLabel = '';\n\n  @property({ type: String, reflect: true })\n  value = '';\n\n  @property({ type: Boolean, reflect: true })\n  disabled = false;\n\n  @property({ type: Boolean, reflect: true })\n  shrinkToFitText = false;\n\n  @property({ type: String, reflect: true })\n  placeholder = '';\n\n  @property({ type: Number })\n  maxlength = -1;\n\n  @property({ type: Number })\n  minlength = -1;\n\n  @property({ type: Number, reflect: true })\n  rows = 1;\n\n  @property({ type: Boolean, reflect: true })\n  showpopup = false;\n\n  @property({ type: Boolean, reflect: true })\n  showHeader = false;\n\n  @property({ type: String, reflect: true })\n  layout: 'grid' | 'single-row' | 'single-column' = 'grid';\n\n  @property({ type: Number, attribute: 'max-rows' })\n  maxRows = 0;\n\n  @property({ type: Number })\n  tabIndex = 0;\n\n  @property({ type: Boolean, reflect: true })\n  overflowTextShadow = true;\n\n  @property({ type: Boolean, attribute: 'enable-height-animation' })\n  enableHeightAnimation = true;\n\n  @state()\n  private hasPreview = false;\n\n  @queryAssignedNodes({ slot: 'preview', flatten: true })\n  previewSlotNodes!: Node[];\n\n  @queryAssignedNodes({ slot: 'popup', flatten: true })\n  popupSlotNodes!: Node[];\n\n  @query('#header-container')\n  private headerContainer!: HTMLElement;\n\n  @query('slot[name=\"header\"]')\n  private headerSlot!: HTMLSlotElement;\n\n  @query('sp-divider.header-divider')\n  private headerDivider!: HTMLElement;\n\n  @state()\n  private headerHeight = 0;\n\n  @query('#popup-container') popupContainer!: HTMLDivElement;\n\n  @query('#prompt-input')\n  private promptInput!: HTMLElement;\n\n  private resizeObserver: ResizeObserver | null = null;\n\n  /**  Lifecycle methods */\n\n  connectedCallback() {\n    super.connectedCallback();\n    window.addEventListener('click', this.handleWindowClick);\n\n    // Create ResizeObserver to monitor header slot content changes\n    this.resizeObserver = new ResizeObserver(entries => {\n      for (const entry of entries) {\n        if (entry.target === this.headerSlot) {\n          this.updateHeaderHeight();\n        }\n      }\n    });\n  }\n\n  disconnectedCallback() {\n    window.removeEventListener('click', this.handleWindowClick);\n\n    // Clean up the observer when the component is removed\n    if (this.resizeObserver) {\n      this.resizeObserver.disconnect();\n      this.resizeObserver = null;\n    }\n\n    super.disconnectedCallback();\n  }\n\n  firstUpdated() {\n    this.updateComplete.then(() => {\n      this.updateHeaderHeight();\n\n      // Start observing the header slot after first render\n      if (this.headerSlot && this.resizeObserver) {\n        this.resizeObserver.observe(this.headerSlot);\n      }\n    });\n  }\n\n  protected updated(changedProperties: PropertyValues): void {\n    super.updated(changedProperties);\n\n    if (changedProperties.has('showHeader') || changedProperties.has('showpopup')) {\n      this.updateHeaderHeight();\n    }\n  }\n\n  private handleWindowClick = (event: MouseEvent) => {\n    const path = event.composedPath();\n    if (this.showpopup && !path.includes(this.popupContainer)) {\n      // TODO: Remove this after deprecating SPL implementation\n      this.showpopup = false;\n      this.dispatchEvent(new PromptPopupClose(event));\n    }\n  };\n\n  private onPreviewSlotChange() {\n    this.hasPreview = this.previewSlotNodes.length > 0;\n  }\n\n  private updateHeaderHeight() {\n    if (!this.headerSlot || !this.headerContainer) {\n      return;\n    }\n\n    const headerNodes = this.headerSlot.assignedNodes({ flatten: true }) as HTMLElement[];\n\n    if (headerNodes.length > 0) {\n      const headerSlot = headerNodes[0];\n      const dividerHeight = this.headerDivider?.getBoundingClientRect().height || 0;\n\n      // Only measure when header should be visible\n      if (this.showHeader && !this.showpopup) {\n        // Use requestAnimationFrame to ensure measurement happens after paint\n        requestAnimationFrame(() => {\n          const headerRect = headerSlot.getBoundingClientRect();\n          if (headerRect.height > 0) {\n            this.headerHeight = headerRect.height + dividerHeight;\n            this.headerContainer.style.height = `${this.headerHeight}px`;\n          }\n        });\n      } else {\n        this.headerContainer.style.height = '0px';\n      }\n    }\n  }\n\n  private onPromptContainerKeydown = (event: KeyboardEvent) => {\n    if (event.key === 'Escape') {\n      // TODO: Remove this after deprecating SPL implementation\n      this.showpopup = false;\n\n      this.dispatchEvent(new PromptPopupClose(event));\n    }\n  };\n\n  /**\n   * Focuses the prompt input field\n   */\n  public focusInput(): void {\n    this.promptInput?.focus();\n  }\n\n  render() {\n    return html`\n      <!-- Placeholder to keep header height while it is hidden (to temporarily show popup) -->\n      ${when(\n        this.showpopup && this.showHeader,\n        () => html`\n          <div\n            class=\"header-placeholder\"\n            style=${styleMap({\n              height: `${this.headerHeight}px`,\n              width: '100%',\n            })}></div>\n        `\n      )}\n      ${when(\n        this.showpopup,\n        () => html`\n          <div id=\"popup-container\" style=\"position: relative\">\n            <div class=\"popup\">\n              <slot name=\"popup\"></slot>\n            </div>\n          </div>\n        `\n      )}\n      <div\n        id=\"firefly-prompt-container\"\n        class=${classMap({\n          ['root']: true,\n          [`${this.layout}`]: true,\n        })}\n        @keydown=${this.onPromptContainerKeydown}\n        data-testid=\"firefly-prompt-container\">\n        <div\n          id=\"header-container\"\n          class=${classMap({\n            ['header-container']: true,\n            ['header-container-hidden']: !this.showHeader || this.showpopup,\n          })}>\n          <slot name=\"header\"></slot>\n          <sp-divider id=\"header-divider\" class=\"header-divider\" size=\"m\"></sp-divider>\n        </div>\n        <slot name=\"preview\" @slotchange=${this.onPreviewSlotChange}></slot>\n        <slot name=\"left-utility\"></slot>\n\n        ${when(this.hasPreview, () => html` <sp-divider class=\"preview-divider\" size=\"m\" vertical></sp-divider> `)}\n\n        <section class=\"input-container\">\n          <div class=\"slots-container\">\n            <div class=\"slots-group\">\n              <slot name=\"label\"></slot>\n              <slot name=\"label-utility\"></slot>\n              <slot name=\"secondary-label-utility\"></slot>\n            </div>\n            <div class=\"slots-group\">\n              <slot name=\"top-right-utility\"></slot>\n            </div>\n          </div>\n          <firefly-textfield\n            id=\"prompt-input\"\n            class=\"input-textfield\"\n            aria-label=${this.inputAriaLabel}\n            rows=${this.rows}\n            ?shrinkToFitText=${this.shrinkToFitText}\n            ?disabled=${this.disabled}\n            max-rows=${this.maxRows}\n            maxlength=${this.maxlength}\n            minlength=${this.minlength}\n            tabIndex=${this.tabIndex ?? 0}\n            placeholder=${this.placeholder}\n            @textfield-input=${(e: TextfieldInputEvent) => this.dispatchEvent(new PromptChangeEvent(e.detail.value))}\n            @textfield-keydown=${(e: TextfieldKeydownEvent) => {\n              // if enter, check if stll composing\n              if (e.detail.originalEvent.key === 'Enter' && !isKeyboardSubmit(e.detail.originalEvent)) {\n                // skip the invalid Enter key event\n                e.detail.originalEvent.stopPropagation();\n                e.detail.originalEvent.preventDefault();\n              } else {\n                this.dispatchEvent(new PromptTextAreaKeydownEvent(e.detail.originalEvent));\n              }\n            }}\n            value=${this.value}></firefly-textfield>\n        </section>\n\n        <slot name=\"utility\"></slot>\n        <slot name=\"secondary-action\"></slot>\n        <slot name=\"primary-action\"></slot>\n      </div>\n    `;\n  }\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\n\nfunction isEnterSubmit(event: KeyboardEvent): boolean {\n  // event keyCode is for Safari\n  return event.key === 'Enter' && event.keyCode === 13 && !event.shiftKey;\n}\n\nfunction isIMECompositing(event: KeyboardEvent): boolean {\n  return event.isComposing;\n}\n\nexport function isKeyboardSubmit(event: KeyboardEvent) {\n  // if IME is composing, don't process keys so that IME can handle them.\n  if (isIMECompositing(event)) {\n    return false;\n  } else if (!isEnterSubmit(event)) {\n    return false;\n  }\n  return true;\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { Item } from './selectable-grid.js';\n\nexport class SelectionChangeEvent extends CustomEvent<{ selected: Array<Item> }> {\n  static readonly EVENT_NAME = 'selectionChange';\n\n  constructor(selected: Array<Item>) {\n    super(SelectionChangeEvent.EVENT_NAME, {\n      bubbles: true,\n      composed: true,\n      detail: { selected },\n    });\n  }\n}\n\nexport class ReorderEvent extends CustomEvent<{ oldIndex: number; newIndex: number; items: Array<Item> }> {\n  static readonly EVENT_NAME = 'reorder';\n\n  constructor(oldIndex: number, newIndex: number, items: Array<Item>) {\n    super(ReorderEvent.EVENT_NAME, {\n      bubbles: true,\n      composed: true,\n      detail: { oldIndex, newIndex, items },\n    });\n  }\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { Item } from '../selectable-grid.js';\n\nexport type AccessibilityState = {\n  focusedItemId: string | undefined;\n  presentedItems: Item[];\n  itemsInSection: number;\n  draggedItemId: string | undefined;\n  disabled: boolean;\n  title: string;\n  ariaLabel: string | null;\n  ariaDescribedby?: string;\n  selectionVariant: 'none' | 'single' | 'multiple';\n};\n\n/**\n * Updates the live region with a message for screen readers\n */\nexport const updateLiveRegion = (message: string, setLiveRegionMessage: (message: string) => void): void => {\n  setLiveRegionMessage(message);\n\n  // Clear the message after screen reader has time to announce it\n  setTimeout(() => {\n    setLiveRegionMessage('');\n  }, 1000);\n};\n\n/**\n * Calculates aria attributes for a grid item\n */\nexport const getItemAriaAttributes = (\n  item: Item,\n  state: AccessibilityState\n): {\n  role: string;\n  'aria-selected': 'true' | 'false';\n  'aria-rowindex': number;\n  'aria-colindex': number;\n  'aria-disabled': 'true' | 'false';\n  'aria-grabbed': 'true' | 'false';\n  'aria-describedby'?: string;\n  tabindex: number;\n} => {\n  const itemIndex = state.presentedItems.findIndex(i => i.id === item.id);\n  const rowIndex = Math.floor(itemIndex / state.itemsInSection) + 1;\n  const colIndex = (itemIndex % state.itemsInSection) + 1;\n  const isFocused = state.focusedItemId === item.id;\n  const isDraggedItem = state.draggedItemId === item.id;\n\n  return {\n    role: 'gridcell',\n    'aria-selected': state.selectionVariant === 'none' ? 'false' : 'true',\n    'aria-rowindex': rowIndex,\n    'aria-colindex': colIndex,\n    'aria-disabled': state.disabled.toString() as 'true' | 'false',\n    'aria-grabbed': isDraggedItem.toString() as 'true' | 'false',\n    'aria-describedby': undefined, // Will be set conditionally based on draggable\n    tabindex: state.disabled ? -1 : isFocused ? 0 : -1,\n  };\n};\n\n/**\n * Calculates aria attributes for the grid container\n */\nexport const getGridAriaAttributes = (\n  state: AccessibilityState,\n  gridId: string,\n  titleId?: string\n): {\n  role: string;\n  'aria-label': string;\n  'aria-labelledby'?: string;\n  'aria-multiselectable': 'true' | 'false';\n  'aria-readonly': 'true' | 'false';\n  'aria-disabled': 'true' | 'false';\n  'aria-activedescendant'?: string;\n  'aria-describedby'?: string;\n  tabindex: number;\n} => {\n  const isMultiSelectable = state.selectionVariant === 'multiple';\n  const isReadonly = state.selectionVariant === 'none' || state.disabled;\n  const gridLabel = state.ariaLabel || state.title || 'Selectable grid';\n\n  return {\n    role: 'grid',\n    'aria-label': gridLabel,\n    'aria-labelledby': state.title ? titleId : undefined,\n    'aria-multiselectable': isMultiSelectable.toString() as 'true' | 'false',\n    'aria-readonly': isReadonly.toString() as 'true' | 'false',\n    'aria-disabled': state.disabled.toString() as 'true' | 'false',\n    'aria-activedescendant': state.focusedItemId,\n    'aria-describedby': state.ariaDescribedby,\n    tabindex: state.disabled ? -1 : 0,\n  };\n};\n\n/**\n * Generates unique IDs for accessibility elements\n */\nexport const generateAccessibilityIds = (componentId?: string) => {\n  const baseId = componentId || 'default';\n  return {\n    titleId: `firefly-selectable-grid-title-${baseId}`,\n    gridId: `firefly-selectable-grid-grid-${baseId}`,\n    dragInstructionsId: `${baseId}-drag-instructions`,\n  };\n};\n\n/**\n * Sets focus on a specific item element\n */\nexport const focusItem = (itemId: string, shadowRoot: ShadowRoot | null, updateComplete: Promise<boolean>): void => {\n  updateComplete.then(() => {\n    const element = shadowRoot?.getElementById(itemId);\n    element?.focus();\n  });\n};\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { Item } from '../selectable-grid.js';\n\nexport type DragState = {\n  draggedItemId: string | undefined;\n  draggedItemOriginalIndex: number;\n  draggedElement: HTMLElement | null;\n  presentedItems: Item[];\n  items: Item[];\n  itemsInSection: number;\n  autoFlow: 'row' | 'column';\n  disabled: boolean;\n  draggable: boolean;\n};\n\nexport type DragCallbacks = {\n  updateLiveRegion: (message: string) => void;\n  dispatchReorderEvent: (originalIndex: number, newIndex: number, items: Item[]) => void;\n  updateItems: (items: Item[]) => void;\n};\n\n/**\n * Gets the grid item element from an event target\n */\nexport const getGridItem = (element: HTMLElement, items: Item[]): HTMLElement | null => {\n  let target = element;\n  const itemIds = items.map(item => item.id);\n  while (target && !itemIds.includes(target.id)) {\n    target = target.parentElement as HTMLElement;\n  }\n  return target && itemIds.includes(target.id) ? target : null;\n};\n\n/**\n * Moves an item within an array from one index to another\n */\nexport const moveItemInArray = (items: Item[], fromIndex: number, toIndex: number): Item[] => {\n  if (fromIndex === toIndex || fromIndex < 0 || toIndex < 0 || fromIndex >= items.length || toIndex >= items.length) {\n    return items;\n  }\n\n  const newItems = [...items];\n  const [movedItem] = newItems.splice(fromIndex, 1);\n  newItems.splice(toIndex, 0, movedItem);\n  return newItems;\n};\n\n/**\n * Enters drag mode for keyboard-based dragging\n */\nexport const enterDragMode = (\n  state: DragState,\n  focusedItemId: string | undefined,\n  callbacks: DragCallbacks\n): { draggedItemId: string | undefined; draggedItemOriginalIndex: number } => {\n  if (state.disabled || !state.draggable || !focusedItemId) {\n    return { draggedItemId: undefined, draggedItemOriginalIndex: -1 };\n  }\n\n  const draggedItemOriginalIndex = state.presentedItems.findIndex(item => item.id === focusedItemId);\n  const draggedItem = state.presentedItems.find(item => item.id === focusedItemId);\n\n  callbacks.updateLiveRegion(`Dragging ${draggedItem?.id || 'item'}. Use arrow keys to move, Enter to drop, Escape to cancel.`);\n\n  return { draggedItemId: focusedItemId, draggedItemOriginalIndex };\n};\n\n/**\n * Exits drag mode and handles drop or cancel\n */\nexport const exitDragMode = (\n  state: DragState,\n  options: { dropped: boolean },\n  callbacks: DragCallbacks\n): { draggedItemId: undefined; draggedItemOriginalIndex: number } => {\n  if (!state.draggedItemId) {\n    return { draggedItemId: undefined, draggedItemOriginalIndex: -1 };\n  }\n\n  const draggedItem = state.presentedItems.find(item => item.id === state.draggedItemId);\n\n  if (options.dropped && state.draggedItemId) {\n    const newIndex = state.presentedItems.findIndex(item => item.id === state.draggedItemId);\n    callbacks.updateLiveRegion(`Dropped ${draggedItem?.id || 'item'} at position ${newIndex + 1}.`);\n\n    // Fire reorder event\n    if (state.draggedItemOriginalIndex !== newIndex) {\n      callbacks.dispatchReorderEvent(state.draggedItemOriginalIndex, newIndex, state.items);\n    }\n  } else {\n    callbacks.updateLiveRegion(`Drag cancelled. ${draggedItem?.id || 'Item'} returned to original position.`);\n\n    // Restore original order if drag was cancelled\n    if (state.draggedItemOriginalIndex !== -1) {\n      const currentIndex = state.presentedItems.findIndex(item => item.id === state.draggedItemId);\n      if (currentIndex !== state.draggedItemOriginalIndex) {\n        const newItems = moveItemInArray(state.items, currentIndex, state.draggedItemOriginalIndex);\n        callbacks.updateItems(newItems);\n      }\n    }\n  }\n\n  return { draggedItemId: undefined, draggedItemOriginalIndex: -1 };\n};\n\n/**\n * Handles keyboard-based drag movement in a specific direction\n */\nexport const handleKeyboardDragMove = (state: DragState, direction: 'up' | 'down' | 'left' | 'right', callbacks: DragCallbacks): Item[] => {\n  if (!state.draggedItemId) return state.items;\n\n  const currentIndex = state.presentedItems.findIndex(item => item.id === state.draggedItemId);\n  if (currentIndex === -1) return state.items;\n\n  const itemsPerRow = state.itemsInSection;\n  const totalItems = state.presentedItems.length;\n  let newIndex = currentIndex;\n\n  switch (direction) {\n    case 'right':\n      if (state.autoFlow === 'row') {\n        newIndex = Math.min(currentIndex + 1, totalItems - 1);\n      } else {\n        newIndex = Math.min(currentIndex + itemsPerRow, totalItems - 1);\n      }\n      break;\n\n    case 'left':\n      if (state.autoFlow === 'row') {\n        newIndex = Math.max(currentIndex - 1, 0);\n      } else {\n        newIndex = Math.max(currentIndex - itemsPerRow, 0);\n      }\n      break;\n\n    case 'down':\n      if (state.autoFlow === 'row') {\n        newIndex = Math.min(currentIndex + itemsPerRow, totalItems - 1);\n      } else {\n        newIndex = Math.min(currentIndex + 1, totalItems - 1);\n      }\n      break;\n\n    case 'up':\n      if (state.autoFlow === 'row') {\n        newIndex = Math.max(currentIndex - itemsPerRow, 0);\n      } else {\n        newIndex = Math.max(currentIndex - 1, 0);\n      }\n      break;\n  }\n\n  if (newIndex !== currentIndex) {\n    const newItems = moveItemInArray(state.items, currentIndex, newIndex);\n    const draggedItem = state.presentedItems.find(item => item.id === state.draggedItemId);\n    callbacks.updateLiveRegion(`Moved ${draggedItem?.id || 'item'} to position ${newIndex + 1}.`);\n    return newItems;\n  }\n\n  return state.items;\n};\n\n/**\n * Handles drag start event\n */\nexport const handleDragStart = (\n  event: DragEvent,\n  state: DragState\n): { draggedElement: HTMLElement | null; draggedItemId: string | undefined } => {\n  if (state.disabled) {\n    return { draggedElement: null, draggedItemId: undefined };\n  }\n\n  const draggedElement = getGridItem(event.target as HTMLElement, state.items);\n  return {\n    draggedElement,\n    draggedItemId: draggedElement?.id,\n  };\n};\n\n/**\n * Handles drag over event\n */\nexport const handleDragOver = (event: DragEvent): void => {\n  event.preventDefault();\n  event.stopPropagation();\n};\n\n/**\n * Handles drop event\n */\nexport const handleDrop = (event: DragEvent, state: DragState, callbacks: DragCallbacks): Item[] => {\n  event.stopPropagation();\n  event.preventDefault();\n\n  if (event.target === null || !state.draggable || state.draggedElement === null) {\n    return state.items;\n  }\n\n  const target = getGridItem(event.target as HTMLElement, state.items);\n  if (target === null) {\n    return state.items;\n  }\n\n  const dropX = event.clientX;\n  const dropY = event.clientY;\n\n  const droppedOnElement = document.elementFromPoint(dropX, dropY);\n  if (droppedOnElement) {\n    const items = state.items;\n    const dropOnId = target.id;\n    const draggedId = state.draggedElement.id;\n    let draggedIndex = items.findIndex(i => i.id === draggedId);\n\n    if (draggedIndex !== -1) {\n      const newItems = [...items];\n      const dropOnIndex = items.findIndex(i => i.id === dropOnId);\n\n      // insert the dragged item before the dropped item\n      newItems.splice(draggedIndex, 1);\n      if (dropOnIndex !== -1) {\n        draggedIndex = items.findIndex(i => i.id === draggedId);\n        newItems.splice(dropOnIndex, 0, items[draggedIndex]);\n\n        callbacks.dispatchReorderEvent(draggedIndex, dropOnIndex, newItems);\n        return newItems;\n      }\n    }\n  }\n\n  return state.items;\n};\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { Item } from '../selectable-grid.js';\n\nexport type KeyboardNavigationState = {\n  focusedItemId: string | undefined;\n  presentedItems: Item[];\n  itemsInSection: number;\n  autoFlow: 'row' | 'column';\n  disabled: boolean;\n  draggedItemId: string | undefined;\n};\n\nexport type KeyboardCallbacks = {\n  setFocusedItem: (index: number) => void;\n  enterDragMode: () => void;\n  handleKeyboardDragMove: (direction: 'up' | 'down' | 'left' | 'right') => void;\n  exitDragMode: (options: { dropped: boolean }) => void;\n  handleItemSelected: (event: Event) => void;\n};\n\n/**\n * Calculates the new index based on navigation direction and grid layout\n */\nconst calculateNewIndex = ({\n  currentIndex,\n  direction,\n  autoFlow,\n  itemsPerRow,\n  totalItems,\n}: {\n  currentIndex: number;\n  direction: 'right' | 'left' | 'down' | 'up';\n  autoFlow: 'row' | 'column';\n  itemsPerRow: number;\n  totalItems: number;\n}): number => {\n  switch (direction) {\n    case 'right':\n      if (autoFlow === 'row') {\n        return (currentIndex + 1) % totalItems;\n      } else {\n        return Math.min(currentIndex + itemsPerRow, totalItems - 1);\n      }\n\n    case 'left':\n      if (autoFlow === 'row') {\n        return currentIndex === 0 ? totalItems - 1 : currentIndex - 1;\n      } else {\n        return Math.max(currentIndex - itemsPerRow, 0);\n      }\n\n    case 'down':\n      if (autoFlow === 'row') {\n        return Math.min(currentIndex + itemsPerRow, totalItems - 1);\n      } else {\n        return (currentIndex + 1) % totalItems;\n      }\n\n    case 'up':\n      if (autoFlow === 'row') {\n        return Math.max(currentIndex - itemsPerRow, 0);\n      } else {\n        return currentIndex === 0 ? totalItems - 1 : currentIndex - 1;\n      }\n\n    default:\n      return currentIndex;\n  }\n};\n\n/**\n * Handles keyboard events when in drag mode\n */\nconst handleDragModeKeys = (event: KeyboardEvent, callbacks: KeyboardCallbacks): void => {\n  switch (event.key) {\n    case 'ArrowRight':\n      event.preventDefault();\n      callbacks.handleKeyboardDragMove('right');\n      break;\n    case 'ArrowLeft':\n      event.preventDefault();\n      callbacks.handleKeyboardDragMove('left');\n      break;\n    case 'ArrowDown':\n      event.preventDefault();\n      callbacks.handleKeyboardDragMove('down');\n      break;\n    case 'ArrowUp':\n      event.preventDefault();\n      callbacks.handleKeyboardDragMove('up');\n      break;\n    case 'Enter':\n      event.preventDefault();\n      callbacks.exitDragMode({ dropped: true });\n      break;\n    case 'Escape':\n      event.preventDefault();\n      callbacks.exitDragMode({ dropped: false });\n      break;\n  }\n};\n\n/**\n * Calculates the focused item index from the current state\n */\nexport const getFocusedItemIndex = (state: KeyboardNavigationState): number => {\n  if (state.focusedItemId === undefined) return -1;\n  return state.presentedItems.findIndex(item => item.id === state.focusedItemId);\n};\n\n/**\n * Handles grid-level keyboard navigation when not in drag mode\n */\nexport const handleGridKeyDown = (event: KeyboardEvent, state: KeyboardNavigationState, callbacks: KeyboardCallbacks): void => {\n  if (state.disabled || state.presentedItems.length === 0 || state.draggedItemId) return;\n\n  const currentIndex = getFocusedItemIndex(state);\n  const itemsPerRow = state.itemsInSection;\n  const totalItems = state.presentedItems.length;\n\n  let newIndex = currentIndex;\n  let handled = false;\n\n  switch (event.key) {\n    case 'ArrowRight':\n      newIndex = calculateNewIndex({\n        currentIndex,\n        direction: 'right',\n        autoFlow: state.autoFlow,\n        itemsPerRow,\n        totalItems,\n      });\n      handled = true;\n      break;\n\n    case 'ArrowLeft':\n      newIndex = calculateNewIndex({\n        currentIndex,\n        direction: 'left',\n        autoFlow: state.autoFlow,\n        itemsPerRow,\n        totalItems,\n      });\n      handled = true;\n      break;\n\n    case 'ArrowDown':\n      newIndex = calculateNewIndex({\n        currentIndex,\n        direction: 'down',\n        autoFlow: state.autoFlow,\n        itemsPerRow,\n        totalItems,\n      });\n      handled = true;\n      break;\n\n    case 'ArrowUp':\n      newIndex = calculateNewIndex({\n        currentIndex,\n        direction: 'up',\n        autoFlow: state.autoFlow,\n        itemsPerRow,\n        totalItems,\n      });\n      handled = true;\n      break;\n\n    case 'Home':\n      newIndex = 0;\n      handled = true;\n      break;\n\n    case 'End':\n      newIndex = totalItems - 1;\n      handled = true;\n      break;\n  }\n\n  if (handled) {\n    event.preventDefault();\n    event.stopPropagation();\n    callbacks.setFocusedItem(newIndex);\n  }\n};\n\n/**\n * Handles item-level keyboard events including drag mode keys\n */\nexport const handleItemKeyDown = (event: KeyboardEvent, state: KeyboardNavigationState, callbacks: KeyboardCallbacks): void => {\n  if (state.disabled) return;\n\n  // Handle drag mode keys directly at the item level\n  if (state.draggedItemId) {\n    handleDragModeKeys(event, callbacks);\n    return;\n  }\n\n  // Handle navigation and selection keys when not in drag mode\n  if (event.key === 'F2' || (event.key === 'M' && (event.ctrlKey || event.metaKey))) {\n    event.preventDefault();\n    callbacks.enterDragMode();\n    return;\n  }\n\n  // Handle selection keys when not in drag mode\n  if (event.key === 'Enter' || event.key === ' ') {\n    event.preventDefault();\n    callbacks.handleItemSelected(event);\n  }\n};\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { Item, SelectableGridProps } from '../selectable-grid.js';\n\nexport type SelectionState = {\n  items: Item[];\n  selected: Item[];\n  selectionVariant: 'none' | 'single' | 'multiple';\n  requireSelection: boolean;\n  disabled: boolean;\n};\n\nexport const getSelectedItems = (selectionVariant: SelectableGridProps['selectionVariant'], selected: Item[]) => {\n  if (selectionVariant === 'single') {\n    if (selected.length > 1) {\n      return [selected[selected.length - 1]];\n    }\n  } else if (selectionVariant === 'none') {\n    return [];\n  } else if (selectionVariant === 'multiple') {\n    return selected;\n  }\n  return selected;\n};\n\n/**\n * Handles item selection logic based on selection variant and current state\n */\nexport const handleItemSelection = (targetItem: Item, state: SelectionState): Item[] => {\n  if (state.disabled) {\n    return state.selected;\n  }\n\n  let newSelected = state.selected;\n  const existed = newSelected.find(item => item.id === targetItem.id);\n\n  if (!existed) {\n    // Add the item to selection\n    newSelected = [...newSelected, targetItem];\n  } else {\n    // Only allow deselection if:\n    // 1. requireSelection is false, OR\n    // 2. selectionVariant is not 'single' even with requireSelection true\n    const canDeselect = !state.requireSelection || state.selectionVariant !== 'single';\n    if (canDeselect) {\n      newSelected = newSelected.filter(item => item.id !== targetItem.id);\n    }\n  }\n\n  return getSelectedItems(state.selectionVariant, newSelected);\n};\n\n/**\n * Ensures selection conforms to the current selection variant\n */\nexport const normalizeSelection = (selected: Item[], selectionVariant: 'none' | 'single' | 'multiple'): Item[] => {\n  return getSelectedItems(selectionVariant, selected);\n};\n\n/**\n * Checks if an item is currently selected\n */\nexport const isItemSelected = (item: Item, selected: Item[]): boolean => {\n  return selected.find(i => i.id === item.id) !== undefined;\n};\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { TemplateResult, html } from 'lit';\nimport { classMap } from 'lit/directives/class-map.js';\nimport { ifDefined } from 'lit/directives/if-defined.js';\nimport { when } from 'lit/directives/when.js';\n\nimport '../grid/index.js';\nimport '@spectrum-web-components/field-label/sp-field-label.js';\nimport '@spectrum-web-components/icon/sp-icon.js';\nimport '@spectrum-web-components/icons-workflow/icons/sp-icon-checkmark.js';\n\nimport { Unlocalized } from '../../services/locale-service/locale-service.js';\nimport { toCssUnitString } from '../internal/css-functions.js';\n\nexport { styles } from './selectable-grid.css.js';\n\nexport const unlocalized = {\n  dragInstructions: 'Press F2 or Control+M to enter drag mode. Use arrow keys to move, Enter to drop, Escape to cancel.',\n} as const satisfies Unlocalized;\n\nexport type SelectableGridRenderItemProps = {\n  id: string;\n  isSelected: boolean;\n  isFocused: boolean;\n};\n\nexport type RenderItemFunction = (props: SelectableGridRenderItemProps) => TemplateResult;\n\nexport type RenderArgs = {\n  // Grid properties\n  title: string;\n  items: Array<{ id: string; render: RenderItemFunction; ariaLabel?: string }>;\n  itemsInSection: number;\n  padding?: number;\n  gap?: number;\n  rowGap?: number;\n  columnGap?: number;\n  autoFlow: 'row' | 'column';\n\n  // Selection state\n  selected: Array<{ id: string }>;\n  selectionVariant: 'none' | 'single' | 'multiple';\n  showSelectIcon: boolean;\n\n  // Interaction state\n  focusedItemId: string | undefined;\n  draggedItemId: string | undefined;\n  disabled: boolean;\n  draggable: boolean;\n\n  // Accessibility\n  ariaLabel: string | null;\n  ariaDescribedby?: string;\n  liveRegionMessage: string;\n\n  // IDs\n  titleId: string;\n  gridId: string;\n  dragInstructionsId: string;\n\n  // Event handlers\n  onItemSelected: (event: Event) => void;\n  onItemKeyDown: (event: KeyboardEvent) => void;\n  onItemFocus: (itemId: string) => void;\n  onGridKeyDown: (event: KeyboardEvent) => void;\n  onDragStart: (event: DragEvent) => void;\n  onDrop: (event: DragEvent) => void;\n  onDragOver: (event: DragEvent) => void;\n};\n\nconst renderItem = (item: { id: string; render: RenderItemFunction }, args: RenderArgs): TemplateResult => {\n  const props: SelectableGridRenderItemProps = {\n    id: item.id,\n    isSelected: args.selected.find(i => i.id === item.id) !== undefined,\n    isFocused: args.focusedItemId === item.id,\n  };\n\n  const isFocused = args.focusedItemId === item.id;\n  const itemIndex = args.items.findIndex(i => i.id === item.id);\n  const rowIndex = Math.floor(itemIndex / args.itemsInSection) + 1;\n  const colIndex = (itemIndex % args.itemsInSection) + 1;\n  const isDraggedItem = args.draggedItemId === item.id;\n\n  const handleKeyDown = (event: KeyboardEvent) => {\n    args.onItemKeyDown(event);\n  };\n\n  const handleFocus = () => {\n    args.onItemFocus(item.id);\n  };\n\n  return html`\n    <div\n      id=${item.id}\n      class=${classMap({\n        'selectable-grid-item': true,\n        'selectable-selected-grid-item': props.isSelected,\n        'selectable-grid-item-disabled': args.disabled,\n        'selectable-grid-item-dragged': isDraggedItem,\n      })}\n      draggable=${args.draggable && !args.disabled}\n      @click=${args.onItemSelected}\n      @keydown=${handleKeyDown}\n      @focus=${handleFocus}\n      @dragstart=${args.onDragStart}\n      @drop=${args.onDrop}\n      @dragover=${args.onDragOver}\n      tabindex=${args.disabled ? -1 : isFocused ? 0 : -1}\n      role=\"gridcell\"\n      aria-selected=${args.selectionVariant === 'none' ? 'false' : (props.isSelected.toString() as 'true' | 'false')}\n      aria-rowindex=${rowIndex}\n      aria-colindex=${colIndex}\n      aria-disabled=${args.disabled.toString() as 'true' | 'false'}\n      aria-grabbed=${isDraggedItem.toString() as 'true' | 'false'}\n      aria-describedby=${ifDefined(args.draggable ? args.dragInstructionsId : undefined)}\n      data-testid=${`firefly-selectable-grid-item-${item.id.replace(/\\s+/g, '-')}`}>\n      ${when(\n        props.isSelected && args.showSelectIcon,\n        () =>\n          html`<sp-icon size=\"s\" class=\"selectable-grid-item-icon\" data-testid=\"checkmark-icon\">\n            <slot name=\"selectIcon\"><sp-icon-checkmark></sp-icon-checkmark></slot>\n          </sp-icon>`\n      )}\n      ${item.render(props)}\n    </div>\n  `;\n};\n\nexport const render = (args: RenderArgs): TemplateResult => {\n  const isMultiSelectable = args.selectionVariant === 'multiple';\n  const isReadonly = args.selectionVariant === 'none' || args.disabled;\n  const gridLabel = args.ariaLabel || args.title || 'Selectable grid';\n  const labelledBy = args.title ? args.titleId : undefined;\n\n  return html`\n    <div class=\"selectable-grid\">\n      ${when(\n        args.title,\n        () => html`<sp-field-label id=${args.titleId} class=\"grid-title\" aria-hidden=\"false\">${args.title}</sp-field-label>`\n      )}\n\n      <!-- Live region for drag and drop announcements -->\n      <div aria-live=\"polite\" aria-atomic=\"true\" class=\"sr-only\">${args.liveRegionMessage}</div>\n\n      <!-- Drag instructions (hidden but referenced by aria-describedby) -->\n      ${when(args.draggable, () => html` <div id=${args.dragInstructionsId} class=\"sr-only\">${unlocalized.dragInstructions}</div> `)}\n\n      <div class=\"selectable-grid-content\">\n        <firefly-grid\n          id=${args.gridId}\n          itemsInSection=${args.itemsInSection || 3}\n          padding=${args.padding ? toCssUnitString(args.padding) : 0}\n          rowGap=${args.rowGap ? toCssUnitString(args.rowGap) : toCssUnitString(args.gap || 20)}\n          columnGap=${args.columnGap ? toCssUnitString(args.columnGap) : toCssUnitString(args.gap || 20)}\n          autoFlow=${args.autoFlow}\n          role=\"grid\"\n          aria-label=${gridLabel}\n          aria-labelledby=${ifDefined(labelledBy)}\n          aria-multiselectable=${isMultiSelectable.toString() as 'true' | 'false'}\n          aria-readonly=${isReadonly.toString() as 'true' | 'false'}\n          aria-disabled=${args.disabled.toString() as 'true' | 'false'}\n          aria-activedescendant=${ifDefined(args.focusedItemId)}\n          aria-describedby=${ifDefined(args.ariaDescribedby)}\n          tabindex=${args.disabled ? -1 : 0}\n          @keydown=${args.onGridKeyDown}>\n          ${args.items.map(item => renderItem(item, args))}\n        </firefly-grid>\n      </div>\n    </div>\n  `;\n};\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { LitElement, html } from 'lit';\nimport { customElement, property } from 'lit/decorators.js';\nimport { styleMap } from 'lit/directives/style-map.js';\n\nimport { toCssUnitString } from '../internal/css-functions.js';\nimport { CssUnit } from '../types.js';\n\ntype AutoFlow = 'row' | 'column';\n\nexport type GridProps = {\n  inline?: boolean;\n  itemsInSection: number;\n  autoFlow?: AutoFlow;\n  rowGap?: CssUnit;\n  columnGap?: CssUnit;\n  padding?: CssUnit;\n};\n\nexport const tagName = 'firefly-grid';\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    [tagName]: Grid;\n  }\n}\n\n/**\n * @description An element to assist in the creation of a fixed layout grid\n * @element firefly-grid\n *\n * @property {boolean} inline - Boolean for inline grid vs block grid\n * @property {number} itemsInSection - Maximum number of items per row/column based on auto flow\n * @property {'row' | 'column'} autoFlow - Direction in which the grid should flow\n * @property {CssUnit} rowGap - Gap between rows in the grid\n * @property {CssUnit} columnGap - Gap between columns in the grid\n *\n * @slot - Default slot for grid items\n */\n@customElement(tagName)\nexport class Grid extends LitElement implements GridProps {\n  @property({ type: Boolean }) inline = false;\n\n  @property({ type: Number }) itemsInSection = 2;\n\n  @property({ type: String }) autoFlow: 'row' | 'column' = 'column';\n\n  @property({ type: String || Number }) rowGap: CssUnit = 10;\n\n  @property({ type: String || Number }) columnGap: CssUnit = 10;\n\n  @property({ type: String || Number }) padding: CssUnit = 0;\n\n  render() {\n    const styles = {\n      display: this.inline ? 'inline-grid' : 'grid',\n      gridRowGap: toCssUnitString(this.rowGap),\n      gridColumnGap: toCssUnitString(this.columnGap),\n      [`gridTemplate${this.autoFlow === 'row' ? 'Columns' : 'Rows'}`]: `repeat(${this.itemsInSection}, 1fr)`,\n      gridAutoFlow: this.autoFlow,\n      padding: toCssUnitString(this.padding),\n    };\n\n    return html`<div style=\"${styleMap(styles)}\"><slot></slot></div>`;\n  }\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { css } from 'lit';\n\nexport const styles = css`\n  .grid-title {\n    display: flex;\n    margin: var(--firefly-selectable-grid-title-margin, 0 0 var(--spectrum-spacing-200) 0);\n    font-weight: var(--firefly-selectable-grid-title-font-weight, bold);\n    font-size: var(--firefly-selectable-grid-title-font-size, var(--spectrum-font-size-100));\n  }\n\n  .selectable-grid {\n    display: block;\n    padding: var(--firefly-selectable-grid-padding, var(--spectrum-spacing-200));\n    width: 100%;\n    height: 100%;\n  }\n\n  .selectable-grid-content {\n    width: 100%;\n    height: 100%;\n    overflow: var(--firefly-selectable-grid-content-overflow, auto);\n    padding: var(--firefly-selectable-grid-content-padding, 2px);\n  }\n\n  .selectable-grid-item {\n    cursor: pointer;\n    border-width: var(--firefly-selectable-grid-selected-border-width, 2px);\n    border-style: var(--firefly-selectable-grid-selected-border-style, solid);\n    border-color: transparent;\n    border-radius: var(--firefly-selectable-grid-selected-border-radius, var(--spectrum-spacing-100));\n    position: relative;\n  }\n\n  .selectable-grid-item.selectable-selected-grid-item {\n    border-color: var(--firefly-selectable-grid-selected-border-color, var(--spectrum-gray-700));\n  }\n\n  .selectable-grid-item-icon {\n    position: absolute;\n    z-index: 1;\n\n    /* stylelint-disable declaration-block-no-redundant-longhand-properties */\n    top: var(--firefly-selectable-grid-item-icon-top, var(--spectrum-spacing-200));\n    right: var(--firefly-selectable-grid-item-icon-right, var(--spectrum-spacing-200));\n    bottom: var(--firefly-selectable-grid-item-icon-bottom, auto);\n    left: var(--firefly-selectable-grid-item-icon-left, auto);\n    /* stylelint-enable declaration-block-no-redundant-longhand-properties */\n\n    color: var(--firefly-selectable-grid-item-icon-color, var(--spectrum-gray-100));\n    background-color: var(--firefly-selectable-grid-item-icon-background-color, var(--spectrum-gray-800));\n    border-radius: var(--firefly-selectable-grid-item-icon-border-radius, var(--spectrum-spacing-75));\n  }\n\n  .selectable-grid-item:focus-visible {\n    outline: 2px solid var(--spectrum-focus-indicator-color, var(--spectrum-blue-600));\n    outline-offset: 2px;\n    border-radius: var(--firefly-selectable-grid-selected-border-radius, var(--spectrum-spacing-100));\n  }\n\n  .selectable-grid-item-disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n    pointer-events: none;\n  }\n\n  .selectable-grid-item-dragged {\n    opacity: 0.7;\n    transform: scale(0.98);\n    box-shadow: 0 4px 8px rgb(0 0 0 / 10%);\n  }\n\n  .sr-only {\n    position: absolute;\n    width: 1px;\n    height: 1px;\n    padding: 0;\n    margin: -1px;\n    overflow: hidden;\n    clip: rect(0, 0, 0, 0);\n    white-space: nowrap;\n    border: 0;\n  }\n`;\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport { ReorderEvent, SelectionChangeEvent } from './events.js';\nimport * as accessibilityFunctions from './functions/accessibility-functions.js';\nimport * as dragFunctions from './functions/drag-functions.js';\nimport * as keyboardFunctions from './functions/keyboard-functions.js';\nimport * as selectionFunctions from './functions/selection-functions.js';\nimport * as presentation from './selectable-grid-presentation.js';\nimport { LitElement, PropertyValues, TemplateResult, html } from 'lit';\nimport { customElement, property, state } from 'lit/decorators.js';\n\nimport { commonStyles } from '../common/styles.css.js';\n\nexport const tagName = 'firefly-selectable-grid';\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    [tagName]: SelectableGrid;\n  }\n}\n\nexport type SelectableGridRenderItemProps = {\n  id: string;\n  isSelected: boolean;\n  isFocused: boolean;\n};\n\n/** Represents an item in the selectable grid.\n * @property {string} id - The id of the item. This id is REQUIRED to be unique. If not provided, the item will not be selectable.\n * @property {string} ariaLabel - Optional accessible label for screen readers. If not provided, the item content should be self-describing.\n * @method render - The method to render the item.\n * @param {SelectableGridRenderItemProps} props - The properties to render the item.\n * @returns {TemplateResult} - The template result of the item.\n */\nexport class Item {\n  id = '';\n\n  ariaLabel?: string;\n\n  render(_props: SelectableGridRenderItemProps): TemplateResult {\n    return html`<div></div>`;\n  }\n}\n\nexport type SelectableGridProps = {\n  title: string;\n  items: Item[];\n  selected: Item[];\n  selectionVariant: 'none' | 'single' | 'multiple';\n  gap?: number;\n  rowGap?: number;\n  columnGap?: number;\n  requireSelection?: boolean;\n  maxShowItems?: number;\n  itemsInSection: number;\n  draggable?: boolean;\n  autoFlow?: 'row' | 'column';\n  showSelectIcon?: boolean;\n  disabled?: boolean;\n  'aria-label'?: string;\n  'aria-describedby'?: string;\n};\n\n/**\n * @description `firefly-selectable-grid` is a custom web component that represents a selectable grid. This component allows for selecting and dragging items within a grid layout.\n *\n * @element firefly-selectable-grid\n *\n * @cssprop --firefly-selectable-grid-padding - The padding of the grid.\n * @cssprop --firefly-selectable-grid-title-margin - The margin of the grid title.\n * @cssprop --firefly-selectable-grid-title-font-weight - The font weight of the grid title.\n * @cssprop --firefly-selectable-grid-title-font-size - The font size of the grid title.\n * @cssprop --firefly-selectable-grid-selected-border-width - The border width of the selected grid item.\n * @cssprop --firefly-selectable-grid-selected-border-style - The border style of the selected grid item.\n * @cssprop --firefly-selectable-grid-selected-border-color - The border color of the selected grid item.\n * @cssprop --firefly-selectable-grid-selected-border-radius - The border radius of the selected grid item.\n * @cssprop --firefly-selectable-grid-item-icon-top - The top position of the selected grid item icon.\n * @cssprop --firefly-selectable-grid-item-icon-right - The right position of the selected grid item icon.\n * @cssprop --firefly-selectable-grid-item-icon-left - The left position of the selected grid item icon.\n * @cssprop --firefly-selectable-grid-item-icon-bottom - The bottom position of the selected grid item icon.\n * @cssprop --firefly-selectable-grid-item-icon-color - The color of the selected grid item icon.\n * @cssprop --firefly-selectable-grid-item-icon-background-color - The background color of the selected grid item icon.\n * @cssprop --firefly-selectable-grid-item-icon-border-radius - The border radius of the selected grid item icon.\n *\n * @property {string} title - The title of the grid.\n * @property {Item[]} items - The list of items to be displayed in the grid.\n * @property {Item[]} selected - The list of selected items.\n * @property {'none' | 'single' | 'multiple'} selectionVariant - The selection variant for the grid. Can be 'none', 'single', or 'multiple'.\n * @property {boolean} draggable - Indicates if the items in the grid are draggable.\n * @property {number} gap - The gap between grid items.\n * @property {number} rowGap - The gap between grid items in the row direction.\n * @property {number} columnGap - The gap between grid items in the column direction.\n * @property {boolean} requireSelection - When true, Atleast one item should be selected.This will work only when selectionVariant is 'single'.\n * @property {number} [maxShowItems] - The maximum number of items to show in the grid.\n * @property {number} itemsInSection - The maximum number of items per row/column in the grid.\n * @property {'row' | 'column'} autoFlow - The direction of grid autoFlow\n * @property {boolean} showSelectIcon - Indicates if the selected state should be shown.\n * @property {boolean} disabled - When true, prevents selection and drag operations on the grid items.\n *\n * @fires selectionChange - Fired when an item is selected or unselected.\n * @fires reorder - Fired when the items in the grid are reordered.\n *\n * @example\n * <firefly-selectable-grid\n *  title=\"My Grid\"\n *  .items=${items}\n *  .selected=${selected}\n *  .selectionVariant=\"multiple\"\n *  .gap=20\n *  .rowGap=10\n *  .columnGap=10\n *  .maxShowItems=10\n *  itemsInSection=3\n *  autoFlow=\"row\"\n *  .draggable=true\n *  .showSelectIcon=true\n *  @selectionChange=${selectChangeHandler}\n *  @reorder=${reorderHandler}>\n * </firefly-selectable-grid>\n */\n@customElement(tagName)\nexport class SelectableGrid extends LitElement implements SelectableGridProps {\n  static styles = [commonStyles, presentation.styles];\n\n  @property({ type: String }) title = '';\n\n  @property({ type: Array }) items: Item[] = [];\n\n  @property({ type: Array }) selected: Item[] = [];\n\n  @property({ type: Boolean }) draggable = false;\n\n  @property({ type: Number }) gap?: number = 20;\n\n  @property({ type: Number }) rowGap?: number;\n\n  @property({ type: Number }) columnGap?: number;\n\n  @property({ type: Number }) padding?: number;\n\n  @property({ type: Boolean }) requireSelection = false;\n\n  @property({ type: Number }) maxShowItems?: number;\n\n  @property({ type: Number }) itemsInSection = 3;\n\n  @property({ type: String }) autoFlow: 'row' | 'column' = 'row';\n\n  @property({ type: String }) selectionVariant: 'none' | 'single' | 'multiple' = 'multiple';\n\n  @property({ type: Boolean }) showSelectIcon = false;\n\n  @property({ type: Boolean }) disabled = false;\n\n  @property({ type: String }) ariaLabel: string | null = null;\n\n  @property({ type: String }) ariaDescribedby?: string;\n\n  @state() private _focusedItemId: string | undefined = undefined;\n\n  @state() private _draggedItemId: string | undefined = undefined;\n\n  @state() private _draggedItemOriginalIndex = -1;\n\n  @state() private _liveRegionMessage = '';\n\n  private _presentedItems: Item[] = [];\n\n  private _draggedElement: HTMLElement | null = null;\n\n  private _getAvailableMaxShowItems = (): number => {\n    return this.maxShowItems || this.items.length;\n  };\n\n  // State preparation methods for function modules\n  private _getKeyboardState = (): keyboardFunctions.KeyboardNavigationState => ({\n    focusedItemId: this._focusedItemId,\n    presentedItems: this._presentedItems,\n    itemsInSection: this.itemsInSection,\n    autoFlow: this.autoFlow,\n    disabled: this.disabled,\n    draggedItemId: this._draggedItemId,\n  });\n\n  private _getDragState = (): dragFunctions.DragState => ({\n    draggedItemId: this._draggedItemId,\n    draggedItemOriginalIndex: this._draggedItemOriginalIndex,\n    draggedElement: this._draggedElement,\n    presentedItems: this._presentedItems,\n    items: this.items,\n    itemsInSection: this.itemsInSection,\n    autoFlow: this.autoFlow,\n    disabled: this.disabled,\n    draggable: this.draggable,\n  });\n\n  private _getSelectionState = (): selectionFunctions.SelectionState => ({\n    items: this.items,\n    selected: this.selected,\n    selectionVariant: this.selectionVariant,\n    requireSelection: this.requireSelection,\n    disabled: this.disabled,\n  });\n\n  private _getKeyboardCallbacks = (): keyboardFunctions.KeyboardCallbacks => ({\n    setFocusedItem: this._setFocusedItem,\n    enterDragMode: this._enterDragMode,\n    handleKeyboardDragMove: this._handleKeyboardDragMove,\n    exitDragMode: this._exitDragMode,\n    handleItemSelected: this._handleItemSelected,\n  });\n\n  private _getDragCallbacks = (): dragFunctions.DragCallbacks => ({\n    updateLiveRegion: this._updateLiveRegion,\n    dispatchReorderEvent: this._dispatchReorderEvent,\n    updateItems: (items: Item[]) => {\n      this.items = items;\n    },\n  });\n\n  // Core functionality using function modules\n  private _setFocusedItem = (index: number): void => {\n    if (index >= 0 && index < this._presentedItems.length) {\n      this._focusedItemId = this._presentedItems[index].id;\n      accessibilityFunctions.focusItem(this._focusedItemId, this.shadowRoot, this.updateComplete);\n    }\n  };\n\n  private _updateLiveRegion = (message: string): void => {\n    accessibilityFunctions.updateLiveRegion(message, msg => {\n      this._liveRegionMessage = msg;\n    });\n  };\n\n  private _dispatchReorderEvent = (originalIndex: number, newIndex: number, items: Item[]): void => {\n    this.dispatchEvent(new ReorderEvent(originalIndex, newIndex, items));\n  };\n\n  private _enterDragMode = (): void => {\n    const result = dragFunctions.enterDragMode(this._getDragState(), this._focusedItemId, this._getDragCallbacks());\n    this._draggedItemId = result.draggedItemId;\n    this._draggedItemOriginalIndex = result.draggedItemOriginalIndex;\n  };\n\n  private _exitDragMode = (options: { dropped: boolean }): void => {\n    const result = dragFunctions.exitDragMode(this._getDragState(), options, this._getDragCallbacks());\n    this._draggedItemId = result.draggedItemId;\n    this._draggedItemOriginalIndex = result.draggedItemOriginalIndex;\n  };\n\n  private _handleKeyboardDragMove = (direction: 'up' | 'down' | 'left' | 'right'): void => {\n    const newItems = dragFunctions.handleKeyboardDragMove(this._getDragState(), direction, this._getDragCallbacks());\n    this.items = newItems;\n  };\n\n  private _getGridItem = (element: HTMLElement): HTMLElement | null => {\n    return dragFunctions.getGridItem(element, this.items);\n  };\n\n  // Event handlers\n  private _handleGridKeyDown = (event: KeyboardEvent): void => {\n    keyboardFunctions.handleGridKeyDown(event, this._getKeyboardState(), this._getKeyboardCallbacks());\n  };\n\n  private _handleItemKeyDown = (event: KeyboardEvent): void => {\n    keyboardFunctions.handleItemKeyDown(event, this._getKeyboardState(), this._getKeyboardCallbacks());\n  };\n\n  private _handleItemFocus = (itemId: string): void => {\n    this._focusedItemId = itemId;\n  };\n\n  private _handleItemSelected = (event: Event): void => {\n    if (this.disabled) return;\n\n    event.stopPropagation();\n    event.preventDefault();\n\n    if (event.target === null) return;\n\n    const target = this._getGridItem(event.target as HTMLElement);\n    if (target === null) return;\n\n    const targetItem = this.items.find(item => item.id === target.id);\n    if (!targetItem) return;\n\n    const newSelected = selectionFunctions.handleItemSelection(targetItem, this._getSelectionState());\n    this.selected = newSelected;\n    this.dispatchEvent(new SelectionChangeEvent(this.selected));\n  };\n\n  private _handleDragStart = (event: DragEvent): void => {\n    const result = dragFunctions.handleDragStart(event, this._getDragState());\n    this._draggedElement = result.draggedElement;\n    this._draggedItemId = result.draggedItemId;\n  };\n\n  private _handleDragOver = (event: DragEvent): void => {\n    dragFunctions.handleDragOver(event);\n  };\n\n  private _handleDrop = (event: DragEvent): void => {\n    const newItems = dragFunctions.handleDrop(event, this._getDragState(), this._getDragCallbacks());\n    this.items = newItems;\n    this._draggedItemId = undefined;\n    this._draggedElement = null;\n  };\n\n  // Lifecycle methods\n  protected override update(changes: PropertyValues<this>): void {\n    if (changes.has('items') || changes.has('maxShowItems')) {\n      const items = this.items.slice(0, this._getAvailableMaxShowItems());\n      this._presentedItems = items;\n\n      // Unset focused item if current focused item is no longer available\n      if (this._focusedItemId && !this._presentedItems.find(item => item.id === this._focusedItemId)) {\n        this._focusedItemId = undefined;\n      }\n    }\n\n    super.update(changes);\n  }\n\n  updated(changedProperties: PropertyValues): void {\n    if (changedProperties.has('selectionVariant')) {\n      this.selected = selectionFunctions.normalizeSelection(this.selected, this.selectionVariant);\n    }\n  }\n\n  render() {\n    const { titleId, gridId, dragInstructionsId } = accessibilityFunctions.generateAccessibilityIds(this.id);\n\n    return presentation.render({\n      // Grid properties\n      title: this.title,\n      items: this._presentedItems,\n      itemsInSection: this.itemsInSection,\n      gap: this.gap,\n      rowGap: this.rowGap,\n      padding: this.padding,\n      columnGap: this.columnGap,\n      autoFlow: this.autoFlow,\n\n      // Selection state\n      selected: this.selected,\n      selectionVariant: this.selectionVariant,\n      showSelectIcon: this.showSelectIcon,\n\n      // Interaction state\n      focusedItemId: this._focusedItemId,\n      draggedItemId: this._draggedItemId,\n      disabled: this.disabled,\n      draggable: this.draggable,\n\n      // Accessibility\n      ariaLabel: this.ariaLabel,\n      ariaDescribedby: this.ariaDescribedby,\n      liveRegionMessage: this._liveRegionMessage,\n\n      // IDs\n      titleId,\n      gridId,\n      dragInstructionsId,\n\n      // Event handlers\n      onItemSelected: this._handleItemSelected,\n      onItemKeyDown: this._handleItemKeyDown,\n      onItemFocus: this._handleItemFocus,\n      onGridKeyDown: this._handleGridKeyDown,\n      onDragStart: this._handleDragStart,\n      onDrop: this._handleDrop,\n      onDragOver: this._handleDragOver,\n    });\n  }\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details\nimport { aspectRatioIcon, getModelIcon, imageIcon } from './icon-functions.js';\nimport { createSettingValueMap, getModelSections, getModelSettingKey, parseAspectRatioItems } from './utils.js';\nimport { html } from 'lit';\n\nimport { localizeBundleDefault } from '../../../services/locale-service/index.js';\n\nimport { getDefaultAspectRatioPriority } from '../../../functions/aspect-ratio-functions.js';\nimport { getModelDisplayName, getSortedModelList } from '../../../functions/model-functions.js';\nimport { StyleItem } from '../../../services/asset-service/asset-service.js';\nimport { LoadedDirectoryItem } from '../../../services/directory-service/directory-functions.js';\nimport { ColligoImageGenerationModels } from '../../../services/image-generation-service/colligo-image-generation-service/colligo-image-generation-service.js';\nimport { ImageGenerationModelId, SupportedSettingsDefault } from '../../../services/image-generation-service/image-generation-service.js';\nimport { Localized } from '../../../services/locale-service/locale-service.js';\nimport { PromptBarAppConfigKey } from '../constants.js';\nimport { unlocalized } from '../prompt-advanced-unlocalized.js';\nimport {\n  AdvancedSettingItem,\n  AdvancedSettingSection,\n  ApplicationConfig,\n  ConfigParserReturnValue,\n  PromptAdvancedSettingValue,\n} from '../prompt-advanced.types.js';\n\n// NOTE: These Partial types are due to the fact that model dictionaries are not exhaustive (by design -- not every user sees every model)\n// However, the Partial type loosens the underlying type to the point of being overly permissive.\n// TODO: Find a better way to type this (i.e. something like ReturnType<typeof availableVideoGenerationModels>)\ntype ImageModelDictionary = Partial<typeof ColligoImageGenerationModels>;\nconst THUMBNAIL_SIZE = 72;\nconst THUMBNAIL_BORDER_RADIUS = 8;\n\n// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details\nexport function parseImageGenerationConfig({\n  modelDictionary = {},\n  effects = [],\n  selectedModelId,\n  isPaidPremium = false,\n  highlightModelPicker = false,\n  hideModelPicker = false,\n  placeholder,\n  localized = localizeBundleDefault(unlocalized),\n  isMobile = false,\n  defaultModelIds = [],\n}: {\n  modelDictionary: ImageModelDictionary;\n  effects?: LoadedDirectoryItem<StyleItem>[];\n  selectedModelId?: ImageGenerationModelId;\n  userInputValues?: Record<string, PromptAdvancedSettingValue>;\n  isPaidPremium?: boolean;\n  highlightModelPicker?: boolean;\n  hideModelPicker?: boolean;\n  localized?: Localized<typeof unlocalized>;\n  isMobile?: boolean;\n  defaultModelIds?: ImageGenerationModelId[];\n  placeholder?: string;\n}): ConfigParserReturnValue {\n  const modelPreviewSuffix = localized?.modelPreviewSuffix;\n  const { all: sortedModels } = getSortedModelList({ modelDict: modelDictionary });\n  const modelIds = sortedModels.map(([id]) => id);\n  const defaultModelId = defaultModelIds.find(id => modelIds.includes(id));\n  const _modelItems: AdvancedSettingItem[] = sortedModels.map(([id, modelConfig]) => {\n    const isPreviewModel = id === 'adobe:firefly:colligo:image5';\n    return {\n      id: getModelSettingKey({ modelId: id, applicationId: PromptBarAppConfigKey.application.IMAGE }),\n      label: getModelDisplayName(modelConfig) + (isPreviewModel ? ` ${modelPreviewSuffix}` : ''),\n      icon: getModelIcon(id),\n      value: { id, ...modelConfig },\n      isDefault: id === defaultModelId,\n    };\n  });\n  const modelItems: AdvancedSettingSection[] = getModelSections({\n    _items: _modelItems,\n    modelDictionary,\n    isPaidPremium,\n    showCrowns: true,\n    localized,\n  });\n\n  const selectedModelConfig = selectedModelId && selectedModelId in modelDictionary ? modelDictionary[selectedModelId] : undefined;\n\n  const outputSizes = selectedModelConfig?.modes?.standard.outputSizes ?? [];\n  const aspectRatioItems = parseAspectRatioItems({\n    sizes: outputSizes,\n    defaultAspectRatioPriority: getDefaultAspectRatioPriority({ isMobile, type: 'image' }),\n    availableAspects: selectedModelConfig?.supportedAspectRatios,\n    sizeMap: selectedModelConfig?.aspectRatioSizeMap,\n  });\n\n  const effectsItems: AdvancedSettingItem[] = effects.map(effect => ({\n    id: `effect-${effect.id}`,\n    label: effect.title ?? '',\n    // allow function to be passed in to handle selection state\n    thumbnail: ({ selected = false }: { selected?: boolean }) => html`\n      <firefly-effect-thumbnail-item\n        .effect=${effect}\n        .selected=${selected}\n        style=\"--firefly-effect-thumbnail-size: ${THUMBNAIL_SIZE}px; --firefly-effect-thumbnail-border-radius: ${THUMBNAIL_BORDER_RADIUS}px;\">\n      </firefly-effect-thumbnail-item>\n    `,\n    value: effect,\n  }));\n\n  const config: ApplicationConfig = {\n    id: PromptBarAppConfigKey.application.IMAGE,\n    label: localized.image,\n    icon: imageIcon,\n    placeholder: placeholder ?? localized.placeholder,\n    settings: [\n      {\n        id: PromptBarAppConfigKey.setting.MODEL,\n        items: modelItems,\n        type: 'picker' as const,\n        highlight: highlightModelPicker,\n        hide: hideModelPicker,\n        label: localized.model,\n      },\n      {\n        id: PromptBarAppConfigKey.setting.ASPECT_RATIO,\n        icon: aspectRatioIcon,\n        items: aspectRatioItems,\n        type: 'picker' as const,\n        label: localized.aspectRatio,\n      },\n      {\n        id: PromptBarAppConfigKey.setting.EFFECTS,\n        icon: html`<firefly-icon-ai-effects></firefly-icon-ai-effects>`,\n        items: effectsItems,\n        type: 'picker-grid-multi' as const,\n        label: localized.theme,\n      },\n    ].filter(setting => {\n      const hasItems = !!setting.items.length;\n      if (!hasItems) return false;\n      if (setting.id === PromptBarAppConfigKey.setting.EFFECTS) {\n        // Matching logic from: https://git.corp.adobe.com/neuralfiltersplatform/firefly-platform/blob/a3d2ffa8a663fa1e91e6abae136b8ea23e6cedce/src/applications/image-generation/dependent-state/show-style-presets.ts#L33\n        return selectedModelConfig?.supportsStylePresets ?? SupportedSettingsDefault.supportsStylePresets;\n      }\n      return true;\n    }),\n  };\n\n  return {\n    config,\n    settingValueMap: createSettingValueMap(config.settings),\n  };\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\n\n/**\n * Provider-specific configuration for special behaviors\n */\nconst PROVIDER_CAPITALIZATION: Record<string, string> = {\n  openai: 'OpenAI',\n};\n\nconst PROVIDER_SORT_CONFIG: Record<string, { suffixBeforeBase: boolean }> = {\n  Adobe: { suffixBeforeBase: true }, // Premium/enhanced variants shown first\n};\n\n/**\n * Capitalizes a provider name, using special cases when needed\n */\nfunction capitalizeProvider(provider: string): string {\n  const lower = provider.toLowerCase();\n  return PROVIDER_CAPITALIZATION[lower] || provider.charAt(0).toUpperCase() + provider.slice(1);\n}\n\n/**\n * Gets the display name for a model, falling back to the name if displayName is not provided.\n */\nexport function getModelDisplayName(modelConfig: { name: string; displayName?: string }): string {\n  return modelConfig.displayName ?? modelConfig.name;\n}\n\n/**\n * Extracts the provider name from a model ID.\n * Handles standard format (provider:firefly:colligo:model) and special video format (video:provider:firefly:colligo:model).\n */\nexport function getProviderFromModelId(modelId: string): string {\n  const parts = modelId.split(':');\n\n  // Special case: video models use second segment as provider\n  if (parts[0] === 'video' && parts.length > 1) {\n    return capitalizeProvider(parts[1]);\n  }\n\n  // Standard case: first segment is provider\n  return capitalizeProvider(parts[0]);\n}\n\n/**\n * Parses a model name to extract base name, version number, and suffix.\n */\nexport function parseModelNameAndVersion(name: string): { baseName: string; version: number | null; suffix: string } {\n  // Match pattern: \"Word(s) Number.Number Word(s)\" or \"Word(s) Number Word(s)\"\n  let versionMatch = name.match(/^(.*?)\\s+(\\d+(?:\\.\\d+)?)\\s*(.*)$/);\n\n  if (versionMatch) {\n    return {\n      baseName: versionMatch[1].trim(),\n      version: parseFloat(versionMatch[2]),\n      suffix: versionMatch[3].trim(),\n    };\n  }\n  versionMatch = name.match(/^([A-Za-z]+)(\\d+(?:\\.\\d+)?)\\s*(.*)$/);\n  if (versionMatch) {\n    return {\n      baseName: versionMatch[1].trim(),\n      version: parseFloat(versionMatch[2]),\n      suffix: versionMatch[3].trim(),\n    };\n  }\n\n  // No version - everything after first word is suffix\n  const firstSpaceIndex = name.indexOf(' ');\n  if (firstSpaceIndex > 0) {\n    const suffix = name.substring(firstSpaceIndex + 1).trim();\n    return {\n      baseName: name.substring(0, firstSpaceIndex),\n      version: null,\n      suffix: suffix,\n    };\n  }\n\n  return { baseName: name, version: null, suffix: '' };\n}\n\ntype ModelEntry<T> = {\n  key: string;\n  model: T;\n  displayName: string;\n};\n\n/**\n * Sorts models by quality and then alphabetically while keeping same-provider models grouped\n *\n * Sorting logic:\n * 1. Sort models with a quality value by quality value. Quality takes highest precedence in sort order,\n *    and those models retain only this ordering (they do not participate in the provider-based sorting below).\n * 2. Group models by provider (extracted from model ID)\n * 3. Sort providers alphabetically by their first model's display name\n * 4. Within each provider, sort by base name (alphabetically)\n * 5. Models without version come before models with version\n * 6. By version (descending - higher versions first)\n * 7. By suffix (configurable per provider via PROVIDER_SORT_CONFIG):\n *    - Providers with suffixBeforeBase=true: suffix models come BEFORE base models\n *    - Default: base models come BEFORE suffix models\n *\n * Provider extraction is automatic from model ID with minimal special cases.\n * New providers will work automatically with sensible defaults.\n */\nexport function getSortedModelList<T extends { name: string; displayName?: string; isThirdParty?: boolean; quality?: number | undefined }>({\n  modelDict,\n}: {\n  modelDict: Record<string, T>;\n}): {\n  all: Array<[string, T]>;\n  firstParty: Array<[string, T]>;\n  thirdParty: Array<[string, T]>;\n} {\n  const modelsByQuality: Array<[string, T]> = [];\n  const modelsByProvider = new Map<string, Array<ModelEntry<T>>>();\n\n  for (const [key, model] of Object.entries(modelDict)) {\n    if (model.quality !== undefined) {\n      modelsByQuality.push([key, model]);\n    } else {\n      // For models WITHOUT a quality, group models by provider and continue with the sorting logic below\n      const provider = getProviderFromModelId(key);\n      const displayName = getModelDisplayName(model);\n      const entry: ModelEntry<T> = { key, model, displayName };\n      const group = modelsByProvider.get(provider);\n      if (group) {\n        group.push(entry);\n      } else {\n        modelsByProvider.set(provider, [entry]);\n      }\n    }\n  }\n\n  // sort the models WITH quality by quality value\n  const sortedQualities = modelsByQuality.sort(([_keyA, modelA], [_keyB, modelB]) => {\n    return modelA.quality! - modelB.quality!;\n  });\n\n  // Sort models WITHOUT a quality within each provider group\n  modelsByProvider.forEach((group, provider) => {\n    group.sort((entryA, entryB) => {\n      const parsedA = parseModelNameAndVersion(entryA.displayName);\n      const parsedB = parseModelNameAndVersion(entryB.displayName);\n\n      // 1. Group by first word of base name (e.g., \"Flux\", \"Veo\", \"Ray\")\n      // This allows \"Flux Kontext\" and \"Flux 1.1\" to be treated as same family\n      // Normalize by stripping version-like patterns (e.g., \".1\", \".2\") from the end\n      // to handle cases like \"FLUX.1\" vs \"FLUX\" where \".1\" is part of the name, not a version\n      const normalizeFirstWord = (word: string): string => {\n        // Strip version-like pattern (dot followed by digits) from the end\n        return word.replace(/\\.\\d+$/, '');\n      };\n      const firstWordA = normalizeFirstWord(parsedA.baseName.split(' ')[0]);\n      const firstWordB = normalizeFirstWord(parsedB.baseName.split(' ')[0]);\n\n      const firstWordCompare = firstWordA.localeCompare(firstWordB);\n      if (firstWordCompare !== 0) return firstWordCompare;\n\n      // 2. Within same first word, models WITHOUT version come BEFORE models WITH version\n      // This naturally prioritizes variants like \"FLUX.1 Kontext [max]\" (no version)\n      // over numbered models like \"FLUX1.1 [pro]\" (has version)\n      if (parsedA.version === null && parsedB.version !== null) return -1;\n      if (parsedA.version !== null && parsedB.version === null) return 1;\n\n      // 3. If both have no version, sort by full name alphabetically\n      if (parsedA.version === null && parsedB.version === null) {\n        return entryA.displayName.localeCompare(entryB.displayName);\n      }\n\n      // 4. If both have versions, sort by version (higher numbers first)\n      if (parsedA.version !== null && parsedB.version !== null) {\n        const versionCompare = parsedB.version - parsedA.version; // Descending order\n        if (versionCompare !== 0) return versionCompare;\n\n        // 5. If versions are equal, sort by suffix\n        // Provider-specific: Adobe shows suffixed variants first (premium/enhanced models)\n        // Default: base models come first\n        const suffixFirst = PROVIDER_SORT_CONFIG[provider]?.suffixBeforeBase ?? false;\n\n        if (!parsedA.suffix && parsedB.suffix) return suffixFirst ? 1 : -1;\n        if (parsedA.suffix && !parsedB.suffix) return suffixFirst ? -1 : 1;\n\n        const suffixCompare = parsedA.suffix.localeCompare(parsedB.suffix);\n        if (suffixCompare !== 0) return suffixCompare;\n      }\n\n      // Fallback to full name comparison\n      return entryA.displayName.localeCompare(entryB.displayName);\n    });\n  });\n\n  // Sort provider groups by their first model's display name (alphabetically)\n  const sortedProviders = Array.from(modelsByProvider.entries()).sort(([_providerA, groupA], [_providerB, groupB]) => {\n    const firstEntryA = groupA[0];\n    const firstEntryB = groupB[0];\n    return firstEntryA.displayName.localeCompare(firstEntryB.displayName);\n  });\n\n  // Flatten the sorted groups back into a single array\n  const entries = sortedProviders.flatMap(([_provider, group]) => group.map(entry => [entry.key, entry.model] as [string, T]));\n\n  const all = [...sortedQualities, ...entries];\n  const firstParty: Array<[string, T]> = [];\n  const thirdParty: Array<[string, T]> = [];\n\n  for (const entry of all) {\n    const [, model] = entry;\n    if (model.isThirdParty) {\n      thirdParty.push(entry);\n    } else {\n      firstParty.push(entry);\n    }\n  }\n\n  return { all, firstParty, thirdParty };\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details\nimport { aspectRatioIcon, getModelIcon, videoIcon } from './icon-functions.js';\nimport { createSettingValueMap, getModelSections, getModelSettingKey, parseAspectRatioItems } from './utils.js';\n\nimport { localizeBundleDefault } from '../../../services/locale-service/index.js';\n\nimport { getDefaultAspectRatioPriority } from '../../../functions/aspect-ratio-functions.js';\nimport { getModelDisplayName, getSortedModelList } from '../../../functions/model-functions.js';\nimport { Localized } from '../../../services/locale-service/locale-service.js';\nimport { VideoGenerationModel, VideoGenerationModelId } from '../../../services/video-generation-service/video-generation-service.js';\nimport { PromptBarAppConfigKey, VIDEO_REFERENCE_FRAMES_END_FRAME_KEY, VIDEO_REFERENCE_FRAMES_FIRST_FRAME_KEY } from '../constants.js';\nimport { unlocalized } from '../prompt-advanced-unlocalized.js';\nimport {\n  AdvancedSettingSection,\n  ConfigParserReturnValue,\n  PromptAdvancedSettingValue,\n  ReferenceFrameValue,\n} from '../prompt-advanced.types.js';\n\ntype ReferenceFrameOption = {\n  disabled: boolean;\n};\n// NOTE: These Partial types are due to the fact that model dictionaries are not exhaustive (by design -- not every user sees every model)\n// However, the Partial type loosens the underlying type to the point of being overly permissive.\n// TODO: Find a better way to type this (i.e. something like ReturnType<typeof availableVideoGenerationModels>)\ntype VideoModelDictionary = Partial<Record<VideoGenerationModelId, VideoGenerationModel>>;\n\n// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details\nexport function parseVideoGenerationConfig({\n  modelDictionary = {},\n  selectedModelId,\n  userInputValues = {},\n  options = {},\n  isPaidPremium = false,\n  highlightModelPicker = false,\n  hideModelPicker = false,\n  localized = localizeBundleDefault(unlocalized),\n  isMobile = false,\n  defaultModelIds = [],\n  placeholder,\n}: {\n  modelDictionary: VideoModelDictionary;\n  selectedModelId?: VideoGenerationModelId;\n  userInputValues?: Record<string, PromptAdvancedSettingValue>;\n  options?: {\n    referenceFrames?: ReferenceFrameOption[];\n  };\n  isPaidPremium?: boolean;\n  highlightModelPicker?: boolean;\n  hideModelPicker?: boolean;\n  localized?: Localized<typeof unlocalized>;\n  isMobile?: boolean;\n  defaultModelIds?: VideoGenerationModelId[];\n  placeholder?: string;\n}): ConfigParserReturnValue {\n  const { all: sortedModels } = getSortedModelList({ modelDict: modelDictionary });\n  const modelIds = sortedModels.map(([id]) => id);\n  const defaultModelId = defaultModelIds.find(id => modelIds.includes(id));\n  const _modelItems = sortedModels.map(([id, modelConfig]) => ({\n    id: getModelSettingKey({ modelId: id, applicationId: PromptBarAppConfigKey.application.VIDEO }),\n    label: getModelDisplayName(modelConfig),\n    icon: getModelIcon(id),\n    value: { id, ...modelConfig },\n    isDefault: id === defaultModelId,\n  }));\n\n  const selectedModelConfig = selectedModelId && selectedModelId in modelDictionary ? modelDictionary[selectedModelId] : undefined;\n  const outputSizes = selectedModelConfig?.modes?.standard.outputSizes ?? [];\n  const aspectRatioItems = parseAspectRatioItems({\n    sizes: outputSizes,\n    defaultAspectRatioPriority: getDefaultAspectRatioPriority({ isMobile, type: 'video' }),\n  });\n\n  const modelItems: AdvancedSettingSection[] = getModelSections({\n    _items: _modelItems,\n    modelDictionary,\n    isPaidPremium,\n    showCrowns: false,\n    localized,\n  });\n\n  const config = {\n    id: PromptBarAppConfigKey.application.VIDEO,\n    label: localized.video,\n    icon: videoIcon,\n    placeholder: placeholder ?? localized.placeholder,\n    settings: [\n      {\n        id: PromptBarAppConfigKey.setting.MODEL,\n        items: modelItems,\n        label: localized.model,\n        type: 'picker' as const,\n        highlight: highlightModelPicker,\n        hide: hideModelPicker,\n      },\n      {\n        id: PromptBarAppConfigKey.setting.ASPECT_RATIO,\n        icon: aspectRatioIcon,\n        items: aspectRatioItems,\n        label: localized.aspectRatio,\n        type: 'picker' as const,\n      },\n      {\n        id: PromptBarAppConfigKey.setting.VIDEO_REFERENCE_FRAMES,\n        items: [\n          {\n            id: VIDEO_REFERENCE_FRAMES_FIRST_FRAME_KEY,\n            label: localized.firstFrame,\n            value: userInputValues[VIDEO_REFERENCE_FRAMES_FIRST_FRAME_KEY] as ReferenceFrameValue | undefined,\n            disabled: !!options.referenceFrames?.[0]?.disabled,\n          },\n          {\n            id: VIDEO_REFERENCE_FRAMES_END_FRAME_KEY,\n            label: localized.endFrame,\n            value: userInputValues[VIDEO_REFERENCE_FRAMES_END_FRAME_KEY] as ReferenceFrameValue | undefined,\n            disabled: !!options.referenceFrames?.[1]?.disabled,\n          },\n        ].filter((_, index) => {\n          return !!options.referenceFrames?.[index];\n        }),\n        label: 'Reference frames',\n        type: 'reference-frames-picker' as const,\n      },\n    ].filter(setting => !!setting.items.length),\n  };\n\n  const firstFrameValue = userInputValues[VIDEO_REFERENCE_FRAMES_FIRST_FRAME_KEY] as File | undefined;\n  const endFrameValue = userInputValues[VIDEO_REFERENCE_FRAMES_END_FRAME_KEY] as File | undefined;\n\n  return {\n    config,\n    settingValueMap: {\n      ...createSettingValueMap(config.settings),\n      [PromptBarAppConfigKey.setting.VIDEO_REFERENCE_FRAMES]: [firstFrameValue, endFrameValue],\n    },\n  };\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details\nimport { soundFxIcon } from './icon-functions.js';\n\nimport { localizeBundleDefault } from '../../../services/locale-service/index.js';\n\nimport { Localized } from '../../../services/locale-service/locale-service.js';\nimport { PromptBarAppConfigKey } from '../constants.js';\nimport { unlocalized } from '../prompt-advanced-unlocalized.js';\nimport { ApplicationConfig, ConfigParserReturnValue } from '../prompt-advanced.types.js';\n\n/**\n * Sound effects config\n */\nexport function parseSoundFXGenerationConfig({\n  localized = localizeBundleDefault(unlocalized),\n  placeholder,\n}: {\n  localized?: Localized<typeof unlocalized>;\n  placeholder?: string;\n} = {}): ConfigParserReturnValue {\n  const config: ApplicationConfig = {\n    id: PromptBarAppConfigKey.application.SOUND_FX,\n    label: localized.soundFx,\n    icon: soundFxIcon,\n    placeholder: placeholder ?? localized.placeholderSoundFx,\n    settings: [],\n  };\n\n  return {\n    config,\n    settingValueMap: {},\n  };\n}\n", "// \u00A9 2025 Adobe. All rights reserved. See /COPYRIGHT for details.\nimport {\n  AdvancedSettingChangeItem,\n  ApplicationConfig,\n  PromptAdvancedInteractionEventType,\n  PromptAdvancedSettingValue,\n  SingleApplicationSelectedSettings,\n} from '../../elements/prompt-advanced/prompt-advanced.types.js';\n\ntype PromptBarAppApplicationChangeEventDetail = {\n  applicationId: string;\n};\n\nexport class PromptBarAppApplicationChangeEvent extends CustomEvent<PromptBarAppApplicationChangeEventDetail> {\n  static readonly eventName = 'prompt-bar-app-application-change';\n\n  constructor({ applicationId }: PromptBarAppApplicationChangeEventDetail) {\n    super(PromptBarAppApplicationChangeEvent.eventName, {\n      detail: { applicationId },\n      bubbles: true,\n      composed: true,\n    });\n  }\n}\n\ntype PromptBarAppMoreButtonClickEventDetail<T extends ApplicationConfig> = {\n  applicationId: T['id'];\n  prompt: string;\n  settings: SingleApplicationSelectedSettings<T>;\n  values: Record<string, PromptAdvancedSettingValue>;\n};\nexport class PromptBarAppMoreButtonClickEvent<T extends ApplicationConfig> extends CustomEvent<PromptBarAppMoreButtonClickEventDetail<T>> {\n  static readonly eventName = 'prompt-bar-app-more-button-click';\n\n  constructor(detail: PromptBarAppMoreButtonClickEventDetail<T>) {\n    super(PromptBarAppMoreButtonClickEvent.eventName, {\n      detail,\n      bubbles: true,\n      composed: true,\n    });\n  }\n}\n\ntype PromptBarAppGenerateEventDetail<T extends ApplicationConfig> = {\n  applicationId: T['id'];\n  prompt: string;\n  settings: SingleApplicationSelectedSettings<T>;\n  values: Record<string, PromptAdvancedSettingValue>;\n};\n\nexport class PromptBarAppGenerateEvent<T extends ApplicationConfig> extends CustomEvent<PromptBarAppGenerateEventDetail<T>> {\n  static readonly eventName = 'prompt-bar-app-generate';\n\n  constructor(detail: PromptBarAppGenerateEventDetail<T>) {\n    super(PromptBarAppGenerateEvent.eventName, {\n      detail,\n      bubbles: true,\n      composed: true,\n    });\n  }\n}\n\ntype PromptBarAppSettingInteractEventDetail = {\n  applicationId: string;\n  settingId: string;\n  type: PromptAdvancedInteractionEventType;\n  value?: string | string[];\n  item?: AdvancedSettingChangeItem | AdvancedSettingChangeItem[];\n};\n\nexport class PromptBarAppSettingInteractEvent extends CustomEvent<PromptBarAppSettingInteractEventDetail> {\n  static readonly eventName = 'prompt-bar-app-setting-interact';\n\n  constructor(detail: PromptBarAppSettingInteractEventDetail) {\n    super(PromptBarAppSettingInteractEvent.eventName, {\n      detail,\n      bubbles: true,\n      composed: true,\n    });\n  }\n}\n"],
  "mappings": "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ACA,GACJ,EACA,GAAM,CACF,IACA,IACJ,EACA,GAAM,CACF,IACA,KACA,IACA,IACJ,EACA,GAAM,CACF,IACA,IACJ,EACA,GAAM,CACF,GACJ,EACA,GAAM,CACF,IACA,KACA,GACJ,EACA,GAAM,CACF,IACA,KACA,GACJ,EACA,GAAM,CACF,IACA,KACA,IACA,IACJ,EACA,GAAM,CACF,IACA,KACA,GACJ,EACA,GAAM,CACF,IACA,IACJ,EACA,GAAM,CACF,IACA,IACJ,EACA,GAAM,CACF,IACA,KACA,GACJ,EACA,GAAM,CACF,IACA,KACA,KACA,GACJ,EACA,GAAM,CACF,IACA,GACJ,EACA,GAAM,CACF,IACA,IACJ,EACA,GAAM,CACF,IACA,IACJ,EACA,GAAM,CACF,IACA,KACA,IACA,IACJ,EACA,GAAM,CACF,KACA,KACA,IACA,GACJ,EACA,GAAM,CACF,IACA,KACA,IACA,IACJ,EACA,GAAM,CACF,GACJ,EACA,GAAM,CACF,IACA,IACJ,EACA,GAAM,CACF,IACA,KACA,IACA,IACJ,EACA,GAAM,CACF,IACA,GACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,IACA,GACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,IACA,KACA,IACA,IACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,KACA,GACJ,EACA,GAAM,CACF,IACA,IACA,IACJ,EACA,GAAM,CACF,IACA,IACJ,EACA,GAAM,CACF,IACA,KACA,GACJ,EACA,GAAM,CACF,IACA,IACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,IACA,IACA,IACJ,EACA,GAAM,CACF,IACA,KACA,KACA,GACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,GACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,IACA,IACJ,EACA,GAAM,CACF,IACA,IACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,GACJ,EACA,GAAM,CACF,IACA,IACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,IACA,GACJ,EACA,GAAM,CACF,GACJ,EACA,GAAM,CACF,IACA,KACA,IACA,IACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,IACA,KACA,KACA,GACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,IACA,KACA,IACA,IACJ,EACA,GAAM,CACF,IACA,IACJ,EACA,GAAM,CACF,IACA,KACA,KACA,GACJ,EACA,GAAM,CACF,IACA,KACA,KACA,GACJ,EACA,GAAM,CACF,IACA,GACJ,EACA,GAAM,CACF,IACA,KACA,IACA,IACJ,EACA,GAAM,CACF,KACA,KACA,IACA,GACJ,EACA,GAAM,CACF,GACJ,EACA,GAAM,CACF,IACA,KACA,IACA,IACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,IACA,KACA,IACA,IACJ,EACA,GAAM,CACF,IACA,GACJ,EACA,GAAM,CACF,IACA,IACJ,EACA,GAAM,CACF,IACA,IACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,IACA,KACA,IACA,IACJ,EACA,GAAM,CACF,IACA,KACA,GACJ,EACA,GAAM,CACF,IACA,IACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,IACA,GACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,IACA,GACJ,EACA,GAAM,CACF,IACA,KACA,IACA,IACJ,EACA,GAAM,CACF,IACA,IACJ,EACA,GAAM,CACF,IACA,IACJ,EACA,GAAM,CACF,IACA,KACA,IACA,IACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,IACA,KACA,IACA,IACJ,EACA,GAAM,CACF,IACA,IACJ,EACA,GAAM,CACF,IACA,KACA,IACA,IACJ,EACA,GAAM,CACF,IACA,KACA,KACA,GACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,IACA,IACJ,EACA,GAAM,CACF,IACA,GACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,GACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,IACA,IACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,IACA,GACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,IACA,KACA,KACA,GACJ,EACA,GAAM,CACF,KACA,GACJ,EACA,GAAM,CACF,GACJ,EACA,GAAM,CACF,IACA,IACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,IACA,KACA,IACA,IACJ,EACA,GAAM,CACF,IACA,KACA,KACA,GACJ,EACA,GAAM,CACF,IACA,IACA,GACJ,EACA,GAAM,CACF,KACA,KACA,IACA,GACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,KACA,IACA,IACA,IACJ,EACA,GAAM,CACF,IACA,KACA,IACA,IACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,IACA,KACA,IACA,IACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,IACA,KACA,KACA,GACJ,EACA,GAAM,CACF,IACA,KACA,IACA,IACJ,EACA,GAAM,CACF,IACA,IACJ,EACA,GAAM,CACF,IACA,KACA,KACA,GACJ,EACA,GAAM,CACF,IACA,KACA,KACA,GACJ,EACA,GAAM,CACF,IACA,KACA,IACA,IACJ,EACA,GAAM,CACF,IACA,KACA,GACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,IACA,KACA,IACA,IACJ,EACA,GAAM,CACF,IACA,GACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,IACA,IACA,IACJ,EACA,GAAM,CACF,IACA,KACA,KACA,GACJ,EACA,GAAM,CACF,IACA,KACA,KACA,GACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,IACA,IACJ,EACA,GAAM,CACF,IACA,IACJ,EACA,GAAM,CACF,IACA,KACA,GACJ,EACA,GAAM,CACF,IACA,IACJ,EACA,GAAM,CACF,IACA,GACJ,EACA,GAAM,CACF,IACA,KACA,IACA,IACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,GACJ,EACA,GAAM,CACF,KACA,KACA,IACA,GACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,IACA,KACA,KACA,GACJ,EACA,GAAM,CACF,IACA,KACA,IACA,IACJ,EACA,GAAM,CACF,IACA,IACJ,EACA,GAAM,CACF,IACA,KACA,KACA,GACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,IACA,GACJ,EACA,GAAM,CACF,IACA,GACJ,EACA,GAAM,CACF,IACA,GACJ,EACA,GAAM,CACF,IACA,KACA,IACA,IACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,KACA,KACA,IACA,GACJ,EACA,GAAM,CACF,IACA,IACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,IACA,IACJ,EACA,GAAM,CACF,GACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,IACA,IACJ,EACA,GAAM,CACF,IACA,GACJ,EACA,GAAM,CACF,IACA,IACA,IACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,IACA,KACA,IACA,IACJ,EACA,GAAM,CACF,IACA,KACA,KACA,GACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,IACA,KACA,IACA,IACJ,EACA,GAAM,CACF,IACA,IACA,IACJ,EACA,GAAM,CACF,IACA,GACJ,EACA,GAAM,CACF,IACA,KACA,KACA,GACJ,EACA,GAAM,CACF,IACA,KACA,GACJ,EACA,GAAM,CACF,IACA,GACJ,EACA,GAAM,CACF,IACA,IACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,IACA,KACA,KACA,GACJ,EACA,GAAM,CACF,IACA,IACJ,EACA,GAAM,CACF,IACA,GACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,IACA,KACA,KACA,GACJ,EACA,GAAM,CACF,IACA,IACJ,EACA,GAAM,CACF,IACA,IACJ,EACA,GAAM,CACF,IACA,KACA,GACJ,EACA,GAAM,CACF,GACJ,EACA,GAAM,CACF,IACA,GACJ,EACA,GAAM,CACF,IACA,KACA,KACA,GACJ,EACA,GAAM,CACF,IACA,KACA,IACA,IACJ,EACA,GAAM,CACF,IACA,IACA,IACJ,EACA,GAAM,CACF,IACA,KACA,KACA,GACJ,EACA,GAAM,CACF,GACJ,EACA,GAAM,CACF,IACA,KACA,IACA,IACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,IACA,IACJ,EACA,GAAM,CACF,GACJ,EACA,GAAM,CACF,GACJ,EACA,GAAM,CACF,IACA,KACA,IACA,IACJ,EACA,GAAM,CACF,IACA,IACA,IACJ,EACA,GAAM,CACF,IACA,IACA,IACJ,EACA,GAAM,CACF,IACA,GACJ,EACA,GAAM,CACF,IACA,IACJ,EACA,GAAM,CACF,IACA,KACA,IACA,IACJ,EACA,GAAM,CACF,IACA,IACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,IACA,KACA,KACA,GACJ,EACA,GAAM,CACF,IACA,KACA,IACA,IACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,IACA,KACA,IACA,IACJ,EACA,GAAM,CACF,IACA,IACA,IACJ,EACA,GAAM,CACF,IACA,IACA,IACJ,EACA,GAAM,CACF,IACA,IACJ,EACA,GAAM,CACF,IACA,GACJ,EACA,GAAM,CACF,IACA,GACJ,EACA,GAAM,CACF,IACA,KACA,KACA,GACJ,EACA,GAAM,CACF,IACA,GACJ,EACA,GAAM,CACF,IACA,KACA,KACA,GACJ,EACA,GAAM,CACF,IACA,GACJ,EACA,GAAM,CACF,IACA,IACJ,EACA,GAAM,CACF,IACA,KACA,IACA,IACJ,EACA,GAAM,CACF,KACA,KACA,IACA,GACJ,EACA,GAAM,CACF,KACA,KACA,IACA,GACJ,EACA,GAAM,CACF,IACA,KACA,GACJ,EACA,GAAM,CACF,KACA,KACA,IACA,GACJ,EACA,GAAM,CACF,IACA,KACA,IACA,IACJ,EACA,GAAM,CACF,IACA,KACA,IACA,IACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,IACA,KACA,GACJ,EACA,GAAM,CACF,IACA,IACA,IACJ,EACA,GAAM,CACF,IACA,KACA,IACA,IACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,IACA,KACA,IACA,IACJ,EACA,GAAM,CACF,IACA,KACA,IACA,IACJ,EACA,GAAM,CACF,IACA,GACJ,EACA,GAAM,CACF,IACA,GACJ,EACA,GAAM,CACF,IACA,IACJ,EACA,GAAM,CACF,IACA,GACJ,EACA,GAAM,CACF,IACA,KACA,GACJ,EACA,GAAM,CACF,IACA,KACA,KACA,GACJ,EACA,GAAM,CACF,IACA,IACJ,EACA,GAAM,CACF,IACA,IACA,KACA,IACJ,EACA,GAAM,CACF,IACA,KACA,IACA,IACJ,EACA,GAAM,CACF,IACA,GACJ,EACA,QAAS,CACL,IACA,IACA,KACA,IACJ,EACA,SAAU,CACN,IACA,KACA,KACA,GACJ,EACA,QAAS,CACL,IACA,IACA,IACJ,EACA,SAAU,CACN,IACA,KACA,IACA,IACJ,EACA,QAAS,CACL,IACA,IACA,KACA,IACJ,EACA,QAAS,CACL,IACA,IACA,KACA,IACJ,EACA,QAAS,CACL,IACA,IACA,KACA,IACJ,EACA,QAAS,CACL,IACA,IACA,KACA,IACJ,EACA,QAAS,CACL,IACA,IACA,KACA,IACJ,EACA,QAAS,CACL,IACA,IACA,KACA,IACJ,EACA,QAAS,CACL,IACA,IACA,IACJ,EACA,QAAS,CACL,IACA,IACA,IACJ,EACA,QAAS,CACL,KACA,KACA,IACA,GACJ,EACA,QAAS,CACL,KACA,IACA,GACJ,EACA,QAAS,CACL,IACA,IACA,IACJ,EACA,QAAS,CACL,IACA,IACA,IACJ,EACA,QAAS,CACL,KACA,IACA,GACJ,EACA,QAAS,CACL,KACA,IACA,GACJ,EACA,QAAS,CACL,KACA,KACA,IACA,GACJ,EACA,QAAS,CACL,KACA,KACA,IACA,GACJ,EACA,QAAS,CACL,KACA,IACA,KACA,GACJ,EACA,QAAS,CACL,KACA,IACA,GACJ,EACA,QAAS,CACL,IACA,KACA,KACA,GACJ,CACJ,EC13CO,SAASC,GAAeC,EAAUC,EAAQ,CAE7C,QADIC,EAAe,GACVC,EAAa,EAAGA,EAAaH,EAAS,OAAQG,IAAc,CACjE,IAAIC,EAAcJ,EAAS,OAAOG,CAAU,EAC5C,GAAIC,IAAgB,IAAK,CAErB,QADIC,EAAc,EACXF,EAAa,EAAIH,EAAS,QAC7BA,EAAS,OAAOG,EAAa,CAAC,IAAMC,GACpCC,IACAF,IAEJ,IAAIG,EAAU,GAAKD,EAAc,GAC7BE,EAAeF,EAAc,EAAI,EAAI,GAAKA,GAAe,GACzDG,EAAgB,IAChBC,EAAWC,GAA+BT,CAAM,EAIpD,KAHIQ,GAAY,K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,IAAM,OACNA,IAAM,OACLA,GAAK,OAAUA,GAAK,OACrBA,IAAM,OACNA,IAAM,OACLA,GAAK,OAAUA,GAAK,OACpBA,GAAK,OAAUA,GAAK,OACpBA,GAAK,OAAUA,GAAK,OACpBA,GAAK,OAAUA,GAAK,OACpBA,GAAK,OAAUA,GAAK,OACpBA,GAAK,OAAUA,GAAK,OACpBA,GAAK,OAAUA,GAAK,OACpBA,GAAK,OAAUA,GAAK,OACrBA,IAAM,OACLA,GAAK,OAAUA,GAAK,OACpBA,GAAK,OAAUA,GAAK,OACrBA,IAAM,OACNA,IAAM,OACNA,IAAM,OACNA,IAAM,OACLA,GAAK,OAAUA,GAAK,OACrBA,IAAM,OACNA,IAAM,OACNA,IAAM,OACNA,IAAM,OACNA,IAAM,OACLA,GAAK,OAAUA,GAAK,OACrBA,IAAM,OACLA,GAAK,OAAUA,GAAK,OACrBA,IAAM,OACNA,IAAM,OACNA,IAAM,OACNA,IAAM,OACLA,GAAK,OAAUA,GAAK,OACrBA,IAAM,OACNA,IAAM,OACNA,IAAM,OACNA,IAAM,OACNA,IAAM,OACNA,IAAM,OACNA,IAAM,OACNA,IAAM,OACNA,IAAM,OACNA,IAAM,OACLA,GAAK,OAAUA,GAAK,OACrBA,IAAM,OACLA,GAAK,OAAUA,GAAK,OACpBA,GAAK,OAAUA,GAAK,OACpBA,GAAK,OAAUA,GAAK,OACrBA,IAAM,OACNA,IAAM,OACNA,IAAM,OACLA,GAAK,OAAUA,GAAK,OACpBA,GAAK,OAAUA,GAAK,OACrBA,IAAM,OACLA,GAAK,OAAUA,GAAK,OACpBA,GAAK,OAAUA,GAAK,OACrBA,IAAM,OACNA,IAAM,OACNA,IAAM,OACNA,IAAM,OACNA,IAAM,OACNA,IAAM,OACNA,IAAM,OACNA,IAAM,OACNA,IAAM,OACNA,IAAM,OACLA,GAAK,OAAUA,GAAK,OACrBA,IAAM,OACNA,IAAM,OACNA,IAAM,OACNA,IAAM,OACNA,IAAM,OACNA,IAAM,OACNA,IAAM,OACNA,IAAM,OACNA,IAAM,OACNA,IAAM,OACLA,GAAK,OAAUA,GAAK,OACrBA,IAAM,OACNA,IAAM,OACNA,IAAM,OAC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;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA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",
  "names": ["imageModelThumbnails", "firefly_thumbnail_new_default", "google_thumbnail_default", "model_icon_ideogram_default", "gpt_icon_white_default", "model_icon_flux_default", "runway_thumbnail_default", "vectorModelThumbnails", "videoModelThumbnails", "thumbnail_default", "defaultThumbnail", "APPLICATION_KEY", "VECTOR_APPLICATION_KEY", "IMAGE_APPLICATION_KEY", "VIDEO_APPLICATION_KEY", "SOUND_FX_APPLICATION_KEY", "MODEL_KEY", "ASPECT_RATIO_KEY", "EFFECTS_KEY", "VIDEO_REFERENCE_FRAMES_KEY", "PromptBarAppConfigKey", "PROMPT_KEY", "VIDEO_REFERENCE_FRAMES_FIRST_FRAME_KEY", "VIDEO_REFERENCE_FRAMES_END_FRAME_KEY", "INTERNAL_CLIENT_ID", "SCREENWIDTH", "PromptAdvancedFrameSelectionEvent", "_PromptAdvancedFrameSelectionEvent", "payload", "ReferenceFramePickerInteractEvent", "_ReferenceFramePickerInteractEvent", "css", "styles", "fromConstant", "LitElement", "html", "customElement", "property", "repeat", "F32Schema", "hookPropsKey", "renderElementStack", "isEffectHookState", "value", "arrayEquals", "a", "b", "length", "i", "withHooks", "_target", "_propertyKey", "descriptor", "original", "args", "props", "hook", "listener", "useActiveElement", "activeElement", "useEffect", "callback", "dependencies", "hookProps", "hookIndex", "oldHookState", "useState", "initialOrFunction", "hookState", "useMemo", "compute", "dependencies", "value", "setValue", "useState", "useEffect", "newValue", "blobStore", "useBorrowUrl", "blobRef", "url", "setUrl", "useState", "useEffect", "disconnected", "cleanup", "value", "e", "toCssUnitString", "measurement", "useObservedValue", "observe", "value", "setValue", "useState", "useEffect", "dispose", "newValue", "fromProperties", "useObservedValues", "observeProperties", "dependencies", "observables", "useMemo", "useObservedValue", "usePromise", "promiseFactory", "deps", "data", "setData", "useState", "useEffect", "isMounted", "result", "useElement", "useActiveElement", "iterateSelfAndAncestors", "element", "current", "getSelfOrAncestor", "predicate", "ancestor", "getSelfOrAncestorByTagName", "tagName", "check", "withCapture", "_target", "_propertyKey", "descriptor", "useSpectrumTheme", "element", "useElement", "themeElement", "getSelfOrAncestorByTagName", "getTheme", "color", "scale", "theme", "setTheme", "useState", "useEffect", "observer", "createObservableEvent", "toAsyncGenerator", "withFilter", "TextfieldInputEvent", "_TextfieldInputEvent", "value", "TextfieldKeydownEvent", "_TextfieldKeydownEvent", "originalEvent", "getLineHeight", "textarea", "lineHeight", "measureNaturalHeight", "calculateFinalHeight", "naturalHeight", "maxRows", "maxHeight", "shouldAnimate", "currentHeight", "finalHeight", "isFocused", "heightChange", "prepareForAnimation", "forceReflow", "setHeight", "height", "setHeightImmediately", "updateTextareaHeight", "css", "styles", "LitElement", "html", "customElement", "property", "query", "state", "classMap", "ifDefined", "css", "commonStyles", "tagName", "Textfield", "LitElement", "changedProperties", "updateTextareaHeight", "event", "target", "TextfieldInputEvent", "TextfieldKeydownEvent", "maxLengthAttr", "minLengthAttr", "html", "classMap", "ifDefined", "commonStyles", "styles", "__decorateClass", "property", "state", "query", "customElement", "isTruthy", "v", "getDimensionKey", "size", "ASPECT_RATIO_ORDER", "ASPECT_RATIO_CODES", "DEFAULT_ASPECT_RATIO_PRIORITY_DESKTOP_IMAGE", "DEFAULT_ASPECT_RATIO_PRIORITY_MOBILE_IMAGE", "DEFAULT_ASPECT_RATIO_PRIORITY_DESKTOP_VIDEO", "DEFAULT_ASPECT_RATIO_PRIORITY_MOBILE_VIDEO", "getDefaultAspectRatioPriority", "isMobile", "type", "buildNumericRatiosMap", "codes", "acc", "code", "width", "height", "ASPECT_RATIO_CODE_TO_DESCRIPTOR", "getResolution", "size", "getAspectRatioCode", "availableAspects", "ratio", "defaultRatioCode", "ratiosMap", "defaultDiff", "closestRatioCode", "ratioDiff", "value", "getSortedAspectRatioSizes", "sizes", "defaultAspectRatioPriority", "order", "deduplicateSizes", "sizeMap", "aspectsToUse", "defaultSortMap", "aspectRatioSizesByNameMap", "cur", "aspectRatioItems", "a", "b", "resolutionA", "resolutionB", "defaultAspectRatioCode", "getDefaultSizeForGroup", "items", "item", "dimensionKey", "getDimensionKey", "sortedSizes", "name", "allResolutions", "exactDefaultSize", "withDefaultFlag", "index", "arr", "isTruthy", "smallestResolutionPerAspectRatio", "getNumericAspectRatio", "size", "fromProperties", "withMapData", "enableUniversalAssetPickerShared", "service", "dependencies", "enableUniversalAssetPicker", "isSignedIn", "html", "customElement", "IconBase", "tagName", "IconUploadS2", "IconBase", "html", "__decorateClass", "customElement", "css", "styles", "LitElement", "html", "customElement", "property", "ifDefined", "when", "tagName", "FFTooltip", "LitElement", "html", "ifDefined", "when", "commonStyles", "styles", "__decorateClass", "property", "customElement", "css", "styles", "FileSelectedEvent", "_FileSelectedEvent", "file", "source", "FileChangeEvent", "_FileChangeEvent", "editorSettings", "FileTypeNotAcceptedEvent", "_FileTypeNotAcceptedEvent", "fileType", "DNIFlaggedEvent", "_DNIFlaggedEvent", "DNIFlaggedCancelEvent", "_DNIFlaggedCancelEvent", "DNIFlaggedConfirmEvent", "_DNIFlaggedConfirmEvent", "FilePreviewImageClickEvent", "_FilePreviewImageClickEvent", "FilePreviewRemoveClickEvent", "_FilePreviewRemoveClickEvent", "FilePreviewPointerOverEvent", "_FilePreviewPointerOverEvent", "FilePreviewPointerOutEvent", "_FilePreviewPointerOutEvent", "UploadEditedEvent", "_UploadEditedEvent", "UploadValidationErrorEvent", "_UploadValidationErrorEvent", "error", "message", "UploadProcessingErrorEvent", "_UploadProcessingErrorEvent", "UploadSourceOpenedEvent", "_UploadSourceOpenedEvent", "LitElement", "html", "nothing", "customElement", "property", "query", "state", "when", "withMap", "localizeBundle", "bundle", "localizeFunction", "prefix", "result", "key", "value", "newKey", "extendStatics", "d", "b", "p", "__extends", "__", "__assign", "t", "s", "i", "n", "__rest", "e", "__spreadArray", "to", "from", "pack", "i", "l", "ar", "ErrorKind", "TYPE", "SKELETON_TYPE", "isLiteralElement", "el", "isArgumentElement", "isNumberElement", "isDateElement", "isTimeElement", "isSelectElement", "isPluralElement", "isPoundElement", "isTagElement", "isNumberSkeleton", "isDateTimeSkeleton", "SPACE_SEPARATOR_REGEX", "DATE_TIME_REGEX", "parseDateTimeSkeleton", "skeleton", "result", "match", "len", "WHITE_SPACE_REGEX", "parseNumberSkeletonFromString", "skeleton", "stringTokens", "WHITE_SPACE_REGEX", "x", "tokens", "_i", "stringTokens_1", "stringToken", "stemAndOptions", "stem", "options", "_a", "options_1", "option", "icuUnitToEcma", "unit", "FRACTION_PRECISION_REGEX", "SIGNIFICANT_PRECISION_REGEX", "INTEGER_WIDTH_REGEX", "CONCISE_INTEGER_WIDTH_REGEX", "parseSignificantPrecision", "str", "result", "_", "g1", "g2", "parseSign", "parseConciseScientificAndEngineeringStem", "signDisplay", "parseNotationOptions", "opt", "signOpts", "parseNumberSkeleton", "tokens_1", "token", "__assign", "all", "g3", "g4", "g5", "conciseScientificAndEngineeringOpts", "timeData", "getBestPattern", "skeleton", "locale", "skeletonCopy", "patternPos", "patternChar", "extraLength", "hourLen", "dayPeriodLen", "dayPeriodChar", "hourChar", "getDefaultHourSymbolFromLocale", "hourCycle", "languageTag", "regionTag", "hourCycles", "timeData", "_a", "SPACE_SEPARATOR_START_REGEX", "SPACE_SEPARATOR_REGEX", "SPACE_SEPARATOR_END_REGEX", "createLocation", "start", "end", "hasNativeStartsWith", "hasNativeFromCodePoint", "hasNativeFromEntries", "hasNativeCodePointAt", "hasTrimStart", "hasTrimEnd", "hasNativeIsSafeInteger", "isSafeInteger", "n", "REGEX_SUPPORTS_U_AND_Y", "re", "RE", "startsWith", "s", "search", "position", "fromCodePoint", "codePoints", "_i", "elements", "length", "i", "code", "fromEntries", "entries", "obj", "entries_1", "k", "v", "codePointAt", "index", "size", "first", "second", "trimStart", "trimEnd", "flag", "matchIdentifierAtIndex", "IDENTIFIER_PREFIX_RE_1", "match", "c", "_isWhiteSpace", "_isPatternSyntax", "Parser", "message", "options", "nestingLevel", "parentArgType", "expectingCloseTag", "char", "result", "TYPE", "ErrorKind", "_isAlpha", "startPosition", "tagName", "childrenResult", "children", "endTagStartPosition", "closingTagNameStartPosition", "closingTagName", "startOffset", "_isPotentialElementNameChar", "value", "parseQuoteResult", "parseUnquotedResult", "parseLeftAngleResult", "location", "_isAlphaOrSlash", "ch", "openingBracePosition", "startingPosition", "endOffset", "endPosition", "typeStartPosition", "argType", "typeEndPosition", "styleAndLocation", "styleStartPosition", "style", "styleLocation", "argCloseResult", "location_1", "skeleton", "dateTimePattern", "getBestPattern", "SKELETON_TYPE", "parseDateTimeSkeleton", "type", "typeEndPosition_1", "__assign", "identifierAndLocation", "pluralOffset", "optionsResult", "location_2", "nestedBraces", "apostrophePosition", "tokens", "parseNumberSkeletonFromString", "parseNumberSkeleton", "expectCloseTag", "parsedFirstIdentifier", "hasOtherClause", "parsedSelectors", "selector", "selectorLocation", "fragmentResult", "expectNumberError", "invalidNumberError", "sign", "hasDigits", "decimal", "offset", "kind", "prefix", "pattern", "currentOffset", "targetOffset", "nextCode", "_isAlpha", "codepoint", "_isAlphaOrSlash", "_isPotentialElementNameChar", "c", "_isWhiteSpace", "_isPatternSyntax", "pruneLocation", "els", "el", "isSelectElement", "isPluralElement", "k", "isNumberElement", "isNumberSkeleton", "isDateElement", "isTimeElement", "isDateTimeSkeleton", "isTagElement", "parse", "message", "opts", "__assign", "result", "Parser", "error", "ErrorKind", "memoize", "fn", "options", "cache", "cacheDefault", "serializer", "serializerDefault", "strategy", "strategyDefault", "isPrimitive", "value", "monadic", "arg", "cacheKey", "computedValue", "variadic", "args", "assemble", "context", "serialize", "strategyVariadic", "strategyMonadic", "ObjectWithoutPrototypeCache", "key", "strategies", "ErrorCode", "FormatError", "_super", "__extends", "msg", "code", "originalMessage", "_this", "InvalidValueError", "_super", "__extends", "variableId", "value", "options", "originalMessage", "ErrorCode", "FormatError", "InvalidValueTypeError", "_super", "__extends", "value", "type", "originalMessage", "ErrorCode", "FormatError", "MissingValueError", "_super", "__extends", "variableId", "originalMessage", "ErrorCode", "FormatError", "PART_TYPE", "mergeLiteral", "parts", "all", "part", "lastPart", "isFormatXMLElementFn", "el", "formatToParts", "els", "locales", "formatters", "formats", "values", "currentPluralValue", "originalMessage", "isLiteralElement", "result", "_i", "els_1", "isPoundElement", "varName", "MissingValueError", "value", "isArgumentElement", "isDateElement", "style", "isDateTimeSkeleton", "isTimeElement", "isNumberElement", "isNumberSkeleton", "isTagElement", "children", "value_1", "formatFn", "InvalidValueTypeError", "chunks", "p", "c", "isSelectElement", "opt", "InvalidValueError", "isPluralElement", "FormatError", "ErrorCode", "rule", "mergeConfig", "c1", "c2", "__assign", "all", "k", "mergeConfigs", "defaultConfig", "configs", "createFastMemoizeCache", "store", "key", "value", "createDefaultFormatters", "cache", "memoize", "_a", "args", "_i", "__spreadArray", "strategies", "IntlMessageFormat", "message", "locales", "overrideFormats", "opts", "_this", "values", "parts", "result", "part", "PART_TYPE", "formatToParts", "formatters", "parseOpts", "__rest", "supportedLocales", "parse", "getIsDevEnvironment", "hostname", "getStringFormatFunction", "key", "message", "locale", "htmlTags", "sanitizedMessage", "match", "formatter", "IntlMessageFormat", "values", "formattedMessage", "_match", "index", "htmlTagsMatch", "identityLocalizedStringFunction", "_key", "unlocalizedValue", "createICUMessageLocaleService", "props", "localeCode", "prefix", "localize", "isProdEnvironment", "getIsDevEnvironment", "convertCamelCaseToKebabCase", "camelCase", "getUniqueKey", "tagName", "getLocalizedValue", "value", "getLocalizedValueInternal", "localizeFunction", "error", "errorMessage", "_args", "_tagName", "bundle", "localizeBundle", "defaultLocaleService", "createICUMessageLocaleService", "localizeBundleDefault", "bundle", "clipPathWithRectangularHole", "cutoutRect", "min", "max", "css", "styles", "CropperUpdateEvent", "_CropperUpdateEvent", "cropArea", "LitElement", "html", "nothing", "customElement", "property", "query", "state", "classMap", "createRef", "ref", "blobStore", "blobStore", "blobStore", "withVideoMetadata", "blobRef", "useVideo", "url", "video", "resolve", "reject", "getVideoSize", "width", "height", "duration", "blobStore", "memoize", "loadImage", "src", "options", "resolve", "reject", "img", "getPreferredSize", "natural", "preferred", "pWidth", "pHeight", "nWidth", "nHeight", "getVideoFrame", "source", "url", "size", "time", "video", "error", "width", "height", "seekHandler", "presolve", "preject", "framePromise", "getFrame", "canvas", "context", "blob", "ref", "getPreviewImage", "unknownType", "getMimeType", "isImageType", "type", "isVideoType", "isMediaType", "createCanvasContext", "canvas", "getMediaSize", "memoize", "mediaRef", "blob", "blobStore", "getVideoSize", "resolve", "reject", "img", "url", "cropImage", "fileRef", "rect", "blobMimeType", "getMimeType", "url", "blobStore", "canvas", "ctx", "image", "loadImage", "blob", "resolve", "cropImageToSize", "memoize", "blobRef", "size", "type", "url", "blobStore", "getMimeType", "img", "loadImage", "context", "createCanvasContext", "inputSize", "getMediaSize", "scale", "sourceWidth", "sourceHeight", "sourceX", "sourceY", "canvas", "resolve", "blob", "error", "getEditedFile", "editorSettings", "baseFileRef", "crop", "cropImage", "clamp", "value", "min", "max", "Vec2", "add", "a", "b", "sub", "mul", "scale", "vec", "max", "abs", "sign", "equals", "epsilon", "lengthSquared", "dot", "project", "direction", "scalar", "projectToLine", "point", "origin", "projectedDifference", "clampToRect", "bounds", "clamp", "Rect", "translate", "rect", "delta", "getWidth", "getHeight", "getSize", "translateToBounds", "clampDela", "min", "fitToBounds", "clampAspect", "aspectRatio", "size", "clampedSize", "boundingBox", "points", "xs", "p", "ys", "minX", "minY", "maxX", "maxY", "intersectLine", "line", "dir", "t0", "t1", "Interval", "create", "intersect", "LineSegment", "nearestPoint", "t", "tClamped", "unlocalized", "_", "tagName", "Cropper", "LitElement", "localizeBundleDefault", "createRef", "value", "Vec2", "minWidth", "cropArea", "clamped", "Rect", "size", "CropperUpdateEvent", "editorSettings", "getEditedFile", "keyboardMode", "maxWidth", "maxHeight", "contentAspectRatio", "vector", "contentSize", "scaleX", "scaleY", "event", "root", "clientBounds", "cursor", "handlers", "pointerId", "releasePointer", "pointerStart", "startRect", "pointer", "offset", "baseSpeed", "speed", "point", "handle", "snapLine", "initialCenter", "pointerOffset", "handlePoint", "anchor", "dragPoint", "LineSegment", "minSize", "diff", "epsilon", "clampedDiff", "newRect", "newCenter", "centeredRect", "img", "corners", "borderThickness", "border", "padding", "html", "nothing", "toRelative", "clientCropArea", "width", "height", "style", "url", "useBorrowUrl", "cropSize", "clientCropSize", "clientPosition", "clientImageSize", "toClientSpace", "clipPath", "clipPathWithRectangularHole", "useEffect", "theme", "useSpectrumTheme", "imgStyle", "clasName", "classMap", "ref", "commonStyles", "styles", "__decorateClass", "query", "property", "state", "withCapture", "withHooks", "customElement", "html", "customElement", "IconBase", "tagName", "IconCheckmark", "IconBase", "html", "__decorateClass", "customElement", "css", "styles", "LitElement", "html", "customElement", "property", "query", "state", "classMap", "ifDefined", "tagName", "TrayPanel", "LitElement", "event", "isOverlay", "isDismissButton", "forceDismiss", "value", "hasTitleContent", "hasBackContent", "html", "ifDefined", "classMap", "commonStyles", "styles", "__decorateClass", "property", "query", "state", "customElement", "unlocalized", "tagName", "CropOverlay", "LitElement", "localizeBundleDefault", "rect", "ms", "editorSettings", "UploadEditedEvent", "event", "preview", "cropArea", "html", "when", "nothing", "title", "commonStyles", "styles", "__decorateClass", "query", "property", "state", "withCapture", "customElement", "css", "styles", "LitElement", "html", "customElement", "property", "fromProperties", "toPromise", "withMapData", "getAppLocaleFromIMS", "normalize", "region", "getCompleteGoURL", "goUrl", "host", "unlocalized", "_", "tagName", "DNIFlaggedModal", "LitElement", "localizeBundleDefault", "html", "getCompleteGoURL", "DNIFlaggedCancelEvent", "DNIFlaggedConfirmEvent", "styles", "commonStyles", "__decorateClass", "property", "customElement", "html", "nothing", "when", "css", "styles", "render", "args", "disabled", "showUploadOptions", "onDragZoneDrop", "onUploadButtonClick", "onBrowseFilesClick", "uploadButtonLabel", "browseButtonLabel", "onFileInputChange", "acceptedFileTypes", "uploadButtonTreatment", "browseButtonTreatment", "uploadButtonVariant", "uploadButtonSize", "browseButtonSize", "isMobile", "content", "html", "nothing", "when", "html", "nothing", "html", "customElement", "IconBase", "tagName", "IconFileUpload", "IconBase", "html", "__decorateClass", "customElement", "html", "customElement", "IconBase", "tagName", "IconUploadToCloud", "IconBase", "html", "__decorateClass", "customElement", "css", "styles", "render", "args", "uploadButtonLabel", "browseButtonLabel", "onUploadButtonClick", "onBrowseFilesClick", "onFileInputChange", "acceptedFileTypes", "showUploadOptions", "html", "nothing", "css", "styles", "LitElement", "html", "nothing", "customElement", "property", "classMap", "when", "unlocalized", "_", "tagName", "FilePreview", "LitElement", "localizeBundleDefault", "html", "previewUrl", "nothing", "imagePreviewRef", "usePromise", "getPreviewImage", "useBorrowUrl", "handleClickClear", "e", "FilePreviewRemoveClickEvent", "classMap", "FilePreviewImageClickEvent", "FilePreviewPointerOverEvent", "FilePreviewPointerOutEvent", "isMediaType", "when", "commonStyles", "styles", "__decorateClass", "property", "withHooks", "customElement", "uploadValidationErrors", "uploadProcessingErrors", "css", "styles", "equals", "blobStore", "LitElement", "html", "nothing", "customElement", "property", "query", "state", "classMap", "html", "customElement", "IconBase", "tagName", "IconAdobeCloudStorage", "IconBase", "html", "__decorateClass", "customElement", "html", "customElement", "IconBase", "tagName", "IconFileImport", "IconBase", "html", "__decorateClass", "customElement", "AssetSelectedEvent", "_AssetSelectedEvent", "asset", "CloseEvent", "_CloseEvent", "OpenFileInputEvent", "_OpenFileInputEvent", "SUPPORTED_IMAGE_TYPES", "SUPPORTED_VIDEO_TYPES", "getCompatibleTypes", "acceptedTypes", "compatibleTypes", "type", "API_KEY", "getUAPConfig", "featureFlags", "html", "render", "theme", "cdoHostProductData", "compatibleTypes", "sharedContext", "onClose", "onAsset", "onOpenOSFilePicker", "isMobile", "pickerInfo", "renderDocumentPicker", "html", "event", "css", "styles", "LitElement", "customElement", "property", "state", "createObservableState", "fromProperties", "toPromise", "withFilter", "CollaborationSDK", "manager", "init", "sdkObservable", "setSdkObservable", "_waitForSdk", "sdk", "_convertUserProfile", "profile", "getAUPSDKManager", "config", "authentication", "environment", "_loadSDK", "clientId", "locale", "production", "accessToken", "userProfile", "sdkConfig", "currentSdk", "tag", "tagName", "FireflyUAP", "LitElement", "authentication", "environment", "aupSDK", "getAUPSDKManager", "theme", "useSpectrumTheme", "values", "useObservedValues", "hostProductData", "getUAPConfig", "render", "getCompatibleTypes", "SUPPORTED_IMAGE_TYPES", "asset", "AssetSelectedEvent", "CloseEvent", "OpenFileInputEvent", "styles", "__decorateClass", "property", "state", "withHooks", "customElement", "unlocalized", "tagName", "blobToFile", "blob", "fileName", "UploadView", "LitElement", "localizeBundleDefault", "render", "e", "html", "classMap", "nothing", "value", "getMimeType", "isImageType", "mimeType", "event", "droppedFile", "FileSelectedEvent", "FileTypeNotAcceptedEvent", "source", "FileChangeEvent", "file", "i", "UploadSourceOpenedEvent", "size", "getMediaSize", "getNumericAspectRatio", "newFile", "UploadValidationErrorEvent", "uploadValidationErrors", "validationResult", "equals", "oldValue", "editorSettings", "blobRef", "blobStore", "skipDNI", "DNIFlaggedEvent", "editedBlobRef", "getEditedFile", "showModalType", "trigger", "handleOpened", "onOverlayClosed", "stopCloseEventPropagation", "testIdPrefix", "options", "shouldWrapInUploadOptions", "type", "UploadProcessingErrorEvent", "uploadProcessingErrors", "error", "errorMessage", "commonStyles", "styles", "__decorateClass", "property", "query", "state", "customElement", "tagName", "PromptAdvancedReferenceFramePicker", "LitElement", "index", "settingId", "file", "editorSettings", "eventType", "item", "PromptAdvancedFrameSelectionEvent", "ReferenceFramePickerInteractEvent", "items", "features", "authentication", "environment", "sam", "hostService", "isUploadCropperEnabledObservable", "fromConstant", "isUniversalAssetPickerEnabledObservable", "enableUniversalAssetPickerShared", "values", "useObservedValues", "repeat", "referenceFrameValue", "fileRef", "html", "getNumericAspectRatio", "e", "commonStyles", "styles", "__decorateClass", "property", "withHooks", "customElement", "PromptChangeEvent", "_PromptChangeEvent", "value", "ApplicationChangeEvent", "_ApplicationChangeEvent", "applicationId", "AdvancedSettingChangeEvent", "_AdvancedSettingChangeEvent", "detail", "MoreButtonClickEvent", "_MoreButtonClickEvent", "GenerateEvent", "_GenerateEvent", "SettingInteractEvent", "_SettingInteractEvent", "html", "html", "customElement", "IconBase", "tagName", "IconAIEffects", "IconBase", "html", "__decorateClass", "customElement", "html", "customElement", "IconBase", "tagName", "AspectLandscape", "IconBase", "html", "__decorateClass", "customElement", "html", "customElement", "IconBase", "tagName", "AspectPortrait", "IconBase", "html", "__decorateClass", "customElement", "html", "customElement", "IconBase", "tagName", "AspectRatio", "IconBase", "html", "__decorateClass", "customElement", "html", "customElement", "IconBase", "tagName", "AspectSquare", "IconBase", "html", "__decorateClass", "customElement", "html", "customElement", "IconBase", "tagName", "AspectTallscreen", "IconBase", "html", "__decorateClass", "customElement", "html", "customElement", "IconBase", "tagName", "AspectWidescreen", "IconBase", "html", "__decorateClass", "customElement", "html", "customElement", "IconBase", "tagName", "IconAudioWave", "IconBase", "html", "__decorateClass", "customElement", "html", "customElement", "IconBase", "tagName", "IconCrown", "IconBase", "html", "__decorateClass", "customElement", "html", "customElement", "IconBase", "tagName", "IconImage", "IconBase", "html", "__decorateClass", "customElement", "html", "customElement", "IconBase", "tagName", "IconModels", "IconBase", "html", "__decorateClass", "customElement", "html", "customElement", "IconBase", "tagName", "IconVectorDraw", "IconBase", "html", "__decorateClass", "customElement", "html", "customElement", "IconBase", "tagName", "IconVector", "IconBase", "html", "__decorateClass", "customElement", "html", "customElement", "IconBase", "tagName", "IconVideo", "IconBase", "html", "__decorateClass", "customElement", "css", "styles", "LitElement", "html", "customElement", "property", "styleMap", "createJSONConverter", "value", "tagName", "defaultSize", "ImageIcon", "LitElement", "size", "src", "spriteArea", "label", "html", "x", "y", "width", "height", "scaleFactor", "imageStyle", "styleMap", "commonStyles", "styles", "__decorateClass", "property", "createJSONConverter", "customElement", "imageIcon", "html", "videoIcon", "aspectRatioIcon", "vectorIcon", "soundFxIcon", "getModelIcon", "modelId", "thumbnailSrc", "imageModelThumbnails", "vectorModelThumbnails", "videoModelThumbnails", "defaultThumbnail", "getAspectRatioIcon", "size", "code", "getAspectRatioCode", "blobStore", "html", "ReferenceUsageConfigSchema", "ReferenceSupportSchema", "BlobRefSchema", "Nullable", "TrueSchema", "U32Schema", "SizeSchema", "AspectRatioSchema", "BlobRefSchema", "Nullable", "ReferenceBlobUsageSchema", "ReferenceBlobSchema", "SizeSchema", "ReferenceBlobsSchema", "ConsumptionStatusValues", "ConsumptionStatusSchema", "CommerceStatusSchema", "normalize", "jsonToHash", "memoize", "getUniqueIdFromObject", "memoize", "settings", "jsonToHash", "typedKeys", "obj", "HostFeatureFlagsDefault", "HostFeatureFlagsKeysSchema", "typedKeys", "HostFeatureFlagsDefault", "GraphicGenerationModeSchema", "GraphicGenerationModeConfigSchema", "SizeSchema", "GraphicGenerationModelSchema", "HostFeatureFlagsKeysSchema", "GraphicGenerationErrorCodeSchema", "RateLimitedErrorCodeSchema", "RateLimitedErrorSchema", "BasicGraphicGenerationErrorSchema", "GraphicGenerationErrorSchema", "IntermediateResultSchemaLegacy", "valueSchema", "SuccessResultSchemaLegacy", "ErrorResultSchemaLegacy", "ProgressiveResultSchemaLegacy", "successSchema", "errorSchema", "intermediateSchema", "SupportedSettingsDefault", "ModelVersionConfigSchema", "ImageGenerationModelSchema", "ReferenceSupportSchema", "Nullable", "GraphicGenerationModeSchema", "SizeSchema", "ImageGenerationModelIdInternalSchema", "ImageGenerationModelIdThirdPartySchema", "ImageGenerationModelIdSchema", "ImageGenerationModelIdInternalSchema", "ImageGenerationModelIdThirdPartySchema", "AspectRatioSchema", "ContentTypeSchema", "ExifTypeSchema", "DetailLevelSchema", "ImageGenerationReferenceImageSchema", "Nullable", "BlobRefSchema", "ImageGenerationStyleSchema", "ImageGenerationReferenceImageSchema", "ImageGenerationSubjectSchema", "ImageGenerationReferenceImageSchema", "ImageGenerationStructureSchema", "ImageGenerationReferenceImageSchema", "ImageGenerationImagePromptSchema", "ImageGenerationReferenceImageSchema", "ImageGenerationOptionsSchema", "TrueSchema", "ImageGenerationSettingsSchema", "AspectRatioSchema", "SizeSchema", "TrueSchema", "ContentTypeSchema", "DetailLevelSchema", "ImageGenerationModelIdSchema", "GraphicGenerationModeSchema", "ImageGenerationOptionsSchema", "Nullable", "ReferenceBlobsSchema", "ImageGenerationSubjectSchema", "ImageGenerationStructureSchema", "ImageGenerationStyleSchema", "ImageGenerationImagePromptSchema", "PersistedMediaSchema", "BlobRefSchema", "ImageGenerationSuccessMetaSchema", "ImageGenerationSuccessSchema", "ContentTypeSchema", "ExifTypeSchema", "SizeSchema", "CommerceStatusSchema", "ImageSpecificErrorCodeSchema", "BasicErrorSchema", "ImageGenerationErrorSchema", "GraphicGenerationErrorSchema", "ImageGenerationIntermediateSchema", "ImageGenerationResultSchema", "ProgressiveResultSchemaLegacy", "BlobRefSchema", "Nullable", "BooleanInputSchema", "SupportedSettingsSchema", "RangeSchema", "DurationSchema", "StructureReferenceSchema", "VideoGenerationModelSettingsSchema", "VideoGenerationModelSettingsDefault", "VideoGenerationModelSchema", "GraphicGenerationModelSchema", "SupportedSettingsSchema", "VideoGenerationModelIdInternalSchema", "VideoGenerationModelIdThirdPartySchema", "VideoGenerationModelIdSchema", "JobModeSchema", "VideoSpecificErrorCodeSchema", "BasicErrorSchema", "VideoSpecificErrorCodeSchema", "JobModeSchema", "VideoRateLimitedErrorSchema", "RateLimitedErrorSchema", "VideoClientCancelledGenerationErrorSchema", "VideoGenerationErrorSchema", "BasicGraphicGenerationErrorSchema", "VideoAspectRatioSchema", "AspectRatioSchema", "CameraMotionSchema", "CameraAngleSchema", "CameraShotSizeSchema", "VideoPromptStyleSchema", "CameraSchema", "Nullable", "CameraMotionSchema", "CameraAngleSchema", "CameraShotSizeSchema", "VideoGenerationReferenceImageSchema", "Nullable", "BlobRefSchema", "VideoGenerationReferenceVideoSchema", "VideoGenerationSuccessMetaSchema", "VideoGenerationSuccessSchema", "BlobRefSchema", "CommerceStatusSchema", "JobModeSchema", "VideoGenerationIntermediateSchema", "VideoGenerationResultSchema", "ProgressiveResultSchemaLegacy", "VideoGenerationErrorSchema", "css", "styles", "LitElement", "html", "customElement", "property", "tagName", "EffectThumbnailItem", "LitElement", "html", "styles", "__decorateClass", "property", "customElement", "unlocalized", "PROMPT_BREAKPOINT_M", "SCREENWIDTH", "PROMPT_BREAKPOINT_S", "PROMPT_MAXLENGTH_IMAGE", "PROMPT_MAXLENGTH_VIDEO", "PROMPT_MAXROWS", "getPromptConfig", "currentApplication", "VIDEO_APPLICATION_KEY", "createSettingValueMap", "settings", "extractMap", "items", "acc", "item", "newMap", "setting", "getDisplayRatioForSize", "size", "sizeMap", "sizeKey", "getDimensionKey", "sizeInfo", "getAspectRatioCode", "getAspectRatioId", "createAspectRatioItem", "isDefault", "getAspectRatioIcon", "areAllItemsPremium", "items", "modelDictionary", "item", "parseAspectRatioItems", "sizes", "defaultAspectRatioPriority", "getDefaultAspectRatioPriority", "availableAspects", "smallestResolutionPerAspectRatio", "getSortedAspectRatioSizes", "getModelSections", "_items", "isPaidPremium", "showCrowns", "localized", "localizeBundleDefault", "unlocalized", "adobeItems", "partnerItems", "sections", "createItems", "html", "createSectionLabel", "titleText", "descriptionText", "descriptionUrl", "allArePremium", "getModelPrefix", "applicationId", "IMAGE_APPLICATION_KEY", "VIDEO_APPLICATION_KEY", "getModelSettingKey", "modelId", "getModelIdFromSettings", "settings", "prefix", "settingsModelKey", "MODEL_KEY", "extractSettingsValues", "settings", "settingValueMap", "acc", "settingId", "settingItemId", "id", "settingValue", "getCurrentScreenWidthId", "width", "SCREENWIDTH", "isGenerateVisible", "breakpoint", "getReferenceFrameConfig", "isFirstFrameSupported", "isLastFrameSupported", "isGuidedTransformsFeatureEnabled", "userInputValues", "incompatibleVideoSettings", "frameConfig", "firstFrame", "VIDEO_REFERENCE_FRAMES_FIRST_FRAME_KEY", "firstFrameHasData", "isImageModelId", "modelId", "ImageGenerationModelIdSchema", "isVideoModelId", "VideoGenerationModelIdSchema", "isApplicationId", "applicationId", "IMAGE_APPLICATION_KEY", "VIDEO_APPLICATION_KEY", "VECTOR_APPLICATION_KEY", "SOUND_FX_APPLICATION_KEY", "isFrameChangeItem", "item", "isSection", "isItem", "getDefaultItem", "items", "firstSeenItem", "defaultItem", "maybeSetDefault", "nestedItem", "css", "styles", "LitElement", "html", "render", "nothing", "customElement", "property", "query", "queryAll", "state", "classMap", "ifDefined", "repeat", "styleMap", "css", "styles", "LitElement", "html", "customElement", "property", "tagName", "CoachIndicator", "LitElement", "html", "styles", "__decorateClass", "property", "customElement", "html", "customElement", "IconBase", "tagName", "IconAIGenerate", "IconBase", "html", "__decorateClass", "customElement", "html", "customElement", "IconBase", "tagName", "IconAISparkles", "IconBase", "html", "__decorateClass", "customElement", "html", "customElement", "IconBase", "tagName", "IconProperties", "IconBase", "html", "__decorateClass", "customElement", "PromptChangeEvent", "_PromptChangeEvent", "value", "PromptTextAreaKeydownEvent", "_PromptTextAreaKeydownEvent", "event", "PromptPopupClose", "_PromptPopupClose", "css", "styles", "LitElement", "html", "customElement", "property", "query", "queryAssignedNodes", "state", "classMap", "styleMap", "when", "isEnterSubmit", "event", "isIMECompositing", "isKeyboardSubmit", "tagName", "Prompt", "LitElement", "event", "path", "PromptPopupClose", "entries", "entry", "changedProperties", "headerNodes", "headerSlot", "dividerHeight", "headerRect", "html", "when", "styleMap", "classMap", "e", "PromptChangeEvent", "isKeyboardSubmit", "PromptTextAreaKeydownEvent", "commonStyles", "styles", "__decorateClass", "property", "state", "queryAssignedNodes", "query", "customElement", "SelectionChangeEvent", "_SelectionChangeEvent", "selected", "ReorderEvent", "_ReorderEvent", "oldIndex", "newIndex", "items", "updateLiveRegion", "message", "setLiveRegionMessage", "generateAccessibilityIds", "componentId", "baseId", "focusItem", "itemId", "shadowRoot", "updateComplete", "getGridItem", "element", "items", "target", "itemIds", "item", "moveItemInArray", "fromIndex", "toIndex", "newItems", "movedItem", "enterDragMode", "state", "focusedItemId", "callbacks", "draggedItemOriginalIndex", "draggedItem", "exitDragMode", "options", "newIndex", "currentIndex", "handleKeyboardDragMove", "direction", "itemsPerRow", "totalItems", "handleDragStart", "event", "draggedElement", "handleDragOver", "handleDrop", "dropX", "dropY", "dropOnId", "draggedId", "draggedIndex", "i", "dropOnIndex", "calculateNewIndex", "currentIndex", "direction", "autoFlow", "itemsPerRow", "totalItems", "handleDragModeKeys", "event", "callbacks", "getFocusedItemIndex", "state", "item", "handleGridKeyDown", "newIndex", "handled", "handleItemKeyDown", "getSelectedItems", "selectionVariant", "selected", "handleItemSelection", "targetItem", "state", "newSelected", "item", "normalizeSelection", "html", "classMap", "ifDefined", "when", "LitElement", "html", "customElement", "property", "styleMap", "tagName", "Grid", "LitElement", "styles", "toCssUnitString", "html", "styleMap", "__decorateClass", "property", "customElement", "css", "styles", "unlocalized", "renderItem", "item", "args", "props", "i", "isFocused", "itemIndex", "rowIndex", "colIndex", "isDraggedItem", "handleKeyDown", "event", "handleFocus", "html", "classMap", "ifDefined", "when", "render", "isMultiSelectable", "isReadonly", "gridLabel", "labelledBy", "toCssUnitString", "LitElement", "html", "customElement", "property", "state", "tagName", "SelectableGrid", "LitElement", "items", "index", "focusItem", "message", "updateLiveRegion", "msg", "originalIndex", "newIndex", "ReorderEvent", "result", "enterDragMode", "options", "exitDragMode", "direction", "newItems", "handleKeyboardDragMove", "element", "getGridItem", "event", "handleGridKeyDown", "handleItemKeyDown", "itemId", "target", "targetItem", "item", "newSelected", "handleItemSelection", "SelectionChangeEvent", "handleDragStart", "handleDragOver", "handleDrop", "changes", "changedProperties", "normalizeSelection", "titleId", "gridId", "dragInstructionsId", "generateAccessibilityIds", "render", "commonStyles", "styles", "__decorateClass", "property", "state", "customElement", "tagName", "tagName", "PromptAdvanced", "LitElement", "localizeBundleDefault", "unlocalized", "SettingInteractEvent", "PROMPT_KEY", "PROMPT_BREAKPOINT_M", "applicationId", "settingId", "item", "arrayOrSingleItemId", "AdvancedSettingChangeEvent", "shouldShowMoreText", "PROMPT_BREAKPOINT_S", "html", "MoreButtonClickEvent", "advancedSetting", "items", "selectedApplicationId", "selectedSettingValueIds", "selectedValuesSet", "itemIdToValue", "itemOrSection", "isItem", "acc", "gridItems", "itemIsSelected", "selectedItems", "e", "id", "selectedSettings", "isModelSetting", "MODEL_KEY", "shouldShowModelText", "defaultItemId", "getDefaultItem", "selectedSettingValueId", "allValuesExist", "valueIds", "valueIdArray", "initialItemValue", "shouldShowCoachIndicator", "nothing", "classMap", "ifDefined", "target", "itemId", "value", "repeat", "itemOrSectionId", "index", "advancedSettingItem", "advancedSettingSection", "APPLICATION_KEY", "applicationConfigItem", "breakpoint", "getCurrentScreenWidthId", "availableSettings", "s", "modelSetting", "setting", "hasLoadedModels", "styleMap", "aspectRatioSetting", "ASPECT_RATIO_KEY", "aspectRatioId", "aspectRatioItem", "isGenerateVisible", "GenerateEvent", "isDark", "useSpectrumTheme", "selectedApplicationConfigItem", "outerClass", "innerClass", "promptConfig", "getPromptConfig", "shouldShowGradient", "PROMPT_MAXROWS", "PromptChangeEvent", "event", "shouldHideText", "modelSettings", "pickerId", "picker", "button", "labelSpan", "labelElement", "selectedItem", "selectedValueId", "labelEl", "endIcon", "iconSpan", "iconContainer", "render", "changedProperties", "nextId", "slicedPrompt", "ApplicationChangeEvent", "commonStyles", "styles", "__decorateClass", "property", "state", "queryAll", "query", "withHooks", "customElement", "html", "PROVIDER_CAPITALIZATION", "PROVIDER_SORT_CONFIG", "capitalizeProvider", "provider", "lower", "getModelDisplayName", "modelConfig", "getProviderFromModelId", "modelId", "parts", "parseModelNameAndVersion", "name", "versionMatch", "firstSpaceIndex", "suffix", "getSortedModelList", "modelDict", "modelsByQuality", "modelsByProvider", "key", "model", "displayName", "entry", "group", "sortedQualities", "_keyA", "modelA", "_keyB", "modelB", "entryA", "entryB", "parsedA", "parsedB", "normalizeFirstWord", "word", "firstWordA", "firstWordB", "firstWordCompare", "versionCompare", "suffixFirst", "suffixCompare", "entries", "_providerA", "groupA", "_providerB", "groupB", "firstEntryA", "firstEntryB", "_provider", "all", "firstParty", "thirdParty", "THUMBNAIL_SIZE", "THUMBNAIL_BORDER_RADIUS", "parseImageGenerationConfig", "modelDictionary", "effects", "selectedModelId", "isPaidPremium", "highlightModelPicker", "hideModelPicker", "placeholder", "localized", "localizeBundleDefault", "unlocalized", "isMobile", "defaultModelIds", "modelPreviewSuffix", "sortedModels", "getSortedModelList", "modelIds", "id", "defaultModelId", "_modelItems", "modelConfig", "isPreviewModel", "getModelSettingKey", "PromptBarAppConfigKey", "getModelDisplayName", "getModelIcon", "modelItems", "getModelSections", "selectedModelConfig", "outputSizes", "aspectRatioItems", "parseAspectRatioItems", "getDefaultAspectRatioPriority", "effectsItems", "effect", "selected", "html", "config", "imageIcon", "aspectRatioIcon", "setting", "SupportedSettingsDefault", "createSettingValueMap", "parseVideoGenerationConfig", "modelDictionary", "selectedModelId", "userInputValues", "options", "isPaidPremium", "highlightModelPicker", "hideModelPicker", "localized", "localizeBundleDefault", "unlocalized", "isMobile", "defaultModelIds", "placeholder", "sortedModels", "getSortedModelList", "modelIds", "id", "defaultModelId", "_modelItems", "modelConfig", "getModelSettingKey", "PromptBarAppConfigKey", "getModelDisplayName", "getModelIcon", "outputSizes", "aspectRatioItems", "parseAspectRatioItems", "getDefaultAspectRatioPriority", "modelItems", "getModelSections", "config", "videoIcon", "aspectRatioIcon", "VIDEO_REFERENCE_FRAMES_FIRST_FRAME_KEY", "VIDEO_REFERENCE_FRAMES_END_FRAME_KEY", "_", "index", "setting", "firstFrameValue", "endFrameValue", "createSettingValueMap", "parseSoundFXGenerationConfig", "localized", "localizeBundleDefault", "unlocalized", "placeholder", "PromptBarAppConfigKey", "soundFxIcon", "PromptBarAppApplicationChangeEvent", "_PromptBarAppApplicationChangeEvent", "applicationId", "PromptBarAppMoreButtonClickEvent", "_PromptBarAppMoreButtonClickEvent", "detail", "PromptBarAppGenerateEvent", "_PromptBarAppGenerateEvent", "PromptBarAppSettingInteractEvent", "_PromptBarAppSettingInteractEvent"]
}
